{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"OpenLibx402: Autonomous Payments for AI Agents","text":"<p>Enable AI agents and web APIs to autonomously pay for services using HTTP 402 \"Payment Required\" and Solana blockchain</p> <p> </p>"},{"location":"#what-is-openlibx402","title":"What is OpenLibx402?","text":"<p>OpenLibx402 is a library ecosystem that implements the X402 protocol - an open standard for enabling AI agents to autonomously pay for API access, data, and digital services using the HTTP 402 \"Payment Required\" status code and blockchain micropayments.</p>"},{"location":"#key-features","title":"Key Features","text":"<p>\u2728 One-Line Integration - Add payments to APIs with a single decorator \ud83e\udd16 AI-Native - Built specifically for autonomous agent workflows \u26a1 Instant Settlement - Payments settle in ~200ms on Solana \ud83d\udcb0 Micropayments - Support payments as low as $0.001 \ud83d\udd10 No Accounts - No API keys, subscriptions, or manual billing \ud83c\udf10 Chain-Agnostic Design - Solana first, architected for multi-chain \ud83d\udee0\ufe0f Framework Integrations - FastAPI, LangChain, LangGraph, and more</p>"},{"location":"#quick-start","title":"Quick Start","text":""},{"location":"#server-fastapi","title":"Server (FastAPI)","text":"<pre><code>from fastapi import FastAPI\nfrom openlibx402_fastapi import payment_required\n\napp = FastAPI()\n\n@app.get(\"/premium-data\")\n@payment_required(\n    amount=\"0.10\",\n    payment_address=\"YOUR_WALLET_ADDRESS\",\n    token_mint=\"USDC_MINT_ADDRESS\"\n)\nasync def get_premium_data():\n    return {\"data\": \"Premium content\"}\n</code></pre>"},{"location":"#client-auto-payment","title":"Client (Auto-Payment)","text":"<pre><code>from openlibx402_client import X402AutoClient\nfrom solders.keypair import Keypair\n\nclient = X402AutoClient(wallet_keypair=keypair)\n\n# Automatically handles 402 and pays\nresponse = await client.fetch(\"https://api.example.com/premium-data\")\ndata = response.json()\n</code></pre>"},{"location":"#langchain-agent","title":"LangChain Agent","text":"<pre><code>from openlibx402_langchain import create_x402_agent\nfrom langchain.chat_models import ChatOpenAI\n\nagent = create_x402_agent(\n    wallet_keypair=keypair,\n    llm=ChatOpenAI(),\n    max_payment=\"5.0\"\n)\n\nresponse = agent.run(\"Get premium market data from the API\")\n</code></pre>"},{"location":"#how-it-works","title":"How It Works","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  AI Agent   \u2502  \u25001\u2500\u2192   \u2502  API Server  \u2502         \u2502 Blockchain \u2502\n\u2502   (Client)  \u2502         \u2502   (Server)   \u2502         \u2502  (Solana)  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502                        \u2502                        \u2502\n       \u2502  GET /data             \u2502                        \u2502\n       \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192\u2502                        \u2502\n       \u2502                        \u2502                        \u2502\n       \u2502  402 Payment Required  \u2502                        \u2502\n       \u2502  + Payment Details     \u2502                        \u2502\n       \u2502\u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524                        \u2502\n       \u2502                        \u2502                        \u2502\n       \u2502  Create &amp; Broadcast    \u2502                        \u2502\n       \u2502  Payment Transaction   \u2502                        \u2502\n       \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192\u2502\n       \u2502                        \u2502                        \u2502\n       \u2502                        \u2502   Verify Transaction   \u2502\n       \u2502                        \u2502\u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n       \u2502                        \u2502                        \u2502\n       \u2502  GET /data             \u2502                        \u2502\n       \u2502  + Payment Auth Header \u2502                        \u2502\n       \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192\u2502                        \u2502\n       \u2502                        \u2502                        \u2502\n       \u2502  200 OK + Data         \u2502                        \u2502\n       \u2502\u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524                        \u2502\n</code></pre>"},{"location":"#documentation","title":"Documentation","text":"<p>\ud83d\udcda Technical Specification - Complete architecture and design \ud83d\udcd6 Quick Reference - Common patterns and examples \ud83d\udcdd Project Summary - Overview and next steps</p>"},{"location":"#packages","title":"Packages","text":""},{"location":"#core","title":"Core","text":"<ul> <li><code>openlibx402-core</code> - Core protocol implementation</li> <li><code>@openlibx402/core</code> - TypeScript equivalent</li> </ul>"},{"location":"#server-frameworks","title":"Server Frameworks","text":"<ul> <li><code>openlibx402-fastapi</code> - FastAPI middleware (Python)</li> <li><code>@openlibx402/express</code> - Express.js middleware (TypeScript)</li> <li><code>@openlibx402/nextjs</code> - Next.js API routes (TypeScript)</li> <li><code>@openlibx402/hono</code> - Hono middleware (TypeScript)</li> </ul>"},{"location":"#client-libraries","title":"Client Libraries","text":"<ul> <li><code>openlibx402-client</code> - HTTP client with payment support (Python)</li> <li><code>@openlibx402/client</code> - TypeScript client</li> </ul>"},{"location":"#ai-agent-integrations","title":"AI Agent Integrations","text":"<ul> <li><code>openlibx402-langchain</code> - LangChain Tool &amp; Middleware (Python)</li> <li><code>openlibx402-langgraph</code> - LangGraph nodes (Python)</li> <li><code>@openlibx402/langchain</code> - TypeScript LangChain integration</li> <li><code>@openlibx402/langgraph</code> - TypeScript LangGraph integration</li> </ul>"},{"location":"#use-cases","title":"Use Cases","text":""},{"location":"#for-api-providers","title":"For API Providers","text":"<ul> <li>\ud83d\udcb5 Monetize APIs with pay-per-use pricing</li> <li>\ud83d\udeab Eliminate API key management</li> <li>\u26a1 Instant payment settlement</li> <li>\ud83d\udee1\ufe0f No chargebacks or fraud risk</li> </ul>"},{"location":"#for-ai-agents","title":"For AI Agents","text":"<ul> <li>\ud83d\udd13 Access premium data without human intervention</li> <li>\ud83d\udcb0 Pay exactly for what you use</li> <li>\ud83c\udf0d No geographic restrictions</li> <li>\ud83e\udd16 Fully autonomous operation</li> </ul>"},{"location":"#real-world-examples","title":"Real-World Examples","text":"<ul> <li>\ud83d\udcca Research agent paying per financial data point</li> <li>\ud83c\udfaf Trading bot accessing real-time market data</li> <li>\ud83d\udcf0 Content aggregator paying per article</li> <li>\ud83d\uddbc\ufe0f Image generation API charging per image</li> <li>\u2601\ufe0f GPU compute charged per minute</li> </ul>"},{"location":"#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    Application Layer                    \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510             \u2502\n\u2502  \u2502 FastAPI  \u2502  \u2502LangChain \u2502  \u2502LangGraph \u2502             \u2502\n\u2502  \u2502 Middleware\u2502  \u2502   Tool   \u2502  \u2502  Nodes   \u2502             \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n        \u2502             \u2502             \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              openlibx402-core / @openlibx402/core              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502   Payment    \u2502  \u2502    Solana    \u2502  \u2502     Error     \u2502  \u2502\n\u2502  \u2502    Models    \u2502  \u2502  Processor   \u2502  \u2502   Handling    \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                            \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   Blockchain Layer                       \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u2502\n\u2502  \u2502  Solana  \u2502  \u2502 Ethereum \u2502  \u2502   Base   \u2502  (Future)    \u2502\n\u2502  \u2502  Devnet  \u2502  \u2502 Mainnet  \u2502  \u2502    L2    \u2502              \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"#development-status","title":"Development Status","text":""},{"location":"#phase-1-python","title":"\u2705 Phase 1: Python","text":"<ul> <li>\u2705 Technical specification complete</li> <li>\u2705 Core package (Python)</li> <li>\u2705 FastAPI integration</li> <li>\u2705 Client library</li> <li>\u2705 LangChain integration</li> <li>\u2705 LangGraph integration</li> <li>\u2705 Example implementations</li> </ul>"},{"location":"#phase-2-typescript","title":"\ud83c\udfd7\ufe0f Phase 2: TypeScript","text":"<ul> <li>\u2705 Core package (TypeScript)</li> <li>\u2705 Express.js middleware</li> <li>\u2705 Client library (TS)</li> <li>\u2705 LangChain.js integration</li> <li>\u2705 LangGraph.js integration</li> <li>\ud83c\udfd7\ufe0f Next.js integration</li> </ul>"},{"location":"#phase-3-ecosystem","title":"\ud83d\udd32 Phase 3: Ecosystem","text":"<ul> <li>[ ] Flask middleware</li> <li>[ ] Django middleware</li> <li>[ ] Hono middleware</li> <li>[ ] Additional agent frameworks</li> <li>[ ] CLI tools</li> </ul>"},{"location":"#phase-4-advanced","title":"\ud83d\udd32 Phase 4: Advanced","text":"<ul> <li>[ ] Multi-chain support (Ethereum, Base)</li> <li>[ ] Payment batching</li> <li>[ ] Admin dashboard</li> <li>[ ] Analytics &amp; monitoring</li> <li>[ ] Browser extension</li> </ul>"},{"location":"#installation-when-available","title":"Installation (When Available)","text":""},{"location":"#python","title":"Python","text":"<pre><code>pip install openlibx402-core openlibx402-fastapi openlibx402-client\npip install openlibx402-langchain openlibx402-langgraph\n</code></pre>"},{"location":"#typescript","title":"TypeScript","text":"<pre><code>npm install @openlibx402/core @openlibx402/express @openlibx402/client\nnpm install @openlibx402/langchain @openlibx402/langgraph\n</code></pre>"},{"location":"#examples","title":"Examples","text":""},{"location":"#fastapi-server","title":"FastAPI Server","text":"<pre><code>from fastapi import FastAPI\nfrom openlibx402_fastapi import X402Config, init_x402, payment_required\n\n# Initialize X402\nconfig = X402Config(\n    payment_address=\"YOUR_WALLET\",\n    token_mint=\"USDC_MINT\",\n    network=\"solana-devnet\"\n)\ninit_x402(config)\n\napp = FastAPI()\n\n@app.get(\"/basic-data\")\nasync def get_basic_data():\n    return {\"data\": \"Free content\"}\n\n@app.get(\"/premium-data\")\n@payment_required(amount=\"0.10\", description=\"Premium market data\")\nasync def get_premium_data():\n    return {\"data\": \"Premium content\", \"price\": 100.50}\n</code></pre>"},{"location":"#langchain-agent_1","title":"LangChain Agent","text":"<pre><code>from langchain.chat_models import ChatOpenAI\nfrom openlibx402_langchain import create_x402_agent\nfrom solders.keypair import Keypair\n\n# Load wallet\nkeypair = Keypair()\n\n# Create agent with X402 support\nagent = create_x402_agent(\n    wallet_keypair=keypair,\n    llm=ChatOpenAI(),\n    max_payment=\"5.0\"\n)\n\n# Agent can now autonomously pay for API access\nresponse = agent.run(\n    \"Get the latest market data from https://api.example.com/premium-data \"\n    \"and summarize the key trends\"\n)\n</code></pre>"},{"location":"#langgraph-workflow","title":"LangGraph Workflow","text":"<pre><code>from typing import TypedDict\nfrom langgraph.graph import StateGraph, END\nfrom openlibx402_langgraph import payment_node, check_payment_required\nfrom solders.keypair import Keypair\n\nclass AgentState(TypedDict):\n    api_url: str\n    api_response: str\n    payment_required: bool\n    payment_completed: bool\n    wallet_keypair: Keypair\n\nworkflow = StateGraph(AgentState)\n\nworkflow.add_node(\"fetch\", fetch_api_node)\nworkflow.add_node(\"pay\", payment_node)  # From openlibx402-langgraph\nworkflow.add_node(\"process\", process_node)\n\nworkflow.set_entry_point(\"fetch\")\n\nworkflow.add_conditional_edges(\n    \"fetch\",\n    check_payment_required,\n    {\n        \"payment_required\": \"pay\",\n        \"success\": \"process\",\n        \"error\": END\n    }\n)\n\nworkflow.add_edge(\"pay\", \"fetch\")\nworkflow.add_edge(\"process\", END)\n\napp = workflow.compile()\n</code></pre>"},{"location":"#configuration","title":"Configuration","text":""},{"location":"#environment-variables","title":"Environment Variables","text":"<pre><code>X402_PAYMENT_ADDRESS=YourSolanaWalletAddress\nX402_TOKEN_MINT=USDC_MINT_ADDRESS\nX402_NETWORK=solana-devnet\nX402_RPC_URL=https://api.devnet.solana.com\n</code></pre>"},{"location":"#code-configuration","title":"Code Configuration","text":"<pre><code>from openlibx402_fastapi import X402Config\n\nconfig = X402Config(\n    payment_address=\"YOUR_WALLET\",\n    token_mint=\"USDC_MINT\",\n    network=\"solana-devnet\",\n    rpc_url=\"https://api.devnet.solana.com\",\n    payment_timeout=300,  # 5 minutes\n    auto_verify=True\n)\n</code></pre>"},{"location":"#security","title":"Security","text":"<p>\ud83d\udd10 Key Security Features: - Private keys never leave client - On-chain transaction verification - Nonce-based replay protection - Payment expiration timestamps - Maximum payment limits - HTTPS required for production</p> <p>\u26a0\ufe0f Security Best Practices: - Never log private keys - Use environment variables for secrets - Validate all payment fields - Set reasonable payment timeouts - Implement rate limiting - Use hardware wallets in production</p>"},{"location":"#testing","title":"Testing","text":""},{"location":"#mock-payment-processor","title":"Mock Payment Processor","text":"<pre><code>from openlibx402_core.testing import MockSolanaPaymentProcessor\n\nprocessor = MockSolanaPaymentProcessor()\nprocessor.balance = 100.0\n\n# Use in tests without real blockchain\nclient = X402AutoClient(wallet_keypair=test_keypair)\nclient.client.processor = processor\n</code></pre>"},{"location":"#test-server","title":"Test Server","text":"<pre><code>from openlibx402_core.testing import TestServer\n\nserver = TestServer(\n    payment_address=\"test_address\",\n    token_mint=\"test_usdc\"\n)\nserver.start(port=8402)\n\n# Test against mock server\n# ...\n</code></pre>"},{"location":"#contributing","title":"Contributing","text":"<p>We welcome contributions! Here's how you can help:</p> <ol> <li>\ud83d\udc1b Report bugs via GitHub Issues</li> <li>\ud83d\udca1 Suggest features or improvements</li> <li>\ud83d\udcdd Improve documentation</li> <li>\ud83d\udd27 Submit pull requests</li> <li>\u2b50 Star the repository</li> </ol>"},{"location":"#development-setup","title":"Development Setup","text":"<pre><code># Clone repository\ngit clone https://github.com/openlibx402/openlibx402.git\ncd openlibx402\n\n# Install development dependencies\npip install -e \"packages/python/openlibx402-core[dev]\"\n\n# Run tests\npytest\n\n# Format code\nblack packages/python/\n</code></pre>"},{"location":"#roadmap","title":"Roadmap","text":""},{"location":"#q4-2025","title":"Q4 2025","text":"<ul> <li>\u2705 Technical specification</li> <li>\u2705 Core libraries (Python &amp; TypeScript)</li> <li>\u2705 FastAPI integration</li> <li>\u2705 LangChain/LangGraph integrations</li> <li>\u2705 Express.js, Next.js integrations</li> <li>\u2705 Documentation site</li> <li>\ud83d\udd32 Additional framework support</li> <li>\ud83d\udd32 CLI tools</li> </ul>"},{"location":"#2026","title":"2026","text":"<ul> <li>\ud83d\udd32 Multi-chain support (Ethereum, Base)</li> <li>\ud83d\udd32 Admin dashboard</li> <li>\ud83d\udd32 Analytics &amp; monitoring</li> <li>\ud83d\udd32 Production deployments</li> <li>\ud83d\udd32 Browser extension</li> <li>\ud83d\udd32 Wallet UI components</li> <li>\ud83d\udd32 Zapier/Make.com integrations</li> <li>\ud83d\udd32 Enterprise features</li> </ul>"},{"location":"#faq","title":"FAQ","text":"<p>Q: Why Solana first? A: Solana offers ~200ms transaction finality and &lt;$0.0001 fees, making it ideal for micropayments.</p> <p>Q: Will this support other blockchains? A: Yes! The architecture is designed to be chain-agnostic. Ethereum and Base L2 support is planned.</p> <p>Q: Do I need crypto knowledge to use this? A: Minimal. The libraries handle blockchain complexity. You just need a wallet and some tokens.</p> <p>Q: Is this production-ready? A: Not yet. We're currently in development. Follow progress on GitHub.</p> <p>Q: How much do transactions cost? A: On Solana devnet/mainnet, transaction fees are &lt;$0.0001. Payment amounts are configurable.</p> <p>Q: Can agents really operate autonomously? A: Yes! Once configured with a wallet, agents can discover, pay for, and use APIs without human intervention.</p>"},{"location":"#resources","title":"Resources","text":"<ul> <li>\ud83d\udcc4 X402 Whitepaper</li> <li>\ud83c\udf10 X402 Protocol Website</li> <li>\ud83d\udcda Solana Documentation</li> <li>\ud83d\udd17 SPL Token Program</li> <li>\ud83e\udd9c LangChain Docs</li> <li>\ud83d\udd78\ufe0f LangGraph Docs</li> </ul>"},{"location":"#community","title":"Community","text":"<ul> <li>\ud83d\udcac Discord - Coming soon</li> <li>\ud83d\udc26 Twitter - @openlibx402</li> <li>\ud83d\udce7 Email - x402@openlib.xyz</li> </ul>"},{"location":"#license","title":"License","text":"<p>OpenLibx402 is released under the MIT License.</p>"},{"location":"#acknowledgments","title":"Acknowledgments","text":"<ul> <li>Built on the X402 protocol by Coinbase</li> <li>Powered by Solana blockchain</li> <li>Integrates with LangChain and LangGraph</li> </ul> <p>Built with \u2764\ufe0f for the autonomous AI economy</p> <p>Documentation | Examples | Contribute</p>"},{"location":"openlibx402-technical-spec/","title":"OpenLibx402 Technical Specification","text":""},{"location":"openlibx402-technical-spec/#project-overview","title":"Project Overview","text":"<p>OpenLibx402 is a library ecosystem that implements the X402 protocol for enabling autonomous, frictionless payments in AI agents and web APIs. The protocol leverages HTTP 402 \"Payment Required\" status code and Solana blockchain for instant, low-cost transactions.</p>"},{"location":"openlibx402-technical-spec/#core-principles","title":"Core Principles","text":"<ol> <li>Machine-Native Payments: Enable AI agents to autonomously pay for API access without human intervention</li> <li>Pay-Per-Use: Support micropayments with near-zero transaction costs</li> <li>Developer-Friendly: Simple integration with one-line middleware</li> <li>Blockchain-Agnostic Design: Start with Solana, architect for future chain support</li> <li>Dual API Approach: Support both explicit and implicit payment handling</li> </ol>"},{"location":"openlibx402-technical-spec/#project-structure","title":"Project Structure","text":"<pre><code>openlibx402/\n\u251c\u2500\u2500 packages/\n\u2502   \u251c\u2500\u2500 core/                      # Core protocol implementation\n\u2502   \u2502   \u251c\u2500\u2500 python/\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 openlibx402-core/\n\u2502   \u2502   \u2514\u2500\u2500 typescript/\n\u2502   \u2502       \u2514\u2500\u2500 @openlibx402/core\n\u2502   \u2502\n\u2502   \u251c\u2500\u2500 server/                    # Server-side libraries\n\u2502   \u2502   \u251c\u2500\u2500 python/\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 openlibx402-fastapi/\n\u2502   \u2502   \u2514\u2500\u2500 typescript/\n\u2502   \u2502       \u251c\u2500\u2500 @openlibx402/express\n\u2502   \u2502       \u251c\u2500\u2500 @openlibx402/nextjs\n\u2502   \u2502       \u2514\u2500\u2500 @openlibx402/hono\n\u2502   \u2502\n\u2502   \u251c\u2500\u2500 client/                    # Client-side libraries\n\u2502   \u2502   \u251c\u2500\u2500 python/\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 openlibx402-client/\n\u2502   \u2502   \u2514\u2500\u2500 typescript/\n\u2502   \u2502       \u2514\u2500\u2500 @openlibx402/client\n\u2502   \u2502\n\u2502   \u2514\u2500\u2500 integrations/              # Framework integrations\n\u2502       \u251c\u2500\u2500 python/\n\u2502       \u2502   \u251c\u2500\u2500 openlibx402-langchain/\n\u2502       \u2502   \u2514\u2500\u2500 openlibx402-langgraph/\n\u2502       \u2514\u2500\u2500 typescript/\n\u2502           \u251c\u2500\u2500 @openlibx402/langchain\n\u2502           \u2514\u2500\u2500 @openlibx402/langgraph\n\u2502\n\u251c\u2500\u2500 examples/                      # Example implementations\n\u2502   \u251c\u2500\u2500 fastapi-server/\n\u2502   \u251c\u2500\u2500 langchain-agent/\n\u2502   \u251c\u2500\u2500 langgraph-workflow/\n\u2502   \u2514\u2500\u2500 fullstack-demo/\n\u2502\n\u2514\u2500\u2500 docs/\n    \u251c\u2500\u2500 getting-started.md\n    \u251c\u2500\u2500 api-reference.md\n    \u2514\u2500\u2500 integration-guides/\n</code></pre>"},{"location":"openlibx402-technical-spec/#1-core-protocol-implementation","title":"1. Core Protocol Implementation","text":""},{"location":"openlibx402-technical-spec/#package-openlibx402-core-python-openlibx402core-typescript","title":"Package: <code>openlibx402-core</code> (Python) / <code>@openlibx402/core</code> (TypeScript)","text":""},{"location":"openlibx402-technical-spec/#purpose","title":"Purpose","text":"<p>Core protocol logic for X402 payment flow, independent of any framework.</p>"},{"location":"openlibx402-technical-spec/#key-components","title":"Key Components","text":""},{"location":"openlibx402-technical-spec/#11-payment-request-structure","title":"1.1 Payment Request Structure","text":"<pre><code># Python\nfrom dataclasses import dataclass\nfrom typing import Optional\nfrom datetime import datetime\n\n@dataclass\nclass PaymentRequest:\n    \"\"\"Represents an X402 payment request (402 response)\"\"\"\n    max_amount_required: str           # Amount in token units (e.g., \"0.10\")\n    asset_type: str                    # \"SPL\" for Solana tokens\n    asset_address: str                 # Token mint address\n    payment_address: str               # Recipient's wallet address\n    network: str                       # \"solana-devnet\" | \"solana-mainnet\"\n    expires_at: datetime               # Expiration timestamp\n    nonce: str                         # Unique identifier for replay protection\n    payment_id: str                    # Unique payment request ID\n    resource: str                      # API endpoint being accessed\n    description: Optional[str] = None  # Human-readable description\n\n    def to_dict(self) -&gt; dict:\n        \"\"\"Convert to JSON-serializable dict\"\"\"\n        pass\n\n    @classmethod\n    def from_dict(cls, data: dict) -&gt; 'PaymentRequest':\n        \"\"\"Parse from 402 response JSON\"\"\"\n        pass\n\n    def is_expired(self) -&gt; bool:\n        \"\"\"Check if payment request has expired\"\"\"\n        pass\n</code></pre> <pre><code>// TypeScript\nexport interface PaymentRequest {\n  maxAmountRequired: string;\n  assetType: string;\n  assetAddress: string;\n  paymentAddress: string;\n  network: string;\n  expiresAt: Date;\n  nonce: string;\n  paymentId: string;\n  resource: string;\n  description?: string;\n}\n\nexport class PaymentRequestParser {\n  static parse(response: Response): PaymentRequest;\n  static isExpired(request: PaymentRequest): boolean;\n  static toJSON(request: PaymentRequest): string;\n}\n</code></pre>"},{"location":"openlibx402-technical-spec/#12-payment-authorization","title":"1.2 Payment Authorization","text":"<pre><code>@dataclass\nclass PaymentAuthorization:\n    \"\"\"Signed payment authorization to be sent with retry request\"\"\"\n    payment_id: str                    # From payment request\n    actual_amount: str                 # Amount being paid (\u2264 max_amount_required)\n    payment_address: str               # Recipient address\n    asset_address: str                 # Token mint address\n    network: str                       # Blockchain network\n    timestamp: datetime                # Authorization timestamp\n    signature: str                     # Solana signature\n    public_key: str                    # Payer's public key\n    transaction_hash: Optional[str]    # On-chain tx hash (after broadcast)\n\n    def to_header_value(self) -&gt; str:\n        \"\"\"Encode as X-Payment-Authorization header value\"\"\"\n        pass\n\n    @classmethod\n    def from_header(cls, header_value: str) -&gt; 'PaymentAuthorization':\n        \"\"\"Parse from request header\"\"\"\n        pass\n</code></pre> <pre><code>export interface PaymentAuthorization {\n  paymentId: string;\n  actualAmount: string;\n  paymentAddress: string;\n  assetAddress: string;\n  network: string;\n  timestamp: Date;\n  signature: string;\n  publicKey: string;\n  transactionHash?: string;\n}\n\nexport class PaymentAuthorizationHandler {\n  static toHeader(auth: PaymentAuthorization): string;\n  static fromHeader(headerValue: string): PaymentAuthorization;\n  static verify(auth: PaymentAuthorization, request: PaymentRequest): boolean;\n}\n</code></pre>"},{"location":"openlibx402-technical-spec/#13-solana-integration","title":"1.3 Solana Integration","text":"<pre><code>from solana.rpc.async_api import AsyncClient\nfrom solana.transaction import Transaction\nfrom solders.keypair import Keypair\nfrom solders.pubkey import Pubkey\nfrom spl.token.instructions import transfer_checked, TransferCheckedParams\n\nclass SolanaPaymentProcessor:\n    \"\"\"Handles Solana blockchain operations\"\"\"\n\n    def __init__(self, rpc_url: str, keypair: Optional[Keypair] = None):\n        self.client = AsyncClient(rpc_url)\n        self.keypair = keypair\n\n    async def create_payment_transaction(\n        self,\n        request: PaymentRequest,\n        amount: str,\n        payer_keypair: Keypair\n    ) -&gt; Transaction:\n        \"\"\"Create a Solana transaction for the payment\"\"\"\n        pass\n\n    async def sign_and_send_transaction(\n        self,\n        transaction: Transaction,\n        keypair: Keypair\n    ) -&gt; str:\n        \"\"\"Sign and broadcast transaction, return tx hash\"\"\"\n        pass\n\n    async def verify_transaction(\n        self,\n        transaction_hash: str,\n        expected_recipient: str,\n        expected_amount: str,\n        expected_token_mint: str\n    ) -&gt; bool:\n        \"\"\"Verify a transaction was successful and matches expectations\"\"\"\n        pass\n\n    async def get_token_balance(\n        self,\n        wallet_address: str,\n        token_mint: str\n    ) -&gt; float:\n        \"\"\"Get token balance for a wallet\"\"\"\n        pass\n</code></pre> <pre><code>import { Connection, Keypair, PublicKey, Transaction } from '@solana/web3.js';\nimport { getAssociatedTokenAddress, createTransferCheckedInstruction } from '@solana/spl-token';\n\nexport class SolanaPaymentProcessor {\n  private connection: Connection;\n  private keypair?: Keypair;\n\n  constructor(rpcUrl: string, keypair?: Keypair);\n\n  async createPaymentTransaction(\n    request: PaymentRequest,\n    amount: string,\n    payerKeypair: Keypair\n  ): Promise&lt;Transaction&gt;;\n\n  async signAndSendTransaction(\n    transaction: Transaction,\n    keypair: Keypair\n  ): Promise&lt;string&gt;;\n\n  async verifyTransaction(\n    transactionHash: string,\n    expectedRecipient: string,\n    expectedAmount: string,\n    expectedTokenMint: string\n  ): Promise&lt;boolean&gt;;\n\n  async getTokenBalance(\n    walletAddress: string,\n    tokenMint: string\n  ): Promise&lt;number&gt;;\n}\n</code></pre>"},{"location":"openlibx402-technical-spec/#14-error-handling","title":"1.4 Error Handling","text":"<pre><code>class X402Error(Exception):\n    \"\"\"Base exception for X402 protocol errors\"\"\"\n    code: str\n    message: str\n    details: Optional[dict]\n\nclass PaymentRequiredError(X402Error):\n    \"\"\"Raised when 402 response received\"\"\"\n    code = \"PAYMENT_REQUIRED\"\n    payment_request: PaymentRequest\n\nclass PaymentExpiredError(X402Error):\n    \"\"\"Payment request has expired\"\"\"\n    code = \"PAYMENT_EXPIRED\"\n\nclass InsufficientFundsError(X402Error):\n    \"\"\"Wallet has insufficient funds\"\"\"\n    code = \"INSUFFICIENT_FUNDS\"\n    required_amount: str\n    available_amount: str\n\nclass PaymentVerificationError(X402Error):\n    \"\"\"Payment verification failed\"\"\"\n    code = \"PAYMENT_VERIFICATION_FAILED\"\n\nclass TransactionBroadcastError(X402Error):\n    \"\"\"Failed to broadcast transaction\"\"\"\n    code = \"TRANSACTION_BROADCAST_FAILED\"\n\nclass InvalidPaymentRequestError(X402Error):\n    \"\"\"Payment request format is invalid\"\"\"\n    code = \"INVALID_PAYMENT_REQUEST\"\n</code></pre> <pre><code>export class X402Error extends Error {\n  code: string;\n  details?: Record&lt;string, any&gt;;\n  constructor(message: string, code: string, details?: Record&lt;string, any&gt;);\n}\n\nexport class PaymentRequiredError extends X402Error {\n  paymentRequest: PaymentRequest;\n  constructor(paymentRequest: PaymentRequest);\n}\n\nexport class PaymentExpiredError extends X402Error {\n  constructor(paymentRequest: PaymentRequest);\n}\n\nexport class InsufficientFundsError extends X402Error {\n  requiredAmount: string;\n  availableAmount: string;\n  constructor(required: string, available: string);\n}\n\nexport class PaymentVerificationError extends X402Error {\n  constructor(reason: string);\n}\n\nexport class TransactionBroadcastError extends X402Error {\n  constructor(reason: string);\n}\n\nexport class InvalidPaymentRequestError extends X402Error {\n  constructor(reason: string);\n}\n</code></pre>"},{"location":"openlibx402-technical-spec/#2-server-side-implementation","title":"2. Server-Side Implementation","text":""},{"location":"openlibx402-technical-spec/#package-openlibx402-fastapi-python","title":"Package: <code>openlibx402-fastapi</code> (Python)","text":""},{"location":"openlibx402-technical-spec/#purpose_1","title":"Purpose","text":"<p>FastAPI middleware for accepting X402 payments on API endpoints.</p>"},{"location":"openlibx402-technical-spec/#key-components_1","title":"Key Components","text":""},{"location":"openlibx402-technical-spec/#21-middleware","title":"2.1 Middleware","text":"<pre><code>from fastapi import Request, Response\nfrom typing import Callable, Optional\nfrom datetime import datetime, timedelta\nimport secrets\n\nclass X402PaymentMiddleware:\n    \"\"\"FastAPI middleware for X402 payment handling\"\"\"\n\n    def __init__(\n        self,\n        payment_address: str,           # Recipient wallet address\n        token_mint: str,                # SPL token mint address (USDC)\n        network: str = \"solana-devnet\", # Network identifier\n        rpc_url: str = None,            # Solana RPC endpoint\n        payment_timeout: int = 300,     # Payment validity in seconds\n        auto_verify: bool = True,       # Auto-verify payments\n    ):\n        self.payment_address = payment_address\n        self.token_mint = token_mint\n        self.network = network\n        self.rpc_url = rpc_url or self._default_rpc_url(network)\n        self.payment_timeout = payment_timeout\n        self.auto_verify = auto_verify\n        self.processor = SolanaPaymentProcessor(self.rpc_url)\n\n    async def __call__(\n        self,\n        request: Request,\n        call_next: Callable,\n    ) -&gt; Response:\n        \"\"\"Process request, check for payment, return 402 if needed\"\"\"\n        pass\n\ndef payment_required(\n    amount: str,\n    payment_address: str,\n    token_mint: str,\n    network: str = \"solana-devnet\",\n    description: Optional[str] = None,\n    expires_in: int = 300,\n):\n    \"\"\"\n    Decorator for FastAPI endpoints requiring payment\n\n    Usage:\n        @app.get(\"/premium-data\")\n        @payment_required(\n            amount=\"0.10\",\n            payment_address=\"FPxxx...\",\n            token_mint=\"USDC_MINT_ADDRESS\"\n        )\n        async def get_premium_data():\n            return {\"data\": \"Premium content\"}\n    \"\"\"\n    def decorator(func):\n        async def wrapper(*args, **kwargs):\n            # Check for payment authorization header\n            # If missing, return 402 response\n            # If present, verify payment\n            # If valid, call original function\n            pass\n        return wrapper\n    return decorator\n</code></pre>"},{"location":"openlibx402-technical-spec/#22-dependency-injection-pattern","title":"2.2 Dependency Injection Pattern","text":"<pre><code>from fastapi import Depends, HTTPException\n\nasync def verify_payment(\n    request: Request,\n    required_amount: str,\n    payment_address: str,\n    token_mint: str,\n) -&gt; PaymentAuthorization:\n    \"\"\"\n    FastAPI dependency for payment verification\n\n    Usage:\n        @app.get(\"/premium-data\")\n        async def get_premium_data(\n            payment: PaymentAuthorization = Depends(\n                verify_payment_factory(\"0.10\", WALLET, TOKEN)\n            )\n        ):\n            return {\"data\": \"Premium content\"}\n    \"\"\"\n    pass\n\ndef verify_payment_factory(\n    amount: str,\n    payment_address: str,\n    token_mint: str,\n    network: str = \"solana-devnet\",\n):\n    \"\"\"Factory for creating payment verification dependency\"\"\"\n    async def _verify(request: Request) -&gt; PaymentAuthorization:\n        return await verify_payment(\n            request, amount, payment_address, token_mint\n        )\n    return _verify\n</code></pre>"},{"location":"openlibx402-technical-spec/#23-configuration","title":"2.3 Configuration","text":"<pre><code>from pydantic import BaseModel\n\nclass X402Config(BaseModel):\n    \"\"\"Global X402 configuration\"\"\"\n    payment_address: str\n    token_mint: str\n    network: str = \"solana-devnet\"\n    rpc_url: Optional[str] = None\n    default_amount: str = \"0.01\"\n    payment_timeout: int = 300\n    auto_verify: bool = True\n\n    class Config:\n        env_prefix = \"X402_\"  # Load from X402_* environment variables\n\n# Singleton configuration\n_config: Optional[X402Config] = None\n\ndef init_x402(config: X402Config):\n    \"\"\"Initialize global X402 configuration\"\"\"\n    global _config\n    _config = config\n\ndef get_config() -&gt; X402Config:\n    \"\"\"Get global X402 configuration\"\"\"\n    if _config is None:\n        raise RuntimeError(\"X402 not initialized. Call init_x402() first.\")\n    return _config\n</code></pre>"},{"location":"openlibx402-technical-spec/#24-response-builder","title":"2.4 Response Builder","text":"<pre><code>from fastapi.responses import JSONResponse\n\ndef build_402_response(\n    amount: str,\n    payment_address: str,\n    token_mint: str,\n    network: str,\n    resource: str,\n    description: Optional[str] = None,\n    expires_in: int = 300,\n) -&gt; JSONResponse:\n    \"\"\"Build a properly formatted 402 Payment Required response\"\"\"\n\n    payment_request = PaymentRequest(\n        max_amount_required=amount,\n        asset_type=\"SPL\",\n        asset_address=token_mint,\n        payment_address=payment_address,\n        network=network,\n        expires_at=datetime.utcnow() + timedelta(seconds=expires_in),\n        nonce=secrets.token_urlsafe(32),\n        payment_id=secrets.token_urlsafe(16),\n        resource=resource,\n        description=description,\n    )\n\n    return JSONResponse(\n        status_code=402,\n        content=payment_request.to_dict(),\n        headers={\n            \"X-Payment-Required\": \"true\",\n            \"X-Payment-Protocol\": \"x402\",\n        }\n    )\n</code></pre>"},{"location":"openlibx402-technical-spec/#3-client-side-implementation","title":"3. Client-Side Implementation","text":""},{"location":"openlibx402-technical-spec/#package-openlibx402-client-python-openlibx402client-typescript","title":"Package: <code>openlibx402-client</code> (Python) / <code>@openlibx402/client</code> (TypeScript)","text":""},{"location":"openlibx402-technical-spec/#purpose_2","title":"Purpose","text":"<p>Client libraries for making X402-enabled API calls with automatic payment handling.</p>"},{"location":"openlibx402-technical-spec/#key-components_2","title":"Key Components","text":""},{"location":"openlibx402-technical-spec/#31-explicit-client-manual-payment-control","title":"3.1 Explicit Client (Manual Payment Control)","text":"<pre><code>from typing import Optional, Dict, Any\nimport httpx\n\nclass X402Client:\n    \"\"\"\n    Explicit X402 client - developer controls payment flow\n\n    Usage:\n        client = X402Client(wallet_keypair)\n\n        # Check if payment required\n        response = await client.get(\"https://api.example.com/data\")\n\n        if client.payment_required(response):\n            payment_request = client.parse_payment_request(response)\n\n            # Make payment\n            authorization = await client.create_payment(payment_request)\n\n            # Retry with payment\n            response = await client.get(\n                \"https://api.example.com/data\",\n                payment=authorization\n            )\n    \"\"\"\n\n    def __init__(\n        self,\n        wallet_keypair: Keypair,\n        rpc_url: Optional[str] = None,\n        http_client: Optional[httpx.AsyncClient] = None,\n    ):\n        self.wallet_keypair = wallet_keypair\n        self.http_client = http_client or httpx.AsyncClient()\n        self.processor = SolanaPaymentProcessor(\n            rpc_url or \"https://api.devnet.solana.com\"\n        )\n\n    async def get(\n        self,\n        url: str,\n        payment: Optional[PaymentAuthorization] = None,\n        **kwargs\n    ) -&gt; httpx.Response:\n        \"\"\"Make GET request with optional payment\"\"\"\n        headers = kwargs.get(\"headers\", {})\n        if payment:\n            headers[\"X-Payment-Authorization\"] = payment.to_header_value()\n        kwargs[\"headers\"] = headers\n        return await self.http_client.get(url, **kwargs)\n\n    async def post(\n        self,\n        url: str,\n        payment: Optional[PaymentAuthorization] = None,\n        **kwargs\n    ) -&gt; httpx.Response:\n        \"\"\"Make POST request with optional payment\"\"\"\n        pass\n\n    def payment_required(self, response: httpx.Response) -&gt; bool:\n        \"\"\"Check if response requires payment\"\"\"\n        return response.status_code == 402\n\n    def parse_payment_request(\n        self,\n        response: httpx.Response\n    ) -&gt; PaymentRequest:\n        \"\"\"Parse payment request from 402 response\"\"\"\n        if not self.payment_required(response):\n            raise ValueError(\"Response does not require payment\")\n        return PaymentRequest.from_dict(response.json())\n\n    async def create_payment(\n        self,\n        request: PaymentRequest,\n        amount: Optional[str] = None,\n    ) -&gt; PaymentAuthorization:\n        \"\"\"\n        Create and broadcast payment for a payment request\n\n        Args:\n            request: Payment request from 402 response\n            amount: Optional custom amount (defaults to max_amount_required)\n\n        Returns:\n            PaymentAuthorization with transaction hash\n        \"\"\"\n        # Validate request not expired\n        if request.is_expired():\n            raise PaymentExpiredError(request)\n\n        # Use provided amount or max required\n        pay_amount = amount or request.max_amount_required\n\n        # Check sufficient balance\n        balance = await self.processor.get_token_balance(\n            str(self.wallet_keypair.pubkey()),\n            request.asset_address\n        )\n        if balance &lt; float(pay_amount):\n            raise InsufficientFundsError(pay_amount, str(balance))\n\n        # Create transaction\n        tx = await self.processor.create_payment_transaction(\n            request, pay_amount, self.wallet_keypair\n        )\n\n        # Sign and broadcast\n        tx_hash = await self.processor.sign_and_send_transaction(\n            tx, self.wallet_keypair\n        )\n\n        # Create authorization\n        return PaymentAuthorization(\n            payment_id=request.payment_id,\n            actual_amount=pay_amount,\n            payment_address=request.payment_address,\n            asset_address=request.asset_address,\n            network=request.network,\n            timestamp=datetime.utcnow(),\n            signature=\"\",  # Solana signature\n            public_key=str(self.wallet_keypair.pubkey()),\n            transaction_hash=tx_hash,\n        )\n</code></pre>"},{"location":"openlibx402-technical-spec/#32-implicit-client-automatic-payment","title":"3.2 Implicit Client (Automatic Payment)","text":"<pre><code>class X402AutoClient:\n    \"\"\"\n    Implicit X402 client - automatically handles payment flow\n\n    Usage:\n        client = X402AutoClient(wallet_keypair)\n\n        # Automatically detects 402 and pays\n        response = await client.fetch(\"https://api.example.com/data\")\n        data = response.json()\n    \"\"\"\n\n    def __init__(\n        self,\n        wallet_keypair: Keypair,\n        rpc_url: Optional[str] = None,\n        max_retries: int = 1,\n        auto_retry: bool = True,\n        max_payment_amount: Optional[str] = None,  # Safety limit\n    ):\n        self.client = X402Client(wallet_keypair, rpc_url)\n        self.max_retries = max_retries\n        self.auto_retry = auto_retry\n        self.max_payment_amount = max_payment_amount\n\n    async def fetch(\n        self,\n        url: str,\n        method: str = \"GET\",\n        auto_retry: Optional[bool] = None,\n        **kwargs\n    ) -&gt; httpx.Response:\n        \"\"\"\n        Make HTTP request with automatic payment handling\n\n        Args:\n            url: Request URL\n            method: HTTP method\n            auto_retry: Override instance auto_retry setting\n            **kwargs: Additional arguments for httpx request\n\n        Returns:\n            Response after payment (if required)\n\n        Raises:\n            PaymentRequiredError: If auto_retry is False and 402 received\n            InsufficientFundsError: If wallet lacks funds\n            PaymentExpiredError: If payment request expired\n        \"\"\"\n        should_retry = auto_retry if auto_retry is not None else self.auto_retry\n\n        # Initial request\n        response = await self._make_request(method, url, **kwargs)\n\n        # Check if payment required\n        if self.client.payment_required(response):\n            if not should_retry:\n                raise PaymentRequiredError(\n                    self.client.parse_payment_request(response)\n                )\n\n            # Parse payment request\n            payment_request = self.client.parse_payment_request(response)\n\n            # Safety check\n            if self.max_payment_amount:\n                if float(payment_request.max_amount_required) &gt; float(self.max_payment_amount):\n                    raise ValueError(\n                        f\"Payment amount {payment_request.max_amount_required} \"\n                        f\"exceeds max allowed {self.max_payment_amount}\"\n                    )\n\n            # Create payment\n            authorization = await self.client.create_payment(payment_request)\n\n            # Retry with payment\n            response = await self._make_request(\n                method, url, payment=authorization, **kwargs\n            )\n\n        return response\n\n    async def _make_request(\n        self,\n        method: str,\n        url: str,\n        payment: Optional[PaymentAuthorization] = None,\n        **kwargs\n    ) -&gt; httpx.Response:\n        \"\"\"Internal method to make HTTP request\"\"\"\n        if method.upper() == \"GET\":\n            return await self.client.get(url, payment=payment, **kwargs)\n        elif method.upper() == \"POST\":\n            return await self.client.post(url, payment=payment, **kwargs)\n        # ... other methods\n\n    async def get(self, url: str, **kwargs) -&gt; httpx.Response:\n        \"\"\"GET request with auto-payment\"\"\"\n        return await self.fetch(url, method=\"GET\", **kwargs)\n\n    async def post(self, url: str, **kwargs) -&gt; httpx.Response:\n        \"\"\"POST request with auto-payment\"\"\"\n        return await self.fetch(url, method=\"POST\", **kwargs)\n</code></pre> <pre><code>// TypeScript versions with similar structure\n\nexport class X402Client {\n  // Explicit client implementation\n}\n\nexport class X402AutoClient {\n  // Implicit auto-payment client implementation\n}\n</code></pre>"},{"location":"openlibx402-technical-spec/#4-langchain-integration","title":"4. LangChain Integration","text":""},{"location":"openlibx402-technical-spec/#package-openlibx402-langchain-python-openlibx402langchain-typescript","title":"Package: <code>openlibx402-langchain</code> (Python) / <code>@openlibx402/langchain</code> (TypeScript)","text":""},{"location":"openlibx402-technical-spec/#purpose_3","title":"Purpose","text":"<p>Integrate X402 payments into LangChain agents via Tools and HTTP request middleware.</p>"},{"location":"openlibx402-technical-spec/#key-components_3","title":"Key Components","text":""},{"location":"openlibx402-technical-spec/#41-x402-tool-for-agents","title":"4.1 X402 Tool (For Agents)","text":"<pre><code>from langchain.tools import BaseTool\nfrom pydantic import Field\nfrom typing import Optional\n\nclass X402PaymentTool(BaseTool):\n    \"\"\"\n    LangChain tool that allows agents to make payments for API access\n\n    Usage:\n        wallet_keypair = load_keypair()\n\n        payment_tool = X402PaymentTool(\n            wallet_keypair=wallet_keypair,\n            name=\"pay_for_api\",\n            description=\"Make payment to access premium API data\"\n        )\n\n        agent = initialize_agent(\n            tools=[payment_tool, ...],\n            llm=llm,\n        )\n    \"\"\"\n\n    name: str = \"x402_payment\"\n    description: str = (\n        \"Make an X402 payment to access a paid API endpoint. \"\n        \"Input should be a JSON string with 'url' and optional 'amount'. \"\n        \"Returns the API response after successful payment.\"\n    )\n\n    wallet_keypair: Keypair = Field(exclude=True)\n    rpc_url: Optional[str] = Field(default=None, exclude=True)\n    max_payment: Optional[str] = Field(default=\"1.0\", exclude=True)\n\n    def _run(\n        self,\n        url: str,\n        amount: Optional[str] = None,\n        method: str = \"GET\",\n        **kwargs\n    ) -&gt; str:\n        \"\"\"Synchronous run (calls async version)\"\"\"\n        import asyncio\n        return asyncio.run(self._arun(url, amount, method, **kwargs))\n\n    async def _arun(\n        self,\n        url: str,\n        amount: Optional[str] = None,\n        method: str = \"GET\",\n        **kwargs\n    ) -&gt; str:\n        \"\"\"\n        Make paid API request\n\n        Args:\n            url: API endpoint URL\n            amount: Optional payment amount override\n            method: HTTP method\n            **kwargs: Additional request parameters\n\n        Returns:\n            API response as string\n        \"\"\"\n        client = X402AutoClient(\n            wallet_keypair=self.wallet_keypair,\n            rpc_url=self.rpc_url,\n            max_payment_amount=self.max_payment,\n        )\n\n        try:\n            response = await client.fetch(url, method=method, **kwargs)\n            return response.text\n        except X402Error as e:\n            return f\"Payment error: {e.code} - {e.message}\"\n</code></pre>"},{"location":"openlibx402-technical-spec/#42-request-middleware-intercept-all-api-calls","title":"4.2 Request Middleware (Intercept All API Calls)","text":"<pre><code>from langchain.requests import RequestsWrapper\nfrom typing import Dict, Any, Optional\n\nclass X402RequestsWrapper(RequestsWrapper):\n    \"\"\"\n    Drop-in replacement for LangChain's RequestsWrapper with X402 support\n\n    Usage:\n        from langchain.agents import load_tools\n\n        wallet_keypair = load_keypair()\n\n        requests_wrapper = X402RequestsWrapper(\n            wallet_keypair=wallet_keypair\n        )\n\n        # Use with LangChain tools that make HTTP requests\n        tools = load_tools(\n            [\"requests_all\"],\n            llm=llm,\n            requests_wrapper=requests_wrapper\n        )\n    \"\"\"\n\n    def __init__(\n        self,\n        wallet_keypair: Keypair,\n        rpc_url: Optional[str] = None,\n        max_payment: Optional[str] = \"1.0\",\n        **kwargs\n    ):\n        super().__init__(**kwargs)\n        self.client = X402AutoClient(\n            wallet_keypair=wallet_keypair,\n            rpc_url=rpc_url,\n            max_payment_amount=max_payment,\n        )\n\n    async def aget(self, url: str, **kwargs) -&gt; str:\n        \"\"\"Async GET with X402 support\"\"\"\n        response = await self.client.get(url, **kwargs)\n        return response.text\n\n    async def apost(self, url: str, **kwargs) -&gt; str:\n        \"\"\"Async POST with X402 support\"\"\"\n        response = await self.client.post(url, **kwargs)\n        return response.text\n\n    def get(self, url: str, **kwargs) -&gt; str:\n        \"\"\"Sync GET with X402 support\"\"\"\n        import asyncio\n        return asyncio.run(self.aget(url, **kwargs))\n\n    def post(self, url: str, **kwargs) -&gt; str:\n        \"\"\"Sync POST with X402 support\"\"\"\n        import asyncio\n        return asyncio.run(self.apost(url, **kwargs))\n</code></pre>"},{"location":"openlibx402-technical-spec/#43-integration-utilities","title":"4.3 Integration Utilities","text":"<pre><code>from langchain.chat_models import ChatOpenAI\nfrom langchain.agents import initialize_agent, AgentType\n\ndef create_x402_agent(\n    wallet_keypair: Keypair,\n    llm: Optional[Any] = None,\n    tools: Optional[list] = None,\n    rpc_url: Optional[str] = None,\n    max_payment: str = \"1.0\",\n    **agent_kwargs\n):\n    \"\"\"\n    Convenience function to create LangChain agent with X402 support\n\n    Usage:\n        agent = create_x402_agent(\n            wallet_keypair=my_keypair,\n            llm=ChatOpenAI(),\n            tools=[custom_tool_1, custom_tool_2],\n            max_payment=\"5.0\"\n        )\n\n        response = agent.run(\"Get me premium market data from api.example.com\")\n    \"\"\"\n    from langchain.agents import load_tools\n\n    # Create X402-enabled requests wrapper\n    requests_wrapper = X402RequestsWrapper(\n        wallet_keypair=wallet_keypair,\n        rpc_url=rpc_url,\n        max_payment=max_payment,\n    )\n\n    # Load standard tools with X402 wrapper\n    x402_tools = load_tools(\n        [\"requests_all\"],\n        llm=llm,\n        requests_wrapper=requests_wrapper\n    )\n\n    # Add custom tools\n    if tools:\n        x402_tools.extend(tools)\n\n    # Create agent\n    agent = initialize_agent(\n        tools=x402_tools,\n        llm=llm or ChatOpenAI(),\n        agent=AgentType.ZERO_SHOT_REACT_DESCRIPTION,\n        **agent_kwargs\n    )\n\n    return agent\n</code></pre>"},{"location":"openlibx402-technical-spec/#5-langgraph-integration","title":"5. LangGraph Integration","text":""},{"location":"openlibx402-technical-spec/#package-openlibx402-langgraph-python-openlibx402langgraph-typescript","title":"Package: <code>openlibx402-langgraph</code> (Python) / <code>@openlibx402/langgraph</code> (TypeScript)","text":""},{"location":"openlibx402-technical-spec/#purpose_4","title":"Purpose","text":"<p>Integrate X402 payments into LangGraph workflows as nodes and conditional edges.</p>"},{"location":"openlibx402-technical-spec/#recommended-patterns","title":"Recommended Patterns","text":""},{"location":"openlibx402-technical-spec/#51-payment-node","title":"5.1 Payment Node","text":"<pre><code>from typing import TypedDict, Annotated\nfrom langgraph.graph import StateGraph, END\nfrom solders.keypair import Keypair\n\nclass AgentState(TypedDict):\n    \"\"\"State for LangGraph agent with payment support\"\"\"\n    messages: list\n    api_url: str\n    api_response: str\n    payment_required: bool\n    payment_completed: bool\n    payment_error: Optional[str]\n    wallet_keypair: Keypair\n\ndef payment_node(state: AgentState) -&gt; AgentState:\n    \"\"\"\n    LangGraph node that handles X402 payment\n\n    Usage in graph:\n        workflow = StateGraph(AgentState)\n        workflow.add_node(\"fetch_api\", fetch_api_node)\n        workflow.add_node(\"make_payment\", payment_node)\n        workflow.add_node(\"process_response\", process_response_node)\n\n        workflow.add_conditional_edges(\n            \"fetch_api\",\n            check_payment_required,\n            {\n                \"payment_required\": \"make_payment\",\n                \"success\": \"process_response\"\n            }\n        )\n    \"\"\"\n    client = X402AutoClient(\n        wallet_keypair=state[\"wallet_keypair\"],\n        auto_retry=True,\n    )\n\n    try:\n        response = asyncio.run(\n            client.fetch(state[\"api_url\"])\n        )\n        state[\"api_response\"] = response.text\n        state[\"payment_completed\"] = True\n        state[\"payment_error\"] = None\n    except X402Error as e:\n        state[\"payment_error\"] = f\"{e.code}: {e.message}\"\n        state[\"payment_completed\"] = False\n\n    return state\n\ndef check_payment_required(state: AgentState) -&gt; str:\n    \"\"\"Conditional edge function\"\"\"\n    if state.get(\"payment_required\"):\n        return \"payment_required\"\n    elif state.get(\"api_response\"):\n        return \"success\"\n    else:\n        return \"error\"\n</code></pre>"},{"location":"openlibx402-technical-spec/#52-payment-aware-api-node","title":"5.2 Payment-Aware API Node","text":"<pre><code>async def fetch_with_payment_node(state: AgentState) -&gt; AgentState:\n    \"\"\"\n    Combined node that fetches API and handles payment automatically\n\n    This is simpler than separate nodes but gives less control\n    \"\"\"\n    client = X402AutoClient(\n        wallet_keypair=state[\"wallet_keypair\"],\n        max_payment_amount=\"1.0\",\n    )\n\n    try:\n        response = await client.fetch(\n            state[\"api_url\"],\n            method=\"GET\"\n        )\n        state[\"api_response\"] = response.text\n        state[\"payment_completed\"] = True\n    except InsufficientFundsError as e:\n        state[\"payment_error\"] = f\"Insufficient funds: need {e.required_amount}\"\n    except X402Error as e:\n        state[\"payment_error\"] = f\"{e.code}: {e.message}\"\n\n    return state\n</code></pre>"},{"location":"openlibx402-technical-spec/#53-example-workflow","title":"5.3 Example Workflow","text":"<pre><code>from langgraph.graph import StateGraph, END\n\ndef create_x402_workflow(wallet_keypair: Keypair) -&gt; StateGraph:\n    \"\"\"\n    Create a LangGraph workflow with X402 payment support\n\n    Workflow:\n        1. Determine what API to call\n        2. Check if payment required\n        3. Make payment if needed\n        4. Process response\n    \"\"\"\n\n    workflow = StateGraph(AgentState)\n\n    # Add nodes\n    workflow.add_node(\"plan\", planning_node)\n    workflow.add_node(\"fetch_api\", fetch_api_node)\n    workflow.add_node(\"make_payment\", payment_node)\n    workflow.add_node(\"process\", process_response_node)\n\n    # Set entry point\n    workflow.set_entry_point(\"plan\")\n\n    # Add edges\n    workflow.add_edge(\"plan\", \"fetch_api\")\n\n    workflow.add_conditional_edges(\n        \"fetch_api\",\n        check_payment_required,\n        {\n            \"payment_required\": \"make_payment\",\n            \"success\": \"process\",\n            \"error\": END\n        }\n    )\n\n    workflow.add_edge(\"make_payment\", \"fetch_api\")  # Retry after payment\n    workflow.add_edge(\"process\", END)\n\n    return workflow.compile()\n</code></pre>"},{"location":"openlibx402-technical-spec/#54-helper-functions","title":"5.4 Helper Functions","text":"<pre><code>def create_payment_capable_graph(\n    state_schema: type,\n    wallet_keypair: Keypair,\n    rpc_url: Optional[str] = None,\n) -&gt; StateGraph:\n    \"\"\"\n    Create a StateGraph with X402 payment capabilities built-in\n\n    Automatically adds wallet_keypair to state and provides helper methods\n    \"\"\"\n    pass\n\ndef add_payment_node(\n    graph: StateGraph,\n    node_name: str = \"x402_payment\",\n    max_payment: str = \"1.0\",\n) -&gt; StateGraph:\n    \"\"\"Add a payment node to existing graph\"\"\"\n    pass\n</code></pre>"},{"location":"openlibx402-technical-spec/#6-error-handling-retry-logic","title":"6. Error Handling &amp; Retry Logic","text":""},{"location":"openlibx402-technical-spec/#automatic-retry-configuration","title":"Automatic Retry Configuration","text":"<pre><code>from dataclasses import dataclass\n\n@dataclass\nclass RetryConfig:\n    \"\"\"Configuration for automatic retry behavior\"\"\"\n    enabled: bool = True\n    max_retries: int = 1  # For payment, 1 retry is usually sufficient\n    retry_on_402: bool = True  # Retry when 402 received\n    retry_on_network_error: bool = True\n    exponential_backoff: bool = False  # Usually not needed for 402\n\nclass X402ClientWithRetry:\n    \"\"\"Client with configurable retry logic\"\"\"\n\n    def __init__(\n        self,\n        wallet_keypair: Keypair,\n        retry_config: Optional[RetryConfig] = None,\n    ):\n        self.wallet_keypair = wallet_keypair\n        self.retry_config = retry_config or RetryConfig()\n        self.client = X402AutoClient(\n            wallet_keypair=wallet_keypair,\n            auto_retry=retry_config.enabled if retry_config else True,\n        )\n</code></pre>"},{"location":"openlibx402-technical-spec/#error-code-reference","title":"Error Code Reference","text":"<pre><code>ERROR_CODES = {\n    \"PAYMENT_REQUIRED\": {\n        \"code\": \"PAYMENT_REQUIRED\",\n        \"message\": \"Payment is required to access this resource\",\n        \"retry\": True,\n        \"user_action\": \"Ensure wallet has sufficient funds and retry\"\n    },\n    \"PAYMENT_EXPIRED\": {\n        \"code\": \"PAYMENT_EXPIRED\",\n        \"message\": \"Payment request has expired\",\n        \"retry\": True,\n        \"user_action\": \"Request a new payment authorization\"\n    },\n    \"INSUFFICIENT_FUNDS\": {\n        \"code\": \"INSUFFICIENT_FUNDS\",\n        \"message\": \"Wallet has insufficient token balance\",\n        \"retry\": False,\n        \"user_action\": \"Add funds to wallet\"\n    },\n    \"PAYMENT_VERIFICATION_FAILED\": {\n        \"code\": \"PAYMENT_VERIFICATION_FAILED\",\n        \"message\": \"Server could not verify payment\",\n        \"retry\": True,\n        \"user_action\": \"Contact API provider if issue persists\"\n    },\n    \"TRANSACTION_BROADCAST_FAILED\": {\n        \"code\": \"TRANSACTION_BROADCAST_FAILED\",\n        \"message\": \"Failed to broadcast transaction to blockchain\",\n        \"retry\": True,\n        \"user_action\": \"Check network connection and RPC endpoint\"\n    },\n    \"INVALID_PAYMENT_REQUEST\": {\n        \"code\": \"INVALID_PAYMENT_REQUEST\",\n        \"message\": \"Payment request format is invalid\",\n        \"retry\": False,\n        \"user_action\": \"Contact API provider\"\n    },\n}\n</code></pre>"},{"location":"openlibx402-technical-spec/#7-testing-development","title":"7. Testing &amp; Development","text":""},{"location":"openlibx402-technical-spec/#test-utilities","title":"Test Utilities","text":"<pre><code># In openlibx402-core\n\nclass MockSolanaPaymentProcessor(SolanaPaymentProcessor):\n    \"\"\"Mock processor for testing without real blockchain\"\"\"\n\n    def __init__(self, *args, **kwargs):\n        super().__init__(*args, **kwargs)\n        self.transactions: list = []\n        self.balance = 100.0  # Mock balance\n\n    async def create_payment_transaction(self, *args, **kwargs):\n        \"\"\"Return mock transaction\"\"\"\n        return MockTransaction()\n\n    async def sign_and_send_transaction(self, *args, **kwargs):\n        \"\"\"Return mock tx hash\"\"\"\n        tx_hash = f\"mock_tx_{len(self.transactions)}\"\n        self.transactions.append(tx_hash)\n        return tx_hash\n\n    async def verify_transaction(self, *args, **kwargs):\n        \"\"\"Always verify successfully\"\"\"\n        return True\n\n    async def get_token_balance(self, *args, **kwargs):\n        \"\"\"Return mock balance\"\"\"\n        return self.balance\n\nclass TestServer:\n    \"\"\"Mock X402 server for testing\"\"\"\n\n    def __init__(self, payment_address: str, token_mint: str):\n        self.payment_address = payment_address\n        self.token_mint = token_mint\n        self.payments_received: list = []\n\n    def require_payment(self, amount: str, resource: str):\n        \"\"\"Decorator that adds payment requirement\"\"\"\n        pass\n\n    def start(self, port: int = 8402):\n        \"\"\"Start test server\"\"\"\n        pass\n</code></pre>"},{"location":"openlibx402-technical-spec/#example-test","title":"Example Test","text":"<pre><code>import pytest\nfrom openlibx402_core.testing import MockSolanaPaymentProcessor, TestServer\n\n@pytest.mark.asyncio\nasync def test_payment_flow():\n    \"\"\"Test complete payment flow\"\"\"\n    # Setup test server\n    server = TestServer(\n        payment_address=\"mock_address\",\n        token_mint=\"mock_usdc\"\n    )\n    server.start(port=8402)\n\n    # Create client with mock processor\n    keypair = Keypair()  # Generate test keypair\n    client = X402AutoClient(wallet_keypair=keypair)\n    client.client.processor = MockSolanaPaymentProcessor()\n\n    # Make request to paywalled endpoint\n    response = await client.fetch(\"http://localhost:8402/premium-data\")\n\n    # Verify payment was made\n    assert response.status_code == 200\n    assert len(client.client.processor.transactions) == 1\n\n    # Cleanup\n    server.stop()\n</code></pre>"},{"location":"openlibx402-technical-spec/#8-example-implementations","title":"8. Example Implementations","text":""},{"location":"openlibx402-technical-spec/#81-fastapi-server-example","title":"8.1 FastAPI Server Example","text":"<pre><code># examples/fastapi-server/main.py\n\nfrom fastapi import FastAPI, Depends\nfrom openlibx402_fastapi import payment_required, X402Config, init_x402\nfrom solders.keypair import Keypair\nimport os\n\n# Initialize X402\nconfig = X402Config(\n    payment_address=os.getenv(\"PAYMENT_WALLET_ADDRESS\"),\n    token_mint=os.getenv(\"USDC_MINT_ADDRESS\"),\n    network=\"solana-devnet\",\n)\ninit_x402(config)\n\napp = FastAPI()\n\n# Simple decorator approach\n@app.get(\"/premium-data\")\n@payment_required(\n    amount=\"0.10\",\n    payment_address=config.payment_address,\n    token_mint=config.token_mint,\n    description=\"Access to premium market data\"\n)\nasync def get_premium_data():\n    return {\n        \"data\": \"This is premium content\",\n        \"price\": 100.50,\n        \"timestamp\": \"2025-05-06T10:00:00Z\"\n    }\n\n# Dependency injection approach\nfrom openlibx402_fastapi import verify_payment_factory\n\n@app.get(\"/expensive-data\")\nasync def get_expensive_data(\n    payment = Depends(\n        verify_payment_factory(\n            amount=\"1.00\",\n            payment_address=config.payment_address,\n            token_mint=config.token_mint,\n        )\n    )\n):\n    return {\n        \"data\": \"Very expensive content\",\n        \"payment_id\": payment.payment_id,\n        \"amount_paid\": payment.actual_amount,\n    }\n\nif __name__ == \"__main__\":\n    import uvicorn\n    uvicorn.run(app, host=\"0.0.0.0\", port=8000)\n</code></pre>"},{"location":"openlibx402-technical-spec/#82-langchain-agent-example","title":"8.2 LangChain Agent Example","text":"<pre><code># examples/langchain-agent/main.py\n\nfrom langchain.chat_models import ChatOpenAI\nfrom langchain.agents import initialize_agent, AgentType\nfrom openlibx402_langchain import X402PaymentTool, X402RequestsWrapper\nfrom solders.keypair import Keypair\nimport os\nimport json\n\n# Load wallet\nwith open(\"wallet.json\") as f:\n    wallet_data = json.load(f)\n    keypair = Keypair.from_bytes(bytes(wallet_data))\n\n# Create X402-enabled tools\npayment_tool = X402PaymentTool(\n    wallet_keypair=keypair,\n    max_payment=\"5.0\",\n    rpc_url=\"https://api.devnet.solana.com\"\n)\n\n# Create requests wrapper for automatic payment handling\nrequests_wrapper = X402RequestsWrapper(\n    wallet_keypair=keypair,\n    max_payment=\"1.0\"\n)\n\n# Load LangChain tools with X402 support\nfrom langchain.agents import load_tools\ntools = load_tools(\n    [\"requests_all\"],\n    llm=ChatOpenAI(),\n    requests_wrapper=requests_wrapper\n)\ntools.append(payment_tool)\n\n# Create agent\nagent = initialize_agent(\n    tools=tools,\n    llm=ChatOpenAI(temperature=0),\n    agent=AgentType.ZERO_SHOT_REACT_DESCRIPTION,\n    verbose=True\n)\n\n# Run agent\nresponse = agent.run(\n    \"Get me the premium market data from http://localhost:8000/premium-data \"\n    \"and tell me the current price\"\n)\n\nprint(response)\n</code></pre>"},{"location":"openlibx402-technical-spec/#83-langgraph-workflow-example","title":"8.3 LangGraph Workflow Example","text":"<pre><code># examples/langgraph-workflow/main.py\n\nfrom typing import TypedDict, Annotated, Optional\nfrom langgraph.graph import StateGraph, END\nfrom openlibx402_langgraph import payment_node, check_payment_required\nfrom openlibx402_client import X402AutoClient\nfrom solders.keypair import Keypair\nimport json\nimport asyncio\n\n# Define state\nclass ResearchState(TypedDict):\n    query: str\n    api_url: str\n    api_response: Optional[str]\n    payment_required: bool\n    payment_completed: bool\n    payment_error: Optional[str]\n    wallet_keypair: Keypair\n    final_answer: Optional[str]\n\n# Load wallet\nwith open(\"wallet.json\") as f:\n    wallet_data = json.load(f)\n    keypair = Keypair.from_bytes(bytes(wallet_data))\n\n# Define nodes\ndef plan_node(state: ResearchState) -&gt; ResearchState:\n    \"\"\"Determine which API to call\"\"\"\n    state[\"api_url\"] = \"http://localhost:8000/premium-data\"\n    state[\"payment_required\"] = False\n    return state\n\nasync def fetch_api_node(state: ResearchState) -&gt; ResearchState:\n    \"\"\"Fetch from API\"\"\"\n    client = X402AutoClient(\n        wallet_keypair=state[\"wallet_keypair\"],\n        auto_retry=False,  # We'll handle retry via graph\n    )\n\n    try:\n        response = await client.fetch(state[\"api_url\"])\n        state[\"api_response\"] = response.text\n        state[\"payment_required\"] = False\n    except Exception as e:\n        if \"402\" in str(e):\n            state[\"payment_required\"] = True\n        else:\n            state[\"payment_error\"] = str(e)\n\n    return state\n\ndef process_node(state: ResearchState) -&gt; ResearchState:\n    \"\"\"Process API response\"\"\"\n    if state[\"api_response\"]:\n        # Parse and format response\n        state[\"final_answer\"] = f\"Retrieved data: {state['api_response']}\"\n    return state\n\n# Build workflow\nworkflow = StateGraph(ResearchState)\n\nworkflow.add_node(\"plan\", plan_node)\nworkflow.add_node(\"fetch\", fetch_api_node)\nworkflow.add_node(\"payment\", payment_node)  # From openlibx402-langgraph\nworkflow.add_node(\"process\", process_node)\n\nworkflow.set_entry_point(\"plan\")\nworkflow.add_edge(\"plan\", \"fetch\")\n\nworkflow.add_conditional_edges(\n    \"fetch\",\n    check_payment_required,  # From openlibx402-langgraph\n    {\n        \"payment_required\": \"payment\",\n        \"success\": \"process\",\n        \"error\": END\n    }\n)\n\nworkflow.add_edge(\"payment\", \"fetch\")  # Retry after payment\nworkflow.add_edge(\"process\", END)\n\n# Compile and run\napp = workflow.compile()\n\n# Execute\nresult = app.invoke({\n    \"query\": \"Get premium market data\",\n    \"wallet_keypair\": keypair,\n})\n\nprint(result[\"final_answer\"])\n</code></pre>"},{"location":"openlibx402-technical-spec/#9-package-metadata-publishing","title":"9. Package Metadata &amp; Publishing","text":""},{"location":"openlibx402-technical-spec/#python-packages-pypi","title":"Python Packages (PyPI)","text":"<pre><code># pyproject.toml example for openlibx402-core\n\n[build-system]\nrequires = [\"hatchling\"]\nbuild-backend = \"hatchling.build\"\n\n[project]\nname = \"openlibx402-core\"\nversion = \"0.1.1\"\ndescription = \"Core implementation of X402 payment protocol\"\nauthors = [\n    {name = \"OpenLibx402 Contributors\", email = \"hello@openlibx402.org\"},\n]\nreadme = \"README.md\"\nlicense = {text = \"MIT\"}\nrequires-python = \"&gt;=3.8\"\ndependencies = [\n    \"solana&gt;=0.30.0\",\n    \"solders&gt;=0.18.0\",\n    \"httpx&gt;=0.24.0\",\n    \"pydantic&gt;=2.0.0\",\n]\n\n[project.optional-dependencies]\ndev = [\n    \"pytest&gt;=7.0.0\",\n    \"pytest-asyncio&gt;=0.21.0\",\n    \"black&gt;=23.0.0\",\n    \"mypy&gt;=1.0.0\",\n]\n\n[project.urls]\nHomepage = \"https://openlib.xyz\"\nDocumentation = \"https://openlibx402.github.io/docs\"\nRepository = \"https://github.com/openlibx402/openlibx402\"\n</code></pre>"},{"location":"openlibx402-technical-spec/#typescript-packages-npm","title":"TypeScript Packages (npm)","text":"<pre><code>// package.json example for @openlibx402/core\n\n{\n  \"name\": \"@openlibx402/core\",\n  \"version\": \"0.1.0\",\n  \"description\": \"Core implementation of X402 payment protocol\",\n  \"main\": \"dist/index.js\",\n  \"types\": \"dist/index.d.ts\",\n  \"scripts\": {\n    \"build\": \"tsc\",\n    \"test\": \"jest\",\n    \"lint\": \"eslint src/**/*.ts\"\n  },\n  \"keywords\": [\"x402\", \"payments\", \"solana\", \"ai-agents\", \"web3\"],\n  \"author\": \"OpenLibx402 Contributors\",\n  \"license\": \"MIT\",\n  \"dependencies\": {\n    \"@solana/web3.js\": \"^1.87.0\",\n    \"@solana/spl-token\": \"^0.3.9\",\n    \"axios\": \"^1.6.0\"\n  },\n  \"devDependencies\": {\n    \"@types/node\": \"^20.0.0\",\n    \"typescript\": \"^5.0.0\",\n    \"jest\": \"^29.0.0\",\n    \"eslint\": \"^8.0.0\"\n  }\n}\n</code></pre>"},{"location":"openlibx402-technical-spec/#10-documentation-structure","title":"10. Documentation Structure","text":"<pre><code>docs/\n\u251c\u2500\u2500 getting-started/\n\u2502   \u251c\u2500\u2500 installation.md\n\u2502   \u251c\u2500\u2500 quickstart-server.md\n\u2502   \u251c\u2500\u2500 quickstart-client.md\n\u2502   \u2514\u2500\u2500 quickstart-agent.md\n\u251c\u2500\u2500 guides/\n\u2502   \u251c\u2500\u2500 fastapi-integration.md\n\u2502   \u251c\u2500\u2500 langchain-integration.md\n\u2502   \u251c\u2500\u2500 langgraph-integration.md\n\u2502   \u251c\u2500\u2500 wallet-setup.md\n\u2502   \u2514\u2500\u2500 testing-locally.md\n\u251c\u2500\u2500 api-reference/\n\u2502   \u251c\u2500\u2500 core/\n\u2502   \u251c\u2500\u2500 server/\n\u2502   \u251c\u2500\u2500 client/\n\u2502   \u2514\u2500\u2500 integrations/\n\u251c\u2500\u2500 examples/\n\u2502   \u251c\u2500\u2500 basic-api-server.md\n\u2502   \u251c\u2500\u2500 autonomous-agent.md\n\u2502   \u251c\u2500\u2500 multi-agent-workflow.md\n\u2502   \u2514\u2500\u2500 error-handling.md\n\u2514\u2500\u2500 advanced/\n    \u251c\u2500\u2500 custom-settlement.md\n    \u251c\u2500\u2500 performance-optimization.md\n    \u2514\u2500\u2500 security-best-practices.md\n</code></pre>"},{"location":"openlibx402-technical-spec/#11-development-roadmap","title":"11. Development Roadmap","text":""},{"location":"openlibx402-technical-spec/#phase-1-core-fastapi","title":"Phase 1: Core &amp; FastAPI","text":"<ul> <li>\u2705 Core protocol implementation (Python + TypeScript)</li> <li>\u2705 Solana blockchain integration</li> <li>\u2705 FastAPI server middleware</li> <li>\u2705 Basic client (explicit &amp; implicit)</li> <li>\u2705 Error handling</li> <li>\u2705 Testing utilities</li> <li>\u2705 Example implementations</li> </ul>"},{"location":"openlibx402-technical-spec/#phase-2-ai-agent-integrations","title":"Phase 2: AI Agent Integrations","text":"<ul> <li>\u2705 LangChain tool &amp; middleware</li> <li>\u2705 LangGraph nodes &amp; helpers</li> <li>\ud83d\udd32 Additional agent framework support (AutoGPT, CrewAI)</li> </ul>"},{"location":"openlibx402-technical-spec/#phase-3-additional-frameworks","title":"Phase 3: Additional Frameworks","text":"<ul> <li>\ud83d\udd32 Express.js middleware (TypeScript)</li> <li>\ud83d\udd32 Next.js API routes helper</li> <li>\ud83d\udd32 Flask middleware (Python)</li> <li>\ud83d\udd32 Django middleware (Python)</li> <li>\ud83d\udd32 Hono middleware (TypeScript)</li> </ul>"},{"location":"openlibx402-technical-spec/#phase-4-enhanced-features","title":"Phase 4: Enhanced Features","text":"<ul> <li>\ud83d\udd32 Payment batching</li> <li>\ud83d\udd32 Subscription management</li> <li>\ud83d\udd32 Usage analytics</li> <li>\ud83d\udd32 Multi-chain support (Ethereum, Base L2)</li> <li>\ud83d\udd32 Alternative tokens (beyond USDC)</li> </ul>"},{"location":"openlibx402-technical-spec/#phase-5-ecosystem","title":"Phase 5: Ecosystem","text":"<ul> <li>\ud83d\udd32 CLI tools</li> <li>\ud83d\udd32 Admin dashboard</li> <li>\ud83d\udd32 Wallet UI components</li> <li>\ud83d\udd32 Browser extension</li> <li>\ud83d\udd32 Zapier/Make.com integrations</li> </ul>"},{"location":"openlibx402-technical-spec/#12-security-considerations","title":"12. Security Considerations","text":""},{"location":"openlibx402-technical-spec/#wallet-security","title":"Wallet Security","text":"<ul> <li>Never log private keys</li> <li>Use environment variables for sensitive data</li> <li>Recommend hardware wallets for production</li> <li>Implement rate limiting on payment endpoints</li> </ul>"},{"location":"openlibx402-technical-spec/#transaction-verification","title":"Transaction Verification","text":"<ul> <li>Always verify transactions on-chain</li> <li>Check recipient, amount, and token mint</li> <li>Implement replay attack protection via nonce</li> <li>Set reasonable expiration times (5-10 minutes)</li> </ul>"},{"location":"openlibx402-technical-spec/#api-security","title":"API Security","text":"<ul> <li>Implement CORS properly</li> <li>Use HTTPS in production</li> <li>Rate limit payment requests</li> <li>Validate all payment authorization fields</li> </ul>"},{"location":"openlibx402-technical-spec/#13-performance-optimization","title":"13. Performance Optimization","text":""},{"location":"openlibx402-technical-spec/#client-side","title":"Client-Side","text":"<ul> <li>Reuse HTTP connections (connection pooling)</li> <li>Cache payment authorizations (with expiry)</li> <li>Batch multiple API calls where possible</li> <li>Use WebSocket for high-frequency payments</li> </ul>"},{"location":"openlibx402-technical-spec/#server-side","title":"Server-Side","text":"<ul> <li>Async transaction verification</li> <li>Cache verified payments (Redis)</li> <li>Background transaction confirmation</li> <li>Load balancing for RPC calls</li> </ul>"},{"location":"openlibx402-technical-spec/#14-monitoring-observability","title":"14. Monitoring &amp; Observability","text":""},{"location":"openlibx402-technical-spec/#metrics-to-track","title":"Metrics to Track","text":"<ul> <li>Payment success rate</li> <li>Transaction confirmation time</li> <li>RPC endpoint latency</li> <li>Token balance (for auto-replenishment alerts)</li> <li>Error rates by type</li> </ul>"},{"location":"openlibx402-technical-spec/#logging","title":"Logging","text":"<pre><code>import logging\n\nlogger = logging.getLogger(\"openlibx402\")\n\n# Log payment requests\nlogger.info(f\"Payment required: {amount} for {resource}\")\n\n# Log successful payments\nlogger.info(f\"Payment verified: tx_hash={tx_hash}\")\n\n# Log errors with context\nlogger.error(\n    f\"Payment failed: {error_code}\",\n    extra={\n        \"payment_id\": payment_id,\n        \"wallet\": wallet_address,\n        \"amount\": amount,\n    }\n)\n</code></pre>"},{"location":"openlibx402-technical-spec/#end-of-technical-specification","title":"End of Technical Specification","text":"<p>This specification provides a comprehensive blueprint for implementing the OpenLibx402 library ecosystem. The architecture is modular, allowing for incremental development and easy addition of new framework integrations.</p>"},{"location":"quick-reference/","title":"OpenLibx402 Quick Reference Guide","text":""},{"location":"quick-reference/#installation","title":"Installation","text":"<pre><code># Python\npip install openlibx402-core openlibx402-fastapi openlibx402-client\npip install openlibx402-langchain openlibx402-langgraph\n\n# TypeScript\nnpm install @openlibx402/core @openlibx402/fastapi @openlibx402/client\nnpm install @openlibx402/langchain @openlibx402/langgraph\n</code></pre>"},{"location":"quick-reference/#fastapi-server-examples","title":"FastAPI Server Examples","text":""},{"location":"quick-reference/#simple-decorator-approach","title":"Simple Decorator Approach","text":"<pre><code>from fastapi import FastAPI\nfrom openlibx402_fastapi import payment_required\n\napp = FastAPI()\n\n@app.get(\"/premium-data\")\n@payment_required(\n    amount=\"0.10\",\n    payment_address=\"YOUR_WALLET_ADDRESS\",\n    token_mint=\"USDC_MINT_ADDRESS\",\n    network=\"solana-devnet\",\n    description=\"Access to premium market data\"\n)\nasync def get_premium_data():\n    return {\"data\": \"Premium content\", \"price\": 100.50}\n</code></pre>"},{"location":"quick-reference/#dependency-injection-approach","title":"Dependency Injection Approach","text":"<pre><code>from fastapi import FastAPI, Depends\nfrom openlibx402_fastapi import verify_payment_factory, PaymentAuthorization\n\napp = FastAPI()\n\n@app.get(\"/expensive-data\")\nasync def get_expensive_data(\n    payment: PaymentAuthorization = Depends(\n        verify_payment_factory(\n            amount=\"1.00\",\n            payment_address=\"YOUR_WALLET_ADDRESS\",\n            token_mint=\"USDC_MINT_ADDRESS\"\n        )\n    )\n):\n    return {\n        \"data\": \"Very expensive content\",\n        \"payment_id\": payment.payment_id,\n        \"amount_paid\": payment.actual_amount\n    }\n</code></pre>"},{"location":"quick-reference/#global-configuration","title":"Global Configuration","text":"<pre><code>from openlibx402_fastapi import X402Config, init_x402\n\nconfig = X402Config(\n    payment_address=\"YOUR_WALLET_ADDRESS\",\n    token_mint=\"USDC_MINT_ADDRESS\",\n    network=\"solana-devnet\",\n    default_amount=\"0.01\"\n)\ninit_x402(config)\n\n@app.get(\"/data\")\n@payment_required(amount=\"0.05\")  # Uses global config\nasync def get_data():\n    return {\"data\": \"content\"}\n</code></pre>"},{"location":"quick-reference/#client-examples","title":"Client Examples","text":""},{"location":"quick-reference/#explicit-client-manual-control","title":"Explicit Client (Manual Control)","text":"<pre><code>from openlibx402_client import X402Client\nfrom solders.keypair import Keypair\n\n# Load wallet\nkeypair = Keypair()  # Or load from file\n\n# Create client\nclient = X402Client(\n    wallet_keypair=keypair,\n    rpc_url=\"https://api.devnet.solana.com\"\n)\n\n# Make initial request\nresponse = await client.get(\"https://api.example.com/premium-data\")\n\n# Check if payment required\nif client.payment_required(response):\n    # Parse payment details\n    payment_request = client.parse_payment_request(response)\n    print(f\"Payment required: {payment_request.max_amount_required} USDC\")\n\n    # Create and send payment\n    authorization = await client.create_payment(payment_request)\n\n    # Retry with payment\n    response = await client.get(\n        \"https://api.example.com/premium-data\",\n        payment=authorization\n    )\n\ndata = response.json()\nprint(data)\n</code></pre>"},{"location":"quick-reference/#implicit-client-auto-payment","title":"Implicit Client (Auto-Payment)","text":"<pre><code>from openlibx402_client import X402AutoClient\nfrom solders.keypair import Keypair\n\n# Load wallet\nkeypair = Keypair()\n\n# Create auto-client\nclient = X402AutoClient(\n    wallet_keypair=keypair,\n    max_payment_amount=\"5.0\"  # Safety limit\n)\n\n# Make request - automatically handles 402 and payment\nresponse = await client.fetch(\"https://api.example.com/premium-data\")\ndata = response.json()\nprint(data)\n\n# Disable auto-retry for specific request\nresponse = await client.fetch(\n    \"https://api.example.com/data\",\n    auto_retry=False\n)\n</code></pre>"},{"location":"quick-reference/#langchain-examples","title":"LangChain Examples","text":""},{"location":"quick-reference/#using-x402paymenttool","title":"Using X402PaymentTool","text":"<pre><code>from langchain.chat_models import ChatOpenAI\nfrom langchain.agents import initialize_agent, AgentType\nfrom openlibx402_langchain import X402PaymentTool\nfrom solders.keypair import Keypair\n\n# Load wallet\nkeypair = Keypair()\n\n# Create payment tool\npayment_tool = X402PaymentTool(\n    wallet_keypair=keypair,\n    max_payment=\"5.0\",\n    name=\"pay_for_api\",\n    description=\"Make payment to access premium API data\"\n)\n\n# Create agent with payment tool\nagent = initialize_agent(\n    tools=[payment_tool],\n    llm=ChatOpenAI(temperature=0),\n    agent=AgentType.ZERO_SHOT_REACT_DESCRIPTION,\n    verbose=True\n)\n\n# Agent can now pay for APIs\nresponse = agent.run(\n    \"Get me the premium market data from https://api.example.com/premium-data\"\n)\nprint(response)\n</code></pre>"},{"location":"quick-reference/#using-x402requestswrapper-middleware","title":"Using X402RequestsWrapper (Middleware)","text":"<pre><code>from langchain.agents import load_tools, initialize_agent, AgentType\nfrom langchain.chat_models import ChatOpenAI\nfrom openlibx402_langchain import X402RequestsWrapper\nfrom solders.keypair import Keypair\n\n# Load wallet\nkeypair = Keypair()\n\n# Create X402-enabled requests wrapper\nrequests_wrapper = X402RequestsWrapper(\n    wallet_keypair=keypair,\n    max_payment=\"1.0\"\n)\n\n# Load standard tools with X402 wrapper\ntools = load_tools(\n    [\"requests_all\"],\n    llm=ChatOpenAI(),\n    requests_wrapper=requests_wrapper\n)\n\n# Create agent\nagent = initialize_agent(\n    tools=tools,\n    llm=ChatOpenAI(temperature=0),\n    agent=AgentType.ZERO_SHOT_REACT_DESCRIPTION,\n    verbose=True\n)\n\n# All HTTP requests automatically handle X402 payments\nresponse = agent.run(\"Fetch data from https://api.example.com/premium-data\")\n</code></pre>"},{"location":"quick-reference/#convenience-function","title":"Convenience Function","text":"<pre><code>from openlibx402_langchain import create_x402_agent\nfrom langchain.chat_models import ChatOpenAI\nfrom solders.keypair import Keypair\n\n# Load wallet\nkeypair = Keypair()\n\n# Create agent with X402 support (one function!)\nagent = create_x402_agent(\n    wallet_keypair=keypair,\n    llm=ChatOpenAI(),\n    max_payment=\"5.0\"\n)\n\nresponse = agent.run(\"Get premium data from API\")\n</code></pre>"},{"location":"quick-reference/#langgraph-examples","title":"LangGraph Examples","text":""},{"location":"quick-reference/#basic-payment-node","title":"Basic Payment Node","text":"<pre><code>from typing import TypedDict\nfrom langgraph.graph import StateGraph, END\nfrom openlibx402_langgraph import payment_node, check_payment_required\nfrom openlibx402_client import X402AutoClient\nfrom solders.keypair import Keypair\n\n# Define state\nclass AgentState(TypedDict):\n    api_url: str\n    api_response: str\n    payment_required: bool\n    payment_completed: bool\n    payment_error: str | None\n    wallet_keypair: Keypair\n\n# Load wallet\nkeypair = Keypair()\n\n# Build workflow\nworkflow = StateGraph(AgentState)\n\nworkflow.add_node(\"fetch_api\", fetch_api_node)\nworkflow.add_node(\"make_payment\", payment_node)  # From openlibx402-langgraph\nworkflow.add_node(\"process\", process_response_node)\n\nworkflow.set_entry_point(\"fetch_api\")\n\n# Conditional edge based on payment\nworkflow.add_conditional_edges(\n    \"fetch_api\",\n    check_payment_required,  # From openlibx402-langgraph\n    {\n        \"payment_required\": \"make_payment\",\n        \"success\": \"process\",\n        \"error\": END\n    }\n)\n\nworkflow.add_edge(\"make_payment\", \"fetch_api\")  # Retry after payment\nworkflow.add_edge(\"process\", END)\n\n# Compile and run\napp = workflow.compile()\nresult = app.invoke({\n    \"api_url\": \"https://api.example.com/data\",\n    \"wallet_keypair\": keypair,\n})\n</code></pre>"},{"location":"quick-reference/#combined-fetch-and-pay-node","title":"Combined Fetch-and-Pay Node","text":"<pre><code>from openlibx402_client import X402AutoClient\n\nasync def fetch_with_payment_node(state: AgentState) -&gt; AgentState:\n    \"\"\"Node that fetches API and handles payment automatically\"\"\"\n    client = X402AutoClient(\n        wallet_keypair=state[\"wallet_keypair\"],\n        max_payment_amount=\"1.0\"\n    )\n\n    try:\n        response = await client.fetch(state[\"api_url\"])\n        state[\"api_response\"] = response.text\n        state[\"payment_completed\"] = True\n    except Exception as e:\n        state[\"payment_error\"] = str(e)\n\n    return state\n\n# Use in workflow\nworkflow.add_node(\"fetch\", fetch_with_payment_node)\n</code></pre>"},{"location":"quick-reference/#error-handling","title":"Error Handling","text":""},{"location":"quick-reference/#catching-specific-errors","title":"Catching Specific Errors","text":"<pre><code>from openlibx402_core import (\n    InsufficientFundsError,\n    PaymentExpiredError,\n    PaymentVerificationError,\n    TransactionBroadcastError\n)\nfrom openlibx402_client import X402AutoClient\n\nclient = X402AutoClient(wallet_keypair=keypair)\n\ntry:\n    response = await client.fetch(\"https://api.example.com/data\")\n\nexcept InsufficientFundsError as e:\n    print(f\"Insufficient funds: need {e.required_amount}, have {e.available_amount}\")\n    # Prompt user to add funds\n\nexcept PaymentExpiredError as e:\n    print(\"Payment request expired, retrying...\")\n    # Automatically handled by auto-client, but you can catch it\n\nexcept TransactionBroadcastError as e:\n    print(f\"Transaction failed: {e.message}\")\n    # Check network connection\n\nexcept PaymentVerificationError as e:\n    print(f\"Payment verification failed: {e.message}\")\n    # Contact API provider\n</code></pre>"},{"location":"quick-reference/#handling-all-x402-errors","title":"Handling All X402 Errors","text":"<pre><code>from openlibx402_core import X402Error\n\ntry:\n    response = await client.fetch(\"https://api.example.com/data\")\nexcept X402Error as e:\n    print(f\"X402 Error: {e.code}\")\n    print(f\"Message: {e.message}\")\n    print(f\"Details: {e.details}\")\n</code></pre>"},{"location":"quick-reference/#configuration","title":"Configuration","text":""},{"location":"quick-reference/#environment-variables","title":"Environment Variables","text":"<pre><code># .env file\nX402_PAYMENT_ADDRESS=YourSolanaWalletAddress\nX402_TOKEN_MINT=USDC_MINT_ADDRESS\nX402_NETWORK=solana-devnet\nX402_RPC_URL=https://api.devnet.solana.com\nX402_DEFAULT_AMOUNT=0.01\n</code></pre> <pre><code>from openlibx402_fastapi import X402Config, init_x402\nimport os\nfrom dotenv import load_dotenv\n\nload_dotenv()\n\nconfig = X402Config(\n    payment_address=os.getenv(\"X402_PAYMENT_ADDRESS\"),\n    token_mint=os.getenv(\"X402_TOKEN_MINT\"),\n    network=os.getenv(\"X402_NETWORK\", \"solana-devnet\"),\n    rpc_url=os.getenv(\"X402_RPC_URL\"),\n)\n\ninit_x402(config)\n</code></pre>"},{"location":"quick-reference/#testing","title":"Testing","text":""},{"location":"quick-reference/#mock-payment-processor","title":"Mock Payment Processor","text":"<pre><code>from openlibx402_core.testing import MockSolanaPaymentProcessor\n\n# Use in tests\nprocessor = MockSolanaPaymentProcessor()\nprocessor.balance = 100.0  # Set mock balance\n\nclient = X402AutoClient(wallet_keypair=test_keypair)\nclient.client.processor = processor\n\n# Make requests without real blockchain\nresponse = await client.fetch(\"http://localhost:8000/data\")\n\n# Check mock transactions\nassert len(processor.transactions) == 1\n</code></pre>"},{"location":"quick-reference/#test-server","title":"Test Server","text":"<pre><code>from openlibx402_core.testing import TestServer\n\n# Create test server\nserver = TestServer(\n    payment_address=\"test_address\",\n    token_mint=\"test_usdc\"\n)\n\n@server.require_payment(amount=\"0.10\", resource=\"/test\")\nasync def test_endpoint():\n    return {\"data\": \"test\"}\n\nserver.start(port=8402)\n\n# Test against mock server\n# ...\n\nserver.stop()\n</code></pre>"},{"location":"quick-reference/#wallet-setup","title":"Wallet Setup","text":""},{"location":"quick-reference/#creating-a-new-wallet","title":"Creating a New Wallet","text":"<pre><code>from solders.keypair import Keypair\nimport json\n\n# Generate new keypair\nkeypair = Keypair()\n\n# Save to file\nwallet_data = list(bytes(keypair))\nwith open(\"wallet.json\", \"w\") as f:\n    json.dump(wallet_data, f)\n\nprint(f\"Wallet address: {keypair.pubkey()}\")\n</code></pre>"},{"location":"quick-reference/#loading-wallet","title":"Loading Wallet","text":"<pre><code>from solders.keypair import Keypair\nimport json\n\n# Load from file\nwith open(\"wallet.json\") as f:\n    wallet_data = json.load(f)\n    keypair = Keypair.from_bytes(bytes(wallet_data))\n\nprint(f\"Loaded wallet: {keypair.pubkey()}\")\n</code></pre>"},{"location":"quick-reference/#getting-devnet-sol-for-fees","title":"Getting Devnet SOL (for fees)","text":"<pre><code># Use Solana CLI\nsolana airdrop 1 YOUR_WALLET_ADDRESS --url devnet\n\n# Or use web faucet\n# https://faucet.solana.com\n</code></pre>"},{"location":"quick-reference/#common-patterns","title":"Common Patterns","text":""},{"location":"quick-reference/#retry-configuration","title":"Retry Configuration","text":"<pre><code>from openlibx402_client import X402AutoClient, RetryConfig\n\nconfig = RetryConfig(\n    enabled=True,\n    max_retries=1,\n    retry_on_402=True,\n    retry_on_network_error=True\n)\n\nclient = X402AutoClient(\n    wallet_keypair=keypair,\n    retry_config=config\n)\n</code></pre>"},{"location":"quick-reference/#custom-payment-amount","title":"Custom Payment Amount","text":"<pre><code># Pay custom amount (less than max required)\nresponse = await client.get(\"https://api.example.com/data\")\n\nif client.payment_required(response):\n    request = client.parse_payment_request(response)\n    # Pay 50% of requested amount (if API supports it)\n    auth = await client.create_payment(request, amount=\"0.05\")\n    response = await client.get(url, payment=auth)\n</code></pre>"},{"location":"quick-reference/#multiple-apis","title":"Multiple APIs","text":"<pre><code># Configure client with higher payment limit\nclient = X402AutoClient(\n    wallet_keypair=keypair,\n    max_payment_amount=\"10.0\"\n)\n\n# Fetch from multiple paid APIs\ndata1 = await client.fetch(\"https://api1.example.com/data\")\ndata2 = await client.fetch(\"https://api2.example.com/data\")\ndata3 = await client.fetch(\"https://api3.example.com/data\")\n\n# Client automatically handles payment for each\n</code></pre>"},{"location":"quick-reference/#devnet-quick-start","title":"Devnet Quick Start","text":"<pre><code># 1. Install packages\npip install openlibx402-core openlibx402-fastapi openlibx402-client\n\n# 2. Create wallet\npython -c \"from solders.keypair import Keypair; import json; kp = Keypair(); \\\njson.dump(list(bytes(kp)), open('wallet.json', 'w')); \\\nprint(f'Address: {kp.pubkey()}')\"\n\n# 3. Get devnet SOL\nsolana airdrop 1 &lt;YOUR_ADDRESS&gt; --url devnet\n\n# 4. Run example server\ncd examples/fastapi-server\npip install -r requirements.txt\npython main.py\n\n# 5. Run example client\ncd examples/langchain-agent\npip install -r requirements.txt\npython main.py\n</code></pre>"},{"location":"quick-reference/#production-checklist","title":"Production Checklist","text":"<ul> <li>[ ] Use mainnet RPC URL</li> <li>[ ] Use real USDC mint address</li> <li>[ ] Never log private keys</li> <li>[ ] Use HTTPS for all APIs</li> <li>[ ] Implement rate limiting</li> <li>[ ] Set up monitoring</li> <li>[ ] Configure reasonable payment timeouts</li> <li>[ ] Implement proper error handling</li> <li>[ ] Use environment variables for config</li> <li>[ ] Test with small amounts first</li> <li>[ ] Set maximum payment limits</li> <li>[ ] Implement wallet balance monitoring</li> </ul>"},{"location":"quick-reference/#resources","title":"Resources","text":"<ul> <li>X402 Whitepaper: https://www.x402.org/x402-whitepaper.pdf</li> <li>Solana Docs: https://docs.solana.com</li> <li>SPL Token: https://spl.solana.com/token</li> <li>FastAPI: https://fastapi.tiangolo.com</li> <li>LangChain: https://python.langchain.com</li> <li>LangGraph: https://langchain-ai.github.io/langgraph</li> </ul>"},{"location":"quick-reference/#common-issues","title":"Common Issues","text":""},{"location":"quick-reference/#insufficient-funds-error","title":"\"Insufficient Funds\" Error","text":"<ul> <li>Check wallet balance: <code>solana balance &lt;ADDRESS&gt; --url devnet</code></li> <li>Ensure you have both SOL (for fees) and USDC (for payment)</li> </ul>"},{"location":"quick-reference/#transaction-failed-error","title":"\"Transaction Failed\" Error","text":"<ul> <li>Check network connectivity</li> <li>Verify RPC endpoint is accessible</li> <li>Ensure devnet is not experiencing issues</li> </ul>"},{"location":"quick-reference/#payment-verification-failed","title":"\"Payment Verification Failed\"","text":"<ul> <li>Transaction may not be confirmed yet</li> <li>Check transaction on Solana Explorer</li> <li>Verify payment address and amount are correct</li> </ul>"},{"location":"quick-reference/#import-errors","title":"Import Errors","text":"<ul> <li>Ensure all packages are installed</li> <li>Check Python version (requires 3.8+)</li> <li>Verify virtual environment is activated</li> </ul> <p>Happy Building! \ud83d\ude80</p>"},{"location":"chatbot/","title":"OpenLibx402 RAG Chatbot Documentation","text":"<p>Welcome to the comprehensive documentation for the OpenLibx402 RAG (Retrieval-Augmented Generation) Chatbot. This chatbot integrates AI-powered question answering with Solana blockchain payments.</p>"},{"location":"chatbot/#documentation-overview","title":"\ud83d\udcda Documentation Overview","text":""},{"location":"chatbot/#for-first-time-users","title":"For First-Time Users","text":"<p>Start here if you're new to the chatbot:</p> <ol> <li>Quick Start (5 min read)</li> <li>Get the chatbot running locally in 5 minutes</li> <li>Basic setup and testing</li> <li> <p>Common troubleshooting</p> </li> <li> <p>Overview (10 min read)</p> </li> <li>What is the chatbot?</li> <li>Key features and benefits</li> <li>High-level architecture</li> <li>Technology stack</li> </ol>"},{"location":"chatbot/#for-developers","title":"For Developers","text":"<p>Develop and understand the system:</p> <ol> <li>Architecture (20 min read)</li> <li>System design and component interactions</li> <li>Data flow diagrams</li> <li>Design patterns and decisions</li> <li> <p>Performance and scalability considerations</p> </li> <li> <p>Configuration (15 min read)</p> </li> <li>Environment variables</li> <li>API key setup</li> <li>Network configuration</li> <li> <p>Solana wallet setup</p> </li> <li> <p>API Reference (15 min read)</p> </li> <li>All REST endpoints</li> <li>Request/response formats</li> <li>Error handling</li> <li> <p>Code examples in JavaScript and Python</p> </li> <li> <p>Payment System (15 min read)</p> </li> <li>How USDC payments work</li> <li>Transaction verification</li> <li>Testing payments</li> <li>Security considerations</li> </ol>"},{"location":"chatbot/#for-operations","title":"For Operations","text":"<p>Deploy and maintain the system:</p> <ol> <li>Deployment Guide (30 min read)</li> <li>Step-by-step production deployment</li> <li>Docker containerization</li> <li>Nginx reverse proxy setup</li> <li>Monitoring and alerts</li> <li>Scaling strategies</li> </ol>"},{"location":"chatbot/#quick-links","title":"Quick Links","text":""},{"location":"chatbot/#getting-started","title":"Getting Started","text":"<ul> <li>\u26a1 Quick Start - Run in 5 minutes</li> <li>\ud83d\udcd6 Configuration Guide - Environment variables</li> <li>\ud83d\ude80 Deployment Guide - Production setup</li> </ul>"},{"location":"chatbot/#api-integration","title":"API &amp; Integration","text":"<ul> <li>\ud83d\udce1 API Reference - Complete endpoint documentation</li> <li>\ud83d\udcb0 Payment System - USDC integration details</li> <li>\ud83c\udfd7\ufe0f Architecture - System design deep-dive</li> </ul>"},{"location":"chatbot/#support","title":"Support","text":"<ul> <li>\ud83c\udd98 Common Issues - Troubleshooting</li> <li>\ud83d\udccb Configuration Troubleshooting</li> <li>\ud83d\udd0d Payment Troubleshooting</li> </ul>"},{"location":"chatbot/#feature-overview","title":"Feature Overview","text":""},{"location":"chatbot/#chat-interface","title":"Chat Interface","text":"<ul> <li>AI-Powered Responses: Uses OpenAI GPT-5 nano for intelligent answers</li> <li>Document Retrieval: Searches documentation using Pinecone vector database</li> <li>Citation Sources: Every answer includes links to source documents</li> <li>Conversation History: Stores chat history in browser localStorage</li> </ul>"},{"location":"chatbot/#rate-limiting","title":"Rate Limiting","text":"<ul> <li>Free Tier: 3 queries per day per user (by IP address)</li> <li>Paid Tier: Purchase 10-1000 additional queries with USDC</li> <li>Daily Reset: Limits reset at midnight UTC</li> <li>Transparent UI: Shows remaining queries and reset time</li> </ul>"},{"location":"chatbot/#payment-system","title":"Payment System","text":"<ul> <li>USDC on Solana: Secure, fast blockchain payments</li> <li>Variable Amounts: Choose from 0.01 to 1.00 USDC</li> <li>Instant Verification: Transaction verified on blockchain</li> <li>Automatic Grants: Queries granted immediately after payment</li> </ul>"},{"location":"chatbot/#key-metrics","title":"Key Metrics","text":""},{"location":"chatbot/#performance","title":"Performance","text":"<ul> <li>Response Time: &lt; 2 seconds (P95)</li> <li>Uptime Target: 99.9%</li> <li>Error Rate: &lt; 1%</li> </ul>"},{"location":"chatbot/#cost","title":"Cost","text":"<ul> <li>Operating Cost: ~$0.000133 per query (GPT-5 nano)</li> <li>User Revenue: $0.001 per query</li> <li>Profit Margin: ~87%</li> </ul>"},{"location":"chatbot/#architecture-at-a-glance","title":"Architecture at a Glance","text":"<pre><code>Frontend (Browser)\n    \u2193 (Chat, Payments)\nDeno Backend Server\n    \u251c\u2500 OpenAI (Response generation)\n    \u251c\u2500 Pinecone (Document retrieval)\n    \u251c\u2500 Solana (Payment verification)\n    \u2514\u2500 Deno KV (Rate limiting)\n</code></pre>"},{"location":"chatbot/#file-structure","title":"File Structure","text":"<pre><code>docs/\n\u2514\u2500\u2500 chatbot/\n    \u251c\u2500\u2500 index.md                 # This file\n    \u251c\u2500\u2500 quickstart.md           # 5-minute setup guide\n    \u251c\u2500\u2500 overview.md             # Feature overview\n    \u251c\u2500\u2500 architecture.md         # System design\n    \u251c\u2500\u2500 configuration.md        # Environment setup\n    \u251c\u2500\u2500 api.md                  # REST API reference\n    \u251c\u2500\u2500 payments.md             # Payment system\n    \u2514\u2500\u2500 deployment.md           # Production deployment\n\nchatbot/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 main.ts                 # Server entry point\n\u2502   \u251c\u2500\u2500 handlers/               # HTTP request handlers\n\u2502   \u251c\u2500\u2500 middleware/             # Request middleware\n\u2502   \u251c\u2500\u2500 services/               # External integrations\n\u2502   \u2514\u2500\u2500 utils/                  # Utilities\n\u251c\u2500\u2500 .env                        # Environment variables\n\u2514\u2500\u2500 deno.json                   # Deno configuration\n</code></pre>"},{"location":"chatbot/#common-tasks","title":"Common Tasks","text":""},{"location":"chatbot/#i-want-to","title":"I want to...","text":"<p>...try the chatbot locally \u2192 Read Quick Start</p> <p>...understand how it works \u2192 Read Overview and Architecture</p> <p>...integrate the API \u2192 Read API Reference</p> <p>...set up payments \u2192 Read Payment System</p> <p>...deploy to production \u2192 Read Deployment Guide</p> <p>...change configuration \u2192 Read Configuration Guide</p> <p>...troubleshoot issues \u2192 Read respective troubleshooting sections</p>"},{"location":"chatbot/#environment-variables-summary","title":"Environment Variables Summary","text":"Variable Purpose Status <code>OPENAI_API_KEY</code> GPT API access Required <code>PINECONE_API_KEY</code> Vector DB access Required <code>PINECONE_INDEX_NAME</code> Index name Required <code>X402_WALLET_ADDRESS</code> Payment receiver Required <code>X402_WALLET_SECRET_KEY</code> Sign transactions Required <code>SOLANA_NETWORK</code> devnet/mainnet Required <code>USDC_MINT_ADDRESS</code> Token address Required <code>RATE_LIMIT_FREE_QUERIES</code> Free queries/day Optional (default: 3) <code>PORT</code> Server port Optional (default: 3000) <code>ALLOWED_ORIGINS</code> CORS origins Optional"},{"location":"chatbot/#endpoints-summary","title":"Endpoints Summary","text":"Method Path Purpose POST <code>/api/chat</code> Send message to chatbot GET <code>/api/status</code> Check rate limit status GET <code>/api/payment/info</code> Get payment configuration POST <code>/api/payment</code> Submit USDC payment"},{"location":"chatbot/#pricing","title":"Pricing","text":"Amount Queries Cost/Query Use Case Free 3/day $0 Trial users 0.01 USDC 10 $0.001 Light users 0.50 USDC 500 $0.001 Active users 1.00 USDC 1000 $0.001 Power users"},{"location":"chatbot/#support-resources","title":"Support &amp; Resources","text":""},{"location":"chatbot/#documentation","title":"Documentation","text":"<ul> <li>\ud83d\udcd6 Full documentation: See above</li> <li>\ud83d\udd17 API Swagger: (Coming soon)</li> <li>\ud83d\udcdd Changelog: Available in main README</li> </ul>"},{"location":"chatbot/#getting-help","title":"Getting Help","text":"<ol> <li>Check Quick Start Troubleshooting</li> <li>Check relevant section (Configuration, Payments, Deployment)</li> <li>Review server logs for <code>[ERROR]</code> messages</li> <li>Create an issue on GitHub</li> </ol>"},{"location":"chatbot/#external-resources","title":"External Resources","text":"<ul> <li>\ud83d\udd17 Deno Docs</li> <li>\ud83d\udd17 Hono Framework</li> <li>\ud83d\udd17 Pinecone Docs</li> <li>\ud83d\udd17 OpenAI API Docs</li> <li>\ud83d\udd17 Solana Docs</li> <li>\ud83d\udd17 Phantom Wallet</li> </ul>"},{"location":"chatbot/#roadmap","title":"Roadmap","text":""},{"location":"chatbot/#current-version-10","title":"Current Version (1.0)","text":"<p>\u2705 Chat with RAG \u2705 Rate limiting \u2705 USDC payments \u2705 Conversation history</p>"},{"location":"chatbot/#planned-features","title":"Planned Features","text":"<ul> <li>[ ] User accounts</li> <li>[ ] Subscription plans</li> <li>[ ] Multiple languages</li> <li>[ ] Voice input/output</li> <li>[ ] Export conversations</li> <li>[ ] Custom fine-tuning</li> <li>[ ] Analytics dashboard</li> <li>[ ] Admin panel</li> </ul>"},{"location":"chatbot/#license","title":"License","text":"<p>OpenLibx402 RAG Chatbot is released under the MIT License.</p>"},{"location":"chatbot/#contributors","title":"Contributors","text":"<p>Built with \u2764\ufe0f by the OpenLibx402 team.</p> <p>Last Updated: 2025-11-04 Version: 1.0.0 Status: Production Ready</p> <p>Need help? Check the Quick Start Guide or Deployment Guide!</p>"},{"location":"chatbot/TABLE_OF_CONTENTS/","title":"Chatbot Documentation - Table of Contents","text":"<p>Complete navigation guide for all chatbot documentation.</p>"},{"location":"chatbot/TABLE_OF_CONTENTS/#quick-navigation","title":"\ud83d\udccb Quick Navigation","text":""},{"location":"chatbot/TABLE_OF_CONTENTS/#by-role","title":"By Role","text":"<p>\ud83d\udc64 End Users - Overview - What is the chatbot? - Quick Start - Get started in 5 minutes - API Reference - Chat Endpoint - Send messages</p> <p>\ud83d\udc68\u200d\ud83d\udcbb Developers - Quick Start - Local setup - Configuration - Environment variables - API Reference - All endpoints - Architecture - System design</p> <p>\ud83d\ude80 DevOps / Operations - Deployment Guide - Production setup - Configuration - Troubleshooting - Architecture - Monitoring - Observability</p> <p>\ud83d\udcb0 Business / Product - Overview - Pricing and costs - Payments - Revenue model - Deployment - Monitoring - Cost tracking</p>"},{"location":"chatbot/TABLE_OF_CONTENTS/#by-task","title":"By Task","text":"<p>\ud83c\udfc3 I want to get started quickly \u2192 Quick Start (5 min)</p> <p>\ud83d\udcda I want to understand the system \u2192 Overview (10 min) \u2192 Architecture (20 min)</p> <p>\ud83d\udd27 I want to configure it \u2192 Configuration Guide (15 min)</p> <p>\ud83d\udce1 I want to use the API \u2192 API Reference (15 min)</p> <p>\ud83d\udcb3 I want to understand payments \u2192 Payments Guide (15 min)</p> <p>\ud83d\ude80 I want to deploy to production \u2192 Deployment Guide (30 min)</p> <p>\ud83d\udc1b Something is broken \u2192 Quick Start - Troubleshooting or    Configuration - Troubleshooting or    Payments - Troubleshooting</p>"},{"location":"chatbot/TABLE_OF_CONTENTS/#all-documents","title":"\ud83d\udcda All Documents","text":""},{"location":"chatbot/TABLE_OF_CONTENTS/#1-index-documentation-hub","title":"1. Index - Documentation Hub","text":"<p>Purpose: Navigation and overview of all documentation Read Time: 5 minutes Audience: Everyone</p> <p>Sections: - Documentation overview - Quick links - Feature overview - Key metrics - Architecture at a glance - Common tasks - Support &amp; resources</p>"},{"location":"chatbot/TABLE_OF_CONTENTS/#2-quick-start-5-minute-setup","title":"2. Quick Start - 5-Minute Setup","text":"<p>Purpose: Get chatbot running locally in 5 minutes Read Time: 5 minutes Audience: Developers, First-time users</p> <p>Sections: - Prerequisites (1 min) - Setup (2 min) - Start server (1 min) - Test chatbot (2 min) - Test payments (optional) - Common issues - Next steps - File structure - Environment variables - Rate limiting - Pricing - Support</p>"},{"location":"chatbot/TABLE_OF_CONTENTS/#3-overview-feature-overview","title":"3. Overview - Feature Overview","text":"<p>Purpose: High-level understanding of what the chatbot does Read Time: 10 minutes Audience: Everyone (technical and non-technical)</p> <p>Sections: - Key features - Architecture - Technology stack - Deployment - User flow (chat &amp; payment) - Rate limiting - Configuration - Security - Cost analysis - Next steps</p>"},{"location":"chatbot/TABLE_OF_CONTENTS/#4-configuration-environment-setup","title":"4. Configuration - Environment Setup","text":"<p>Purpose: Configure the chatbot for your environment Read Time: 15 minutes Audience: Developers, DevOps</p> <p>Sections: - Environment variables (all variables documented) - Environment files (development vs production) - Runtime configuration - Payment pricing - Solana network setup (devnet vs mainnet) - Frontend configuration - Verifying configuration - Troubleshooting - Security best practices</p>"},{"location":"chatbot/TABLE_OF_CONTENTS/#5-api-reference-rest-endpoints","title":"5. API Reference - REST Endpoints","text":"<p>Purpose: Complete documentation of all API endpoints Read Time: 15 minutes Audience: Developers, Integration engineers</p> <p>Sections: - Base URL - Authentication - All 4 endpoints with detailed documentation:   1. POST /api/chat - Send message   2. GET /api/status - Check rate limit   3. GET /api/payment/info - Get payment info   4. POST /api/payment - Submit payment - HTTP headers - Rate limiting - Error handling - CORS configuration - Integration examples (JavaScript &amp; Python) - Changelog</p>"},{"location":"chatbot/TABLE_OF_CONTENTS/#6-payments-usdc-integration","title":"6. Payments - USDC Integration","text":"<p>Purpose: Deep dive into how payments work Read Time: 15 minutes Audience: Developers, Product managers</p> <p>Sections: - Payment flow (user perspective &amp; technical) - Data flow diagram - Pricing model &amp; cost analysis - Transaction verification details - Blockchain details (Solana, SPL Token, ATAs) - Payment handler API (request/response) - Payment info endpoint - Testing payments - Monitoring payments - Security considerations - Future enhancements</p>"},{"location":"chatbot/TABLE_OF_CONTENTS/#7-architecture-system-design","title":"7. Architecture - System Design","text":"<p>Purpose: Understand the technical architecture Read Time: 20 minutes Audience: Developers, Architects, Technical leads</p> <p>Sections: - System overview - Component diagram - Data flows (chat &amp; payment) - Architecture patterns - State management (Deno KV schema) - Code organization - Technology choices &amp; rationale - Performance considerations - Optimization strategies - Cost optimization - Security architecture - Scalability architecture - Monitoring and observability - Testing strategy - Disaster recovery - Future enhancements - References</p>"},{"location":"chatbot/TABLE_OF_CONTENTS/#8-deployment-production-setup","title":"8. Deployment - Production Setup","text":"<p>Purpose: Deploy chatbot to production Read Time: 30 minutes Audience: DevOps, SREs, Operations</p> <p>Sections: - Prerequisites - Deployment architecture - Phase 1: Development setup - Phase 2: Testing - Phase 3: Production preparation - Phase 4: Deployment options   - Docker   - Deno Deploy (Cloud)   - Traditional VPS - Phase 5: MkDocs integration - Phase 6: Monitoring &amp; maintenance - Production checklist - Scaling considerations - Troubleshooting - Rolling updates - Security hardening - Success indicators</p>"},{"location":"chatbot/TABLE_OF_CONTENTS/#document-statistics","title":"\ud83d\udcca Document Statistics","text":"Document Read Time Size Audience Index 5 min Medium Everyone Quick Start 5 min Small Developers Overview 10 min Medium Everyone Configuration 15 min Large Developers API Reference 15 min Large Developers Payments 15 min Large Product Architecture 20 min Very Large Technical Deployment 30 min Very Large DevOps <p>Total Documentation: ~2-3 hours of reading Recommended Reading Order: Quick Start \u2192 Overview \u2192 Architecture \u2192 Deployment</p>"},{"location":"chatbot/TABLE_OF_CONTENTS/#learning-paths","title":"\ud83c\udfaf Learning Paths","text":""},{"location":"chatbot/TABLE_OF_CONTENTS/#path-1-user-5-10-min","title":"Path 1: User (5-10 min)","text":"<ol> <li>Overview - Understand what it does</li> <li>Quick Start - Testing Payments - Try it out</li> </ol>"},{"location":"chatbot/TABLE_OF_CONTENTS/#path-2-developer-30-45-min","title":"Path 2: Developer (30-45 min)","text":"<ol> <li>Quick Start - Get running locally</li> <li>Configuration - Understand settings</li> <li>API Reference - Learn endpoints</li> <li>Payments - Understand USDC</li> </ol>"},{"location":"chatbot/TABLE_OF_CONTENTS/#path-3-devops-45-60-min","title":"Path 3: DevOps (45-60 min)","text":"<ol> <li>Overview - Understand system</li> <li>Configuration - Understand settings</li> <li>Deployment - Deploy to production</li> <li>Architecture - Monitoring - Set up monitoring</li> </ol>"},{"location":"chatbot/TABLE_OF_CONTENTS/#path-4-architect-90-min","title":"Path 4: Architect (90+ min)","text":"<ol> <li>Overview - High-level view</li> <li>Architecture - Deep technical dive</li> <li>Deployment - Production setup</li> <li>Configuration - Fine details</li> <li>Payments - Payment verification</li> </ol>"},{"location":"chatbot/TABLE_OF_CONTENTS/#search-guide","title":"\ud83d\udd0d Search Guide","text":"<p>Looking for...</p> <p>Environment Variables? \u2192 Configuration - Environment Variables</p> <p>API Endpoints? \u2192 API Reference - Endpoints</p> <p>Payment Instructions? \u2192 Payments - Payment Flow</p> <p>Deployment Steps? \u2192 Deployment - Phase 5</p> <p>How Rate Limiting Works? \u2192 Overview - Rate Limiting \u2192 Configuration - Rate Limiting \u2192 Architecture - State Management</p> <p>How Payments Work? \u2192 Payments - Payment Flow \u2192 Payments - Transaction Verification \u2192 API Reference - Payment Endpoint</p> <p>Troubleshooting Issues? \u2192 Quick Start - Common Issues \u2192 Configuration - Troubleshooting \u2192 Payments - Troubleshooting</p> <p>Deployment? \u2192 Deployment - Full Guide \u2192 Deployment - Docker \u2192 Deployment - Deno Deploy \u2192 Deployment - VPS</p> <p>Security? \u2192 Architecture - Security Architecture \u2192 Payments - Security \u2192 Deployment - Security Hardening</p> <p>Costs? \u2192 Overview - Cost Analysis \u2192 Payments - Pricing Model \u2192 Payments - Cost Analysis</p> <p>Scalability? \u2192 Architecture - Scalability \u2192 Deployment - Scaling</p> <p>Monitoring? \u2192 Architecture - Monitoring \u2192 Deployment - Monitoring</p>"},{"location":"chatbot/TABLE_OF_CONTENTS/#reading-recommendations","title":"\ud83d\udcd6 Reading Recommendations","text":"<p>For Understanding the System: 1. Start: Overview 2. Then: Architecture 3. Finally: Deployment</p> <p>For Setting Up Locally: 1. Start: Quick Start 2. Then: Configuration 3. Finally: Test with API Reference</p> <p>For Production Deployment: 1. Start: Configuration 2. Then: Deployment 3. Finally: Architecture - Monitoring</p> <p>For Payment Integration: 1. Start: Payments 2. Then: API Reference - Payment Endpoint 3. Finally: Payments - Testing</p>"},{"location":"chatbot/TABLE_OF_CONTENTS/#documentation-structure","title":"\ud83c\udfd7\ufe0f Documentation Structure","text":"<pre><code>docs/\n\u2514\u2500\u2500 chatbot/\n    \u251c\u2500\u2500 index.md                      # Navigation hub\n    \u251c\u2500\u2500 TABLE_OF_CONTENTS.md          # This file\n    \u251c\u2500\u2500 quickstart.md                 # 5-min setup\n    \u251c\u2500\u2500 overview.md                   # Feature overview\n    \u251c\u2500\u2500 configuration.md              # Environment setup\n    \u251c\u2500\u2500 api.md                        # REST endpoints\n    \u251c\u2500\u2500 payments.md                   # USDC system\n    \u251c\u2500\u2500 architecture.md               # Technical design\n    \u2514\u2500\u2500 deployment.md                 # Production setup\n\nchatbot/\n\u2514\u2500\u2500 CHATBOT_README.md                 # Development guide\n</code></pre>"},{"location":"chatbot/TABLE_OF_CONTENTS/#documentation-checklist","title":"\u2705 Documentation Checklist","text":"<ul> <li>[x] Quick Start (5 min) - Get running locally</li> <li>[x] Overview - Understand features</li> <li>[x] Configuration - Set up environment</li> <li>[x] API Reference - All endpoints documented</li> <li>[x] Payments - USDC integration detailed</li> <li>[x] Architecture - Technical deep dive</li> <li>[x] Deployment - Production setup</li> <li>[x] Table of Contents (this file) - Navigation</li> </ul>"},{"location":"chatbot/TABLE_OF_CONTENTS/#version-info","title":"\ud83d\udcdd Version Info","text":"Document Version Last Updated Status Quick Start 1.0 2025-11-04 \u2705 Complete Overview 1.0 2025-11-04 \u2705 Complete Configuration 1.0 2025-11-04 \u2705 Complete API Reference 1.0 2025-11-04 \u2705 Complete Payments 1.0 2025-11-04 \u2705 Complete Architecture 1.0 2025-11-04 \u2705 Complete Deployment 1.0 2025-11-04 \u2705 Complete Table of Contents 1.0 2025-11-04 \u2705 Complete"},{"location":"chatbot/TABLE_OF_CONTENTS/#getting-started","title":"\ud83d\ude80 Getting Started","text":"<p>New to the chatbot? \u2192 Start with Quick Start (5 minutes)</p> <p>Want to understand it first? \u2192 Read Overview (10 minutes)</p> <p>Ready to deploy? \u2192 Follow Deployment Guide (30 minutes)</p> <p>Need API details? \u2192 Check API Reference (15 minutes)</p> <p>Happy coding! \ud83c\udf89</p>"},{"location":"chatbot/api/","title":"Chatbot API Reference","text":"<p>Complete API documentation for the OpenLibx402 RAG Chatbot backend server.</p>"},{"location":"chatbot/api/#base-url","title":"Base URL","text":"<ul> <li>Development: <code>http://localhost:8000</code> (Deno) or <code>http://localhost:3000</code> (Node.js)</li> <li>Production: <code>https://your-project.deno.dev</code> or <code>https://api.chatbot.openlibx402.com</code></li> </ul> <p>Note: The base URL is configured in <code>docs/mkdocs.yml</code> under <code>extra.chatbot.api_url</code>. See Backend API Configuration for setup details.</p>"},{"location":"chatbot/api/#authentication","title":"Authentication","text":"<p>The API does not require authentication. Rate limiting is handled per user based on IP address.</p>"},{"location":"chatbot/api/#endpoints","title":"Endpoints","text":""},{"location":"chatbot/api/#1-chat-message","title":"1. Chat Message","text":"<p>Send a message to the chatbot and receive an AI-generated response.</p> <p>Endpoint: <code>POST /api/chat</code></p> <p>Headers: <pre><code>Content-Type: application/json\n</code></pre></p> <p>Request Body: <pre><code>{\n  \"message\": \"What is OpenLibx402?\",\n  \"conversationId\": \"optional-uuid-for-tracking\"\n}\n</code></pre></p> <p>Parameters:</p> Field Type Required Description <code>message</code> string Yes User's question or message <code>conversationId</code> string No Optional ID for tracking conversations <p>Response (200 OK): <pre><code>{\n  \"success\": true,\n  \"response\": \"OpenLibx402 is a library that provides...\",\n  \"sources\": [\n    {\n      \"title\": \"Introduction\",\n      \"url\": \"https://docs.openlibx402.com/intro\",\n      \"excerpt\": \"OpenLibx402 is...\"\n    },\n    {\n      \"title\": \"Features\",\n      \"url\": \"https://docs.openlibx402.com/features\",\n      \"excerpt\": \"Key features include...\"\n    }\n  ],\n  \"tokensUsed\": 150\n}\n</code></pre></p> <p>Response (402 Payment Required):</p> <p>The response uses the standardized OpenLibx402 PaymentRequest format:</p> <pre><code>{\n  \"max_amount_required\": \"0.01\",\n  \"asset_type\": \"SPL\",\n  \"asset_address\": \"4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU\",\n  \"payment_address\": \"HMYDGuLTCL6r5pGL8yUbj27i4pyafpomfhZLq3psxm7L\",\n  \"network\": \"solana-devnet\",\n  \"expires_at\": \"2025-11-05T12:05:00Z\",\n  \"nonce\": \"base64-encoded-nonce\",\n  \"payment_id\": \"uuid-payment-id\",\n  \"resource\": \"/api/chat\",\n  \"description\": \"Access to /api/chat endpoint - 3 free queries/day used\"\n}\n</code></pre> <p>X402 Standard: This follows the OpenLibx402 HTTP 402 Payment Required protocol for standardized payment requests. See Payment System Documentation for details.</p> <p>Response (500 Internal Server Error): <pre><code>{\n  \"error\": \"Failed to process request\",\n  \"message\": \"An unexpected error occurred\"\n}\n</code></pre></p> <p>Example Usage:</p> <pre><code>curl -X POST http://localhost:3000/api/chat \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"message\": \"How do I use OpenLibx402?\",\n    \"conversationId\": \"user-123\"\n  }'\n</code></pre> <p>JavaScript Example:</p> <pre><code>const response = await fetch('http://localhost:3000/api/chat', {\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n  },\n  body: JSON.stringify({\n    message: 'How do I use OpenLibx402?',\n    conversationId: 'user-123'\n  })\n});\n\nif (response.status === 402) {\n  // Handle rate limit - show payment modal\n  console.log('Rate limit exceeded - payment required');\n} else if (response.ok) {\n  const data = await response.json();\n  console.log('Response:', data.response);\n  console.log('Sources:', data.sources);\n} else {\n  console.error('Error:', response.status);\n}\n</code></pre>"},{"location":"chatbot/api/#2-status-rate-limit-check","title":"2. Status / Rate Limit Check","text":"<p>Check the current rate limit status for your user (IP address).</p> <p>Endpoint: <code>GET /api/status</code></p> <p>Response (200 OK - Queries Available): <pre><code>{\n  \"allowed\": true,\n  \"remaining\": 2,\n  \"resetAt\": 1730851200000,\n  \"requiresPayment\": false,\n  \"rateLimit\": {\n    \"allowed\": true,\n    \"remaining\": 2,\n    \"resetAt\": 1730851200000,\n    \"requiresPayment\": false\n  }\n}\n</code></pre></p> <p>Response (402 Payment Required - No Queries): <pre><code>{\n  \"error\": \"Rate limit exceeded\",\n  \"message\": \"You have used all 3 free queries for today. Please make a payment to continue.\",\n  \"remaining\": 0,\n  \"resetAt\": 1730851200000,\n  \"payment\": {\n    \"required\": true,\n    \"amount\": 0.01,\n    \"token\": \"USDC\"\n  }\n}\n</code></pre></p> <p>Example Usage:</p> <pre><code>curl http://localhost:3000/api/status\n</code></pre>"},{"location":"chatbot/api/#3-payment-info","title":"3. Payment Info","text":"<p>Get payment configuration information in standardized X402 format.</p> <p>Endpoint: <code>GET /api/payment/info</code></p> <p>Response (200 OK): <pre><code>{\n  \"x402_format\": \"v1\",\n  \"asset_type\": \"SPL\",\n  \"asset_address\": \"4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU\",\n  \"payment_address\": \"HMYDGuLTCL6r5pGL8yUbj27i4pyafpomfhZLq3psxm7L\",\n  \"network\": \"solana-devnet\",\n  \"amount\": 0.01,\n  \"token\": \"USDC\",\n  \"recipient\": \"HMYDGuLTCL6r5pGL8yUbj27i4pyafpomfhZLq3psxm7L\",\n  \"payment_methods\": [\n    {\n      \"method\": \"x-payment-authorization-header\",\n      \"description\": \"Submit as X-Payment-Authorization header in base64-encoded JSON\"\n    },\n    {\n      \"method\": \"post-body-legacy\",\n      \"description\": \"Submit as JSON POST body (backward compatible)\"\n    }\n  ],\n  \"instructions\": [\n    \"1. Send the specified amount of USDC to the payment address\",\n    \"2. Get the transaction signature\",\n    \"3. Submit via X-Payment-Authorization header OR POST body to /api/payment\",\n    \"4. Receive query credits (1 USDC = 1000 queries)\"\n  ]\n}\n</code></pre></p> <p>Example Usage:</p> <pre><code>curl http://localhost:8000/api/payment/info\n</code></pre>"},{"location":"chatbot/api/#4-submit-payment","title":"4. Submit Payment","text":"<p>Submit a Solana transaction signature to verify USDC payment and grant queries.</p> <p>Endpoint: <code>POST /api/payment</code></p> <p>Headers: <pre><code>Content-Type: application/json\n</code></pre></p> <p>The endpoint supports two submission methods:</p>"},{"location":"chatbot/api/#method-1-x-payment-authorization-header-recommended","title":"Method 1: X-Payment-Authorization Header (Recommended)","text":"<pre><code>POST /api/payment\nX-Payment-Authorization: base64-encoded-json\n</code></pre> <p>Header value (base64-encoded): <pre><code>{\n  \"payment_id\": \"uuid\",\n  \"actual_amount\": \"0.01\",\n  \"signature\": \"3xMqyz4fTVaVPpZxbMCuKgf2PQ2hLzpvgLFAkf6fV5zR3FVFBsG9U8k3VzZgPRbmm6U3K3uKZT2\",\n  \"payment_address\": \"HMYDGuLTCL6r5pGL8yUbj27i4pyafpomfhZLq3psxm7L\"\n}\n</code></pre></p>"},{"location":"chatbot/api/#method-2-post-body-legacy-backward-compatible","title":"Method 2: POST Body (Legacy, Backward Compatible)","text":"<p>Request Body: <pre><code>{\n  \"signature\": \"3xMqyz4fTVaVPpZxbMCuKgf2PQ2hLzpvgLFAkf6fV5zR3FVFBsG9U8k3VzZgPRbmm6U3K3uKZT2\",\n  \"amount\": 0.01,\n  \"token\": \"USDC\",\n  \"payment_id\": \"optional-uuid\"\n}\n</code></pre></p> <p>Parameters:</p> Field Type Required Description <code>signature</code> string Yes Solana transaction signature <code>amount</code> number Yes Amount sent (0.01 - 1.00 USDC) <code>token</code> string Optional Token symbol (\"USDC\") <code>payment_id</code> string Optional Payment ID for tracking <p>Response (200 OK): <pre><code>{\n  \"success\": true,\n  \"message\": \"Payment accepted. You have been granted 10 additional queries.\",\n  \"signature\": \"3xMqyz4fTVaVPpZxbMCuKgf2PQ2hLzpvgLFAkf6fV5zR3FVFBsG9U8k3VzZgPRbmm6U3K3uKZT2\",\n  \"queriesGranted\": 10,\n  \"rateLimit\": {\n    \"remaining\": 10,\n    \"resetAt\": 1730851200000,\n    \"requiresPayment\": false\n  }\n}\n</code></pre></p> <p>Response (400 Bad Request): <pre><code>{\n  \"error\": \"Invalid or unconfirmed transaction. Please ensure you sent 0.01 USDC (not SOL) to the recipient address.\",\n  \"details\": \"Transaction verification failed. Check that: 1) You sent USDC tokens (not SOL), 2) Amount is 0.01 USDC, 3) Sent to the correct recipient address, 4) Transaction has been confirmed on the blockchain\"\n}\n</code></pre></p> <p>Example Usage:</p> <p>Method 1 - Using X-Payment-Authorization header: <pre><code>AUTH_JSON='{\"payment_id\":\"uuid\",\"actual_amount\":\"0.01\",\"signature\":\"3xMqyz4fTVaVPpZxbMCuKgf2PQ2hLzpvgLFAkf6fV5zR3FVFBsG9U8k3VzZgPRbmm6U3K3uKZT2\",\"payment_address\":\"HMYDGuLTCL6r5pGL8yUbj27i4pyafpomfhZLq3psxm7L\"}'\nAUTH_HEADER=$(echo -n \"$AUTH_JSON\" | base64)\n\ncurl -X POST http://localhost:8000/api/payment \\\n  -H \"Content-Type: application/json\" \\\n  -H \"X-Payment-Authorization: $AUTH_HEADER\"\n</code></pre></p> <p>Method 2 - Using POST body (legacy): <pre><code>curl -X POST http://localhost:8000/api/payment \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"signature\": \"3xMqyz4fTVaVPpZxbMCuKgf2PQ2hLzpvgLFAkf6fV5zR3FVFBsG9U8k3VzZgPRbmm6U3K3uKZT2\",\n    \"amount\": 0.01,\n    \"token\": \"USDC\"\n  }'\n</code></pre></p> <p>See Payment System Documentation for detailed payment flow.</p>"},{"location":"chatbot/api/#http-headers","title":"HTTP Headers","text":""},{"location":"chatbot/api/#request-headers","title":"Request Headers","text":"<p>Standard request headers:</p> <pre><code>Content-Type: application/json\nAccept: application/json\n</code></pre>"},{"location":"chatbot/api/#response-headers","title":"Response Headers","text":"<p>Standard response headers:</p> <pre><code>Content-Type: application/json\nX-RateLimit-Limit: 3\nX-RateLimit-Remaining: 2\nX-RateLimit-Reset: 1730851200000\n</code></pre> Header Description <code>X-RateLimit-Limit</code> Total free queries per day <code>X-RateLimit-Remaining</code> Queries remaining today <code>X-RateLimit-Reset</code> Unix timestamp (ms) when limit resets"},{"location":"chatbot/api/#rate-limiting","title":"Rate Limiting","text":"<p>Rate limiting is applied per user (identified by IP address).</p> <p>Free Tier: 3 queries per day</p> <p>Paid: Purchase additional queries with USDC (0.01 - 1.00 USDC)</p> <p>Reset: Daily at midnight UTC</p> <p>Behavior: - Requests within limit: <code>200 OK</code> - Requests exceeding limit: <code>402 Payment Required</code></p>"},{"location":"chatbot/api/#error-handling","title":"Error Handling","text":"<p>All errors follow this format:</p> <pre><code>{\n  \"error\": \"Error category\",\n  \"message\": \"Human-readable error message\",\n  \"details\": \"Optional additional context\"\n}\n</code></pre>"},{"location":"chatbot/api/#common-http-status-codes","title":"Common HTTP Status Codes","text":"Status Meaning Example <code>200</code> Success Query completed <code>400</code> Bad Request Invalid amount <code>402</code> Payment Required Rate limit exceeded <code>500</code> Server Error Internal failure"},{"location":"chatbot/api/#error-types","title":"Error Types","text":"<p>400 Bad Request: - Missing required fields - Invalid request format - Amount outside range</p> <p>402 Payment Required: - Daily query limit reached - Payment required to continue</p> <p>500 Internal Server Error: - OpenAI API failure - Pinecone connection error - Deno KV failure - Blockchain communication error</p>"},{"location":"chatbot/api/#rate-limit-behavior","title":"Rate Limit Behavior","text":""},{"location":"chatbot/api/#within-limit","title":"Within Limit","text":"<pre><code>GET /api/status\n\u2192 200 OK\n\nPOST /api/chat { \"message\": \"...\" }\n\u2192 200 OK { \"response\": \"...\", \"sources\": [...] }\n</code></pre> <p>Rate limit headers: <pre><code>X-RateLimit-Remaining: 2\n</code></pre></p>"},{"location":"chatbot/api/#exceeds-limit","title":"Exceeds Limit","text":"<pre><code>POST /api/chat { \"message\": \"...\" }\n\u2192 402 Payment Required\n\n{\n  \"error\": \"Rate limit exceeded\",\n  \"message\": \"You have used all 3 free queries for today. Please make a payment to continue.\",\n  \"remaining\": 0,\n  \"resetAt\": 1730851200000,\n  \"payment\": {\n    \"required\": true,\n    \"amount\": 0.01,\n    \"token\": \"USDC\"\n  }\n}\n</code></pre>"},{"location":"chatbot/api/#cors-configuration","title":"CORS Configuration","text":"<p>Cross-Origin Resource Sharing (CORS) is configured for allowed origins:</p> <pre><code>ALLOWED_ORIGINS=http://localhost:8000,http://localhost:3000,https://openlibx402.github.io\n</code></pre> <p>Allowed Methods: GET, POST, OPTIONS</p> <p>Allowed Headers: Content-Type</p>"},{"location":"chatbot/api/#integration-examples","title":"Integration Examples","text":""},{"location":"chatbot/api/#javascript-fetch-api","title":"JavaScript (Fetch API)","text":"<pre><code>// Check rate limit\nconst checkStatus = async () =&gt; {\n  const response = await fetch('http://localhost:3000/api/status');\n  const data = await response.json();\n  console.log(`Remaining queries: ${data.remaining}`);\n  return data;\n};\n\n// Send chat message\nconst sendMessage = async (message) =&gt; {\n  const response = await fetch('http://localhost:3000/api/chat', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ message })\n  });\n\n  if (response.status === 402) {\n    console.log('Payment required');\n    return null;\n  }\n\n  const data = await response.json();\n  return data;\n};\n\n// Submit payment\nconst submitPayment = async (signature, amount) =&gt; {\n  const response = await fetch('http://localhost:3000/api/payment', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({\n      signature,\n      amount,\n      token: 'USDC'\n    })\n  });\n\n  const data = await response.json();\n  return data;\n};\n</code></pre>"},{"location":"chatbot/api/#python-requests","title":"Python (Requests)","text":"<pre><code>import requests\n\nBASE_URL = 'http://localhost:3000'\n\n# Check rate limit\ndef check_status():\n    response = requests.get(f'{BASE_URL}/api/status')\n    return response.json()\n\n# Send chat message\ndef send_message(message):\n    response = requests.post(\n        f'{BASE_URL}/api/chat',\n        json={'message': message}\n    )\n    if response.status_code == 402:\n        return None\n    return response.json()\n\n# Submit payment\ndef submit_payment(signature, amount):\n    response = requests.post(\n        f'{BASE_URL}/api/payment',\n        json={\n            'signature': signature,\n            'amount': amount,\n            'token': 'USDC'\n        }\n    )\n    return response.json()\n</code></pre>"},{"location":"chatbot/api/#changelog","title":"Changelog","text":""},{"location":"chatbot/api/#version-100","title":"Version 1.0.0","text":"<ul> <li>\u2705 Chat endpoint with RAG</li> <li>\u2705 Rate limiting per IP</li> <li>\u2705 USDC payment system</li> <li>\u2705 Payment info endpoint</li> <li>\u2705 Status/rate limit check</li> </ul>"},{"location":"chatbot/architecture/","title":"Architecture Documentation","text":"<p>Technical deep-dive into the OpenLibx402 RAG Chatbot architecture and design decisions.</p>"},{"location":"chatbot/architecture/#system-overview","title":"System Overview","text":"<p>The chatbot is a Retrieval-Augmented Generation (RAG) system that combines:</p> <ol> <li>Document Retrieval: Pinecone vector database for semantic search</li> <li>Response Generation: OpenAI GPT models for intelligent answers</li> <li>Rate Limiting: Deno KV for per-user query tracking</li> <li>Payment Processing: Solana blockchain for USDC transactions</li> </ol>"},{"location":"chatbot/architecture/#component-diagram","title":"Component Diagram","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      Client (Browser)                           \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502  Chatbot Widget (chatbot.js)                             \u2502  \u2502\n\u2502  \u2502  - Chat interface (React-like pattern)                   \u2502  \u2502\n\u2502  \u2502  - LocalStorage for conversation history                \u2502  \u2502\n\u2502  \u2502  - Phantom wallet integration                           \u2502  \u2502\n\u2502  \u2502  - Real-time payment UI updates                         \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                           \u2193 HTTP (REST)\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    Deno Backend Server                          \u2502\n\u2502                   (Hono Framework)                              \u2502\n\u2502                                                                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502  HTTP Handlers                                          \u2502  \u2502\n\u2502  \u2502  \u251c\u2500 POST /api/chat              \u2192 ChatHandler          \u2502  \u2502\n\u2502  \u2502  \u251c\u2500 GET /api/status             \u2192 RateLimitCheck       \u2502  \u2502\n\u2502  \u2502  \u251c\u2500 GET /api/payment/info       \u2192 PaymentInfo          \u2502  \u2502\n\u2502  \u2502  \u2514\u2500 POST /api/payment           \u2192 PaymentHandler       \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                                                                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502  Middleware                                             \u2502  \u2502\n\u2502  \u2502  \u251c\u2500 CORS Middleware                                    \u2502  \u2502\n\u2502  \u2502  \u251c\u2500 RateLimiter Middleware                            \u2502  \u2502\n\u2502  \u2502  \u2514\u2500 Logging Middleware                                \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                                                                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502  Services                                               \u2502  \u2502\n\u2502  \u2502  \u251c\u2500 OpenAIService                                       \u2502  \u2502\n\u2502  \u2502  \u2502  \u2514\u2500 Text generation (GPT-5 nano)                     \u2502  \u2502\n\u2502  \u2502  \u251c\u2500 PineconeService                                     \u2502  \u2502\n\u2502  \u2502  \u2502  \u2514\u2500 Semantic search &amp; retrieval                      \u2502  \u2502\n\u2502  \u2502  \u251c\u2500 SolanaVerificationService                           \u2502  \u2502\n\u2502  \u2502  \u2502  \u2514\u2500 USDC payment verification                        \u2502  \u2502\n\u2502  \u2502  \u2514\u2500 RateLimiter                                         \u2502  \u2502\n\u2502  \u2502     \u2514\u2500 Query counting &amp; limits                          \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                                                                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502  Storage                                                \u2502  \u2502\n\u2502  \u2502  \u2514\u2500 Deno KV (Distributed key-value store)              \u2502  \u2502\n\u2502  \u2502     \u251c\u2500 rate_limit: userId \u2192 queryCount                 \u2502  \u2502\n\u2502  \u2502     \u2514\u2500 used_transactions: txSignature \u2192 true           \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n     \u2193 HTTP API          \u2193 REST API       \u2193 RPC JSON-RPC\n  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n  \u2502 OpenAI     \u2502    \u2502 Pinecone     \u2502   \u2502 Solana RPC   \u2502\n  \u2502 API        \u2502    \u2502 Vector DB    \u2502   \u2502 Mainnet/     \u2502\n  \u2502            \u2502    \u2502              \u2502   \u2502 Devnet       \u2502\n  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"chatbot/architecture/#data-flow","title":"Data Flow","text":""},{"location":"chatbot/architecture/#chat-message-flow","title":"Chat Message Flow","text":"<pre><code>User Input\n    \u2193\n[Browser] validateInput()\n    \u2193\n[API] POST /api/chat { message, conversationId }\n    \u2193\n[Middleware] checkLimit(userId, ipAddress)\n    \u2193\n    \u251c\u2500 If rate limited:\n    \u2502   return 402 Payment Required\n    \u2502\n    \u2514\u2500 If allowed:\n        [Service] Pinecone.search(message)\n            \u251c\u2500 Embed message (OpenAI)\n            \u251c\u2500 Search vector DB\n            \u2514\u2500 Return top 5 documents\n        \u2193\n        [Service] OpenAI.generate(message, documents)\n            \u251c\u2500 Create prompt with context\n            \u251c\u2500 Call GPT-5 nano\n            \u2514\u2500 Return response with citations\n        \u2193\n        [Middleware] incrementUsage(userId)\n        \u2193\n        [Response] {\n          success: true,\n          response: \"...\",\n          sources: [...],\n          tokensUsed: 150\n        }\n        \u2193\n        [Browser] displayResponse()\n        \u2193\n        [Browser] saveHistory(localStorage)\n</code></pre>"},{"location":"chatbot/architecture/#payment-flow","title":"Payment Flow","text":"<pre><code>Rate Limit Exceeded\n    \u2193\n[UI] showPaymentModal()\n    \u2193\n[UI] User selects amount (slider)\n    \u2193\n[UI] User clicks \"Pay with Solana\"\n    \u2193\n[Service] Phantom.connect()\n    \u2193\n[Service] buildUSDCTransaction()\n    \u251c\u2500 Calculate token accounts\n    \u251c\u2500 Create TransferChecked instruction\n    \u2514\u2500 Build transaction\n    \u2193\n[Service] Phantom.signAndSendTransaction()\n    \u2193\n[API] POST /api/payment { signature, amount }\n    \u2193\n[Service] Solana.verifyTransaction(signature, amount)\n    \u251c\u2500 Fetch transaction from RPC\n    \u251c\u2500 Check token balance changes\n    \u251c\u2500 Validate recipient\n    \u2514\u2500 Return true/false\n    \u2193\n    \u251c\u2500 If invalid:\n    \u2502   return 400 Bad Request\n    \u2502\n    \u2514\u2500 If valid:\n        [Service] SolanaService.markTransactionUsed(signature)\n        \u2193\n        [Service] RateLimiter.grantQueries(userId, queriesGranted)\n            \u251c\u2500 Calculate: queriesGranted = amount * 1000\n            \u251c\u2500 Update KV store\n            \u2514\u2500 Verify grant\n        \u2193\n        [Response] {\n          success: true,\n          queriesGranted: 10,\n          rateLimit: { remaining: 10, ... }\n        }\n        \u2193\n        [UI] updateQueryCount()\n        \u2193\n        [UI] closePaymentModal()\n        \u2193\n        Chat resumes\n</code></pre>"},{"location":"chatbot/architecture/#architecture-patterns","title":"Architecture Patterns","text":""},{"location":"chatbot/architecture/#1-service-oriented-architecture","title":"1. Service-Oriented Architecture","text":"<p>Each external integration is wrapped in a service:</p> <pre><code>\u250c\u2500 OpenAIService\n\u2502  \u2514\u2500 Handles all OpenAI API calls\n\u2502     \u251c\u2500 Embedding\n\u2502     \u251c\u2500 Text generation\n\u2502     \u2514\u2500 Error handling\n\u2502\n\u251c\u2500 PineconeService\n\u2502  \u2514\u2500 Handles vector DB operations\n\u2502     \u251c\u2500 Vector search\n\u2502     \u251c\u2500 Caching\n\u2502     \u2514\u2500 Error handling\n\u2502\n\u251c\u2500 SolanaVerificationService\n\u2502  \u2514\u2500 Handles blockchain verification\n\u2502     \u251c\u2500 Transaction fetching\n\u2502     \u251c\u2500 Balance validation\n\u2502     \u2514\u2500 Error handling\n\u2502\n\u2514\u2500 RateLimiter\n   \u2514\u2500 Handles rate limiting\n      \u251c\u2500 Query tracking\n      \u251c\u2500 Limit checking\n      \u2514\u2500 Grant management\n</code></pre>"},{"location":"chatbot/architecture/#2-middleware-pipeline","title":"2. Middleware Pipeline","text":"<pre><code>Request\n  \u2193\n[CORS] Check origin\n  \u2193\n[Logging] Log request\n  \u2193\n[RateLimiter] Check rate limit\n  \u2193\n[Handler] Process request\n  \u2193\n[Logging] Log response\n  \u2193\nResponse\n</code></pre>"},{"location":"chatbot/architecture/#3-error-handling-strategy","title":"3. Error Handling Strategy","text":"<pre><code>Try\n  \u251c\u2500 Call external service\n  \u2514\u2500 Handle service errors\n        \u251c\u2500 Retry? (with backoff)\n        \u251c\u2500 Fallback? (cached data)\n        \u2514\u2500 Return error response\nCatch\n  \u2514\u2500 Log error\n  \u2514\u2500 Return 500 with generic message\n</code></pre>"},{"location":"chatbot/architecture/#state-management","title":"State Management","text":""},{"location":"chatbot/architecture/#deno-kv-schema","title":"Deno KV Schema","text":"<p>Rate Limiting: <pre><code>Key:   ['rate_limit', 'user:192.168.1.1', '2025-11-04']\nValue: 2  // number of queries used today\nTTL:   25 hours\n</code></pre></p> <p>Used Transactions: <pre><code>Key:   ['used_transactions', '3xMqyz4f...']\nValue: true\nTTL:   30 days\n</code></pre></p> <p>Rate Limit Index (for cleanup): <pre><code>Key:   ['rate_limit_users', 'user:192.168.1.1']\nValue: ['2025-11-04', '2025-11-03']\n</code></pre></p>"},{"location":"chatbot/architecture/#code-organization","title":"Code Organization","text":"<pre><code>src/\n\u251c\u2500\u2500 main.ts                          # Server entry point\n\u2502   \u251c\u2500 Initialize Hono server\n\u2502   \u251c\u2500 Register middleware\n\u2502   \u251c\u2500 Register routes\n\u2502   \u2514\u2500 Start listening\n\u2502\n\u251c\u2500\u2500 handlers/                        # HTTP request handlers\n\u2502   \u251c\u2500 chat.ts                       # Chat endpoint\n\u2502   \u2502  \u251c\u2500 Validate message\n\u2502   \u2502  \u251c\u2500 Call services\n\u2502   \u2502  \u2514\u2500 Return response\n\u2502   \u2502\n\u2502   \u2514\u2500 payment.ts                    # Payment endpoint\n\u2502      \u251c\u2500 Validate signature/amount\n\u2502      \u251c\u2500 Call Solana service\n\u2502      \u251c\u2500 Grant queries\n\u2502      \u2514\u2500 Return confirmation\n\u2502\n\u251c\u2500\u2500 middleware/                      # Request middleware\n\u2502   \u2514\u2500 rateLimit.ts                  # Rate limiting\n\u2502      \u251c\u2500 getUserId()\n\u2502      \u251c\u2500 checkLimit()\n\u2502      \u251c\u2500 incrementUsage()\n\u2502      \u2514\u2500 grantQueries()\n\u2502\n\u251c\u2500\u2500 services/                        # External integrations\n\u2502   \u251c\u2500 openai.ts                     # GPT integration\n\u2502   \u251c\u2500 pinecone.ts                   # Vector DB\n\u2502   \u251c\u2500 solana.ts                     # Blockchain verification\n\u2502   \u2514\u2500 logger.ts                     # Logging\n\u2502\n\u2514\u2500\u2500 utils/                           # Utilities\n    \u251c\u2500 config.ts                     # Configuration loading\n    \u251c\u2500 logger.ts                     # Logging setup\n    \u2514\u2500 types.ts                      # TypeScript types\n</code></pre>"},{"location":"chatbot/architecture/#technology-choices","title":"Technology Choices","text":""},{"location":"chatbot/architecture/#deno-runtime","title":"Deno Runtime","text":"<p>Why Deno? - \u2705 Built-in TypeScript support (no build step) - \u2705 Secure by default (explicit permissions) - \u2705 Modern JavaScript features - \u2705 Better developer experience - \u2705 Easy to deploy (single binary)</p> <p>Drawbacks - \u26a0\ufe0f Smaller ecosystem than Node.js - \u26a0\ufe0f Less third-party library support</p>"},{"location":"chatbot/architecture/#hono-framework","title":"Hono Framework","text":"<p>Why Hono? - \u2705 Lightweight (optimized for edge computing) - \u2705 Works with Deno - \u2705 TypeScript first - \u2705 Minimal boilerplate - \u2705 Built-in middleware support</p> <p>Alternative: Express (Node.js)</p>"},{"location":"chatbot/architecture/#pinecone-for-vectors","title":"Pinecone for Vectors","text":"<p>Why Pinecone? - \u2705 Managed vector database (no ops) - \u2705 Semantic search built-in - \u2705 Scales automatically - \u2705 Free tier available</p> <p>Alternatives: - Weaviate (open source) - Milvus (open source) - Qdrant (open source)</p>"},{"location":"chatbot/architecture/#openai-for-generation","title":"OpenAI for Generation","text":"<p>Why OpenAI? - \u2705 GPT-5 nano is very cheap - \u2705 High quality responses - \u2705 Easy API - \u2705 Well documented</p> <p>Alternatives: - Claude (Anthropic) - Llama 2 (Meta, open source) - Mistral (open source)</p>"},{"location":"chatbot/architecture/#solana-for-payments","title":"Solana for Payments","text":"<p>Why Solana? - \u2705 Low transaction fees (~$0.00025) - \u2705 Fast confirmation (1-2 seconds) - \u2705 USDC widely available - \u2705 Developer friendly</p> <p>Alternatives: - Ethereum (expensive gas fees) - Polygon (cheaper alternative) - Lightning Network (Bitcoin)</p>"},{"location":"chatbot/architecture/#deno-kv-for-storage","title":"Deno KV for Storage","text":"<p>Why Deno KV? - \u2705 Distributed key-value store - \u2705 Built into Deno Deploy - \u2705 Atomic operations - \u2705 TTL support - \u2705 No external service to manage</p> <p>Alternatives: - Redis (requires separate deployment) - PostgreSQL (more overhead) - MongoDB (overkill for this use case)</p>"},{"location":"chatbot/architecture/#performance-considerations","title":"Performance Considerations","text":""},{"location":"chatbot/architecture/#query-response-time-target-2-seconds","title":"Query Response Time Target: &lt; 2 seconds","text":"<p>Breakdown: 1. Pinecone search: ~500ms (network + embedding) 2. OpenAI generation: ~1000ms (API call) 3. Other overhead: ~200ms (parsing, formatting) 4. Total: ~1.7 seconds</p>"},{"location":"chatbot/architecture/#optimization-strategies","title":"Optimization Strategies","text":"<ol> <li> <p>Parallel requests:    <pre><code>// Bad: Sequential\nconst embedding = await openai.embed(message);\nconst docs = await pinecone.search(embedding);\n\n// Good: Parallel\nconst response = await openai.generate(message, docs);\n</code></pre></p> </li> <li> <p>Caching:</p> </li> <li>Cache common questions</li> <li>Cache document embeddings</li> <li> <p>Cache OpenAI responses</p> </li> <li> <p>Batching:</p> </li> <li>Batch payment verification</li> <li>Batch rate limit checks</li> </ol>"},{"location":"chatbot/architecture/#cost-optimization","title":"Cost Optimization","text":"<p>Current costs per query: - OpenAI: ~$0.000133 (GPT-5 nano @ $0.15/1M tokens) - Pinecone: ~$0 (free tier) - Solana: ~$0 (negligible) - Total: ~$0.000133</p> <p>Revenue per query: $0.001 Profit margin: ~87%</p> <p>Cost reduction opportunities: 1. Cache common responses (reduce OpenAI calls) 2. Use cron job for batch processing 3. Migrate to open source models (Llama 2) 4. Implement query deduplication</p>"},{"location":"chatbot/architecture/#security-architecture","title":"Security Architecture","text":""},{"location":"chatbot/architecture/#input-validation","title":"Input Validation","text":"<pre><code>// Message validation\nif (!message || message.trim().length === 0) {\n  throw new Error('Message cannot be empty');\n}\n\n// Amount validation\nif (amount &lt; 0.01 || amount &gt; 1.0) {\n  throw new Error('Invalid amount');\n}\n\n// Signature validation\nif (!isValidSolanaSignature(signature)) {\n  throw new Error('Invalid signature format');\n}\n</code></pre>"},{"location":"chatbot/architecture/#authentication","title":"Authentication","text":"<p>The chatbot uses IP-based identification (not authentication): - Each request gets a user ID based on IP - Rate limits are tracked per IP - Suitable for public documentation</p> <p>Not suitable for: - User accounts - Sensitive data - Enterprise use</p>"},{"location":"chatbot/architecture/#authorization","title":"Authorization","text":"<p>All endpoints are public (no authorization required): - Anyone can chat - Anyone can pay - No authentication credentials needed</p> <p>Future enhancement: Add API keys for enterprise deployments</p>"},{"location":"chatbot/architecture/#data-privacy","title":"Data Privacy","text":"<p>What we store: - \u2705 Rate limit counts (KV, auto-expiring) - \u2705 Used transaction signatures (KV, 30-day TTL) - \u274c Not storing chat history (ephemeral) - \u274c Not storing personal data</p> <p>What third parties see: - OpenAI: Chat messages (covered by their privacy policy) - Pinecone: Chat messages (covered by their privacy policy) - Solana: Only public transaction data</p>"},{"location":"chatbot/architecture/#scalability-architecture","title":"Scalability Architecture","text":""},{"location":"chatbot/architecture/#horizontal-scaling","title":"Horizontal Scaling","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Load Balancer         \u2502\n\u2502   (Nginx/HAProxy)       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n           \u2502\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2193      \u2193      \u2193       \u2193\n  [Pod1] [Pod2] [Pod3] [Pod4]\n    \u2502      \u2502      \u2502       \u2502\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n           \u2502\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2193             \u2193\n[Pinecone]  [Deno KV]\n           (shared storage)\n</code></pre>"},{"location":"chatbot/architecture/#vertical-scaling","title":"Vertical Scaling","text":"<ul> <li>Increase memory: 512MB \u2192 2GB</li> <li>Increase CPU: 1 core \u2192 4 cores</li> <li>Cache more aggressively</li> <li>Use CDN for static assets</li> </ul>"},{"location":"chatbot/architecture/#rate-limiting-strategy","title":"Rate Limiting Strategy","text":"<ol> <li>Per-IP: 3 free queries/day</li> <li>Per-endpoint: 100 req/s (DDoS protection)</li> <li>Per-user-paid: 1000 queries/day</li> </ol>"},{"location":"chatbot/architecture/#monitoring-and-observability","title":"Monitoring and Observability","text":""},{"location":"chatbot/architecture/#key-metrics","title":"Key Metrics","text":"<pre><code>Request Latency\n\u251c\u2500 P50: &lt; 1s\n\u251c\u2500 P95: &lt; 2s\n\u2514\u2500 P99: &lt; 5s\n\nError Rate\n\u251c\u2500 &lt; 1% API errors\n\u251c\u2500 &lt; 0.1% payment failures\n\u2514\u2500 &lt; 0.01% data loss\n\nCost\n\u251c\u2500 OpenAI: ${cost per day}\n\u251c\u2500 Pinecone: ${cost per day}\n\u2514\u2500 Solana: ${cost per day}\n</code></pre>"},{"location":"chatbot/architecture/#logging","title":"Logging","text":"<pre><code>logger.info('Chat request', { userId, messageLength, ipAddress });\nlogger.warn('Rate limit exceeded', { userId, queries });\nlogger.error('Payment verification failed', { signature, error });\n</code></pre>"},{"location":"chatbot/architecture/#alerting","title":"Alerting","text":"<pre><code>IF error_rate &gt; 5% THEN alert(\"High error rate\")\nIF avg_latency &gt; 3s THEN alert(\"Slow response times\")\nIF openai_cost &gt; $100/day THEN alert(\"High OpenAI costs\")\n</code></pre>"},{"location":"chatbot/architecture/#testing-strategy","title":"Testing Strategy","text":""},{"location":"chatbot/architecture/#unit-tests","title":"Unit Tests","text":"<ul> <li>Service methods</li> <li>Rate limiter logic</li> <li>Payment verification</li> </ul>"},{"location":"chatbot/architecture/#integration-tests","title":"Integration Tests","text":"<ul> <li>Chat endpoint</li> <li>Payment endpoint</li> <li>Rate limiting</li> </ul>"},{"location":"chatbot/architecture/#e2e-tests","title":"E2E Tests","text":"<ul> <li>Full chat flow</li> <li>Full payment flow</li> <li>Rate limit reset</li> </ul>"},{"location":"chatbot/architecture/#load-testing","title":"Load Testing","text":"<ul> <li>100 concurrent users</li> <li>1000 msg/sec throughput</li> <li>Validate cost per user</li> </ul>"},{"location":"chatbot/architecture/#disaster-recovery","title":"Disaster Recovery","text":""},{"location":"chatbot/architecture/#backup-strategy","title":"Backup Strategy","text":"<ul> <li>Daily Deno KV snapshots</li> <li>Version control for code</li> <li>Environment variable backups (encrypted)</li> </ul>"},{"location":"chatbot/architecture/#failover-plan","title":"Failover Plan","text":"<ul> <li>Spin up new instance</li> <li>Restore KV data</li> <li>Verify blockchain payments still work</li> <li>Re-check Pinecone access</li> </ul>"},{"location":"chatbot/architecture/#rtorpo","title":"RTO/RPO","text":"<ul> <li>RTO (Recovery Time Objective): 1 hour</li> <li>RPO (Recovery Point Objective): 24 hours</li> </ul>"},{"location":"chatbot/architecture/#future-enhancements","title":"Future Enhancements","text":"<ol> <li>Multi-LLM Support: Swap between Claude, Llama, GPT</li> <li>Subscription Plans: Monthly recurring payments</li> <li>User Accounts: Per-user rate limiting instead of IP</li> <li>Analytics: Track usage patterns</li> <li>A/B Testing: Test different prompts</li> <li>Feedback Loop: Learn from user interactions</li> <li>Multi-language: Support non-English queries</li> <li>Voice Chat: Accept voice input</li> <li>Export History: Allow users to export conversations</li> <li>Custom Models: Fine-tune on documentation</li> </ol>"},{"location":"chatbot/architecture/#references","title":"References","text":"<ul> <li>Deno Documentation</li> <li>Hono Framework</li> <li>Pinecone API</li> <li>OpenAI API</li> <li>Solana Docs</li> <li>RAG Pattern</li> </ul>"},{"location":"chatbot/configuration/","title":"Chatbot Configuration","text":"<p>The chatbot backend is configured via environment variables in the <code>.env</code> file located in the <code>chatbot/</code> directory.</p>"},{"location":"chatbot/configuration/#environment-variables","title":"Environment Variables","text":""},{"location":"chatbot/configuration/#openai-configuration","title":"OpenAI Configuration","text":"<pre><code>OPENAI_API_KEY=sk-proj-xxx...\n</code></pre> <p>Your OpenAI API key for accessing GPT models. Get one from OpenAI Platform.</p> <p>Required: Yes</p>"},{"location":"chatbot/configuration/#pinecone-configuration","title":"Pinecone Configuration","text":"<pre><code>PINECONE_API_KEY=pcsk_xxx...\nPINECONE_INDEX_NAME=openlibx402-docs\n</code></pre> <p>PINECONE_API_KEY: Your Pinecone API key from Pinecone Console</p> <p>PINECONE_INDEX_NAME: The name of your Pinecone index containing document embeddings. Default: <code>openlibx402-docs</code></p> <p>Required: Yes</p>"},{"location":"chatbot/configuration/#solana-payment-configuration","title":"Solana Payment Configuration","text":"<pre><code>X402_WALLET_ADDRESS=HMYDGuLTCL6r5pGL8yUbj27i4pyafpomfhZLq3psxm7L\nX402_WALLET_SECRET_KEY=[137,174,28,79,...]\nSOLANA_NETWORK=devnet\nUSDC_MINT_ADDRESS=4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU\nX402_PAYMENT_AMOUNT=0.01\nX402_PAYMENT_TOKEN=USDC\n</code></pre> Variable Description Default <code>X402_WALLET_ADDRESS</code> Solana wallet address to receive payments Required <code>X402_WALLET_SECRET_KEY</code> Secret key (as JSON array) for signing transactions Required <code>SOLANA_NETWORK</code> Network: <code>devnet</code> or <code>mainnet-beta</code> <code>devnet</code> <code>USDC_MINT_ADDRESS</code> USDC token mint address <code>4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU</code> (devnet) <code>X402_PAYMENT_AMOUNT</code> Default payment amount (deprecated, frontend uses slider) <code>0.01</code> <code>X402_PAYMENT_TOKEN</code> Token symbol for payments <code>USDC</code> <p>Notes: - Secret key must be in JSON array format: <code>[byte1,byte2,...]</code> - For production, use mainnet USDC: <code>EPjFWaYCh7QFMZWWB2BHXZPE6q8bZvWfNvwsKqVDTLST</code> - Never commit secret keys to version control</p>"},{"location":"chatbot/configuration/#rate-limiting-configuration","title":"Rate Limiting Configuration","text":"<pre><code>RATE_LIMIT_FREE_QUERIES=3\n</code></pre> <p>Number of free queries allowed per user per day. Default: <code>3</code></p>"},{"location":"chatbot/configuration/#server-configuration","title":"Server Configuration","text":"<pre><code>PORT=3000\nALLOWED_ORIGINS=http://localhost:8000,http://localhost:3000,https://openlibx402.github.io\n</code></pre> Variable Description Default <code>PORT</code> Server port <code>3000</code> <code>ALLOWED_ORIGINS</code> Comma-separated CORS origins <code>http://localhost:8000,http://localhost:3000</code>"},{"location":"chatbot/configuration/#environment-files","title":"Environment Files","text":""},{"location":"chatbot/configuration/#development-env","title":"Development (.env)","text":"<p>Local development configuration. Never commit this to version control.</p> <pre><code>OPENAI_API_KEY=sk-proj-test-key...\nPINECONE_API_KEY=pcsk-test-key...\nPINECONE_INDEX_NAME=openlibx402-docs\nX402_WALLET_ADDRESS=your-devnet-wallet\nX402_WALLET_SECRET_KEY=[...]\nSOLANA_NETWORK=devnet\nUSDC_MINT_ADDRESS=4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU\nRATE_LIMIT_FREE_QUERIES=3\nPORT=3000\nALLOWED_ORIGINS=http://localhost:8000,http://localhost:3000\n</code></pre>"},{"location":"chatbot/configuration/#production-envproduction","title":"Production (.env.production)","text":"<p>Production configuration with mainnet settings.</p> <pre><code>OPENAI_API_KEY=sk-proj-production-key...\nPINECONE_API_KEY=pcsk-production-key...\nPINECONE_INDEX_NAME=openlibx402-docs-prod\nX402_WALLET_ADDRESS=your-mainnet-wallet\nX402_WALLET_SECRET_KEY=[...]\nSOLANA_NETWORK=mainnet-beta\nUSDC_MINT_ADDRESS=EPjFWaYCh7QFMZWWB2BHXZPE6q8bZvWfNvwsKqVDTLST\nRATE_LIMIT_FREE_QUERIES=5\nPORT=3000\nALLOWED_ORIGINS=https://openlibx402.github.io,https://docs.openlibx402.com\n</code></pre>"},{"location":"chatbot/configuration/#runtime-configuration","title":"Runtime Configuration","text":"<p>The chatbot loads configuration via the <code>Config</code> interface in <code>src/utils/config.ts</code>:</p> <pre><code>export interface Config {\n  openai: {\n    apiKey: string;\n  };\n  pinecone: {\n    apiKey: string;\n    indexName: string;\n  };\n  rateLimit: {\n    freeQueries: number;\n  };\n  server: {\n    port: number;\n  };\n  cors: {\n    allowedOrigins: string[];\n  };\n}\n</code></pre>"},{"location":"chatbot/configuration/#payment-pricing","title":"Payment Pricing","text":"<p>The pricing is hardcoded in the payment handler for all deployments:</p> <ul> <li>Minimum: 0.01 USDC = 10 queries</li> <li>Maximum: 1.00 USDC = 1000 queries</li> <li>Rate: 1000 queries per USDC</li> </ul> <p>To change pricing, modify <code>src/handlers/payment.ts</code> line 100:</p> <pre><code>const queriesGranted = Math.floor(paymentAmount * 1000); // Change multiplier here\n</code></pre>"},{"location":"chatbot/configuration/#solana-network-setup","title":"Solana Network Setup","text":""},{"location":"chatbot/configuration/#devnet-development","title":"Devnet (Development)","text":"<p>For local development on Solana devnet:</p> <ol> <li>Get devnet USDC tokens: https://spl-token-faucet.com/</li> <li>Use devnet wallet address</li> <li>Set <code>SOLANA_NETWORK=devnet</code></li> </ol>"},{"location":"chatbot/configuration/#mainnet-production","title":"Mainnet (Production)","text":"<p>For production on Solana mainnet:</p> <ol> <li>Create mainnet wallet with SOL for transaction fees</li> <li>Ensure wallet has USDC tokens for testing</li> <li>Use mainnet USDC mint: <code>EPjFWaYCh7QFMZWWB2BHXZPE6q8bZvWfNvwsKqVDTLST</code></li> <li>Set <code>SOLANA_NETWORK=mainnet-beta</code></li> </ol>"},{"location":"chatbot/configuration/#frontend-configuration","title":"Frontend Configuration","text":"<p>The frontend chatbot is configured via the HTML script tag:</p> <pre><code>&lt;script&gt;\n  // Optional: Override API URL (defaults to current origin)\n  window.CHATBOT_API_URL = 'http://localhost:3000';\n\n  // Load chatbot widget\n  window.CHATBOT_DISABLED = false; // Set to true to disable chatbot\n&lt;/script&gt;\n&lt;script src=\"/assets/javascripts/chatbot.js\"&gt;&lt;/script&gt;\n</code></pre>"},{"location":"chatbot/configuration/#verifying-configuration","title":"Verifying Configuration","text":"<p>Start the server and check the logs:</p> <pre><code>cd chatbot\ndeno run --allow-net --allow-env --allow-read --allow-ffi main.ts\n</code></pre> <p>You should see: <pre><code>[INFO] [RAGBOT] Starting OpenLibx402 RAG Chatbot server...\n[INFO] [RAGBOT] OpenAI API configured\n[INFO] [RAGBOT] Pinecone index connected: openlibx402-docs\n[INFO] [RAGBOT] Rate limiter initialized with Deno KV\n[INFO] [RAGBOT] CORS enabled for origins: http://localhost:8000, http://localhost:3000\n[INFO] [RAGBOT] Server listening on http://localhost:3000\n</code></pre></p>"},{"location":"chatbot/configuration/#troubleshooting","title":"Troubleshooting","text":""},{"location":"chatbot/configuration/#api-key-errors","title":"API Key Errors","text":"<pre><code>[ERROR] OpenAI API key not configured\n</code></pre> <p>Solution: Ensure <code>OPENAI_API_KEY</code> is set in <code>.env</code> file.</p>"},{"location":"chatbot/configuration/#pinecone-connection-errors","title":"Pinecone Connection Errors","text":"<pre><code>[ERROR] Failed to connect to Pinecone\n</code></pre> <p>Solution: - Verify <code>PINECONE_API_KEY</code> is correct - Check <code>PINECONE_INDEX_NAME</code> exists in Pinecone console - Ensure network connectivity to Pinecone</p>"},{"location":"chatbot/configuration/#cors-errors","title":"CORS Errors","text":"<pre><code>Access to XMLHttpRequest blocked by CORS policy\n</code></pre> <p>Solution: Add your origin to <code>ALLOWED_ORIGINS</code> in <code>.env</code>:</p> <pre><code>ALLOWED_ORIGINS=http://localhost:8000,http://localhost:3000,https://your-domain.com\n</code></pre>"},{"location":"chatbot/configuration/#solana-network-errors","title":"Solana Network Errors","text":"<pre><code>RpcError: failed to send transaction\n</code></pre> <p>Solution: - Verify wallet address is valid - Check wallet has SOL for transaction fees - Ensure network matches (devnet vs mainnet) - Verify recipient wallet exists on the network</p>"},{"location":"chatbot/configuration/#security-best-practices","title":"Security Best Practices","text":"<ol> <li>Never commit <code>.env</code> files to version control</li> <li>Use environment variables for all secrets</li> <li>Rotate API keys regularly</li> <li>Monitor spending on OpenAI and Pinecone</li> <li>Use HTTPS in production</li> <li>Validate all inputs on the backend</li> <li>Rate limit payment endpoints to prevent abuse</li> </ol>"},{"location":"chatbot/deployment/","title":"Deployment Guide","text":"<p>Complete guide for deploying the OpenLibx402 RAG Chatbot to production.</p>"},{"location":"chatbot/deployment/#prerequisites","title":"Prerequisites","text":"<ul> <li>Deno 1.x+ installed</li> <li>OpenAI API key</li> <li>Pinecone account and index</li> <li>Solana devnet or mainnet wallet</li> <li>USDC tokens (for testing on devnet)</li> <li>A web server running mkdocs documentation</li> </ul>"},{"location":"chatbot/deployment/#deployment-architecture","title":"Deployment Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   Client Browser                    \u2502\n\u2502                 (MkDocs Docs Site)                  \u2502\n\u2502                                                     \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  Chatbot Widget (JavaScript)                \u2502   \u2502\n\u2502  \u2502  - Chat UI                                  \u2502   \u2502\n\u2502  \u2502  - Rate limit display                       \u2502   \u2502\n\u2502  \u2502  - Payment modal                            \u2502   \u2502\n\u2502  \u2502  - Phantom wallet integration               \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n           \u2193 (REST API calls)\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502          Chatbot Backend (Deno Server)              \u2502\n\u2502          http://localhost:3000                      \u2502\n\u2502                                                     \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  Routes                                    \u2502   \u2502\n\u2502  \u2502  - POST /api/chat                          \u2502   \u2502\n\u2502  \u2502  - GET /api/status                         \u2502   \u2502\n\u2502  \u2502  - GET /api/payment/info                   \u2502   \u2502\n\u2502  \u2502  - POST /api/payment                       \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                     \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  Services                                  \u2502   \u2502\n\u2502  \u2502  - OpenAI (GPT-5 nano)                     \u2502   \u2502\n\u2502  \u2502  - Pinecone (Vector DB)                    \u2502   \u2502\n\u2502  \u2502  - Solana (Payment verification)           \u2502   \u2502\n\u2502  \u2502  - Deno KV (Rate limiting &amp; transactions)  \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n     \u2193 (API calls)        \u2193 (Vector queries)    \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  OpenAI API  \u2502    \u2502  Pinecone API   \u2502    \u2502  Solana  \u2502\n\u2502              \u2502    \u2502                 \u2502    \u2502  RPC     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"chatbot/deployment/#step-by-step-deployment","title":"Step-by-Step Deployment","text":""},{"location":"chatbot/deployment/#phase-1-development-setup","title":"Phase 1: Development Setup","text":""},{"location":"chatbot/deployment/#11-clone-and-install","title":"1.1 Clone and Install","text":"<pre><code>git clone https://github.com/your-org/openlibx402.git\ncd openlibx402/chatbot\ndeno cache --reload src/main.ts\n</code></pre>"},{"location":"chatbot/deployment/#12-configure-environment","title":"1.2 Configure Environment","text":"<p>Create <code>.env</code> file in <code>chatbot/</code> directory:</p> <pre><code>OPENAI_API_KEY=sk-proj-your-key-here\nPINECONE_API_KEY=pcsk_your-key-here\nPINECONE_INDEX_NAME=openlibx402-docs\nX402_WALLET_ADDRESS=your-devnet-wallet\nX402_WALLET_SECRET_KEY=[your,secret,key,bytes]\nSOLANA_NETWORK=devnet\nUSDC_MINT_ADDRESS=4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU\nRATE_LIMIT_FREE_QUERIES=3\nPORT=3000\nALLOWED_ORIGINS=http://localhost:8000,http://localhost:3000\n</code></pre>"},{"location":"chatbot/deployment/#13-test-locally","title":"1.3 Test Locally","text":"<pre><code>deno run --allow-net --allow-env --allow-read --allow-ffi main.ts\n</code></pre> <p>Expected output: <pre><code>[INFO] [RAGBOT] Starting OpenLibx402 RAG Chatbot server...\n[INFO] [RAGBOT] OpenAI API configured\n[INFO] [RAGBOT] Pinecone index connected: openlibx402-docs\n[INFO] [RAGBOT] Rate limiter initialized with Deno KV\n[INFO] [RAGBOT] CORS enabled for origins: http://localhost:8000, http://localhost:3000\n[INFO] [RAGBOT] Server listening on http://localhost:3000\n</code></pre></p>"},{"location":"chatbot/deployment/#phase-2-testing","title":"Phase 2: Testing","text":""},{"location":"chatbot/deployment/#21-test-chat-endpoint","title":"2.1 Test Chat Endpoint","text":"<pre><code>curl -X POST http://localhost:3000/api/chat \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"message\":\"What is OpenLibx402?\"}'\n</code></pre>"},{"location":"chatbot/deployment/#22-test-status-endpoint","title":"2.2 Test Status Endpoint","text":"<pre><code>curl http://localhost:3000/api/status\n</code></pre>"},{"location":"chatbot/deployment/#23-manual-payment-testing","title":"2.3 Manual Payment Testing","text":"<ol> <li>Get devnet tokens: https://spl-token-faucet.com/</li> <li>Open browser devtools</li> <li>Open chatbot widget</li> <li>Use 3 free queries</li> <li>Click \"Pay with Solana\"</li> <li>Complete payment flow</li> <li>Verify queries are granted</li> </ol>"},{"location":"chatbot/deployment/#phase-3-production-preparation","title":"Phase 3: Production Preparation","text":""},{"location":"chatbot/deployment/#31-update-configuration","title":"3.1 Update Configuration","text":"<p>Create <code>chatbot/.env.production</code>:</p> <pre><code>OPENAI_API_KEY=sk-proj-your-production-key\nPINECONE_API_KEY=pcsk_your-production-key\nPINECONE_INDEX_NAME=openlibx402-docs-prod\nX402_WALLET_ADDRESS=your-mainnet-wallet\nX402_WALLET_SECRET_KEY=[your,production,secret,key]\nSOLANA_NETWORK=mainnet-beta\nUSDC_MINT_ADDRESS=EPjFWaYCh7QFMZWWB2BHXZPE6q8bZvWfNvwsKqVDTLST\nRATE_LIMIT_FREE_QUERIES=5\nPORT=3000\nALLOWED_ORIGINS=https://docs.openlibx402.com,https://openlibx402.github.io\n</code></pre>"},{"location":"chatbot/deployment/#32-update-frontend-configuration","title":"3.2 Update Frontend Configuration","text":"<p>Update <code>docs/overrides/main.html</code>:</p> <pre><code>&lt;script&gt;\n  window.CHATBOT_API_URL = 'https://api.chatbot.openlibx402.com';\n&lt;/script&gt;\n&lt;script src=\"/assets/javascripts/chatbot.js\"&gt;&lt;/script&gt;\n</code></pre>"},{"location":"chatbot/deployment/#33-build-mkdocs","title":"3.3 Build MkDocs","text":"<pre><code>cd docs\nmkdocs build -c\n</code></pre>"},{"location":"chatbot/deployment/#phase-4-deployment-options","title":"Phase 4: Deployment Options","text":""},{"location":"chatbot/deployment/#option-a-docker-container","title":"Option A: Docker Container","text":"<p>Create <code>chatbot/Dockerfile</code>:</p> <pre><code>FROM denoland/deno:latest\n\nWORKDIR /app\nCOPY . .\n\nRUN deno cache src/main.ts\n\nCMD [\"deno\", \"run\", \"--allow-net\", \"--allow-env\", \"--allow-read\", \"--allow-ffi\", \"src/main.ts\"]\n</code></pre> <p>Build and deploy:</p> <pre><code>docker build -t openlibx402-chatbot .\ndocker run -p 3000:3000 --env-file .env.production openlibx402-chatbot\n</code></pre>"},{"location":"chatbot/deployment/#option-b-deno-deploy-cloud","title":"Option B: Deno Deploy (Cloud)","text":"<ol> <li>Create account at https://deno.com/deploy</li> <li>Connect GitHub repository</li> <li>Create new project</li> <li>Set environment variables in project settings</li> <li>Deploy main branch</li> </ol> <p><code>.deployrc.json</code>: <pre><code>{\n  \"include\": [\"src/\"],\n  \"exclude\": [],\n  \"entrypoint\": \"src/main.ts\"\n}\n</code></pre></p>"},{"location":"chatbot/deployment/#option-c-traditional-vps","title":"Option C: Traditional VPS","text":"<ol> <li>Set up VPS (Ubuntu 22.04+)</li> <li>Install Deno: <code>curl -fsSL https://deno.land/x/install/install.sh | sh</code></li> <li>Create systemd service</li> <li>Set up reverse proxy (Nginx)</li> <li>Configure SSL/TLS</li> </ol> <p>System Service (<code>/etc/systemd/system/chatbot.service</code>):</p> <pre><code>[Unit]\nDescription=OpenLibx402 RAG Chatbot\nAfter=network.target\n\n[Service]\nType=simple\nUser=chatbot\nWorkingDirectory=/opt/chatbot\nEnvironmentFile=/opt/chatbot/.env.production\nExecStart=/home/user/.deno/bin/deno run --allow-net --allow-env --allow-read --allow-ffi src/main.ts\nRestart=on-failure\nRestartSec=10\n\n[Install]\nWantedBy=multi-user.target\n</code></pre> <p>Nginx Reverse Proxy:</p> <pre><code>upstream chatbot {\n    server localhost:3000;\n}\n\nserver {\n    listen 443 ssl http2;\n    server_name api.chatbot.openlibx402.com;\n\n    ssl_certificate /etc/letsencrypt/live/chatbot.openlibx402.com/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/chatbot.openlibx402.com/privkey.pem;\n\n    location / {\n        proxy_pass http://chatbot;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_http_version 1.1;\n        proxy_set_header Connection \"upgrade\";\n        proxy_read_timeout 86400;\n    }\n}\n</code></pre>"},{"location":"chatbot/deployment/#phase-5-integration-with-mkdocs","title":"Phase 5: Integration with MkDocs","text":""},{"location":"chatbot/deployment/#51-update-mkdocs-config","title":"5.1 Update MkDocs Config","text":"<p><code>docs/mkdocs.yml</code>:</p> <pre><code>site_name: OpenLibx402 Documentation\ntheme:\n  name: material\n\nnav:\n  - Home: index.md\n  - Getting Started: getting-started.md\n  - API Reference: api.md\n\nplugins:\n  - search\n  - offline\n\nextra:\n  chatbot:\n    enabled: true\n    api_url: https://api.chatbot.openlibx402.com\n</code></pre>"},{"location":"chatbot/deployment/#52-update-html-template","title":"5.2 Update HTML Template","text":"<p><code>docs/overrides/main.html</code>:</p> <pre><code>{% extends \"base.html\" %}\n\n{% block scripts %}\n  {{ super() }}\n  &lt;script&gt;\n    window.CHATBOT_API_URL = '{{ config.extra.chatbot.api_url }}';\n    window.CHATBOT_DISABLED = !{{ config.extra.chatbot.enabled|lower }};\n  &lt;/script&gt;\n  &lt;script src=\"{{ 'assets/javascripts/chatbot.js'|url }}\"&gt;&lt;/script&gt;\n{% endblock %}\n</code></pre>"},{"location":"chatbot/deployment/#53-deploy-documentation","title":"5.3 Deploy Documentation","text":"<pre><code>cd docs\nmkdocs gh-deploy  # For GitHub Pages\n# OR\nmkdocs build &amp;&amp; aws s3 sync site/ s3://your-bucket/docs/\n</code></pre>"},{"location":"chatbot/deployment/#phase-6-monitoring-and-maintenance","title":"Phase 6: Monitoring and Maintenance","text":""},{"location":"chatbot/deployment/#61-health-checks","title":"6.1 Health Checks","text":"<p>Set up monitoring for <code>/api/status</code> endpoint:</p> <pre><code># Monitoring script\ncurl -f http://localhost:3000/api/status || echo \"Chatbot down\"\n</code></pre>"},{"location":"chatbot/deployment/#62-log-monitoring","title":"6.2 Log Monitoring","text":"<p>Monitor server logs:</p> <pre><code>journalctl -u chatbot -f\n# or\ntail -f /var/log/chatbot.log\n</code></pre>"},{"location":"chatbot/deployment/#63-cost-monitoring","title":"6.3 Cost Monitoring","text":"<p>Track spending on: - OpenAI API (view at https://platform.openai.com/account/billing/overview) - Pinecone (view at https://app.pinecone.io/organizations) - Solana RPC (if using paid tier)</p>"},{"location":"chatbot/deployment/#64-backup-strategy","title":"6.4 Backup Strategy","text":"<p>Back up critical data:</p> <pre><code># Backup Deno KV data\ndeno eval \"const kv = await Deno.openKv(); const iter = kv.list({}); for await (const entry of iter) { console.log(JSON.stringify(entry)); }\" &gt; kv-backup.jsonl\n\n# Backup environment\ncp .env.production .env.production.backup\n</code></pre>"},{"location":"chatbot/deployment/#production-checklist","title":"Production Checklist","text":"<ul> <li>[ ] Update all API keys to production values</li> <li>[ ] Set <code>SOLANA_NETWORK=mainnet-beta</code></li> <li>[ ] Use mainnet USDC mint address</li> <li>[ ] Configure production CORS origins</li> <li>[ ] Update frontend API URL</li> <li>[ ] Set up SSL/TLS certificates</li> <li>[ ] Configure reverse proxy (Nginx)</li> <li>[ ] Set up monitoring and alerting</li> <li>[ ] Test full payment flow end-to-end</li> <li>[ ] Load test with simulated users</li> <li>[ ] Plan for scaling (if needed)</li> <li>[ ] Document runbooks for operations</li> <li>[ ] Set up automated backups</li> </ul>"},{"location":"chatbot/deployment/#scaling-considerations","title":"Scaling Considerations","text":""},{"location":"chatbot/deployment/#horizontal-scaling","title":"Horizontal Scaling","text":"<p>For high traffic, run multiple chatbot instances:</p> <pre><code># Instance 1\nPORT=3001 deno run --allow-net --allow-env --allow-read --allow-ffi src/main.ts\n\n# Instance 2\nPORT=3002 deno run --allow-net --allow-env --allow-read --allow-ffi src/main.ts\n\n# Load balancer routes to both\n</code></pre> <p>Nginx Load Balancer:</p> <pre><code>upstream chatbot_backend {\n    server localhost:3001;\n    server localhost:3002;\n    server localhost:3003;\n}\n\nserver {\n    listen 443 ssl http2;\n    server_name api.chatbot.openlibx402.com;\n\n    location / {\n        proxy_pass http://chatbot_backend;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    }\n}\n</code></pre>"},{"location":"chatbot/deployment/#rate-limiting-at-proxy-level","title":"Rate Limiting at Proxy Level","text":"<pre><code>limit_req_zone $binary_remote_addr zone=chatbot:10m rate=10r/s;\n\nlocation /api/chat {\n    limit_req zone=chatbot burst=20 nodelay;\n    proxy_pass http://chatbot_backend;\n}\n</code></pre>"},{"location":"chatbot/deployment/#caching-strategy","title":"Caching Strategy","text":"<pre><code># Cache payment info endpoint\nlocation /api/payment/info {\n    proxy_pass http://chatbot_backend;\n    proxy_cache_valid 200 1h;\n    add_header X-Cache-Status $upstream_cache_status;\n}\n</code></pre>"},{"location":"chatbot/deployment/#troubleshooting","title":"Troubleshooting","text":""},{"location":"chatbot/deployment/#server-wont-start","title":"Server Won't Start","text":"<pre><code># Check Deno is installed\ndeno --version\n\n# Check port is available\nlsof -i :3000\n\n# Check environment variables\necho $OPENAI_API_KEY\n</code></pre>"},{"location":"chatbot/deployment/#api-errors-in-logs","title":"API Errors in Logs","text":"<pre><code># Check OpenAI API key\ncurl -H \"Authorization: Bearer $OPENAI_API_KEY\" https://api.openai.com/v1/models\n\n# Check Pinecone connection\ndeno eval \"const pc = await fetch('https://api.pinecone.io/v1/indexes'); console.log(await pc.json());\"\n</code></pre>"},{"location":"chatbot/deployment/#payment-verification-failures","title":"Payment Verification Failures","text":"<p>See Payment System Troubleshooting</p>"},{"location":"chatbot/deployment/#high-memory-usage","title":"High Memory Usage","text":"<pre><code># Monitor memory\nwatch -n 1 'ps aux | grep deno'\n\n# Reduce cache size or restart service\nsystemctl restart chatbot\n</code></pre>"},{"location":"chatbot/deployment/#rolling-updates","title":"Rolling Updates","text":"<p>Zero-downtime deployment:</p> <pre><code># 1. Build new version\ndeno cache --reload src/main.ts\n\n# 2. Start new instance on different port\nPORT=3001 deno run --allow-net --allow-env --allow-read --allow-ffi src/main.ts\n\n# 3. Health check new instance\ncurl http://localhost:3001/api/status\n\n# 4. Update load balancer to new instance\n# (modify nginx upstream)\nnginx -s reload\n\n# 5. Stop old instance\nkill $OLD_PID\n</code></pre>"},{"location":"chatbot/deployment/#security-hardening","title":"Security Hardening","text":""},{"location":"chatbot/deployment/#firewall-rules","title":"Firewall Rules","text":"<pre><code># Allow HTTPS only\nsudo ufw allow 443/tcp\nsudo ufw allow 80/tcp  # Redirect to HTTPS\nsudo ufw deny 3000     # Block direct access\n\n# SSH access\nsudo ufw allow 22/tcp from 1.2.3.4  # Your IP only\n</code></pre>"},{"location":"chatbot/deployment/#ddos-protection","title":"DDoS Protection","text":"<pre><code># Cloudflare or similar\n# - Rate limiting\n# - Bot detection\n# - WAF rules\n# - DDoS mitigation\n</code></pre>"},{"location":"chatbot/deployment/#secret-management","title":"Secret Management","text":"<pre><code># Use environment variable management\n# Never hardcode secrets\n# Rotate API keys regularly\n# Use different keys per environment\n</code></pre>"},{"location":"chatbot/deployment/#success-indicators","title":"Success Indicators","text":"<p>\u2705 Chatbot responding to queries in production \u2705 Rate limiting working correctly \u2705 Payments being processed and verified \u2705 Documentation loading without errors \u2705 API response time &lt; 2 seconds \u2705 99.9% uptime \u2705 Zero failed transactions</p>"},{"location":"chatbot/overview/","title":"OpenLibx402 RAG Chatbot","text":"<p>The OpenLibx402 RAG (Retrieval-Augmented Generation) Chatbot is an intelligent assistant that provides real-time answers to questions about OpenLibx402 documentation. It uses Pinecone vector database for document retrieval and OpenAI's GPT models for response generation.</p>"},{"location":"chatbot/overview/#key-features","title":"Key Features","text":"<ul> <li>Real-time Documentation Search: Retrieves relevant documentation snippets using semantic similarity</li> <li>Intelligent Responses: Uses OpenAI GPT models to generate contextual answers</li> <li>Rate Limiting: Protects API resources with configurable per-user daily limits</li> <li>Solana USDC Payments: Users can purchase additional queries with USDC tokens on Solana blockchain</li> <li>Conversation History: Maintains chat history using browser localStorage</li> <li>Responsive Design: Works seamlessly on desktop and mobile devices</li> </ul>"},{"location":"chatbot/overview/#architecture","title":"Architecture","text":""},{"location":"chatbot/overview/#backend-components","title":"Backend Components","text":"<ul> <li>Deno Server: High-performance server runtime with built-in TypeScript support</li> <li>Hono Framework: Lightweight web framework for handling HTTP requests</li> <li>Pinecone Vector DB: Stores and retrieves document embeddings</li> <li>Deno KV: Distributed key-value store for rate limiting and transaction tracking</li> <li>Solana Web3.js: Blockchain integration for payment verification</li> </ul>"},{"location":"chatbot/overview/#frontend-components","title":"Frontend Components","text":"<ul> <li>Vanilla JavaScript: No framework dependencies for lightweight embedding</li> <li>Phantom Wallet Integration: Secure Solana payment handling</li> <li>LocalStorage: Persists conversation history</li> <li>Range Slider UI: Interactive payment amount selector</li> </ul>"},{"location":"chatbot/overview/#technology-stack","title":"Technology Stack","text":"Component Technology Purpose Server Deno 1.x Runtime environment Framework Hono HTTP request handling API OpenAI Response generation Vector DB Pinecone Document retrieval Storage Deno KV Rate limit tracking Blockchain Solana Payment verification Wallet Phantom USDC transactions Frontend Vanilla JS Widget embedding"},{"location":"chatbot/overview/#deployment","title":"Deployment","text":"<p>The chatbot is embedded in the mkdocs documentation site as a floating widget. It communicates with a separate Deno backend server via REST API.</p>"},{"location":"chatbot/overview/#running-the-server","title":"Running the Server","text":"<pre><code>cd chatbot\ndeno run --allow-net --allow-env --allow-read --allow-ffi main.ts\n</code></pre> <p>The server will start on <code>http://localhost:3000</code> by default.</p>"},{"location":"chatbot/overview/#embedding-in-mkdocs","title":"Embedding in MkDocs","text":"<p>The chatbot widget is loaded via a script in the HTML template:</p> <pre><code>&lt;script&gt;\n  window.CHATBOT_API_URL = 'http://localhost:3000';\n&lt;/script&gt;\n&lt;script src=\"/assets/javascripts/chatbot.js\"&gt;&lt;/script&gt;\n</code></pre>"},{"location":"chatbot/overview/#user-flow","title":"User Flow","text":""},{"location":"chatbot/overview/#chat-interaction","title":"Chat Interaction","text":"<ol> <li>User clicks the chat bubble (\ud83d\udcac) in the bottom-right corner</li> <li>Chatbot displays welcome message with query limit info</li> <li>User types a question and presses Enter or clicks Send</li> <li>Backend retrieves relevant documents from Pinecone</li> <li>OpenAI generates a response with citations</li> <li>Response is displayed in the chat interface</li> </ol>"},{"location":"chatbot/overview/#payment-flow","title":"Payment Flow","text":"<ol> <li>User exhausts their daily free queries (default: 3)</li> <li>System displays payment modal with USDC amount selector</li> <li>User selects amount (0.01 to 1.00 USDC) using interactive slider</li> <li>User connects Phantom wallet and confirms transaction</li> <li>Frontend waits for blockchain confirmation (5-30 seconds)</li> <li>Backend verifies USDC token transfer</li> <li>Queries are granted and chat resumes</li> </ol>"},{"location":"chatbot/overview/#rate-limiting","title":"Rate Limiting","text":"<ul> <li>Free Tier: 3 queries per day per user (identified by IP address)</li> <li>Paid Credits:</li> <li>0.01 USDC = 10 queries</li> <li>1.00 USDC = 1000 queries</li> <li>Price: 1000 queries per USDC</li> <li>Reset: Daily at midnight UTC</li> </ul>"},{"location":"chatbot/overview/#configuration","title":"Configuration","text":"<p>See Configuration Guide for environment variables and settings.</p>"},{"location":"chatbot/overview/#security-considerations","title":"Security Considerations","text":"<ul> <li>HTTPS Only: Payment endpoints use HTTPS in production</li> <li>USDC Verification: All transactions verified on Solana blockchain</li> <li>Transaction Deduplication: Used transaction signatures stored for 30 days</li> <li>IP-Based Tracking: Rate limits tracked by user IP address</li> <li>CORS Protection: Configured allowed origins for API access</li> </ul>"},{"location":"chatbot/overview/#cost-analysis","title":"Cost Analysis","text":"<p>Operating Costs: - GPT-5 nano: ~$0.000133 per query - Pinecone vector retrieval: Minimal cost per query - Total: ~$0.000133 per query</p> <p>Revenue Model: - User pays: $0.001 per query (at 0.01 USDC = 10 queries) - Profit margin: ~87%</p>"},{"location":"chatbot/overview/#next-steps","title":"Next Steps","text":"<ul> <li>See API Reference for endpoint documentation</li> <li>See Payment System for USDC integration details</li> <li>See Deployment Guide for production setup</li> </ul>"},{"location":"chatbot/payments/","title":"Payment System (USDC on Solana)","text":"<p>The chatbot uses Solana blockchain and USDC tokens to handle payments for additional queries. This document explains how the payment system works and how to use it.</p>"},{"location":"chatbot/payments/#x402-integration","title":"X402 Integration","text":"<p>The payment system is built on the OpenLibx402 HTTP 402 Payment Protocol, which provides:</p> <ul> <li>\u2705 Standardized 402 Payment Required responses with structured payment details</li> <li>\u2705 X-Payment-Authorization header support for protocol compliance</li> <li>\u2705 Payment expiration and nonce validation for security</li> <li>\u2705 Standardized error classes for better error handling</li> <li>\u2705 Query credit system converting USDC payments into query credits</li> </ul> <p>See OpenLibx402 Integration for implementation details.</p>"},{"location":"chatbot/payments/#payment-flow","title":"Payment Flow","text":""},{"location":"chatbot/payments/#user-perspective","title":"User Perspective","text":"<ol> <li>Rate Limit Reached: User exhausts their 3 free daily queries</li> <li>Payment Modal: System displays payment interface with interactive slider</li> <li>Amount Selection: User selects amount between 0.01 and 1.00 USDC using slider</li> <li>Wallet Connection: User clicks \"Connect Phantom &amp; Pay X USDC\"</li> <li>Approval: Phantom wallet displays transaction for user to confirm</li> <li>Confirmation: User approves transaction in wallet</li> <li>Waiting: Frontend waits 5+ seconds for blockchain confirmation</li> <li>Verification: Backend verifies USDC transfer on blockchain</li> <li>Success: Queries are granted and chat resumes</li> </ol>"},{"location":"chatbot/payments/#technical-flow","title":"Technical Flow","text":"<pre><code>Frontend                    Backend                     Solana\n  |                            |                          |\n  |-- Payment Request -------&gt; |                          |\n  |                            |                          |\n  |&lt;-- Payment Info ---------- |                          |\n  |                            |                          |\n  |-- Sign &amp; Send TX --------&gt; Phantom Wallet            |\n  |                            |                          |\n  |&lt;-- Signature -------------- |                          |\n  |                            |                          |\n  |-- Verify Payment --------&gt; |-- Get Transaction -----&gt; |\n  |                            |&lt;-- TX Details ---------- |\n  |                            |                          |\n  |                            |-- Verify Balances -----&gt; |\n  |                            |&lt;-- Balance Changes ----- |\n  |                            |                          |\n  |&lt;-- Grant Queries --------- |-- Store Used TX         |\n  |                            |-- Grant Credits in KV   |\n  |                            |                          |\n  Chat Resumes\n</code></pre>"},{"location":"chatbot/payments/#pricing-model","title":"Pricing Model","text":""},{"location":"chatbot/payments/#query-pricing","title":"Query Pricing","text":"Amount Queries Cost per Query 0.01 USDC 10 $0.001 0.05 USDC 50 $0.001 0.10 USDC 100 $0.001 0.50 USDC 500 $0.001 1.00 USDC 1000 $0.001 <p>Formula: <code>queries = amount * 1000</code></p>"},{"location":"chatbot/payments/#transaction-verification","title":"Transaction Verification","text":""},{"location":"chatbot/payments/#usdc-token-transfer-verification","title":"USDC Token Transfer Verification","text":"<p>The backend verifies USDC transfers by:</p> <ol> <li>Fetching Transaction: Gets transaction details from Solana RPC</li> <li>Checking Status: Ensures transaction succeeded (no errors)</li> <li>Examining Balances: Checks <code>preTokenBalances</code> and <code>postTokenBalances</code></li> <li>Validating Amount: Confirms correct USDC amount received</li> <li>Validating Recipient: Ensures tokens sent to configured wallet address</li> <li>Deduplicating: Checks transaction hasn't been used before</li> </ol>"},{"location":"chatbot/payments/#verification-code","title":"Verification Code","text":"<p>See solana.ts for implementation details.</p> <p>Key validation points:</p> <pre><code>// 1. Transaction must exist and be confirmed\nif (!transaction) return false;\n\n// 2. Transaction must not have errors\nif (transaction.meta?.err) return false;\n\n// 3. Token account must belong to recipient\nif (postBalance.owner !== recipientAddress.toBase58()) return false;\n\n// 4. Amount must match (with 1% tolerance)\nif (recipientReceived &lt; minAmount) return false;\n</code></pre>"},{"location":"chatbot/payments/#blockchain-details","title":"Blockchain Details","text":""},{"location":"chatbot/payments/#solana-network","title":"Solana Network","text":"<ul> <li>Devnet: Development/testing network</li> <li>USDC Mint: <code>4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU</code></li> <li>RPC: <code>https://api.devnet.solana.com</code></li> <li> <p>Get test tokens: https://spl-token-faucet.com/</p> </li> <li> <p>Mainnet: Production network</p> </li> <li>USDC Mint: <code>EPjFWaYCh7QFMZWWB2BHXZPE6q8bZvWfNvwsKqVDTLST</code></li> <li>RPC: <code>https://api.mainnet-beta.solana.com</code></li> <li>Real USDC tokens required</li> </ul>"},{"location":"chatbot/payments/#spl-token-transfer","title":"SPL Token Transfer","text":"<p>The payment system uses the SPL Token Program's <code>TransferChecked</code> instruction:</p> <ul> <li>Program ID: <code>TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA</code></li> <li>Instruction Discriminator: <code>12</code></li> <li>Parameters:</li> <li>Source token account (user's USDC account)</li> <li>USDC mint address</li> <li>Destination token account (chatbot's USDC account)</li> <li>Token owner (user)</li> <li>Amount (in base units, with 6 decimals)</li> <li>Decimals (always 6 for USDC)</li> </ul>"},{"location":"chatbot/payments/#associated-token-accounts","title":"Associated Token Accounts","text":"<p>USDC tokens are stored in Associated Token Accounts (ATAs) derived from:</p> <pre><code>PDA = hash(wallet_address || token_program_id || token_mint_address)\n</code></pre> <p>The system automatically derives the correct token account addresses for both sender and recipient.</p>"},{"location":"chatbot/payments/#payment-handler-api","title":"Payment Handler API","text":""},{"location":"chatbot/payments/#request","title":"Request","text":"<p>Endpoint: <code>POST /api/payment</code></p> <p>Headers: <pre><code>Content-Type: application/json\n</code></pre></p> <p>Body: <pre><code>{\n  \"signature\": \"3xMqyz4fTVaVPpZxbMCuKgf2PQ2hLzpvgLFAkf6fV5zR3FVFBsG9U8k3VzZgPRbmm6U3K3uKZT2\",\n  \"amount\": 0.01,\n  \"token\": \"USDC\"\n}\n</code></pre></p> Field Type Description <code>signature</code> string Transaction signature from Phantom <code>amount</code> number Amount in USDC (0.01 - 1.00) <code>token</code> string Token symbol (always \"USDC\")"},{"location":"chatbot/payments/#response-success","title":"Response (Success)","text":"<p>Status: <code>200 OK</code></p> <pre><code>{\n  \"success\": true,\n  \"message\": \"Payment accepted. You have been granted 10 additional queries.\",\n  \"signature\": \"3xMqyz4fTVaVPpZxbMCuKgf2PQ2hLzpvgLFAkf6fV5zR3FVFBsG9U8k3VzZgPRbmm6U3K3uKZT2\",\n  \"queriesGranted\": 10,\n  \"rateLimit\": {\n    \"remaining\": 10,\n    \"resetAt\": 1730851200000,\n    \"requiresPayment\": false\n  }\n}\n</code></pre>"},{"location":"chatbot/payments/#response-error","title":"Response (Error)","text":"<p>Status: <code>400 Bad Request</code></p> <pre><code>{\n  \"error\": \"Invalid or unconfirmed transaction. Please ensure you sent 0.01 USDC (not SOL) to the recipient address.\",\n  \"details\": \"Transaction verification failed. Check that: 1) You sent USDC tokens (not SOL), 2) Amount is 0.01 USDC, 3) Sent to the correct recipient address, 4) Transaction has been confirmed on the blockchain (wait 30-60 seconds)\"\n}\n</code></pre> <p>Common errors:</p> <ul> <li>Invalid amount: Amount outside 0.01-1.00 USDC range</li> <li>Transaction not found: Transaction not yet on blockchain</li> <li>Transaction not confirmed: Wait longer for confirmation</li> <li>Wrong token: Sent SOL or different token instead of USDC</li> <li>Wrong recipient: Sent to wrong wallet address</li> <li>Insufficient amount: Sent less than expected amount</li> <li>Already used: Transaction signature already used before</li> </ul>"},{"location":"chatbot/payments/#payment-info-endpoint","title":"Payment Info Endpoint","text":""},{"location":"chatbot/payments/#request_1","title":"Request","text":"<p>Endpoint: <code>GET /api/payment/info</code></p> <p>Returns payment configuration information.</p>"},{"location":"chatbot/payments/#response","title":"Response","text":"<pre><code>{\n  \"amount\": 0.01,\n  \"token\": \"USDC\",\n  \"network\": \"devnet\",\n  \"recipient\": \"HMYDGuLTCL6r5pGL8yUbj27i4pyafpomfhZLq3psxm7L\",\n  \"usdcMint\": \"4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU\",\n  \"instructions\": [\n    \"Send the specified amount of USDC to the recipient address\",\n    \"Submit the transaction signature to the /api/payment endpoint\",\n    \"You will receive 1 additional query after successful verification\"\n  ]\n}\n</code></pre>"},{"location":"chatbot/payments/#testing-payments","title":"Testing Payments","text":""},{"location":"chatbot/payments/#devnet-testing","title":"Devnet Testing","text":"<ol> <li> <p>Get Devnet SOL: Use faucet at https://faucet.solana.com/</p> </li> <li> <p>Get Devnet USDC: Use faucet at https://spl-token-faucet.com/</p> </li> <li>Select network: Devnet</li> <li>Paste wallet address</li> <li> <p>Select USDC token</p> </li> <li> <p>Connect Phantom to Devnet:</p> </li> <li>Click wallet address in top-right</li> <li>Click Settings</li> <li> <p>Change network to Devnet</p> </li> <li> <p>Make Test Payment:</p> </li> <li>Open chatbot</li> <li>Use 3 free queries</li> <li>Click \"Pay with Solana\"</li> <li>Select 0.01 USDC (10 queries)</li> <li>Confirm in Phantom</li> </ol>"},{"location":"chatbot/payments/#monitoring-payments","title":"Monitoring Payments","text":"<p>Check the server logs for transaction verification:</p> <pre><code>[INFO] [RAGBOT] Verifying USDC transaction: 3xMqyz4f..., expected amount: 0.01 USDC\n[INFO] [RAGBOT] Pre-token balances: [...]\n[INFO] [RAGBOT] Post-token balances: [...]\n[INFO] [RAGBOT] \u2713 Found recipient account with 10000 tokens received (0.01 USDC)\n[INFO] [RAGBOT] USDC transaction verified successfully: 3xMqyz4f... (0.01 USDC received)\n[INFO] [RAGBOT] Granting 10 queries to user:127.0.0.1\n</code></pre>"},{"location":"chatbot/payments/#security-considerations","title":"Security Considerations","text":""},{"location":"chatbot/payments/#transaction-deduplication","title":"Transaction Deduplication","text":"<p>Used transaction signatures are stored in Deno KV for 30 days to prevent reuse:</p> <pre><code>const key = ['used_transactions', signature];\nawait kv.set(key, true, { expireIn: 30 * 24 * 60 * 60 * 1000 });\n</code></pre>"},{"location":"chatbot/payments/#balance-verification","title":"Balance Verification","text":"<p>The system verifies: - \u2705 Transaction exists on blockchain - \u2705 Transaction succeeded (no errors) - \u2705 Correct token (USDC mint address) - \u2705 Correct recipient (wallet address) - \u2705 Correct amount (within 1% tolerance for rounding) - \u2705 Transaction not used before</p>"},{"location":"chatbot/payments/#rate-limiting-on-payments","title":"Rate Limiting on Payments","text":"<p>Payment endpoint is not explicitly rate-limited but: - Frontend waits 5 seconds before verification - Backend verifies transaction on blockchain (prevents duplicates) - Used transactions tracked for 30 days</p>"},{"location":"chatbot/payments/#troubleshooting","title":"Troubleshooting","text":""},{"location":"chatbot/payments/#payment-verification-fails","title":"Payment Verification Fails","text":"<p>Error: \"Invalid or unconfirmed transaction\"</p> <p>Solutions: 1. Wait for confirmation: Transaction may not be confirmed yet. Wait 30-60 seconds and try again. 2. Check amount: Ensure you sent exactly the amount specified (0.01, 0.05, 0.1, 0.5, or 1.0 USDC). 3. Check token: Ensure you sent USDC tokens, not SOL. 4. Check recipient: Verify you sent to the correct recipient wallet address. 5. Check network: If on devnet, use devnet tokens from https://spl-token-faucet.com/</p>"},{"location":"chatbot/payments/#transaction-already-used","title":"Transaction Already Used","text":"<p>Error: \"This transaction has already been used\"</p> <p>Solution: Each transaction signature can only be used once. Make a new payment with a different transaction.</p>"},{"location":"chatbot/payments/#no-token-balances-found","title":"No Token Balances Found","text":"<p>Error: \"No token account found for recipient\"</p> <p>Causes: 1. Sent to wrong wallet address 2. Sent a different token (not USDC) 3. Transaction not confirmed yet</p> <p>Solutions: - Verify recipient wallet address in payment modal - Confirm you're sending USDC (not SOL or other tokens) - Wait longer for blockchain confirmation</p>"},{"location":"chatbot/payments/#phantom-wallet-issues","title":"Phantom Wallet Issues","text":"<p>Can't connect wallet: - Make sure Phantom is installed and unlocked - Check correct network is selected (devnet or mainnet)</p> <p>Transaction rejected: - Ensure wallet has SOL for transaction fees - Check you have USDC tokens to send - Try again with smaller amount</p>"},{"location":"chatbot/payments/#future-enhancements","title":"Future Enhancements","text":"<ul> <li>[ ] Support for other tokens (SOL, USDT)</li> <li>[ ] Subscription plans with recurring payments</li> <li>[ ] Withdrawal mechanism for collected payments</li> <li>[ ] Multi-signature payment verification</li> <li>[ ] Payment history and analytics</li> <li>[ ] Refund mechanism for failed transactions</li> </ul>"},{"location":"chatbot/quickstart/","title":"Quick Start Guide","text":"<p>Get the OpenLibx402 RAG Chatbot up and running in 5 minutes.</p>"},{"location":"chatbot/quickstart/#prerequisites","title":"Prerequisites","text":"<ul> <li>Deno 1.x+ (Install)</li> <li>OpenAI API key (Get one)</li> <li>Pinecone account (Create)</li> </ul>"},{"location":"chatbot/quickstart/#1-setup-2-minutes","title":"1. Setup (2 minutes)","text":"<pre><code># Navigate to chatbot directory\ncd openlibx402/chatbot\n\n# Create .env file\ncat &gt; .env &lt;&lt; 'EOF'\nOPENAI_API_KEY=sk-proj-your-key-here\nPINECONE_API_KEY=pcsk_your-key-here\nPINECONE_INDEX_NAME=openlibx402-docs\nX402_WALLET_ADDRESS=HMYDGuLTCL6r5pGL8yUbj27i4pyafpomfhZLq3psxm7L\nX402_WALLET_SECRET_KEY=[137,174,28,79,13,105,253,115,92,47,1,209,169,160,241,189,17,251,27,225,172,209,84,43,143,100,219,114,248,112,8,117,242,253,229,233,202,205,228,253,191,126,8,194,34,243,59,154,2,74,186,146,72,72,94,206,84,43,36,16,140,176,239,55]\nSOLANA_NETWORK=devnet\nUSDC_MINT_ADDRESS=4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU\nRATE_LIMIT_FREE_QUERIES=3\nPORT=3000\nALLOWED_ORIGINS=http://localhost:8000,http://localhost:3000\nEOF\n</code></pre> <p>Replace the API keys with your actual keys.</p>"},{"location":"chatbot/quickstart/#2-start-server-1-minute","title":"2. Start Server (1 minute)","text":"<pre><code>deno run --allow-net --allow-env --allow-read --allow-ffi src/main.ts\n</code></pre> <p>You should see: <pre><code>[INFO] [RAGBOT] Server listening on http://localhost:3000\n</code></pre></p>"},{"location":"chatbot/quickstart/#3-test-chatbot-2-minutes","title":"3. Test Chatbot (2 minutes)","text":""},{"location":"chatbot/quickstart/#option-a-via-browser","title":"Option A: Via Browser","text":"<ol> <li>Open <code>http://localhost:8000</code> (your docs site)</li> <li>Click the chat bubble (\ud83d\udcac) in bottom-right</li> <li>Type a question: \"What is OpenLibx402?\"</li> <li>See the response!</li> </ol>"},{"location":"chatbot/quickstart/#option-b-via-curl","title":"Option B: Via cURL","text":"<pre><code>curl -X POST http://localhost:3000/api/chat \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"message\":\"What is OpenLibx402?\"}'\n</code></pre>"},{"location":"chatbot/quickstart/#4-test-payments-optional","title":"4. Test Payments (Optional)","text":"<p>To test the payment system:</p> <ol> <li>Get devnet tokens:</li> <li>Visit https://spl-token-faucet.com/</li> <li>Paste your Phantom wallet address</li> <li>Select USDC token</li> <li> <p>Request airdrop</p> </li> <li> <p>Make a test payment:</p> </li> <li>Use 3 free queries in chatbot</li> <li>Click \"Pay with Solana\"</li> <li>Select 0.01 USDC (10 queries)</li> <li>Confirm in Phantom wallet</li> <li>Wait for blockchain confirmation</li> <li>See queries granted!</li> </ol>"},{"location":"chatbot/quickstart/#common-issues","title":"Common Issues","text":""},{"location":"chatbot/quickstart/#server-wont-start","title":"\"Server won't start\"","text":"<pre><code># Check Deno is installed\ndeno --version\n\n# Check port 3000 is available\nlsof -i :3000\n</code></pre>"},{"location":"chatbot/quickstart/#openai-api-error","title":"\"OpenAI API error\"","text":"<pre><code># Verify your API key\necho $OPENAI_API_KEY\n\n# Check your account has credits\n# https://platform.openai.com/account/billing/overview\n</code></pre>"},{"location":"chatbot/quickstart/#pinecone-connection-error","title":"\"Pinecone connection error\"","text":"<pre><code># Check index exists\n# https://app.pinecone.io\n\n# Verify API key in .env file\ncat .env | grep PINECONE\n</code></pre>"},{"location":"chatbot/quickstart/#no-responses-from-chat","title":"\"No responses from chat\"","text":"<p>Check server logs for errors: <pre><code># Look for [ERROR] messages\n# Verify Pinecone index has documents\n# Check OpenAI API key is valid\n</code></pre></p>"},{"location":"chatbot/quickstart/#next-steps","title":"Next Steps","text":"<ul> <li>\ud83d\udcd6 Read Configuration Guide for advanced setup</li> <li>\ud83d\ude80 See Deployment Guide for production</li> <li>\ud83d\udcb0 Learn about Payment System</li> <li>\ud83d\udcda Check API Reference for all endpoints</li> </ul>"},{"location":"chatbot/quickstart/#file-structure","title":"File Structure","text":"<pre><code>chatbot/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 main.ts                 # Server entry point\n\u2502   \u251c\u2500\u2500 handlers/\n\u2502   \u2502   \u251c\u2500\u2500 chat.ts            # Chat endpoint\n\u2502   \u2502   \u2514\u2500\u2500 payment.ts         # Payment endpoint\n\u2502   \u251c\u2500\u2500 middleware/\n\u2502   \u2502   \u2514\u2500\u2500 rateLimit.ts       # Rate limiting\n\u2502   \u251c\u2500\u2500 services/\n\u2502   \u2502   \u251c\u2500\u2500 openai.ts          # OpenAI integration\n\u2502   \u2502   \u251c\u2500\u2500 pinecone.ts        # Pinecone integration\n\u2502   \u2502   \u2514\u2500\u2500 solana.ts          # Solana verification\n\u2502   \u2514\u2500\u2500 utils/\n\u2502       \u251c\u2500\u2500 config.ts          # Configuration\n\u2502       \u2514\u2500\u2500 logger.ts          # Logging\n\u251c\u2500\u2500 .env                        # Environment variables\n\u251c\u2500\u2500 deno.json                   # Deno config\n\u2514\u2500\u2500 deno.lock                   # Dependency lock file\n\ndocs/\n\u251c\u2500\u2500 overrides/\n\u2502   \u251c\u2500\u2500 main.html              # MkDocs template\n\u2502   \u2514\u2500\u2500 assets/javascripts/\n\u2502       \u2514\u2500\u2500 chatbot.js         # Frontend widget\n\u2514\u2500\u2500 chatbot/\n    \u251c\u2500\u2500 overview.md            # This guide\n    \u251c\u2500\u2500 configuration.md       # Configuration docs\n    \u251c\u2500\u2500 api.md                 # API reference\n    \u251c\u2500\u2500 payments.md            # Payment docs\n    \u251c\u2500\u2500 deployment.md          # Deployment guide\n    \u2514\u2500\u2500 quickstart.md          # Quick start\n</code></pre>"},{"location":"chatbot/quickstart/#key-endpoints","title":"Key Endpoints","text":"Method Endpoint Purpose POST <code>/api/chat</code> Send message to chatbot GET <code>/api/status</code> Check rate limit GET <code>/api/payment/info</code> Get payment info POST <code>/api/payment</code> Submit payment"},{"location":"chatbot/quickstart/#environment-variables-summary","title":"Environment Variables Summary","text":"Variable Purpose Required <code>OPENAI_API_KEY</code> GPT API access \u2705 Yes <code>PINECONE_API_KEY</code> Vector DB access \u2705 Yes <code>PINECONE_INDEX_NAME</code> Index name \u2705 Yes <code>X402_WALLET_ADDRESS</code> Payment receiver \u2705 Yes <code>X402_WALLET_SECRET_KEY</code> Sign transactions \u2705 Yes <code>SOLANA_NETWORK</code> devnet/mainnet \u2705 Yes <code>USDC_MINT_ADDRESS</code> Token address \u2705 Yes <code>RATE_LIMIT_FREE_QUERIES</code> Free limit per day \u26a0\ufe0f Optional (default: 3) <code>PORT</code> Server port \u26a0\ufe0f Optional (default: 3000) <code>ALLOWED_ORIGINS</code> CORS origins \u26a0\ufe0f Optional"},{"location":"chatbot/quickstart/#rate-limiting","title":"Rate Limiting","text":"<ul> <li>Free: 3 queries per day (per IP)</li> <li>Paid: Purchase with USDC (10-1000 queries)</li> <li>Reset: Daily at midnight UTC</li> </ul>"},{"location":"chatbot/quickstart/#pricing","title":"Pricing","text":"<ul> <li>Cost to user: $0.001 per query (0.01 USDC = 10 queries)</li> <li>Cost to operate: ~$0.000133 per query</li> <li>Profit margin: ~87%</li> </ul>"},{"location":"chatbot/quickstart/#support","title":"Support","text":"<p>For issues or questions: 1. Check Configuration Guide 2. Check Payment System 3. Review server logs for [ERROR] messages 4. Create an issue on GitHub</p>"},{"location":"chatbot/quickstart/#whats-next","title":"What's Next?","text":"<p>Once you have the chatbot running:</p> <ol> <li>Test thoroughly on devnet with USDC payments</li> <li>Review the API at <code>/docs/chatbot/api.md</code></li> <li>Configure production settings following <code>/docs/chatbot/deployment.md</code></li> <li>Deploy to production using Docker or VPS</li> <li>Monitor costs and performance</li> <li>Gather feedback from users</li> </ol> <p>Enjoy your RAG chatbot! \ud83d\ude80</p>"},{"location":"examples/","title":"OpenLibx402 Examples","text":"<p>This directory contains example applications demonstrating the X402 payment protocol in both Python and TypeScript.</p>"},{"location":"examples/#structure","title":"\ud83d\udcc1 Structure","text":"<pre><code>examples/\n\u251c\u2500\u2500 python/                      # Python examples\n\u2502   \u251c\u2500\u2500 fastapi-server/          # FastAPI server with payment endpoints\n\u2502   \u251c\u2500\u2500 langchain-agent/         # LangChain agent with autonomous payments\n\u2502   \u2514\u2500\u2500 langgraph-workflow/      # LangGraph workflow with payment nodes\n\u2502\n\u2514\u2500\u2500 typescript/                  # TypeScript examples\n    \u251c\u2500\u2500 express-server/          # Express.js server with payment endpoints\n    \u251c\u2500\u2500 langchain-agent/         # LangChain.js agent with autonomous payments\n    \u2514\u2500\u2500 langgraph-workflow/      # LangGraph.js workflow with payment nodes\n</code></pre>"},{"location":"examples/#python-examples","title":"\ud83d\udc0d Python Examples","text":""},{"location":"examples/#fastapi-server","title":"FastAPI Server","text":"<p>HTTP API server that requires payments for premium endpoints.</p> <p>Location: <code>python/fastapi-server/</code></p> <p>Run: <pre><code>cd python/fastapi-server\nuv run uvicorn main:app --reload\n</code></pre></p> <p>Endpoints: - <code>GET /</code> - API info (free) - <code>GET /free-data</code> - Free endpoint - <code>GET /premium-data</code> - Requires 0.10 USDC - <code>GET /expensive-data</code> - Requires 1.00 USDC - <code>GET /tiered-data/{tier}</code> - Requires 0.05 USDC</p>"},{"location":"examples/#langchain-agent","title":"LangChain Agent","text":"<p>AI agent that autonomously pays for API access.</p> <p>Location: <code>python/langchain-agent/</code></p> <p>Run: <pre><code>cd python/langchain-agent\nexport OPENAI_API_KEY=\"your-key\"\nuv run python main.py\n</code></pre></p> <p>Features: - Autonomous payment capability - Multiple API access - Custom tool integration</p>"},{"location":"examples/#langgraph-workflow","title":"LangGraph Workflow","text":"<p>Workflows with payment nodes for accessing paid APIs.</p> <p>Location: <code>python/langgraph-workflow/</code></p> <p>Run: <pre><code>cd python/langgraph-workflow\nuv run python main.py\n</code></pre></p> <p>Features: - Payment nodes - Conditional routing - Multi-step workflows</p>"},{"location":"examples/#typescript-examples","title":"\ud83d\udce6 TypeScript Examples","text":""},{"location":"examples/#expressjs-server","title":"Express.js Server","text":"<p>HTTP API server that requires payments for premium endpoints.</p> <p>Location: <code>typescript/express-server/</code></p> <p>Run: <pre><code>cd typescript/express-server\npnpm install &amp;&amp; pnpm run build &amp;&amp; pnpm start\n</code></pre></p> <p>Or from root: <pre><code>make example-express\n</code></pre></p> <p>Endpoints: - <code>GET /</code> - API info (free) - <code>GET /free-data</code> - Free endpoint - <code>GET /premium-data</code> - Requires 0.10 USDC - <code>GET /expensive-data</code> - Requires 1.00 USDC - <code>GET /tiered-data/:tier</code> - Requires 0.05 USDC</p>"},{"location":"examples/#langchainjs-agent","title":"LangChain.js Agent","text":"<p>AI agent that autonomously pays for API access.</p> <p>Location: <code>typescript/langchain-agent/</code></p> <p>Run: <pre><code>cd typescript/langchain-agent\ncp .env.example .env\n# Edit .env and add OPENAI_API_KEY\npnpm install &amp;&amp; pnpm run build &amp;&amp; pnpm start\n</code></pre></p> <p>Or from root: <pre><code>make example-langchain\n</code></pre></p> <p>Features: - Autonomous payment capability - Multiple API access - Custom tool configuration</p>"},{"location":"examples/#langgraphjs-workflow","title":"LangGraph.js Workflow","text":"<p>Workflows with payment nodes for accessing paid APIs.</p> <p>Location: <code>typescript/langgraph-workflow/</code></p> <p>Run: <pre><code>cd typescript/langgraph-workflow\npnpm install &amp;&amp; pnpm run build &amp;&amp; pnpm start\n</code></pre></p> <p>Or from root: <pre><code>make example-langgraph\n</code></pre></p> <p>Features: - Payment nodes - Conditional routing - Multi-step workflows</p>"},{"location":"examples/#quick-start","title":"\ud83d\ude80 Quick Start","text":""},{"location":"examples/#1-start-a-server","title":"1. Start a Server","text":"<p>Python FastAPI: <pre><code>cd examples/python/fastapi-server\nuv run uvicorn main:app --reload\n</code></pre></p> <p>TypeScript Express: <pre><code>cd examples/typescript/express-server\npnpm install &amp;&amp; pnpm run build &amp;&amp; pnpm start\n</code></pre></p> <p>Server will be available at: - Python: <code>http://localhost:8000</code> - TypeScript: <code>http://localhost:3000</code></p>"},{"location":"examples/#2-test-with-client","title":"2. Test with Client","text":"<p>Python Client: <pre><code>from openlibx402_client import X402AutoClient\nfrom solders.keypair import Keypair\n\nkeypair = Keypair()  # Load your keypair\nclient = X402AutoClient(keypair)\n\nresponse = await client.get(\"http://localhost:8000/premium-data\")\nprint(response.json())\n</code></pre></p> <p>TypeScript Client: <pre><code>import { X402AutoClient } from '@openlibx402/client';\nimport { Keypair } from '@solana/web3.js';\n\nconst keypair = Keypair.generate();  // Load your keypair\nconst client = new X402AutoClient(keypair);\n\nconst response = await client.get('http://localhost:3000/premium-data');\nconsole.log(response.data);\n</code></pre></p>"},{"location":"examples/#3-run-agent-examples","title":"3. Run Agent Examples","text":"<p>Make sure the server is running first!</p> <p>Python LangChain: <pre><code>cd examples/python/langchain-agent\nexport OPENAI_API_KEY=\"your-key\"\nuv run python main.py\n</code></pre></p> <p>TypeScript LangChain.js: <pre><code>cd examples/typescript/langchain-agent\nexport OPENAI_API_KEY=\"your-key\"\npnpm run dev\n</code></pre></p>"},{"location":"examples/#prerequisites","title":"\ud83d\udd11 Prerequisites","text":""},{"location":"examples/#all-examples","title":"All Examples","text":"<ul> <li>Solana wallet with:</li> <li>SOL for transaction fees</li> <li>USDC tokens for payments</li> <li>Running server (FastAPI or Express)</li> </ul>"},{"location":"examples/#agent-examples-additional","title":"Agent Examples (Additional)","text":"<ul> <li>OpenAI API key (for LangChain/LangChain.js agents)</li> <li>Set as <code>OPENAI_API_KEY</code> environment variable</li> </ul>"},{"location":"examples/#wallet-setup","title":"\ud83d\udcb0 Wallet Setup","text":"<p>All examples will create a <code>wallet.json</code> file on first run.</p> <p>Fund your wallet:</p> <pre><code># Get SOL on devnet\nsolana airdrop 1 &lt;YOUR_ADDRESS&gt; --url devnet\n\n# Get USDC from a faucet\n# Visit: https://spl-token-faucet.com/\n</code></pre> <p>\u26a0\ufe0f Security Warning: - Never commit <code>wallet.json</code> to version control - In production, use secure key management - The wallet files are in <code>.gitignore</code></p>"},{"location":"examples/#testing-flow","title":"\ud83e\uddea Testing Flow","text":"<ol> <li>Start Server: Run FastAPI or Express server</li> <li>Test Free Endpoint: <code>curl http://localhost:3000/free-data</code></li> <li>Test Paid Endpoint: <code>curl http://localhost:3000/premium-data</code></li> <li>Should return 402 Payment Required</li> <li>Run Agent: Agent automatically handles payment</li> <li>Verify: Check agent receives data</li> </ol>"},{"location":"examples/#learn-more","title":"\ud83d\udcda Learn More","text":"<p>Each example directory contains its own detailed README:</p> <ul> <li>FastAPI Server</li> <li>Python LangChain Agent</li> <li>Python LangGraph Workflow</li> <li>Express.js Server</li> <li>TypeScript LangChain Agent</li> <li>TypeScript LangGraph Workflow</li> </ul>"},{"location":"examples/#troubleshooting","title":"\ud83d\udd27 Troubleshooting","text":""},{"location":"examples/#server-wont-start","title":"Server Won't Start","text":"<ul> <li>Check port isn't already in use</li> <li>Verify dependencies are installed</li> <li>Check wallet address is configured</li> </ul>"},{"location":"examples/#agent-cant-pay","title":"Agent Can't Pay","text":"<ul> <li>Ensure server is running</li> <li>Fund wallet with SOL and USDC</li> <li>Check OpenAI API key is set</li> <li>Verify server URL is correct</li> </ul>"},{"location":"examples/#payment-verification-fails","title":"Payment Verification Fails","text":"<ul> <li>Check RPC URL is accessible</li> <li>Ensure transaction was broadcast</li> <li>Verify wallet has sufficient funds</li> </ul>"},{"location":"examples/#next-steps","title":"\ud83c\udfaf Next Steps","text":"<ol> <li>Run the server examples</li> <li>Test with simple curl requests</li> <li>Try the agent examples</li> <li>Build your own application!</li> </ol> <p>For more information, see the main documentation.</p>"},{"location":"examples/python/fastapi-server/","title":"FastAPI Server Example","text":"<p>Example FastAPI server with X402 payment requirements.</p>"},{"location":"examples/python/fastapi-server/#setup","title":"Setup","text":"<ol> <li> <p>Install dependencies: <pre><code>pip install -r requirements.txt\n</code></pre></p> </li> <li> <p>Configure environment: <pre><code>cp .env.example .env\n# Edit .env with your wallet address and token mint\n</code></pre></p> </li> <li> <p>Run the server: <pre><code>python main.py\n</code></pre></p> </li> <li> <p>Visit http://localhost:8000/docs for API documentation</p> </li> </ol>"},{"location":"examples/python/fastapi-server/#testing","title":"Testing","text":""},{"location":"examples/python/fastapi-server/#get-free-data","title":"Get free data:","text":"<pre><code>curl http://localhost:8000/free-data\n</code></pre>"},{"location":"examples/python/fastapi-server/#try-premium-endpoint-will-return-402","title":"Try premium endpoint (will return 402):","text":"<pre><code>curl http://localhost:8000/premium-data\n</code></pre>"},{"location":"examples/python/fastapi-server/#with-payment-client","title":"With payment client:","text":"<p>See the langchain-agent example for how to make payments automatically.</p>"},{"location":"examples/python/fastapi-server/#endpoints","title":"Endpoints","text":"<ul> <li><code>GET /</code> - API information (free)</li> <li><code>GET /free-data</code> - Free data (no payment)</li> <li><code>GET /premium-data</code> - Premium data (0.10 USDC)</li> <li><code>GET /expensive-data</code> - Expensive AI data (1.00 USDC)</li> <li><code>GET /tiered-data/{tier}</code> - Tiered access (0.05 USDC)</li> </ul>"},{"location":"examples/python/langchain-agent/","title":"LangChain Agent Example","text":"<p>Example LangChain agent with autonomous X402 payment capabilities.</p>"},{"location":"examples/python/langchain-agent/#setup","title":"Setup","text":"<ol> <li> <p>Install dependencies: <pre><code>pip install -r requirements.txt\n</code></pre></p> </li> <li> <p>Set OpenAI API key: <pre><code>export OPENAI_API_KEY='your-key-here'\n</code></pre></p> </li> <li> <p>Create and fund wallet: <pre><code># Run the script once to generate wallet\npython main.py\n\n# Fund the wallet with SOL (for transaction fees)\nsolana airdrop 1 YOUR_WALLET_ADDRESS --url devnet\n\n# You'll also need USDC on devnet for payments\n# Use a faucet or swap service\n</code></pre></p> </li> <li> <p>Start the FastAPI server (in another terminal): <pre><code>cd ../fastapi-server\npython main.py\n</code></pre></p> </li> <li> <p>Run the agent examples: <pre><code>python main.py\n</code></pre></p> </li> </ol>"},{"location":"examples/python/langchain-agent/#what-it-does","title":"What it does","text":"<p>The examples demonstrate three scenarios:</p>"},{"location":"examples/python/langchain-agent/#example-1-simple-agent","title":"Example 1: Simple Agent","text":"<p>Creates an agent using the convenience function that can autonomously detect and pay for 402 responses.</p>"},{"location":"examples/python/langchain-agent/#example-2-custom-tools","title":"Example 2: Custom Tools","text":"<p>Shows how to combine X402 payment capabilities with other LangChain tools.</p>"},{"location":"examples/python/langchain-agent/#example-3-multi-api","title":"Example 3: Multi-API","text":"<p>Demonstrates an agent making multiple payments to different APIs in a single workflow.</p>"},{"location":"examples/python/langchain-agent/#key-features","title":"Key Features","text":"<ul> <li>Autonomous Payments: Agent detects 402 responses and pays automatically</li> <li>Safety Limits: <code>max_payment</code> parameter prevents overspending</li> <li>Transparent: Verbose mode shows payment decisions</li> <li>Flexible: Works with any X402-enabled API</li> </ul>"},{"location":"examples/python/langgraph-workflow/","title":"LangGraph Workflow Example","text":"<p>Example LangGraph workflows with X402 payment nodes.</p>"},{"location":"examples/python/langgraph-workflow/#setup","title":"Setup","text":"<ol> <li> <p>Install dependencies: <pre><code>pip install -r requirements.txt\n</code></pre></p> </li> <li> <p>Create and fund wallet: <pre><code># Run the script once to generate wallet\npython main.py\n\n# Fund the wallet with SOL (for transaction fees)\nsolana airdrop 1 YOUR_WALLET_ADDRESS --url devnet\n</code></pre></p> </li> <li> <p>Start the FastAPI server (in another terminal): <pre><code>cd ../fastapi-server\npython main.py\n</code></pre></p> </li> <li> <p>Run the workflow examples: <pre><code>python main.py\n</code></pre></p> </li> </ol>"},{"location":"examples/python/langgraph-workflow/#what-it-does","title":"What it does","text":"<p>The examples demonstrate three workflow patterns:</p>"},{"location":"examples/python/langgraph-workflow/#example-1-simple-workflow","title":"Example 1: Simple Workflow","text":"<p>Uses the convenience function to create a basic workflow with payment handling.</p>"},{"location":"examples/python/langgraph-workflow/#example-2-custom-workflow","title":"Example 2: Custom Workflow","text":"<p>Shows how to build a workflow with separate fetch and payment nodes for more control.</p>"},{"location":"examples/python/langgraph-workflow/#example-3-multi-step-workflow","title":"Example 3: Multi-Step Workflow","text":"<p>Demonstrates a workflow that accesses multiple paid APIs sequentially, handling payments for each.</p>"},{"location":"examples/python/langgraph-workflow/#key-features","title":"Key Features","text":"<ul> <li>Modular Design: Payment logic is isolated in dedicated nodes</li> <li>Conditional Routing: Workflows automatically route to payment nodes when needed</li> <li>Error Handling: Graceful handling of payment errors</li> <li>Composable: Easy to add payment capabilities to existing workflows</li> </ul>"},{"location":"examples/python/langgraph-workflow/#workflow-patterns","title":"Workflow Patterns","text":""},{"location":"examples/python/langgraph-workflow/#pattern-1-combined-node","title":"Pattern 1: Combined Node","text":"<p><pre><code>workflow.add_node(\"fetch\", fetch_with_payment_node)\n</code></pre> Simplest approach - fetch and pay in one node.</p>"},{"location":"examples/python/langgraph-workflow/#pattern-2-separate-nodes","title":"Pattern 2: Separate Nodes","text":"<p><pre><code>workflow.add_node(\"fetch\", fetch_node)\nworkflow.add_node(\"pay\", payment_node)\nworkflow.add_conditional_edges(\"fetch\", check_payment_required, {...})\n</code></pre> More control - explicit payment step.</p>"},{"location":"examples/python/langgraph-workflow/#pattern-3-multi-step","title":"Pattern 3: Multi-Step","text":"<p><pre><code># Loop through multiple APIs\nworkflow.add_conditional_edges(\"collect\", check_more_apis, {\n    \"fetch_next\": \"fetch\",\n    \"complete\": END\n})\n</code></pre> Complex workflows with multiple payments.</p>"},{"location":"examples/typescript/astro-app/","title":"Astro App Example with X402 Payment Support","text":"<p>This example demonstrates how to create an Astro application with X402 payment requirements for API endpoints, featuring server-side rendering, React component integration, and real Solana wallet payments.</p>"},{"location":"examples/typescript/astro-app/#features","title":"Features","text":"<ul> <li>Astro SSR - Server-side rendering with <code>@astrojs/node</code> adapter</li> <li>React Integration - Interactive payment UI with React components</li> <li>Server-side API Routes - Protected endpoints with payment requirements</li> <li>Phantom Wallet Support - Real blockchain transactions on Solana devnet</li> <li>Payment Simulation - Demo mode for testing without wallet/funds</li> <li>TypeScript - Full type safety across client and server</li> <li>Tailwind CSS - Modern, responsive styling</li> <li>X402 Protocol - HTTP 402 Payment Required standard</li> </ul>"},{"location":"examples/typescript/astro-app/#setup","title":"Setup","text":""},{"location":"examples/typescript/astro-app/#1-install-dependencies","title":"1. Install Dependencies","text":"<p>From the monorepo root:</p> <pre><code>pnpm install\n</code></pre> <p>Or from the <code>examples/typescript/astro-app</code> directory:</p> <pre><code>npm install\n</code></pre>"},{"location":"examples/typescript/astro-app/#2-configure-environment","title":"2. Configure Environment","text":"<p>Create a <code>.env</code> file based on <code>.env.example</code>:</p> <pre><code>cp .env.example .env\n</code></pre> <p>Edit <code>.env</code> with your Solana wallet details:</p> <pre><code># Solana Configuration\nSOLANA_RPC_URL=https://api.devnet.solana.com\n\n# X402 Payment Configuration\nPAYMENT_WALLET_ADDRESS=your_wallet_address_here\nUSDC_MINT_ADDRESS=4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU\n</code></pre>"},{"location":"examples/typescript/astro-app/#3-build-and-run","title":"3. Build and Run","text":"<pre><code># Development mode\nnpm run dev\n\n# Build for production\nnpm run build\n\n# Preview production build\nnpm run preview\n</code></pre> <p>The app will start on <code>http://localhost:4321</code>.</p>"},{"location":"examples/typescript/astro-app/#api-endpoints","title":"API Endpoints","text":""},{"location":"examples/typescript/astro-app/#free-endpoints","title":"Free Endpoints","text":"<ul> <li>GET /api/free-data - Public data access (no payment required)</li> </ul>"},{"location":"examples/typescript/astro-app/#paid-endpoints","title":"Paid Endpoints","text":"<ul> <li>GET /api/premium-data - Premium data (0.10 USDC)</li> <li>GET /api/expensive-data - AI inference (1.00 USDC)</li> <li>GET /api/tiered-data/[tier] - Tiered content (0.05 USDC for premium)</li> <li>POST /api/process-data - Data processing (0.25 USDC)</li> </ul>"},{"location":"examples/typescript/astro-app/#how-it-works","title":"How It Works","text":""},{"location":"examples/typescript/astro-app/#server-side-api-routes","title":"Server-Side (API Routes)","text":"<p>Astro API routes are located in <code>src/pages/api/</code> and export request handlers:</p> <ol> <li>Initialize X402 Configuration (<code>src/utils/x402-config.ts</code>):</li> </ol> <pre><code>import type { PaymentRequestData } from '@openlibx402/core';\n\nexport function initX402Config(): X402Config {\n  const paymentAddress = process.env.PAYMENT_WALLET_ADDRESS;\n  const tokenMint = process.env.USDC_MINT_ADDRESS;\n\n  return {\n    paymentAddress,\n    tokenMint,\n    network: 'solana-devnet',\n    rpcUrl: 'https://api.devnet.solana.com',\n    autoVerify: process.env.NODE_ENV === 'production',\n  };\n}\n</code></pre> <ol> <li>Protect API Routes with <code>withPayment</code> helper:</li> </ol> <pre><code>import { withPayment } from '../utils/x402-config';\n\nexport async function GET(request: Request) {\n  const response = await withPayment(\n    request,\n    {\n      amount: \"0.10\",\n      description: \"Access to premium data\",\n    },\n    async (request, context) =&gt; {\n      return {\n        data: \"Premium content\",\n        payment_id: context.payment?.payment_id,\n        timestamp: new Date().toISOString(),\n      };\n    }\n  );\n\n  return new Response(JSON.stringify(response.body), {\n    status: response.status,\n    headers: { 'Content-Type': 'application/json' },\n  });\n}\n</code></pre>"},{"location":"examples/typescript/astro-app/#client-side-react-components","title":"Client-Side (React Components)","text":"<ol> <li>Wallet Connection (<code>src/components/WalletButton.tsx</code>):</li> </ol> <pre><code>import { useState, useEffect } from 'react';\n\nexport default function WalletButton() {\n  const [walletAddress, setWalletAddress] = useState&lt;string | null&gt;(null);\n\n  const connectWallet = async () =&gt; {\n    const response = await (window as any).phantom.solana.connect();\n    setWalletAddress(response.publicKey.toString());\n  };\n\n  return (\n    &lt;button onClick={connectWallet}&gt;\n      {walletAddress ? `Connected: ${walletAddress.slice(0, 8)}...` : 'Connect Wallet'}\n    &lt;/button&gt;\n  );\n}\n</code></pre> <ol> <li>Payment Endpoint Card (<code>src/components/X402EndpointCard.tsx</code>):</li> </ol> <pre><code>import { useState } from 'react';\nimport { generateMockPaymentAuthorization } from '../utils/mock-payment';\nimport { createPaymentTransaction, transactionToAuthHeader } from '../utils/real-payment';\n\nexport default function X402EndpointCard({ endpoint, price }) {\n  const [paymentRequired, setPaymentRequired] = useState(null);\n\n  // Try endpoint - may return 402 Payment Required\n  const handleFetch = async (authHeader?: string) =&gt; {\n    const headers = authHeader ? { 'x-payment-authorization': authHeader } : {};\n    const response = await fetch(endpoint, { headers });\n\n    if (response.status === 402) {\n      const paymentData = await response.json();\n      setPaymentRequired(paymentData);\n    } else {\n      const data = await response.json();\n      setResult(data);\n    }\n  };\n\n  // Real payment with Phantom wallet\n  const handleRealPayment = async () =&gt; {\n    const phantomProvider = (window as any).phantom?.solana;\n    const txResult = await createPaymentTransaction(paymentRequired, phantomProvider);\n    const authHeader = transactionToAuthHeader(txResult);\n    await handleFetch(authHeader);\n  };\n\n  // Simulated payment for demo\n  const handleSimulatePayment = async () =&gt; {\n    const mockAuth = generateMockPaymentAuthorization(paymentRequired);\n    await handleFetch(mockAuth);\n  };\n\n  return (\n    &lt;div&gt;\n      &lt;button onClick={() =&gt; handleFetch()}&gt;Try Endpoint&lt;/button&gt;\n\n      {paymentRequired &amp;&amp; (\n        &lt;&gt;\n          &lt;button onClick={handleRealPayment}&gt;\ud83d\udcb0 Pay with Phantom Wallet&lt;/button&gt;\n          &lt;button onClick={handleSimulatePayment}&gt;Simulate Payment &amp; Retry&lt;/button&gt;\n        &lt;/&gt;\n      )}\n    &lt;/div&gt;\n  );\n}\n</code></pre>"},{"location":"examples/typescript/astro-app/#payment-flow","title":"Payment Flow","text":""},{"location":"examples/typescript/astro-app/#demo-mode-simulated","title":"Demo Mode (Simulated)","text":"<ol> <li>User clicks \"Try Endpoint\" button</li> <li>Server responds with 402 Payment Required</li> <li>User clicks \"Simulate Payment &amp; Retry\"</li> <li>Client generates mock authorization header</li> <li>Client retries request with authorization</li> <li>Server validates and returns content</li> </ol>"},{"location":"examples/typescript/astro-app/#real-mode-blockchain","title":"Real Mode (Blockchain)","text":"<ol> <li>User clicks \"Connect Wallet\" and approves Phantom connection</li> <li>User clicks \"Try Endpoint\" button</li> <li>Server responds with 402 Payment Required</li> <li>User clicks \"\ud83d\udcb0 Pay with Phantom Wallet\"</li> <li>Client creates Solana transaction and requests signature</li> <li>User approves transaction in Phantom wallet</li> <li>Transaction broadcasts to Solana devnet</li> <li>Client retries request with transaction details</li> <li>Server validates payment and returns content</li> <li>Transaction visible on Solscan</li> </ol>"},{"location":"examples/typescript/astro-app/#real-wallet-integration","title":"Real Wallet Integration","text":""},{"location":"examples/typescript/astro-app/#setup-phantom-wallet-for-testing","title":"Setup Phantom Wallet for Testing","text":"<ol> <li>Install Phantom: Download from phantom.app</li> <li>Switch to Devnet: Settings \u2192 Developer Settings \u2192 Testnet Mode \u2192 Solana Devnet</li> <li>Get SOL: Visit solfaucet.com and request free devnet SOL</li> <li>Connect: Click \"Connect Wallet\" button in the app</li> </ol>"},{"location":"examples/typescript/astro-app/#real-payment-implementation","title":"Real Payment Implementation","text":"<p>The <code>src/utils/real-payment.ts</code> utility handles actual blockchain transactions:</p> <pre><code>import { Connection, PublicKey, Transaction, SystemProgram } from '@solana/web3.js';\n\nexport async function createPaymentTransaction(\n  paymentRequest: PaymentRequestData,\n  phantomProvider: any\n): Promise&lt;PaymentTransactionResult&gt; {\n  const connection = new Connection('https://api.devnet.solana.com', 'confirmed');\n  const senderPublicKey = new PublicKey(phantomProvider.publicKey);\n  const recipientPublicKey = new PublicKey(paymentRequest.payment_address);\n\n  // Check balance for transaction fees\n  const balance = await connection.getBalance(senderPublicKey);\n  if (balance &lt; 5000) {\n    throw new Error('Insufficient SOL for fees. Get free SOL from https://solfaucet.com');\n  }\n\n  // Create transaction\n  const { blockhash } = await connection.getLatestBlockhash();\n  const transaction = new Transaction({\n    recentBlockhash: blockhash,\n    feePayer: senderPublicKey,\n  });\n\n  transaction.add(\n    SystemProgram.transfer({\n      fromPubkey: senderPublicKey,\n      toPubkey: recipientPublicKey,\n      lamports: 1000, // ~0.000001 SOL for demo\n    })\n  );\n\n  // Sign with Phantom\n  const signedTransaction = await phantomProvider.signTransaction(transaction);\n\n  // Broadcast\n  const signature = await connection.sendRawTransaction(\n    signedTransaction.serialize(),\n    { skipPreflight: false, preflightCommitment: 'confirmed' }\n  );\n\n  // Wait for confirmation\n  await connection.confirmTransaction(signature, 'confirmed');\n\n  return {\n    transactionHash: signature,\n    signature: signature,\n    publicKey: senderPublicKey.toString(),\n    amount: paymentRequest.max_amount_required,\n    timestamp: new Date().toISOString(),\n    paymentAddress: paymentRequest.payment_address,\n  };\n}\n</code></pre>"},{"location":"examples/typescript/astro-app/#verifying-transactions-on-solscan","title":"Verifying Transactions on Solscan","text":"<p>After a successful real payment:</p> <ol> <li>Copy the transaction signature from the UI response</li> <li>Visit: <code>https://solscan.io/tx/[SIGNATURE]?cluster=devnet</code></li> <li>View transaction details including:</li> <li>Transaction status (Success/Failed)</li> <li>Signer (your wallet address)</li> <li>Recipient (payment wallet address)</li> <li>Amount and fees</li> <li>Block and timestamp</li> </ol>"},{"location":"examples/typescript/astro-app/#project-structure","title":"Project Structure","text":"<pre><code>astro-app/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 components/\n\u2502   \u2502   \u251c\u2500\u2500 EndpointCard.astro          # Free endpoint component\n\u2502   \u2502   \u251c\u2500\u2500 X402EndpointCard.tsx        # Paid endpoint (React)\n\u2502   \u2502   \u2514\u2500\u2500 WalletButton.tsx            # Wallet connection (React)\n\u2502   \u251c\u2500\u2500 layouts/\n\u2502   \u2502   \u2514\u2500\u2500 Layout.astro                # Base layout\n\u2502   \u251c\u2500\u2500 pages/\n\u2502   \u2502   \u251c\u2500\u2500 index.astro                 # Main demo page\n\u2502   \u2502   \u2514\u2500\u2500 api/\n\u2502   \u2502       \u251c\u2500\u2500 free-data.ts            # Public endpoint\n\u2502   \u2502       \u251c\u2500\u2500 premium-data.ts         # 0.10 USDC endpoint\n\u2502   \u2502       \u251c\u2500\u2500 expensive-data.ts       # 1.00 USDC endpoint\n\u2502   \u2502       \u251c\u2500\u2500 tiered-data/[tier].ts   # 0.05 USDC endpoint\n\u2502   \u2502       \u2514\u2500\u2500 process-data.ts         # 0.25 USDC POST endpoint\n\u2502   \u2514\u2500\u2500 utils/\n\u2502       \u251c\u2500\u2500 mock-payment.ts             # Payment simulation\n\u2502       \u251c\u2500\u2500 real-payment.ts             # Real blockchain payments\n\u2502       \u2514\u2500\u2500 x402-config.ts              # X402 configuration\n\u251c\u2500\u2500 astro.config.mjs                    # Astro configuration\n\u251c\u2500\u2500 tailwind.config.ts                  # Tailwind CSS config\n\u251c\u2500\u2500 package.json\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"examples/typescript/astro-app/#configuration","title":"Configuration","text":""},{"location":"examples/typescript/astro-app/#astro-config-astroconfigmjs","title":"Astro Config (<code>astro.config.mjs</code>)","text":"<pre><code>import { defineConfig } from 'astro/config';\nimport tailwind from '@astrojs/tailwind';\nimport react from '@astrojs/react';\nimport node from '@astrojs/node';\n\nexport default defineConfig({\n  adapter: node({\n    mode: 'standalone',\n  }),\n  integrations: [tailwind(), react()],\n  output: 'server',\n  image: {\n    service: {\n      entrypoint: 'astro/assets/services/noop'\n    }\n  },\n  vite: {\n    ssr: {\n      external: ['@solana/wallet-adapter-base', '@solana/web3.js']\n    }\n  }\n});\n</code></pre> <p>Key configuration points:</p> <ul> <li><code>@astrojs/node</code>: Server-side rendering adapter (required for API routes)</li> <li><code>@astrojs/react</code>: Enables React components with client-side interactivity</li> <li><code>output: 'server'</code>: Full SSR mode (not static or hybrid)</li> <li>Vite SSR externals: Prevents bundling Solana packages server-side</li> </ul>"},{"location":"examples/typescript/astro-app/#development-tips","title":"Development Tips","text":""},{"location":"examples/typescript/astro-app/#testing-workflow","title":"Testing Workflow","text":"<ol> <li>Start with Demo Mode: Use \"Simulate Payment &amp; Retry\" to test the flow without wallet setup</li> <li>Test Free Endpoint: Verify basic API routing works correctly</li> <li>Set up Phantom: Only needed when testing real blockchain payments</li> <li>Check Browser Console: Detailed error messages appear in developer tools</li> </ol>"},{"location":"examples/typescript/astro-app/#common-issues","title":"Common Issues","text":"<p>\"Phantom wallet not connected\" - Solution: Click \"Connect Wallet\" button first - Verify Phantom extension is installed and enabled</p> <p>\"Insufficient SOL balance\" - Solution: Visit solfaucet.com for free devnet SOL - Need at least 0.000005 SOL for transaction fees</p> <p>\"Payment address mismatch\" - Solution: Ensure <code>.env</code> file has correct <code>PAYMENT_WALLET_ADDRESS</code> - Check address matches between client and server</p> <p>\"Transaction doesn't appear on Solscan\" - Verify you used \"Pay with Phantom Wallet\" (not simulate) - Check correct cluster: <code>?cluster=devnet</code> in URL - Wait 30 seconds for confirmation</p>"},{"location":"examples/typescript/astro-app/#hot-reload","title":"Hot Reload","text":"<p>Astro supports hot module replacement: - Changes to <code>.astro</code> files reload automatically - React component changes (<code>.tsx</code>) hot-reload - API route changes require manual refresh - <code>.env</code> changes require server restart</p>"},{"location":"examples/typescript/astro-app/#production-considerations","title":"Production Considerations","text":""},{"location":"examples/typescript/astro-app/#mainnet-deployment","title":"Mainnet Deployment","text":"<p>For production on Solana mainnet:</p> <ol> <li>Update RPC URL: Use mainnet endpoint or dedicated provider</li> <li>Use Real USDC: Update <code>USDC_MINT_ADDRESS</code> to mainnet USDC mint</li> <li>Implement SPL Token Transfers: Replace SOL transfers with proper USDC token transfers</li> <li>On-chain Verification: Enable <code>autoVerify</code> in X402 config</li> <li>Rate Limiting: Add rate limiting middleware</li> <li>Database Storage: Store payment receipts and transaction history</li> <li>Error Handling: Implement retry logic and user notifications</li> </ol>"},{"location":"examples/typescript/astro-app/#security-best-practices","title":"Security Best Practices","text":"<ul> <li>Never expose private keys in client-side code</li> <li>Validate all inputs on server-side</li> <li>Use HTTPS for production deployments</li> <li>Implement CORS policies appropriately</li> <li>Monitor transactions for suspicious activity</li> <li>Test thoroughly on devnet before mainnet</li> </ul>"},{"location":"examples/typescript/astro-app/#comparison-with-other-frameworks","title":"Comparison with Other Frameworks","text":""},{"location":"examples/typescript/astro-app/#astro-vs-nextjs","title":"Astro vs Next.js","text":"<p>Astro Advantages: - Lighter JavaScript bundle (less client-side JS by default) - Flexible component framework (React, Vue, Svelte in one project) - Better static site performance</p> <p>Next.js Advantages: - More mature ecosystem - Built-in API routes with middleware - Better TypeScript integration</p>"},{"location":"examples/typescript/astro-app/#astro-vs-nuxt","title":"Astro vs Nuxt","text":"<p>Astro Advantages: - Framework-agnostic (not tied to Vue) - Better performance for content-heavy sites - Simpler mental model</p> <p>Nuxt Advantages: - Better for full Vue.js applications - More integrated dev experience with Vue ecosystem - Auto-imports and conventions</p> <p>All three frameworks (Astro, Next.js, Nuxt) support X402 with similar implementation patterns.</p>"},{"location":"examples/typescript/astro-app/#learn-more","title":"Learn More","text":"<ul> <li>OpenLibx402 Documentation</li> <li>X402 Protocol Specification</li> <li>Astro Documentation</li> <li>Phantom Wallet Docs</li> <li>Solana Web3.js</li> <li>Solscan Explorer</li> </ul>"},{"location":"examples/typescript/astro-app/#additional-resources","title":"Additional Resources","text":"<p>For detailed setup instructions on real wallet payments, see REAL_PAYMENTS.md in the example directory.</p>"},{"location":"examples/typescript/express-server/","title":"Express.js Server Example with X402 Payment Support","text":"<p>This example demonstrates how to create an Express.js API server with X402 payment requirements for specific endpoints.</p>"},{"location":"examples/typescript/express-server/#features","title":"Features","text":"<ul> <li>Free endpoints - Public access without payment</li> <li>Premium endpoints - Require payment to access</li> <li>Automatic payment verification - Built-in Solana blockchain verification</li> <li>Flexible pricing - Different amounts for different endpoints</li> <li>TypeScript - Full type safety</li> </ul>"},{"location":"examples/typescript/express-server/#setup","title":"Setup","text":""},{"location":"examples/typescript/express-server/#1-install-dependencies","title":"1. Install Dependencies","text":"<pre><code>npm install\n</code></pre>"},{"location":"examples/typescript/express-server/#2-configure-environment","title":"2. Configure Environment","text":"<p>Create a <code>.env</code> file based on <code>.env.example</code>:</p> <pre><code>cp .env.example .env\n</code></pre> <p>Edit <code>.env</code> with your Solana wallet details:</p> <pre><code>PAYMENT_WALLET_ADDRESS=your_solana_wallet_address_here\nUSDC_MINT_ADDRESS=EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\nSOLANA_RPC_URL=https://api.devnet.solana.com\nPORT=3000\n</code></pre>"},{"location":"examples/typescript/express-server/#3-build-and-run","title":"3. Build and Run","text":"<pre><code># Build TypeScript\nnpm run build\n\n# Start server\nnpm start\n\n# Or run in development mode\nnpm run dev\n</code></pre> <p>The server will start on <code>http://localhost:3000</code>.</p>"},{"location":"examples/typescript/express-server/#api-endpoints","title":"API Endpoints","text":""},{"location":"examples/typescript/express-server/#free-endpoints","title":"Free Endpoints","text":"<ul> <li>GET / - API information (no payment)</li> <li>GET /free-data - Free data access (no payment)</li> </ul>"},{"location":"examples/typescript/express-server/#paid-endpoints","title":"Paid Endpoints","text":"<ul> <li>GET /premium-data - Premium data (0.10 USDC)</li> <li>GET /expensive-data - AI inference (1.00 USDC)</li> <li>GET /tiered-data/:tier - Tiered content (0.05 USDC)</li> <li>POST /process-data - Data processing (0.25 USDC)</li> </ul>"},{"location":"examples/typescript/express-server/#usage-examples","title":"Usage Examples","text":""},{"location":"examples/typescript/express-server/#free-endpoint","title":"Free Endpoint","text":"<pre><code>curl http://localhost:3000/free-data\n</code></pre> <p>Response: <pre><code>{\n  \"data\": \"This is free content available to everyone\",\n  \"price\": 0,\n  \"access\": \"public\"\n}\n</code></pre></p>"},{"location":"examples/typescript/express-server/#paid-endpoint-without-payment","title":"Paid Endpoint (Without Payment)","text":"<pre><code>curl http://localhost:3000/premium-data\n</code></pre> <p>Response (402 Payment Required): ```json {   \"max_amount_required\": \"0.10\",   \"asset_type\": \"SPL\",   \"asset_address\": \"DEMO_USDC_MINT\",   \"payment_address\": \"DEMO_WALLET_ADDRESS\",   \"network\": \"solana-devnet\",   \"expires_at\": \"2025-01-01T10:05:00Z\",   \"nonce\": \"...\",   \"payment_id\": \"...\",</p>"},{"location":"examples/typescript/langchain-agent/","title":"LangChain.js Payment Tool Example","text":"<p>This example demonstrates the X402 payment tool for LangChain.js, which enables payment capabilities that can be integrated with AI agents.</p>"},{"location":"examples/typescript/langchain-agent/#features","title":"Features","text":"<ul> <li>X402 Payment Tool: LangChain.js tool for making payments to access APIs</li> <li>Multiple APIs: Examples of accessing multiple paid APIs</li> <li>Custom Behavior: Configurable payment limits and RPC URLs</li> <li>TypeScript: Full type safety and modern async/await patterns</li> <li>Agent-Ready: Tool can be integrated with LangChain agents for autonomous payments</li> </ul>"},{"location":"examples/typescript/langchain-agent/#overview","title":"Overview","text":"<p>The X402PaymentTool can be integrated with LangChain.js agents to enable autonomous payment capabilities. This example shows direct tool usage for clarity. In production, integrate this tool with LangChain agents that use LLMs to decide when to make payments.</p>"},{"location":"examples/typescript/langchain-agent/#prerequisites","title":"Prerequisites","text":"<ol> <li> <p>Express.js Server: The express-server example must be running    <pre><code>cd ../express-server\npnpm install &amp;&amp; pnpm run build &amp;&amp; pnpm start\n</code></pre></p> </li> <li> <p>Wallet with Funds: You need a Solana wallet with:</p> </li> <li>SOL for transaction fees</li> <li>USDC tokens for payments (on devnet)</li> </ol>"},{"location":"examples/typescript/langchain-agent/#setup","title":"Setup","text":"<ol> <li> <p>Install dependencies:    <pre><code>pnpm install\n</code></pre></p> </li> <li> <p>The first run will create a wallet file (<code>wallet.json</code>)</p> </li> <li>Important: Fund this wallet with SOL and USDC on devnet</li> <li>Get SOL: <code>solana airdrop 1 &lt;ADDRESS&gt; --url devnet</code></li> <li>Get USDC: Use a devnet faucet</li> </ol>"},{"location":"examples/typescript/langchain-agent/#running-examples","title":"Running Examples","text":"<pre><code># Build\npnpm run build\n\n# Run\npnpm start\n\n# Or run in dev mode\npnpm run dev\n</code></pre>"},{"location":"examples/typescript/langchain-agent/#examples","title":"Examples","text":""},{"location":"examples/typescript/langchain-agent/#example-1-simple-payment-tool","title":"Example 1: Simple Payment Tool","text":"<p>Demonstrates basic tool usage: - Creates X402PaymentTool - Makes payment to access a single API - Shows direct tool invocation</p>"},{"location":"examples/typescript/langchain-agent/#example-2-multiple-apis","title":"Example 2: Multiple APIs","text":"<p>Demonstrates accessing multiple paid APIs: - Higher payment limit for multiple payments - Sequential API access - Handles multiple 402 responses</p>"},{"location":"examples/typescript/langchain-agent/#example-3-custom-payment-behavior","title":"Example 3: Custom Payment Behavior","text":"<p>Shows customization options: - Custom RPC URL - Specific payment limits - Custom tool names and descriptions</p>"},{"location":"examples/typescript/langchain-agent/#integration-with-langchain-agents","title":"Integration with LangChain Agents","text":"<p>To use this tool with a LangChain agent:</p> <p>```typescript import { createX402PaymentTool } from '@openlibx402/langchain'; import { ChatOpenAI } from '@langchain/openai';</p> <p>// Create the payment tool const paymentTool = createX402PaymentTool({   walletKeypair: yourKeypair,   maxPayment: '5.0', });</p> <p>// Use with your LangChain agent const agent = createYourAgent({   llm: new ChatOpenAI(),   tools: [paymentTool, ...otherTools], });</p> <p>// Agent can now autonomously make payments const result = await agent.invoke({   input: 'Get data from http://localhost:3000/premium-data' });</p>"},{"location":"examples/typescript/langgraph-workflow/","title":"LangGraph.js Workflow with X402 Payment Support","text":"<p>This example demonstrates how to build LangGraph.js workflows that include payment nodes for accessing paid APIs using the X402 payment protocol.</p>"},{"location":"examples/typescript/langgraph-workflow/#features","title":"Features","text":"<ul> <li>Payment Nodes: Reusable nodes for handling payments in workflows</li> <li>Conditional Routing: Route based on payment requirements</li> <li>Multi-Step Workflows: Access multiple paid APIs in sequence</li> <li>State Management: Proper state handling for payment status</li> <li>TypeScript: Full type safety with LangGraph.js</li> </ul>"},{"location":"examples/typescript/langgraph-workflow/#prerequisites","title":"Prerequisites","text":"<ol> <li> <p>Express.js Server: The express-server example must be running    <pre><code>cd ../express-server\npnpm install &amp;&amp; pnpm run build &amp;&amp; pnpm start\n</code></pre></p> </li> <li> <p>Wallet with Funds: You need a Solana wallet with:</p> </li> <li>SOL for transaction fees</li> <li>USDC tokens for payments (on devnet)</li> </ol>"},{"location":"examples/typescript/langgraph-workflow/#setup","title":"Setup","text":"<ol> <li> <p>Install dependencies:    <pre><code>pnpm install\n</code></pre></p> </li> <li> <p>Create <code>.env</code> file (optional):    <pre><code>cp .env.example .env\n</code></pre></p> </li> <li> <p>The first run will create a wallet file (<code>wallet.json</code>)</p> </li> <li>Important: Fund this wallet with SOL and USDC on devnet</li> <li>Get SOL: <code>solana airdrop 1 &lt;ADDRESS&gt; --url devnet</code></li> <li>Get USDC: Use a devnet faucet</li> </ol>"},{"location":"examples/typescript/langgraph-workflow/#running-examples","title":"Running Examples","text":"<pre><code># Build\npnpm run build\n\n# Run\npnpm start\n\n# Or run in dev mode\npnpm run dev\n</code></pre>"},{"location":"examples/typescript/langgraph-workflow/#examples","title":"Examples","text":""},{"location":"examples/typescript/langgraph-workflow/#example-1-simple-payment-workflow","title":"Example 1: Simple Payment Workflow","text":"<p>Uses <code>fetchWithPaymentNode</code> for easy payment integration: - Single node handles both fetch and payment - Minimal configuration - Automatic payment handling</p>"},{"location":"examples/typescript/langgraph-workflow/#example-2-custom-workflow-with-conditional-payment","title":"Example 2: Custom Workflow with Conditional Payment","text":"<p>Demonstrates explicit payment handling: - Separate fetch and payment nodes - Conditional routing based on payment requirements - Custom error handling</p>"},{"location":"examples/typescript/langgraph-workflow/#example-3-multi-step-research-workflow","title":"Example 3: Multi-Step Research Workflow","text":"<p>Shows complex multi-API workflows: - Access multiple paid APIs sequentially - Collect and aggregate results - State management across multiple steps</p>"},{"location":"examples/typescript/langgraph-workflow/#how-it-works","title":"How It Works","text":""},{"location":"examples/typescript/langgraph-workflow/#payment-flow","title":"Payment Flow","text":"<ol> <li>Fetch Node: Attempts to fetch API</li> <li>Check Payment: Determines if payment is required (402 response)</li> <li>Payment Node: Creates and broadcasts payment if needed</li> <li>Process Node: Processes API response</li> <li>State Updates: Tracks payment status throughout workflow</li> </ol>"},{"location":"examples/typescript/langgraph-workflow/#state-management","title":"State Management","text":"<p>```typescript interface PaymentState {   wallet_keypair: Keypair;   api_url: string;   api_response?: string;   payment_required?: boolean;   payment_completed?: boolean;   payment_error?: string;   max_payment_amount?: string; }</p>"},{"location":"examples/typescript/nextjs-app/","title":"Next.js App Example with X402 Payment Support","text":"<p>This example demonstrates how to create a Next.js application with X402 payment requirements for API endpoints, including both server-side API routes and client-side payment handling.</p>"},{"location":"examples/typescript/nextjs-app/#features","title":"Features","text":"<ul> <li>Next.js App Router - Modern Next.js 14 with App Router</li> <li>Server-side API Routes - Protected endpoints with payment requirements</li> <li>Client-side Payment Handling - React components with automatic payment flow</li> <li>Free and Premium Endpoints - Mix of public and paid content</li> <li>TypeScript - Full type safety</li> <li>Tailwind CSS - Modern styling</li> <li>X402 Protocol - Blockchain-based micropayments</li> </ul>"},{"location":"examples/typescript/nextjs-app/#setup","title":"Setup","text":""},{"location":"examples/typescript/nextjs-app/#1-install-dependencies","title":"1. Install Dependencies","text":"<p>From the monorepo root:</p> <pre><code>pnpm install\n</code></pre> <p>Or from npm:</p> <pre><code>npm install\n</code></pre>"},{"location":"examples/typescript/nextjs-app/#2-configure-environment","title":"2. Configure Environment","text":"<p>Create a <code>.env.local</code> file based on <code>.env.example</code>:</p> <pre><code>cp .env.example .env.local\n</code></pre> <p>Edit <code>.env.local</code> with your Solana wallet details:</p> <pre><code>PAYMENT_WALLET_ADDRESS=your_solana_wallet_address_here\nUSDC_MINT_ADDRESS=EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\nSOLANA_RPC_URL=https://api.devnet.solana.com\n</code></pre>"},{"location":"examples/typescript/nextjs-app/#3-build-and-run","title":"3. Build and Run","text":"<pre><code># Development mode\nnpm run dev\n\n# Build for production\nnpm run build\n\n# Start production server\nnpm start\n</code></pre> <p>The app will start on <code>http://localhost:3000</code>.</p>"},{"location":"examples/typescript/nextjs-app/#api-endpoints","title":"API Endpoints","text":""},{"location":"examples/typescript/nextjs-app/#free-endpoints","title":"Free Endpoints","text":"<ul> <li>GET /api - API information (no payment)</li> <li>GET /api/free-data - Free data access (no payment)</li> </ul>"},{"location":"examples/typescript/nextjs-app/#paid-endpoints","title":"Paid Endpoints","text":"<ul> <li>GET /api/premium-data - Premium data (0.10 USDC)</li> <li>GET /api/expensive-data - AI inference (1.00 USDC)</li> <li>GET /api/tiered-data/[tier] - Tiered content (0.05 USDC)</li> <li>POST /api/process-data - Data processing (0.25 USDC)</li> </ul>"},{"location":"examples/typescript/nextjs-app/#how-it-works","title":"How It Works","text":""},{"location":"examples/typescript/nextjs-app/#server-side-api-routes","title":"Server-Side (API Routes)","text":"<ol> <li>Initialize X402 Configuration (<code>app/api/config.ts</code>):</li> </ol> <pre><code>import { X402Config, initX402 } from \"@openlibx402/nextjs\";\n\nconst config = new X402Config({\n  paymentAddress: process.env.PAYMENT_WALLET_ADDRESS!,\n  tokenMint: process.env.USDC_MINT_ADDRESS!,\n  network: \"solana-devnet\",\n});\n\ninitX402(config);\n</code></pre> <ol> <li>Protect API Routes with <code>withPayment</code>:</li> </ol> <pre><code>import { withPayment } from \"@openlibx402/nextjs\";\n\nexport const GET = withPayment(\n  {\n    amount: \"0.10\",\n    description: \"Access to premium data\",\n  },\n  async (req, context) =&gt; {\n    return NextResponse.json({\n      data: \"Premium content\",\n      payment_id: context.payment?.paymentId,\n    });\n  }\n);\n</code></pre>"},{"location":"examples/typescript/nextjs-app/#client-side-react-components","title":"Client-Side (React Components)","text":"<ol> <li>Setup X402 Client Provider (<code>app/components/X402ClientProvider.tsx</code>):</li> </ol> <pre><code>import { X402AutoClient } from \"@openlibx402/client\";\nimport { Keypair } from \"@solana/web3.js\";\n\nconst keypair = Keypair.generate(); // Or use browser wallet\nconst client = new X402AutoClient(keypair, rpcUrl);\n</code></pre> <ol> <li>Make Requests (automatic payment handling):</li> </ol> <pre><code>const response = await client.get(\"/api/premium-data\");\n// Payment is handled automatically if required\n</code></pre>"},{"location":"examples/typescript/nextjs-app/#payment-flow","title":"Payment Flow","text":"<ol> <li>User clicks \"Try Endpoint\" button</li> <li>Client makes request to API endpoint</li> <li>Server responds with 402 Payment Required (if no payment)</li> <li>Client detects 402 and creates payment</li> <li>Client retries request with payment authorization</li> <li>Server verifies payment on-chain</li> <li>Server returns protected content</li> </ol>"},{"location":"examples/typescript/nextjs-app/#browser-wallet-integration","title":"Browser Wallet Integration","text":"<p>To integrate with browser wallets in production:</p> <pre><code>// Instead of generating a keypair\nimport { useWallet } from \"@solana/wallet-adapter-react\";\n\nconst { publicKey, signTransaction } = useWallet();\n\n// Use wallet adapter with X402Client\nconst client = new X402Client(/* wallet adapter */, rpcUrl);\n</code></pre>"},{"location":"examples/typescript/nextjs-app/#development-tips","title":"Development Tips","text":"<ol> <li>Testing without funds: The demo will show payment required errors, which is expected behavior</li> <li>Hot reload: Changes to API routes and components are automatically reflected</li> <li>TypeScript: Full type checking for both client and server code</li> <li>Tailwind CSS: Utility-first styling for rapid UI development</li> </ol>"},{"location":"examples/typescript/nextjs-app/#learn-more","title":"Learn More","text":"<ul> <li>OpenLibx402 Documentation</li> <li>X402 Protocol Specification</li> <li>Next.js Documentation</li> <li>Solana Web3.js</li> </ul>"},{"location":"examples/typescript/nuxtjs-app/","title":"Nuxt.js App Example with X402 Payment Support","text":"<p>This example demonstrates how to create a Nuxt.js application with X402 payment requirements for API endpoints, including both server-side API routes with on-chain payment verification and client-side payment handling.</p>"},{"location":"examples/typescript/nuxtjs-app/#features","title":"Features","text":"<ul> <li>Nuxt.js 4 - Modern Nuxt with Vue 3 Composition API</li> <li>Server API Routes - Protected endpoints with payment requirements</li> <li>On-Chain Payment Verification - Uses <code>@openlibx402/core</code> with <code>SolanaPaymentProcessor</code></li> <li>Client-side Payment Handling - Vue components with automatic payment flow</li> <li>Free and Premium Endpoints - Mix of public and paid content</li> <li>TypeScript - Full type safety</li> <li>Tailwind CSS - Modern styling</li> <li>X402 Protocol - Blockchain-based micropayments</li> <li>Solana Wallet Integration - Support for Phantom, Solflare, and more</li> </ul>"},{"location":"examples/typescript/nuxtjs-app/#getting-started","title":"Getting Started","text":""},{"location":"examples/typescript/nuxtjs-app/#installation","title":"Installation","text":"<pre><code>cd examples/typescript/nuxt-app\npnpm install\n</code></pre>"},{"location":"examples/typescript/nuxtjs-app/#configuration","title":"Configuration","text":"<p>Create a <code>.env</code> file:</p> <pre><code>PAYMENT_WALLET_ADDRESS=your_solana_wallet_address_here\nUSDC_MINT_ADDRESS=EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\nSOLANA_RPC_URL=https://api.devnet.solana.com\n</code></pre>"},{"location":"examples/typescript/nuxtjs-app/#running-the-app","title":"Running the App","text":"<pre><code># Development\npnpm dev\n\n# Build for production\npnpm build\n\n# Preview production build\npnpm preview\n</code></pre> <p>The app will start on <code>http://localhost:3000</code>.</p>"},{"location":"examples/typescript/nuxtjs-app/#api-endpoints","title":"API Endpoints","text":""},{"location":"examples/typescript/nuxtjs-app/#free-endpoints","title":"Free Endpoints","text":"<ul> <li>GET /api - API information (no payment)</li> <li>GET /api/free-data - Free data access (no payment)</li> </ul>"},{"location":"examples/typescript/nuxtjs-app/#paid-endpoints","title":"Paid Endpoints","text":"<ul> <li>GET /api/premium-data - Premium data (0.10 USDC)</li> <li>GET /api/expensive-data - AI inference (1.00 USDC)</li> <li>GET /api/tiered-data/[tier] - Tiered content (0.05 USDC)</li> <li>POST /api/process-data - Data processing (0.25 USDC)</li> </ul>"},{"location":"examples/typescript/nuxtjs-app/#key-features","title":"Key Features","text":""},{"location":"examples/typescript/nuxtjs-app/#server-side-implementation","title":"Server-Side Implementation","text":"<p>API routes are protected using the <code>withPayment</code> helper which: - Validates payment authorization headers - Verifies amounts and addresses - Performs on-chain verification in production mode - Returns 402 Payment Required if payment is invalid or missing</p>"},{"location":"examples/typescript/nuxtjs-app/#client-side-implementation","title":"Client-Side Implementation","text":"<p>Vue composables handle: - useWallet: Solana wallet connection and management - useX402Client: X402 payment client lifecycle - Automatic payment flow handling with 402 response interception - Support for demo mode with simulated payments</p>"},{"location":"examples/typescript/nuxtjs-app/#payment-flow","title":"Payment Flow","text":"<ol> <li>User initiates request to protected endpoint</li> <li>Server responds with 402 Payment Required</li> <li>Client displays payment request details</li> <li>User simulates or signs real payment</li> <li>Client retries request with payment authorization</li> <li>Server verifies payment and returns content</li> </ol>"},{"location":"examples/typescript/nuxtjs-app/#on-chain-verification","title":"On-Chain Verification","text":"<ul> <li>Development mode: Mock payments (no blockchain verification)</li> <li>Production mode: Full on-chain verification using Solana devnet RPC</li> <li>Enabled via <code>NODE_ENV=production</code> environment variable</li> </ul>"},{"location":"examples/typescript/nuxtjs-app/#project-structure","title":"Project Structure","text":"<pre><code>nuxt-app/\n\u251c\u2500\u2500 components/              # Vue components\n\u251c\u2500\u2500 composables/            # Vue composables (useWallet, useX402Client)\n\u251c\u2500\u2500 pages/                  # Nuxt pages\n\u251c\u2500\u2500 server/                 # Server-side code\n\u2502   \u251c\u2500\u2500 api/               # API routes\n\u2502   \u2514\u2500\u2500 utils/             # X402 configuration\n\u251c\u2500\u2500 utils/                 # Client utilities\n\u251c\u2500\u2500 assets/                # Stylesheets\n\u251c\u2500\u2500 nuxt.config.ts         # Nuxt configuration\n\u251c\u2500\u2500 tailwind.config.ts     # Tailwind config\n\u2514\u2500\u2500 package.json\n</code></pre>"},{"location":"examples/typescript/nuxtjs-app/#learn-more","title":"Learn More","text":"<ul> <li>OpenLibx402 Documentation</li> <li>X402 Protocol Specification</li> <li>Nuxt.js Documentation</li> <li>Vue 3 Composition API</li> </ul>"},{"location":"examples/typescript/vue-app/","title":"Vue.js App Example with X402 Payment Support","text":"<p>This example demonstrates how to create a Vue.js 3 application with X402 payment requirements for API endpoints, including a separate Express API server with payment protection and client-side payment handling.</p>"},{"location":"examples/typescript/vue-app/#features","title":"Features","text":"<ul> <li>Vue 3 with Composition API - Modern Vue using <code>&lt;script setup&gt;</code> syntax</li> <li>Express API Server - Separate backend with <code>@openlibx402/express</code> middleware</li> <li>On-Chain Payment Verification - Uses <code>SolanaPaymentProcessor</code> to verify transactions on Solana devnet</li> <li>Client-side Payment Handling - Vue components with automatic payment flow</li> <li>Free and Premium Endpoints - Mix of public and paid content</li> <li>TypeScript - Full type safety</li> <li>Vite - Lightning-fast dev server and HMR</li> <li>Tailwind CSS - Modern styling</li> <li>X402 Protocol - Blockchain-based micropayments</li> <li>Solana Wallet Integration - Support for Phantom, Solflare, and more</li> </ul>"},{"location":"examples/typescript/vue-app/#architecture","title":"Architecture","text":"<p>This example uses a client-server architecture: - Frontend (Port 5173): Vue.js app built with Vite - Backend (Port 3001): Express.js API server with X402 middleware - Proxy: Vite proxies <code>/api/*</code> requests to the Express server</p>"},{"location":"examples/typescript/vue-app/#getting-started","title":"Getting Started","text":""},{"location":"examples/typescript/vue-app/#installation","title":"Installation","text":"<pre><code>cd examples/typescript/vue-app\npnpm install\n</code></pre>"},{"location":"examples/typescript/vue-app/#configuration","title":"Configuration","text":"<p>Create a <code>.env</code> file:</p> <pre><code># Server configuration\nPAYMENT_WALLET_ADDRESS=your_solana_wallet_address_here\nUSDC_MINT_ADDRESS=EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\nSOLANA_RPC_URL=https://api.devnet.solana.com\n\n# Client configuration (Vite variables)\nVITE_SOLANA_RPC_URL=https://api.devnet.solana.com\nVITE_API_URL=http://localhost:3001\n</code></pre>"},{"location":"examples/typescript/vue-app/#running-the-app","title":"Running the App","text":"<pre><code># Start both frontend and backend\npnpm dev\n\n# Frontend: http://localhost:5173\n# Backend: http://localhost:3001\n</code></pre> <p>For separate development:</p> <pre><code># Terminal 1: Frontend only\npnpm dev:vite\n\n# Terminal 2: Backend only\npnpm dev:server\n</code></pre>"},{"location":"examples/typescript/vue-app/#api-endpoints","title":"API Endpoints","text":""},{"location":"examples/typescript/vue-app/#free-endpoints","title":"Free Endpoints","text":"<ul> <li>GET /api - API information (no payment)</li> <li>GET /api/free-data - Free data access (no payment)</li> </ul>"},{"location":"examples/typescript/vue-app/#paid-endpoints","title":"Paid Endpoints","text":"<ul> <li>GET /api/premium-data - Premium data (0.10 USDC)</li> <li>GET /api/expensive-data - AI inference (1.00 USDC)</li> <li>GET /api/tiered-data/:tier - Tiered content (0.05 USDC)</li> <li>POST /api/process-data - Data processing (0.25 USDC)</li> </ul>"},{"location":"examples/typescript/vue-app/#key-features","title":"Key Features","text":""},{"location":"examples/typescript/vue-app/#backend-express-server","title":"Backend (Express Server)","text":"<p>API routes are protected using the <code>paymentRequired</code> middleware which: - Validates payment authorization headers - Verifies amounts and addresses - Performs on-chain verification in production mode - Returns 402 Payment Required if payment is invalid or missing</p>"},{"location":"examples/typescript/vue-app/#frontend-vuejs","title":"Frontend (Vue.js)","text":"<p>Vue composables and components handle: - useWallet: Solana wallet connection and management - useX402Client: X402 payment client lifecycle - EndpointCard: Component for free endpoints - X402EndpointCard: Component for paid endpoints with payment flow - Automatic 402 response handling with payment retry logic</p>"},{"location":"examples/typescript/vue-app/#payment-flow","title":"Payment Flow","text":"<ol> <li>User initiates request to protected endpoint</li> <li>Server responds with 402 Payment Required</li> <li>Client displays payment request details</li> <li>User simulates or signs real payment</li> <li>Client retries request with payment authorization</li> <li>Server verifies payment and returns content</li> </ol>"},{"location":"examples/typescript/vue-app/#on-chain-verification","title":"On-Chain Verification","text":"<ul> <li>Development mode: Mock payments (no blockchain verification)</li> <li>Production mode: Full on-chain verification using Solana devnet RPC</li> <li>Enabled via <code>NODE_ENV=production</code> environment variable</li> </ul>"},{"location":"examples/typescript/vue-app/#project-structure","title":"Project Structure","text":"<pre><code>vue-app/\n\u251c\u2500\u2500 server/                # Express API server\n\u2502   \u2514\u2500\u2500 index.ts          # Express app with X402 routes\n\u251c\u2500\u2500 src/                  # Vue.js frontend\n\u2502   \u251c\u2500\u2500 components/       # Vue components\n\u2502   \u251c\u2500\u2500 composables/      # Vue composables\n\u2502   \u251c\u2500\u2500 utils/            # Utility functions\n\u2502   \u251c\u2500\u2500 assets/           # Stylesheets\n\u2502   \u251c\u2500\u2500 App.vue           # Main app component\n\u2502   \u2514\u2500\u2500 main.ts           # Entry point\n\u251c\u2500\u2500 vite.config.ts        # Vite configuration\n\u251c\u2500\u2500 tailwind.config.ts    # Tailwind config\n\u2514\u2500\u2500 package.json\n</code></pre>"},{"location":"examples/typescript/vue-app/#learn-more","title":"Learn More","text":"<ul> <li>OpenLibx402 Documentation</li> <li>X402 Protocol Specification</li> <li>Vue.js Documentation</li> <li>Vite Documentation</li> <li>Express.js Documentation</li> </ul>"},{"location":"go/","title":"Go Implementation","text":"<p>Welcome to the OpenLibx402 Go implementation documentation. This section covers all Go packages, libraries, middleware, and examples for building X402-enabled APIs and clients.</p>"},{"location":"go/#overview","title":"Overview","text":"<p>The Go implementation provides:</p> <ul> <li>Core Library - X402 protocol implementation with models, errors, and Solana payment processing</li> <li>Client Library - HTTP client with automatic and explicit payment handling</li> <li>Middleware - Integration with popular Go web frameworks (net/http, Echo)</li> <li>Examples - Complete working examples for server and client implementations</li> </ul>"},{"location":"go/#quick-navigation","title":"Quick Navigation","text":""},{"location":"go/#libraries","title":"\ud83d\udcda Libraries","text":"<ul> <li>Core Library - Payment models, errors, and Solana processor</li> <li>Client Library - X402 HTTP client with auto-payment support</li> </ul>"},{"location":"go/#middleware","title":"\ud83d\udd17 Middleware","text":"<ul> <li>net/http Middleware - Standard Go net/http integration</li> <li>Echo Middleware - Echo web framework integration</li> </ul>"},{"location":"go/#examples","title":"\ud83d\ude80 Examples","text":"<ul> <li>net/http Server - Complete server with multiple pricing tiers</li> <li>Echo Server - Echo framework server with dynamic pricing</li> </ul>"},{"location":"go/#getting-started","title":"\ud83d\udcd6 Getting Started","text":"<ul> <li>Installation</li> <li>Quick Start Server</li> <li>Quick Start Client</li> </ul>"},{"location":"go/#reference","title":"\ud83d\udd27 Reference","text":"<ul> <li>API Reference</li> <li>Configuration</li> <li>Error Handling</li> </ul>"},{"location":"go/#key-features","title":"Key Features","text":"<p>\u2728 One-Line Integration - Add payment requirements with minimal code \ud83e\udd16 Automatic Payments - Clients automatically handle payment flows \u26a1 Instant Settlement - ~200ms on Solana \ud83d\udcb0 Micropayments - Support payments as low as $0.001 \ud83d\udd10 Secure - SSRF protection, payment verification, nonce-based replay protection \ud83c\udf10 Framework Agnostic - Works with net/http, Echo, and custom implementations</p>"},{"location":"go/#import-paths","title":"Import Paths","text":"<pre><code>// Core protocol\nimport \"github.com/openlibx402/go/openlibx402-core\"\n\n// HTTP client\nimport \"github.com/openlibx402/go/openlibx402-client\"\n\n// net/http middleware\nimport nethttp \"github.com/openlibx402/go/openlibx402-nethttp\"\n\n// Echo middleware\nimport echox402 \"github.com/openlibx402/go/openlibx402-echo\"\n</code></pre>"},{"location":"go/#installation","title":"Installation","text":"<pre><code># Core package (required)\ngo get github.com/openlibx402/go/openlibx402-core\n\n# Client (for consuming paid APIs)\ngo get github.com/openlibx402/go/openlibx402-client\n\n# Middleware for your framework\ngo get github.com/openlibx402/go/openlibx402-nethttp\n# or\ngo get github.com/openlibx402/go/openlibx402-echo\n</code></pre>"},{"location":"go/#the-x402-flow","title":"The X402 Flow","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  AI Agent   \u2502  \u25001\u2500\u2192   \u2502  API Server  \u2502         \u2502 Blockchain \u2502\n\u2502   (Client)  \u2502         \u2502   (Server)   \u2502         \u2502  (Solana)  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n     \u2502                        \u2502                        \u2502\n     \u2502  GET /data             \u2502                        \u2502\n     \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192\u2502                        \u2502\n     \u2502                        \u2502                        \u2502\n     \u2502  402 Payment Required  \u2502                        \u2502\n     \u2502  + Payment Details     \u2502                        \u2502\n     \u2502\u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524                        \u2502\n     \u2502                        \u2502                        \u2502\n     \u2502  Create &amp; Broadcast    \u2502                        \u2502\n     \u2502  Payment Transaction   \u2502                        \u2502\n     \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192\u2502\n     \u2502                        \u2502                        \u2502\n     \u2502                        \u2502   Verify Transaction   \u2502\n     \u2502                        \u2502\u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n     \u2502                        \u2502                        \u2502\n     \u2502  GET /data             \u2502                        \u2502\n     \u2502  + Payment Auth Header \u2502                        \u2502\n     \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192\u2502                        \u2502\n     \u2502                        \u2502                        \u2502\n     \u2502  200 OK + Data         \u2502                        \u2502\n     \u2502\u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524                        \u2502\n</code></pre>"},{"location":"go/#support","title":"Support","text":"<p>For issues, questions, or contributions: - GitHub Issues - GitHub Discussions - X402 Protocol</p>"},{"location":"go/#next-steps","title":"Next Steps","text":"<p>Start with the Installation guide and choose your path:</p> <ul> <li>Building a Server? \u2192 Server Quick Start</li> <li>Building a Client? \u2192 Client Quick Start</li> <li>Need Details? \u2192 API Reference</li> </ul>"},{"location":"go/examples/echo-server/","title":"Echo Server Example","text":"<p>Complete working example of an X402-enabled server using the Echo web framework.</p>"},{"location":"go/examples/echo-server/#overview","title":"Overview","text":"<p>This example demonstrates:</p> <ul> <li>Free and paid endpoints</li> <li>Multiple pricing tiers</li> <li>Dynamic pricing by URL parameter</li> <li>Payment verification and logging</li> <li>POST request handling with payment</li> </ul>"},{"location":"go/examples/echo-server/#running-the-example","title":"Running the Example","text":""},{"location":"go/examples/echo-server/#1-setup-environment","title":"1. Setup Environment","text":"<pre><code># Clone and navigate to example\ncd examples/go/echo-server\n\n# Set your Solana wallet\nexport X402_PAYMENT_ADDRESS=\"YOUR_SOLANA_WALLET_ADDRESS\"\nexport X402_TOKEN_MINT=\"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\"\nexport X402_NETWORK=\"solana-devnet\"\n</code></pre>"},{"location":"go/examples/echo-server/#2-install-dependencies","title":"2. Install Dependencies","text":"<pre><code>go mod tidy\n</code></pre>"},{"location":"go/examples/echo-server/#3-run-server","title":"3. Run Server","text":"<pre><code>go run main.go\n</code></pre> <p>Output: <pre><code>\ud83d\ude80 X402 Echo Server starting on port 8080\n\ud83d\udccd Network: solana-devnet\n\ud83d\udcb0 Payment Address: YOUR_WALLET_ADDRESS\n\ud83e\ude99 Token Mint: EPjFWdd5...\n\nAvailable endpoints:\n  GET  /api/free-data         - Free access (no payment)\n  GET  /api/premium-data      - $0.10 USDC\n  GET  /api/expensive-data    - $1.00 USDC\n  POST /api/process           - $0.50 USDC\n  GET  /api/tiered/:tier      - Dynamic pricing by tier\n</code></pre></p>"},{"location":"go/examples/echo-server/#4-test-endpoints","title":"4. Test Endpoints","text":"<p>Free endpoint (no payment needed): <pre><code>curl http://localhost:8080/api/free-data | jq\n</code></pre></p> <p>Response: <pre><code>{\n  \"message\": \"This is free public data\",\n  \"data\": {\n    \"timestamp\": \"2024-01-01T00:00:00Z\",\n    \"value\": \"basic information\"\n  }\n}\n</code></pre></p> <p>Premium endpoint (payment required): <pre><code>curl http://localhost:8080/api/premium-data\n</code></pre></p> <p>Response (402 Payment Required): <pre><code>{\n  \"max_amount_required\": \"0.10\",\n  \"asset_type\": \"SPL\",\n  \"asset_address\": \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\",\n  \"payment_address\": \"YOUR_WALLET_ADDRESS\",\n  \"network\": \"solana-devnet\",\n  \"expires_at\": \"2025-01-01T00:05:00Z\",\n  \"nonce\": \"abc123...\",\n  \"payment_id\": \"def456...\",\n  \"resource\": \"/api/premium-data\",\n  \"description\": \"Premium market data access\"\n}\n</code></pre></p> <p>Tiered endpoint with dynamic pricing: <pre><code># Basic tier ($0.05)\ncurl http://localhost:8080/api/tiered/basic\n\n# Standard tier ($0.10)\ncurl http://localhost:8080/api/tiered/standard\n\n# Premium tier ($0.25)\ncurl http://localhost:8080/api/tiered/premium\n\n# Ultimate tier ($1.00)\ncurl http://localhost:8080/api/tiered/ultimate\n</code></pre></p> <p>POST endpoint with data: <pre><code>curl -X POST -H \"Content-Type: application/json\" \\\n  -d '{\"data\": \"to process\"}' \\\n  http://localhost:8080/api/process\n</code></pre></p>"},{"location":"go/examples/echo-server/#server-code","title":"Server Code","text":"<p>The server (<code>main.go</code>) contains:</p>"},{"location":"go/examples/echo-server/#configuration","title":"Configuration","text":"<pre><code>echox402.InitX402(&amp;echox402.Config{\n    PaymentAddress: os.Getenv(\"X402_PAYMENT_ADDRESS\"),\n    TokenMint:      os.Getenv(\"X402_TOKEN_MINT\"),\n    Network:        \"solana-devnet\",\n    AutoVerify:     true,\n})\n</code></pre>"},{"location":"go/examples/echo-server/#endpoint-setup","title":"Endpoint Setup","text":"<pre><code>// Free endpoint\ne.GET(\"/api/free-data\", freeDataHandler)\n\n// Premium endpoints with different prices\ne.GET(\"/api/premium-data\", premiumDataHandler, echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n    Amount:      \"0.10\",\n    Description: \"Premium market data access\",\n}))\n\n// Dynamic pricing by tier\ne.GET(\"/api/tiered/:tier\", tieredDataHandler)\n</code></pre>"},{"location":"go/examples/echo-server/#handler-examples","title":"Handler Examples","text":""},{"location":"go/examples/echo-server/#free-handler","title":"Free Handler","text":"<pre><code>func freeDataHandler(c echo.Context) error {\n    data := map[string]interface{}{\n        \"message\": \"This is free public data\",\n        \"data\": map[string]interface{}{\n            \"timestamp\": \"2024-01-01T00:00:00Z\",\n            \"value\":     \"basic information\",\n        },\n    }\n    return c.JSON(http.StatusOK, data)\n}\n</code></pre>"},{"location":"go/examples/echo-server/#premium-handler-with-payment-access","title":"Premium Handler (with Payment Access)","text":"<pre><code>func premiumDataHandler(c echo.Context) error {\n    // Access payment details if needed\n    auth := echox402.GetPaymentAuthorization(c)\n    if auth != nil {\n        log.Printf(\"\u2705 Payment received: %s USDC from %s\",\n            auth.ActualAmount, auth.PublicKey)\n    }\n\n    data := map[string]interface{}{\n        \"message\": \"This is premium data (paid $0.10)\",\n        \"data\": map[string]interface{}{\n            \"timestamp\": \"2024-01-01T00:00:00Z\",\n            \"value\":     \"premium market data\",\n            \"metrics\": map[string]interface{}{\n                \"price\":  42.50,\n                \"volume\": 1000000,\n                \"trend\":  \"bullish\",\n            },\n        },\n    }\n    return c.JSON(http.StatusOK, data)\n}\n</code></pre>"},{"location":"go/examples/echo-server/#post-handler-with-payment","title":"POST Handler with Payment","text":"<pre><code>func processHandler(c echo.Context) error {\n    auth := echox402.GetPaymentAuthorization(c)\n    if auth != nil {\n        log.Printf(\"\u2705 Payment received: %s USDC from %s\",\n            auth.ActualAmount, auth.PublicKey)\n    }\n\n    // Parse request body\n    var input map[string]interface{}\n    if err := c.Bind(&amp;input); err != nil {\n        return echo.NewHTTPError(http.StatusBadRequest, \"Invalid JSON\")\n    }\n\n    // Process the data\n    result := map[string]interface{}{\n        \"message\": \"Data processed successfully (paid $0.50)\",\n        \"input\":   input,\n        \"result\": map[string]interface{}{\n            \"processed\": true,\n            \"timestamp\": \"2024-01-01T00:00:00Z\",\n            \"output\":    \"Processed: \" + fmt.Sprint(input),\n        },\n    }\n    return c.JSON(http.StatusOK, result)\n}\n</code></pre>"},{"location":"go/examples/echo-server/#dynamic-pricing-handler","title":"Dynamic Pricing Handler","text":"<pre><code>func tieredDataHandler(c echo.Context) error {\n    tier := c.Param(\"tier\")\n\n    // Define pricing per tier\n    pricing := map[string]string{\n        \"basic\":    \"0.05\",\n        \"standard\": \"0.10\",\n        \"premium\":  \"0.25\",\n        \"ultimate\": \"1.00\",\n    }\n\n    amount, ok := pricing[tier]\n    if !ok {\n        return echo.NewHTTPError(http.StatusBadRequest, \"Invalid tier\")\n    }\n\n    // Apply payment middleware dynamically\n    paymentMiddleware := echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n        Amount:      amount,\n        Description: fmt.Sprintf(\"Tiered data access - %s tier\", tier),\n    })\n\n    // Wrap handler with payment middleware\n    handler := paymentMiddleware(func(c echo.Context) error {\n        auth := echox402.GetPaymentAuthorization(c)\n        if auth != nil {\n            log.Printf(\"\u2705 Payment received: %s USDC from %s for %s tier\",\n                auth.ActualAmount, auth.PublicKey, tier)\n        }\n\n        data := map[string]interface{}{\n            \"message\": fmt.Sprintf(\"This is %s tier data (paid $%s)\", tier, amount),\n            \"tier\":    tier,\n            \"data\": map[string]interface{}{\n                \"timestamp\": \"2024-01-01T00:00:00Z\",\n                \"value\":     fmt.Sprintf(\"%s tier content\", tier),\n                \"quality\":   tier,\n            },\n        }\n        return c.JSON(http.StatusOK, data)\n    })\n\n    return handler(c)\n}\n</code></pre>"},{"location":"go/examples/echo-server/#client-example","title":"Client Example","text":""},{"location":"go/examples/echo-server/#automatic-payment","title":"Automatic Payment","text":"<p>The client automatically handles 402 responses:</p> <pre><code># Set your wallet private key\nexport X402_PRIVATE_KEY=\"your-base58-private-key\"\n\n# Run client\ngo run client_example.go\n</code></pre> <p>The client will: 1. Request protected endpoint 2. Receive 402 response 3. Parse payment request 4. Create payment transaction 5. Broadcast to Solana 6. Retry with payment authorization 7. Display response</p>"},{"location":"go/examples/echo-server/#auto-client-code","title":"Auto Client Code","text":"<pre><code>client := client.NewAutoClient(walletKeypair, \"\", &amp;client.AutoClientOptions{\n    MaxPaymentAmount: \"10.0\",\n    AutoRetry:        true,\n    AllowLocal:       true,\n})\ndefer client.Close()\n\n// Automatically handles payment\nresp, err := client.Get(context.Background(), \"http://localhost:8080/api/premium-data\")\n</code></pre>"},{"location":"go/examples/echo-server/#project-structure","title":"Project Structure","text":"<pre><code>echo-server/\n\u251c\u2500\u2500 main.go              # Server with multiple endpoints\n\u251c\u2500\u2500 go.mod              # Module definition\n\u2514\u2500\u2500 README.md           # This file\n</code></pre>"},{"location":"go/examples/echo-server/#endpoint-details","title":"Endpoint Details","text":""},{"location":"go/examples/echo-server/#apifree-data-free","title":"/api/free-data (Free)","text":"<p>No payment required. Returns basic data.</p> <pre><code>curl http://localhost:8080/api/free-data | jq\n</code></pre>"},{"location":"go/examples/echo-server/#apipremium-data-010","title":"/api/premium-data ($0.10)","text":"<p>Requires $0.10 USDC payment. Returns market data.</p> <pre><code># First request returns 402\ncurl http://localhost:8080/api/premium-data\n\n# After payment with auth header\ncurl -H \"X-Payment-Authorization: &lt;base64&gt;\" http://localhost:8080/api/premium-data\n</code></pre>"},{"location":"go/examples/echo-server/#apiexpensive-data-100","title":"/api/expensive-data ($1.00)","text":"<p>Requires $1.00 USDC payment. Returns exclusive insights.</p> <pre><code>curl http://localhost:8080/api/expensive-data\n</code></pre>"},{"location":"go/examples/echo-server/#apiprocess-050","title":"/api/process ($0.50)","text":"<p>POST endpoint requiring $0.50 USDC. Processes data.</p> <pre><code>curl -X POST -H \"Content-Type: application/json\" \\\n  -d '{\"data\": \"to process\"}' \\\n  http://localhost:8080/api/process\n</code></pre>"},{"location":"go/examples/echo-server/#apitieredtier-variable","title":"/api/tiered/:tier (Variable)","text":"<p>Dynamic pricing based on tier parameter: - <code>basic</code>: $0.05 - <code>standard</code>: $0.10 - <code>premium</code>: $0.25 - <code>ultimate</code>: $1.00</p> <pre><code>curl http://localhost:8080/api/tiered/premium\n</code></pre>"},{"location":"go/examples/echo-server/#configuration-options","title":"Configuration Options","text":""},{"location":"go/examples/echo-server/#environment-variables","title":"Environment Variables","text":"<pre><code># Required\nX402_PAYMENT_ADDRESS=\"YOUR_SOLANA_WALLET\"\nX402_TOKEN_MINT=\"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\"\n\n# Optional\nX402_NETWORK=\"solana-devnet\"  # or solana-mainnet\nX402_RPC_URL=\"https://api.devnet.solana.com\"\nPORT=8080\n</code></pre>"},{"location":"go/examples/echo-server/#per-endpoint-configuration","title":"Per-Endpoint Configuration","text":"<p>In <code>main.go</code>, modify the <code>PaymentRequiredOptions</code>:</p> <pre><code>echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n    Amount:      \"0.10\",\n    Description: \"Custom description\",\n    ExpiresIn:   300,  // Seconds\n    AutoVerify:  true, // Verify on-chain\n})\n</code></pre>"},{"location":"go/examples/echo-server/#middleware-setup","title":"Middleware Setup","text":"<p>The example uses Echo's standard middleware:</p> <pre><code>// Request logging\ne.Use(middleware.Logger())\n\n// Panic recovery\ne.Use(middleware.Recover())\n\n// CORS support\ne.Use(middleware.CORS())\n</code></pre> <p>Add the X402 payment middleware on specific routes:</p> <pre><code>e.GET(\"/api/premium\", handler, echox402.PaymentRequired(opts))\n</code></pre>"},{"location":"go/examples/echo-server/#testing-locally","title":"Testing Locally","text":""},{"location":"go/examples/echo-server/#test-without-real-payments","title":"Test Without Real Payments","text":"<p>For development, test the payment flow without real transactions:</p> <ol> <li>Use devnet tokens (free from faucet)</li> <li>Set <code>AutoVerify: false</code> to skip on-chain verification</li> <li>Use client with <code>AllowLocal: true</code></li> </ol>"},{"location":"go/examples/echo-server/#mock-payment-response","title":"Mock Payment Response","text":"<p>For testing without a server:</p> <pre><code>// Simulate 402 response\nresp := &amp;http.Response{\n    StatusCode: http.StatusPaymentRequired,\n    Body:       io.NopCloser(bytes.NewBufferString(paymentJSON)),\n}\n\n// Test parsing\npaymentReq, err := client.ParsePaymentRequest(resp)\n</code></pre>"},{"location":"go/examples/echo-server/#production-considerations","title":"Production Considerations","text":""},{"location":"go/examples/echo-server/#1-use-mainnet","title":"1. Use Mainnet","text":"<p>Update environment: <pre><code>export X402_NETWORK=\"solana-mainnet\"\nexport X402_RPC_URL=\"https://api.mainnet-beta.solana.com\"\n</code></pre></p>"},{"location":"go/examples/echo-server/#2-enable-https","title":"2. Enable HTTPS","text":"<pre><code>e.StartTLS(\":443\", \"cert.pem\", \"key.pem\")\n</code></pre>"},{"location":"go/examples/echo-server/#3-add-rate-limiting","title":"3. Add Rate Limiting","text":"<pre><code>import \"golang.org/x/time/rate\"\n\nvar limiter = rate.NewLimiter(100, 10)\n\nfunc rateLimited(next echo.HandlerFunc) echo.HandlerFunc {\n    return func(c echo.Context) error {\n        if !limiter.Allow() {\n            return echo.NewHTTPError(http.StatusTooManyRequests, \"Rate limited\")\n        }\n        return next(c)\n    }\n}\n\ne.Use(rateLimited)\n</code></pre>"},{"location":"go/examples/echo-server/#4-add-logging","title":"4. Add Logging","text":"<pre><code>e.Use(middleware.LoggerWithConfig(middleware.LoggerConfig{\n    Format: \"[${time_rfc3339}] ${status} ${method} ${path}\\n\",\n}))\n</code></pre>"},{"location":"go/examples/echo-server/#5-monitor-payments","title":"5. Monitor Payments","text":"<pre><code>func logPayment(auth *core.PaymentAuthorization) {\n    log.Printf(\"[PAYMENT] ID:%s Amount:%s Payer:%s TX:%s\",\n        auth.PaymentID,\n        auth.ActualAmount,\n        auth.PublicKey[:8],\n        auth.TransactionHash[:8])\n}\n</code></pre>"},{"location":"go/examples/echo-server/#6-graceful-shutdown","title":"6. Graceful Shutdown","text":"<pre><code>import \"os/signal\"\n\ngo func() {\n    if err := e.Start(\":8080\"); err != nil {\n        e.Logger.Info(\"shutting down:\", err)\n    }\n}()\n\nquit := make(chan os.Signal, 1)\nsignal.Notify(quit, syscall.SIGINT, syscall.SIGTERM)\n&lt;-quit\n\nctx, cancel := context.WithTimeout(context.Background(), 10*time.Second)\ndefer cancel()\nif err := e.Shutdown(ctx); err != nil {\n    e.Logger.Fatal(err)\n}\n</code></pre>"},{"location":"go/examples/echo-server/#troubleshooting","title":"Troubleshooting","text":""},{"location":"go/examples/echo-server/#402-responses-even-after-payment","title":"402 responses even after payment","text":"<ul> <li>Check payment amount matches exactly</li> <li>Verify payment address is correct</li> <li>Ensure RPC endpoint is accessible</li> <li>Check network configuration (devnet vs mainnet)</li> </ul>"},{"location":"go/examples/echo-server/#server-wont-start","title":"Server won't start","text":"<ul> <li>Check port is available: <code>lsof -i :8080</code></li> <li>Verify environment variables are set</li> <li>Ensure dependencies are installed: <code>go mod tidy</code></li> </ul>"},{"location":"go/examples/echo-server/#payment-verification-failures","title":"Payment verification failures","text":"<ul> <li>Disable <code>AutoVerify: false</code> temporarily for testing</li> <li>Check Solana network is operational</li> <li>Verify RPC endpoint is responding</li> </ul>"},{"location":"go/examples/echo-server/#echo-context-issues","title":"Echo context issues","text":"<ul> <li>Ensure payment middleware is added to route definition</li> <li>Payment middleware must be called after route handler is defined</li> <li>Use <code>echox402.GetPaymentAuthorization(c)</code> to access payment in handler</li> </ul>"},{"location":"go/examples/echo-server/#extended-examples","title":"Extended Examples","text":""},{"location":"go/examples/echo-server/#route-groups-with-different-tiers","title":"Route Groups with Different Tiers","text":"<pre><code>// Free tier\nfree := e.Group(\"/api/free\")\nfree.GET(\"/data\", freeDataHandler)\n\n// Premium tier\npremium := e.Group(\"/api/premium\", echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n    Amount: \"0.10\",\n}))\npremium.GET(\"/data\", premiumDataHandler)\npremium.POST(\"/export\", exportHandler)\n\n// Enterprise tier\nenterprise := e.Group(\"/api/enterprise\", echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n    Amount: \"5.00\",\n}))\nenterprise.GET(\"/analytics\", analyticsHandler)\nenterprise.GET(\"/export\", enterpriseExportHandler)\n</code></pre>"},{"location":"go/examples/echo-server/#subscription-based-access","title":"Subscription-Based Access","text":"<p>Track payments and allow multiple requests:</p> <pre><code>type Subscription struct {\n    Address    string\n    PaidUntil  time.Time\n    Requests   int\n}\n\nfunc checkSubscription(auth *core.PaymentAuthorization) bool {\n    // Check if payer has active subscription\n    return true\n}\n</code></pre>"},{"location":"go/examples/echo-server/#custom-error-responses","title":"Custom Error Responses","text":"<pre><code>e.HTTPErrorHandler = func(err error, c echo.Context) {\n    code := http.StatusInternalServerError\n    message := \"Internal Server Error\"\n\n    if he, ok := err.(*echo.HTTPError); ok {\n        code = he.Code\n        message = fmt.Sprint(he.Message)\n    }\n\n    c.JSON(code, map[string]interface{}{\n        \"error\": message,\n    })\n}\n</code></pre>"},{"location":"go/examples/echo-server/#see-also","title":"See Also","text":"<ul> <li>net/http Server Example</li> <li>Echo Middleware Docs</li> <li>Server Quick Start</li> <li>Client Library Docs</li> </ul>"},{"location":"go/examples/nethttp-server/","title":"net/http Server Example","text":"<p>Complete working example of an X402-enabled server using Go's standard <code>net/http</code> package.</p>"},{"location":"go/examples/nethttp-server/#overview","title":"Overview","text":"<p>This example demonstrates:</p> <ul> <li>Free and paid endpoints</li> <li>Multiple pricing tiers</li> <li>Payment verification</li> <li>Processing payment details in handlers</li> </ul>"},{"location":"go/examples/nethttp-server/#running-the-example","title":"Running the Example","text":""},{"location":"go/examples/nethttp-server/#1-setup-environment","title":"1. Setup Environment","text":"<pre><code># Clone and navigate to example\ncd examples/go/nethttp-server\n\n# Set your Solana wallet\nexport X402_PAYMENT_ADDRESS=\"YOUR_SOLANA_WALLET_ADDRESS\"\nexport X402_TOKEN_MINT=\"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\"\nexport X402_NETWORK=\"solana-devnet\"\n</code></pre>"},{"location":"go/examples/nethttp-server/#2-install-dependencies","title":"2. Install Dependencies","text":"<pre><code>go mod tidy\n</code></pre>"},{"location":"go/examples/nethttp-server/#3-run-server","title":"3. Run Server","text":"<pre><code>go run main.go\n</code></pre> <p>Output: <pre><code>\ud83d\ude80 X402 Server starting on port 8080\n\ud83d\udccd Network: solana-devnet\n\ud83d\udcb0 Payment Address: YOUR_WALLET_ADDRESS\n\ud83e\ude99 Token Mint: EPjFWdd5...\n\nAvailable endpoints:\n  GET  /api/free-data       - Free access (no payment)\n  GET  /api/premium-data    - $0.10 USDC\n  GET  /api/expensive-data  - $1.00 USDC\n  POST /api/process         - $0.50 USDC\n</code></pre></p>"},{"location":"go/examples/nethttp-server/#4-test-endpoints","title":"4. Test Endpoints","text":"<p>Free endpoint (no payment needed): <pre><code>curl http://localhost:8080/api/free-data\n</code></pre></p> <p>Response: <pre><code>{\n  \"message\": \"This is free public data\",\n  \"data\": {\n    \"timestamp\": \"2024-01-01T00:00:00Z\",\n    \"value\": \"basic information\"\n  }\n}\n</code></pre></p> <p>Premium endpoint (payment required): <pre><code>curl http://localhost:8080/api/premium-data\n</code></pre></p> <p>Response (402 Payment Required): <pre><code>{\n  \"max_amount_required\": \"0.10\",\n  \"asset_type\": \"SPL\",\n  \"asset_address\": \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\",\n  \"payment_address\": \"YOUR_WALLET_ADDRESS\",\n  \"network\": \"solana-devnet\",\n  \"expires_at\": \"2025-01-01T00:05:00Z\",\n  \"nonce\": \"abc123...\",\n  \"payment_id\": \"def456...\",\n  \"resource\": \"/api/premium-data\",\n  \"description\": \"Premium market data access\"\n}\n</code></pre></p>"},{"location":"go/examples/nethttp-server/#server-code","title":"Server Code","text":"<p>The server (<code>main.go</code>) contains:</p>"},{"location":"go/examples/nethttp-server/#configuration","title":"Configuration","text":"<pre><code>nethttp.InitX402(&amp;nethttp.Config{\n    PaymentAddress: os.Getenv(\"X402_PAYMENT_ADDRESS\"),\n    TokenMint:      os.Getenv(\"X402_TOKEN_MINT\"),\n    Network:        \"solana-devnet\",\n    AutoVerify:     true,\n})\n</code></pre>"},{"location":"go/examples/nethttp-server/#endpoint-setup","title":"Endpoint Setup","text":"<pre><code>// Free endpoint\nmux.HandleFunc(\"/api/free-data\", freeDataHandler)\n\n// Premium endpoints with different prices\nmux.Handle(\"/api/premium-data\", nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n    Amount:      \"0.10\",\n    Description: \"Premium market data access\",\n})(http.HandlerFunc(premiumDataHandler)))\n</code></pre>"},{"location":"go/examples/nethttp-server/#client-example","title":"Client Example","text":""},{"location":"go/examples/nethttp-server/#automatic-payment","title":"Automatic Payment","text":"<p>The <code>client_example.go</code> shows automatic payment:</p> <pre><code># Set your wallet private key\nexport X402_PRIVATE_KEY=\"your-base58-private-key\"\n\n# Run client\ngo run client_example.go\n</code></pre> <p>The client will: 1. Request protected endpoint 2. Receive 402 response 3. Parse payment request 4. Create payment transaction 5. Broadcast to Solana 6. Retry with payment authorization 7. Display response</p>"},{"location":"go/examples/nethttp-server/#auto-client-code","title":"Auto Client Code","text":"<pre><code>client := client.NewAutoClient(walletKeypair, \"\", &amp;client.AutoClientOptions{\n    MaxPaymentAmount: \"10.0\",\n    AutoRetry:        true,\n    AllowLocal:       true,\n})\ndefer client.Close()\n\n// Automatically handles payment\nresp, err := client.Get(context.Background(), \"http://localhost:8080/api/premium-data\")\n</code></pre>"},{"location":"go/examples/nethttp-server/#explicit-client-code","title":"Explicit Client Code","text":"<pre><code>// Manual payment control\nclient := client.NewX402Client(walletKeypair, \"\", nil, true)\ndefer client.Close()\n\nresp, err := client.Get(ctx, url, nil)\n\nif client.PaymentRequired(resp) {\n    paymentReq, _ := client.ParsePaymentRequest(resp)\n    auth, _ := client.CreatePayment(ctx, paymentReq, \"\")\n    resp, _ = client.Get(ctx, url, auth)\n}\n</code></pre>"},{"location":"go/examples/nethttp-server/#project-structure","title":"Project Structure","text":"<pre><code>nethttp-server/\n\u251c\u2500\u2500 main.go              # Server with multiple endpoints\n\u251c\u2500\u2500 client_example.go    # Example clients (auto and explicit)\n\u251c\u2500\u2500 go.mod              # Module definition\n\u2514\u2500\u2500 README.md           # This file\n</code></pre>"},{"location":"go/examples/nethttp-server/#endpoint-details","title":"Endpoint Details","text":""},{"location":"go/examples/nethttp-server/#apifree-data-free","title":"/api/free-data (Free)","text":"<p>No payment required. Returns basic data.</p> <pre><code>curl http://localhost:8080/api/free-data | jq\n</code></pre>"},{"location":"go/examples/nethttp-server/#apipremium-data-010","title":"/api/premium-data ($0.10)","text":"<p>Requires $0.10 USDC payment. Returns market data.</p> <pre><code># First request returns 402\ncurl http://localhost:8080/api/premium-data\n\n# After payment with auth header\ncurl -H \"X-Payment-Authorization: &lt;base64&gt;\" http://localhost:8080/api/premium-data\n</code></pre>"},{"location":"go/examples/nethttp-server/#apiexpensive-data-100","title":"/api/expensive-data ($1.00)","text":"<p>Requires $1.00 USDC payment. Returns exclusive insights.</p> <pre><code>curl http://localhost:8080/api/expensive-data\n</code></pre>"},{"location":"go/examples/nethttp-server/#apiprocess-050","title":"/api/process ($0.50)","text":"<p>POST endpoint requiring $0.50 USDC. Processes data.</p> <pre><code>curl -X POST -H \"Content-Type: application/json\" \\\n  -d '{\"data\": \"to process\"}' \\\n  http://localhost:8080/api/process\n</code></pre>"},{"location":"go/examples/nethttp-server/#handler-examples","title":"Handler Examples","text":""},{"location":"go/examples/nethttp-server/#free-handler","title":"Free Handler","text":"<pre><code>func freeDataHandler(w http.ResponseWriter, r *http.Request) {\n    data := map[string]interface{}{\n        \"message\": \"This is free public data\",\n        \"data\": map[string]interface{}{\n            \"timestamp\": \"2024-01-01T00:00:00Z\",\n            \"value\":     \"basic information\",\n        },\n    }\n    respondJSON(w, http.StatusOK, data)\n}\n</code></pre>"},{"location":"go/examples/nethttp-server/#premium-handler-with-payment-access","title":"Premium Handler (with Payment Access)","text":"<pre><code>func premiumDataHandler(w http.ResponseWriter, r *http.Request) {\n    // Access payment details if needed\n    auth := nethttp.GetPaymentAuthorization(r)\n    if auth != nil {\n        log.Printf(\"\u2705 Payment received: %s USDC from %s\",\n            auth.ActualAmount, auth.PublicKey)\n    }\n\n    data := map[string]interface{}{\n        \"message\": \"This is premium data (paid $0.10)\",\n        \"data\": map[string]interface{}{\n            \"timestamp\": \"2024-01-01T00:00:00Z\",\n            \"value\":     \"premium market data\",\n            \"metrics\": map[string]interface{}{\n                \"price\":  42.50,\n                \"volume\": 1000000,\n                \"trend\":  \"bullish\",\n            },\n        },\n    }\n    respondJSON(w, http.StatusOK, data)\n}\n</code></pre>"},{"location":"go/examples/nethttp-server/#configuration-options","title":"Configuration Options","text":""},{"location":"go/examples/nethttp-server/#environment-variables","title":"Environment Variables","text":"<pre><code># Required\nX402_PAYMENT_ADDRESS=\"YOUR_SOLANA_WALLET\"\nX402_TOKEN_MINT=\"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\"\n\n# Optional\nX402_NETWORK=\"solana-devnet\"  # or solana-mainnet\nX402_RPC_URL=\"https://api.devnet.solana.com\"\nPORT=8080\n</code></pre>"},{"location":"go/examples/nethttp-server/#per-endpoint-configuration","title":"Per-Endpoint Configuration","text":"<p>In <code>main.go</code>, modify the <code>PaymentRequiredOptions</code>:</p> <pre><code>nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n    Amount:      \"0.10\",\n    Description: \"Custom description\",\n    ExpiresIn:   300,  // Seconds\n    AutoVerify:  true, // Verify on-chain\n})\n</code></pre>"},{"location":"go/examples/nethttp-server/#testing-locally","title":"Testing Locally","text":""},{"location":"go/examples/nethttp-server/#test-without-real-payments","title":"Test Without Real Payments","text":"<p>For development, you can test the payment flow without real transactions:</p> <ol> <li>Use devnet tokens (free from faucet)</li> <li>Set <code>AutoVerify: false</code> to skip on-chain verification</li> <li>Use client with <code>AllowLocal: true</code></li> </ol>"},{"location":"go/examples/nethttp-server/#mock-payment-response","title":"Mock Payment Response","text":"<p>For testing without a server:</p> <pre><code>// Simulate 402 response\nresp := &amp;http.Response{\n    StatusCode: http.StatusPaymentRequired,\n    Body:       io.NopCloser(bytes.NewBufferString(paymentJSON)),\n}\n\n// Test parsing\npaymentReq, err := client.ParsePaymentRequest(resp)\n</code></pre>"},{"location":"go/examples/nethttp-server/#production-considerations","title":"Production Considerations","text":""},{"location":"go/examples/nethttp-server/#1-use-mainnet","title":"1. Use Mainnet","text":"<p>Update environment: <pre><code>export X402_NETWORK=\"solana-mainnet\"\nexport X402_RPC_URL=\"https://api.mainnet-beta.solana.com\"\n</code></pre></p>"},{"location":"go/examples/nethttp-server/#2-enable-https","title":"2. Enable HTTPS","text":"<pre><code>err := http.ListenAndServeTLS(\":443\", \"cert.pem\", \"key.pem\", mux)\n</code></pre>"},{"location":"go/examples/nethttp-server/#3-add-rate-limiting","title":"3. Add Rate Limiting","text":"<pre><code>import \"golang.org/x/time/rate\"\n\nvar limiter = rate.NewLimiter(100, 10)\n\nfunc rateLimited(h http.HandlerFunc) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n        if !limiter.Allow() {\n            http.Error(w, \"Too many requests\", http.StatusTooManyRequests)\n            return\n        }\n        h(w, r)\n    }\n}\n\nmux.Handle(\"/api/premium\", rateLimited(premiumHandler))\n</code></pre>"},{"location":"go/examples/nethttp-server/#4-add-logging","title":"4. Add Logging","text":"<pre><code>import \"log\"\n\nfunc logRequest(handler http.HandlerFunc) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n        log.Printf(\"%s %s\", r.Method, r.URL.Path)\n        handler(w, r)\n    }\n}\n</code></pre>"},{"location":"go/examples/nethttp-server/#5-monitor-payments","title":"5. Monitor Payments","text":"<pre><code>func logPayment(auth *core.PaymentAuthorization) {\n    log.Printf(\"[PAYMENT] ID:%s Amount:%s Payer:%s TX:%s\",\n        auth.PaymentID,\n        auth.ActualAmount,\n        auth.PublicKey[:8],\n        auth.TransactionHash[:8])\n}\n</code></pre>"},{"location":"go/examples/nethttp-server/#troubleshooting","title":"Troubleshooting","text":""},{"location":"go/examples/nethttp-server/#402-responses-even-after-payment","title":"402 responses even after payment","text":"<ul> <li>Check payment amount matches exactly</li> <li>Verify payment address is correct</li> <li>Ensure RPC endpoint is accessible</li> <li>Check network configuration (devnet vs mainnet)</li> </ul>"},{"location":"go/examples/nethttp-server/#client-connection-refused","title":"Client connection refused","text":"<ul> <li>Ensure server is running: <code>go run main.go</code></li> <li>Check port is correct: <code>lsof -i :8080</code></li> <li>Verify localhost is accessible</li> </ul>"},{"location":"go/examples/nethttp-server/#payment-verification-failures","title":"Payment verification failures","text":"<ul> <li>Disable <code>AutoVerify: false</code> temporarily for testing</li> <li>Check Solana network is operational</li> <li>Verify RPC endpoint is responding</li> </ul>"},{"location":"go/examples/nethttp-server/#extended-examples","title":"Extended Examples","text":""},{"location":"go/examples/nethttp-server/#dynamic-pricing","title":"Dynamic Pricing","text":"<p>Modify the endpoint setup:</p> <pre><code>func getPriceTier(endpoint string) string {\n    switch endpoint {\n    case \"/api/basic\":\n        return \"0.05\"\n    case \"/api/premium\":\n        return \"0.10\"\n    case \"/api/ultimate\":\n        return \"1.00\"\n    default:\n        return \"0.05\"\n    }\n}\n</code></pre>"},{"location":"go/examples/nethttp-server/#subscription-based","title":"Subscription-Based","text":"<p>Track payments and allow multiple requests:</p> <pre><code>type Subscription struct {\n    Address    string\n    PaidUntil  time.Time\n    Requests   int\n}\n\nfunc checkSubscription(auth *core.PaymentAuthorization) bool {\n    // Check if payer has active subscription\n    return true\n}\n</code></pre>"},{"location":"go/examples/nethttp-server/#see-also","title":"See Also","text":"<ul> <li>Echo Server Example</li> <li>Server Quick Start</li> <li>net/http Middleware Docs</li> <li>Client Library Docs</li> </ul>"},{"location":"go/getting-started/client-quickstart/","title":"Client Quick Start","text":"<p>Build a client that automatically pays for API access in minutes.</p>"},{"location":"go/getting-started/client-quickstart/#5-minute-auto-paying-client","title":"5-Minute Auto-Paying Client","text":""},{"location":"go/getting-started/client-quickstart/#step-1-initialize-your-project","title":"Step 1: Initialize Your Project","text":"<pre><code>mkdir x402-client\ncd x402-client\ngo mod init github.com/yourname/x402-client\n</code></pre>"},{"location":"go/getting-started/client-quickstart/#step-2-install-dependencies","title":"Step 2: Install Dependencies","text":"<pre><code>go get github.com/openlibx402/go/openlibx402-client\ngo get github.com/gagliardetto/solana-go\n</code></pre>"},{"location":"go/getting-started/client-quickstart/#step-3-create-your-client","title":"Step 3: Create Your Client","text":"<p>Create <code>main.go</code>:</p> <pre><code>package main\n\nimport (\n    \"context\"\n    \"io\"\n    \"log\"\n    \"os\"\n\n    \"github.com/gagliardetto/solana-go\"\n    \"github.com/mr-tron/base58\"\n    \"github.com/openlibx402/go/openlibx402-client\"\n)\n\nfunc main() {\n    // Load wallet from environment\n    privateKeyStr := os.Getenv(\"X402_PRIVATE_KEY\")\n    if privateKeyStr == \"\" {\n        log.Fatal(\"X402_PRIVATE_KEY not set\")\n    }\n\n    // Decode private key\n    privateKeyBytes := base58.Decode(privateKeyStr)\n    walletKeypair := solana.PrivateKey(privateKeyBytes)\n\n    // Create auto client (automatically handles 402 and pays)\n    client := client.NewAutoClient(walletKeypair, \"\", &amp;client.AutoClientOptions{\n        MaxPaymentAmount: \"10.0\",  // Safety limit\n        AutoRetry:        true,    // Auto-pay on 402\n    })\n    defer client.Close()\n\n    ctx := context.Background()\n\n    // Access premium endpoint (automatically pays if needed)\n    log.Println(\"Accessing premium endpoint...\")\n    resp, err := client.Get(ctx, \"https://api.example.com/api/premium\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer resp.Body.Close()\n\n    // Read response\n    data, _ := io.ReadAll(resp.Body)\n    log.Printf(\"Response: %s\", string(data))\n}\n</code></pre>"},{"location":"go/getting-started/client-quickstart/#step-4-get-your-wallet-private-key","title":"Step 4: Get Your Wallet Private Key","text":"<pre><code># If you have a Solana wallet file\nsolana-keygen show --private-key\n\n# Output will be base58 encoded private key\n# Export it\nexport X402_PRIVATE_KEY=\"your-base58-private-key\"\n</code></pre>"},{"location":"go/getting-started/client-quickstart/#step-5-run-your-client","title":"Step 5: Run Your Client","text":"<pre><code>export X402_PRIVATE_KEY=\"your-private-key-here\"\ngo run main.go\n</code></pre>"},{"location":"go/getting-started/client-quickstart/#explicit-control-mode","title":"Explicit Control Mode","text":"<p>For applications needing fine-grained control:</p> <pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"io\"\n    \"log\"\n\n    \"github.com/gagliardetto/solana-go\"\n    \"github.com/openlibx402/go/openlibx402-client\"\n)\n\nfunc main() {\n    walletKeypair := solana.NewWallet().PrivateKey\n\n    // Create explicit client (manual control)\n    client := client.NewX402Client(walletKeypair, \"\", nil, false)\n    defer client.Close()\n\n    ctx := context.Background()\n\n    // Step 1: Make initial request\n    log.Println(\"Making request...\")\n    resp, err := client.Get(ctx, \"https://api.example.com/premium\", nil)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // Step 2: Check if payment required\n    if client.PaymentRequired(resp) {\n        log.Println(\"Payment required!\")\n\n        // Step 3: Parse payment request\n        paymentReq, err := client.ParsePaymentRequest(resp)\n        if err != nil {\n            log.Fatal(err)\n        }\n\n        log.Printf(\"Amount: %s USDC\", paymentReq.MaxAmountRequired)\n\n        // Step 4: User confirmation (optional)\n        if !userConfirms() {\n            log.Fatal(\"Payment declined\")\n        }\n\n        // Step 5: Create and broadcast payment\n        log.Println(\"Creating payment...\")\n        auth, err := client.CreatePayment(ctx, paymentReq, \"\")\n        if err != nil {\n            log.Fatal(err)\n        }\n\n        log.Printf(\"Payment sent: %s\", auth.TransactionHash)\n\n        // Step 6: Retry with payment\n        log.Println(\"Retrying with payment...\")\n        resp, err = client.Get(ctx, \"https://api.example.com/premium\", auth)\n        if err != nil {\n            log.Fatal(err)\n        }\n    }\n\n    // Step 7: Process response\n    data, _ := io.ReadAll(resp.Body)\n    resp.Body.Close()\n    log.Printf(\"Data: %s\", string(data))\n}\n\nfunc userConfirms() bool {\n    // Implement your confirmation logic\n    return true\n}\n</code></pre>"},{"location":"go/getting-started/client-quickstart/#postputdelete-requests","title":"POST/PUT/DELETE Requests","text":"<pre><code>// POST request\ndata := []byte(`{\"name\": \"value\"}`)\nresp, err := client.Post(ctx, \"https://api.example.com/data\", data)\n\n// PUT request\nresp, err := client.Put(ctx, \"https://api.example.com/data\", data)\n\n// DELETE request\nresp, err := client.Delete(ctx, \"https://api.example.com/data\")\n</code></pre>"},{"location":"go/getting-started/client-quickstart/#error-handling","title":"Error Handling","text":"<pre><code>import \"github.com/openlibx402/go/openlibx402-core\"\n\nresp, err := client.Get(ctx, url)\nif err != nil {\n    switch err := err.(type) {\n    case *core.PaymentExpiredError:\n        log.Println(\"Payment request expired\")\n    case *core.InsufficientFundsError:\n        log.Printf(\"Need: %s, Have: %s\",\n            err.RequiredAmount,\n            err.AvailableAmount)\n    case *core.PaymentVerificationError:\n        log.Println(\"Payment verification failed\")\n    default:\n        log.Println(\"Other error:\", err)\n    }\n}\n</code></pre>"},{"location":"go/getting-started/client-quickstart/#accessing-payment-details","title":"Accessing Payment Details","text":"<pre><code>auth, err := client.CreatePayment(ctx, paymentReq, \"\")\nif err != nil {\n    log.Fatal(err)\n}\n\nlog.Printf(\"Payment ID: %s\", auth.PaymentID)\nlog.Printf(\"Amount: %s\", auth.ActualAmount)\nlog.Printf(\"Payment Address: %s\", auth.PaymentAddress)\nlog.Printf(\"Network: %s\", auth.Network)\nlog.Printf(\"Signature: %s\", auth.Signature)\nlog.Printf(\"Transaction: %s\", auth.TransactionHash)\n</code></pre>"},{"location":"go/getting-started/client-quickstart/#auto-client-options","title":"Auto Client Options","text":"<pre><code>client := client.NewAutoClient(walletKeypair, rpcURL, &amp;client.AutoClientOptions{\n    MaxPaymentAmount: \"10.0\",   // Safety limit - reject payments over this\n    AutoRetry:        true,     // Auto-retry on 402 with payment\n    AllowLocal:       false,    // Allow localhost URLs (dev only!)\n})\n</code></pre>"},{"location":"go/getting-started/client-quickstart/#handling-multiple-payment-types","title":"Handling Multiple Payment Types","text":"<pre><code>// Different endpoints with different pricing\nendpoints := map[string]string{\n    \"basic\":    \"https://api.example.com/basic\",\n    \"premium\":  \"https://api.example.com/premium\",\n    \"ultimate\": \"https://api.example.com/ultimate\",\n}\n\nfor name, endpoint := range endpoints {\n    log.Printf(\"Accessing %s endpoint...\", name)\n    resp, err := client.Get(ctx, endpoint)\n    if err != nil {\n        log.Printf(\"Error accessing %s: %v\", name, err)\n        continue\n    }\n\n    data, _ := io.ReadAll(resp.Body)\n    resp.Body.Close()\n    log.Printf(\"%s response: %s\", name, string(data))\n}\n</code></pre>"},{"location":"go/getting-started/client-quickstart/#testing-with-local-server","title":"Testing with Local Server","text":"<p>For local development, enable local URLs:</p> <pre><code>// Development: allow localhost\nclient := client.NewAutoClient(walletKeypair, \"\", &amp;client.AutoClientOptions{\n    AllowLocal: true,  // Enable for http://localhost:8080\n})\n\nresp, err := client.Get(ctx, \"http://localhost:8080/api/premium\")\n</code></pre>"},{"location":"go/getting-started/client-quickstart/#configuration","title":"Configuration","text":"<pre><code>// Custom RPC endpoint\nrpcURL := \"https://api.mainnet-beta.solana.com\"\nclient := client.NewAutoClient(walletKeypair, rpcURL, nil)\n\n// Custom options\nclient := client.NewAutoClient(walletKeypair, rpcURL, &amp;client.AutoClientOptions{\n    MaxPaymentAmount: \"100.0\",  // Higher limit for expensive APIs\n    AutoRetry:        true,\n    AllowLocal:       false,\n})\n</code></pre>"},{"location":"go/getting-started/client-quickstart/#safety-best-practices","title":"Safety Best Practices","text":"<pre><code>// \u2705 Good: Always use payment limit\nclient := client.NewAutoClient(walletKeypair, \"\", &amp;client.AutoClientOptions{\n    MaxPaymentAmount: \"10.0\",  // Prevent accidental overpayment\n})\n\n// \u2705 Good: Always close\ndefer client.Close()\n\n// \u2705 Good: Use context with timeout\nctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)\ndefer cancel()\n\n// \u274c Bad: No safety limits\nclient := client.NewAutoClient(walletKeypair, \"\", nil)\n\n// \u274c Bad: AllowLocal in production\nclient := client.NewAutoClient(walletKeypair, \"\", &amp;client.AutoClientOptions{\n    AllowLocal: true,  // Only for development!\n})\n</code></pre>"},{"location":"go/getting-started/client-quickstart/#rate-limiting-payments","title":"Rate Limiting Payments","text":"<pre><code>// Track payments to avoid excessive spending\ntype PaymentTracker struct {\n    totalSpent float64\n    maxSpend   float64\n}\n\nfunc (pt *PaymentTracker) canPay(amount string) bool {\n    amountFloat, _ := strconv.ParseFloat(amount, 64)\n    return (pt.totalSpent + amountFloat) &lt;= pt.maxSpend\n}\n\n// Usage\ntracker := &amp;PaymentTracker{\n    totalSpent: 0,\n    maxSpend:   10.0,\n}\n\nresp, err := client.Get(ctx, url)\nif err != nil {\n    if paymentErr, ok := err.(*core.PaymentRequiredError); ok {\n        if !tracker.canPay(paymentErr.PaymentRequest.MaxAmountRequired) {\n            log.Fatal(\"Would exceed spending limit\")\n        }\n    }\n}\n</code></pre>"},{"location":"go/getting-started/client-quickstart/#next-steps","title":"Next Steps","text":"<ul> <li>Full Example: See net/http Client Example</li> <li>Error Handling: Error Reference</li> <li>API Details: Client Library Documentation</li> <li>Building a Server: Server Quick Start</li> </ul>"},{"location":"go/getting-started/client-quickstart/#support","title":"Support","text":"<ul> <li>Client Library Docs</li> <li>API Reference</li> <li>Error Handling</li> </ul>"},{"location":"go/getting-started/installation/","title":"Installation","text":"<p>Get started with OpenLibx402 Go packages in minutes.</p>"},{"location":"go/getting-started/installation/#prerequisites","title":"Prerequisites","text":"<ul> <li>Go: 1.21 or later</li> <li>Solana Wallet: For testing (testnet/devnet tokens recommended)</li> <li>Git: For cloning the repository</li> </ul>"},{"location":"go/getting-started/installation/#package-installation","title":"Package Installation","text":""},{"location":"go/getting-started/installation/#option-1-using-go-get-recommended-for-users","title":"Option 1: Using <code>go get</code> (Recommended for Users)","text":"<p>Install the packages you need:</p> <pre><code># Core protocol (required)\ngo get github.com/openlibx402/go/openlibx402-core\n\n# Client for consuming APIs\ngo get github.com/openlibx402/go/openlibx402-client\n\n# Middleware for your framework\ngo get github.com/openlibx402/go/openlibx402-nethttp\n# or\ngo get github.com/openlibx402/go/openlibx402-echo\n</code></pre>"},{"location":"go/getting-started/installation/#option-2-development-installation-for-contributors","title":"Option 2: Development Installation (for Contributors)","text":"<pre><code># Clone the repository\ngit clone https://github.com/openlibx402/openlibx402.git\ncd openlibx402\n\n# Navigate to a package\ncd packages/go/openlibx402-core\n\n# Install dependencies\ngo mod tidy\n\n# Build and test\ngo build\ngo test ./...\n</code></pre>"},{"location":"go/getting-started/installation/#verifying-installation","title":"Verifying Installation","text":""},{"location":"go/getting-started/installation/#verify-with-go","title":"Verify with Go","text":"<pre><code>go list -m github.com/openlibx402/go/openlibx402-core\n</code></pre> <p>Output should show: <pre><code>github.com/openlibx402/go/openlibx402-core v0.1.0\n</code></pre></p>"},{"location":"go/getting-started/installation/#verify-with-pkggodev","title":"Verify with pkg.go.dev","text":"<p>Visit: https://pkg.go.dev/github.com/openlibx402/go/openlibx402-core</p>"},{"location":"go/getting-started/installation/#import-statements","title":"Import Statements","text":"<p>Once installed, you can import in your code:</p> <pre><code>package main\n\nimport (\n    \"github.com/openlibx402/go/openlibx402-core\"\n    \"github.com/openlibx402/go/openlibx402-client\"\n)\n</code></pre> <p>Or with aliases:</p> <pre><code>import (\n    nethttp \"github.com/openlibx402/go/openlibx402-nethttp\"\n    echox402 \"github.com/openlibx402/go/openlibx402-echo\"\n)\n</code></pre>"},{"location":"go/getting-started/installation/#environment-setup","title":"Environment Setup","text":""},{"location":"go/getting-started/installation/#for-server-development","title":"For Server Development","text":"<p>Create a <code>.env</code> file:</p> <pre><code># Your Solana wallet address\nX402_PAYMENT_ADDRESS=\"YOUR_SOLANA_WALLET_ADDRESS\"\n\n# USDC token mint (devnet: EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v)\nX402_TOKEN_MINT=\"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\"\n\n# Network (solana-devnet, solana-mainnet)\nX402_NETWORK=\"solana-devnet\"\n\n# RPC endpoint\nX402_RPC_URL=\"https://api.devnet.solana.com\"\n\n# Server port\nPORT=8080\n</code></pre> <p>Load in your code:</p> <pre><code>import \"os\"\n\npaymentAddress := os.Getenv(\"X402_PAYMENT_ADDRESS\")\ntokenMint := os.Getenv(\"X402_TOKEN_MINT\")\n</code></pre>"},{"location":"go/getting-started/installation/#for-client-development","title":"For Client Development","text":"<pre><code># Your wallet's private key (base58 encoded)\nexport X402_PRIVATE_KEY=\"your-base58-private-key\"\n\n# Optional: RPC endpoint\nexport X402_RPC_URL=\"https://api.devnet.solana.com\"\n</code></pre>"},{"location":"go/getting-started/installation/#getting-devnet-tokens","title":"Getting Devnet Tokens","text":"<p>To test on Solana devnet:</p> <ol> <li> <p>Create a Solana wallet:    <pre><code>solana-keygen new\n</code></pre></p> </li> <li> <p>Get devnet SOL:    <pre><code>solana airdrop 2 $(solana address) --url devnet\n</code></pre></p> </li> <li> <p>Get devnet USDC:</p> </li> <li>Use spl-token</li> <li>Or visit a devnet faucet</li> </ol>"},{"location":"go/getting-started/installation/#troubleshooting","title":"Troubleshooting","text":""},{"location":"go/getting-started/installation/#module-not-found-error","title":"Module not found error","text":"<pre><code>go: github.com/openlibx402/go/openlibx402-core@latest:\nreading go.sum: no matching version found\n</code></pre> <p>Solution: Clear module cache and retry: <pre><code>go clean -modcache\ngo get github.com/openlibx402/go/openlibx402-core@latest\n</code></pre></p>"},{"location":"go/getting-started/installation/#version-mismatch","title":"Version mismatch","text":"<pre><code>different modules with the same import path\n</code></pre> <p>Solution: Ensure you're using the correct import path: <pre><code># Wrong (old path)\nimport \"github.com/openlibx402/openlibx402/go/openlibx402-core\"\n\n# Correct (simplified path)\nimport \"github.com/openlibx402/go/openlibx402-core\"\n</code></pre></p>"},{"location":"go/getting-started/installation/#missing-go-version","title":"Missing Go version","text":"<p>Solution: Update Go: <pre><code># macOS with Homebrew\nbrew upgrade go\n\n# Or download from https://golang.org/dl/\n</code></pre></p>"},{"location":"go/getting-started/installation/#next-steps","title":"Next Steps","text":"<p>After installation:</p> <ol> <li>Choose Your Path:</li> <li>Server Quick Start - Build a payment-required API</li> <li> <p>Client Quick Start - Build a payment client</p> </li> <li> <p>Explore Examples:</p> </li> <li>net/http Server Example</li> <li> <p>Echo Server Example</p> </li> <li> <p>Learn More:</p> </li> <li>Core Library</li> <li>Client Library</li> </ol>"},{"location":"go/getting-started/installation/#support","title":"Support","text":"<ul> <li>Issues: GitHub Issues</li> <li>Discussions: GitHub Discussions</li> </ul>"},{"location":"go/getting-started/server-quickstart/","title":"Server Quick Start","text":"<p>Build a payment-required API in minutes with OpenLibx402.</p>"},{"location":"go/getting-started/server-quickstart/#5-minute-server","title":"5-Minute Server","text":""},{"location":"go/getting-started/server-quickstart/#step-1-initialize-your-project","title":"Step 1: Initialize Your Project","text":"<pre><code>mkdir x402-server\ncd x402-server\ngo mod init github.com/yourname/x402-server\n</code></pre>"},{"location":"go/getting-started/server-quickstart/#step-2-install-dependencies","title":"Step 2: Install Dependencies","text":"<pre><code>go get github.com/openlibx402/go/openlibx402-nethttp\n</code></pre>"},{"location":"go/getting-started/server-quickstart/#step-3-create-your-server","title":"Step 3: Create Your Server","text":"<p>Create <code>main.go</code>:</p> <pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"log\"\n    \"net/http\"\n    \"os\"\n\n    nethttp \"github.com/openlibx402/go/openlibx402-nethttp\"\n)\n\nfunc main() {\n    // Initialize X402 with configuration\n    nethttp.InitX402(&amp;nethttp.Config{\n        PaymentAddress: os.Getenv(\"X402_PAYMENT_ADDRESS\"),\n        TokenMint:      os.Getenv(\"X402_TOKEN_MINT\"),\n        Network:        \"solana-devnet\",\n        AutoVerify:     true,\n    })\n\n    // Free endpoint (no payment required)\n    http.HandleFunc(\"/api/free\", func(w http.ResponseWriter, r *http.Request) {\n        json.NewEncoder(w).Encode(map[string]string{\n            \"message\": \"Free data\",\n            \"data\":    \"Available to everyone\",\n        })\n    })\n\n    // Premium endpoint (requires $0.10)\n    http.Handle(\"/api/premium\", nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n        Amount:      \"0.10\",\n        Description: \"Premium data access\",\n    })(http.HandlerFunc(premiumHandler)))\n\n    log.Println(\"Server listening on :8080\")\n    log.Fatal(http.ListenAndServe(\":8080\", nil))\n}\n\nfunc premiumHandler(w http.ResponseWriter, r *http.Request) {\n    // Access payment details if needed\n    auth := nethttp.GetPaymentAuthorization(r)\n    if auth != nil {\n        log.Printf(\"Payment received: %s USDC\", auth.ActualAmount)\n    }\n\n    json.NewEncoder(w).Encode(map[string]interface{}{\n        \"message\": \"Premium data\",\n        \"data\":    \"You paid for this!\",\n        \"premium\": true,\n    })\n}\n</code></pre>"},{"location":"go/getting-started/server-quickstart/#step-4-set-environment-variables","title":"Step 4: Set Environment Variables","text":"<pre><code>export X402_PAYMENT_ADDRESS=\"YOUR_SOLANA_WALLET_ADDRESS\"\nexport X402_TOKEN_MINT=\"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\"\n</code></pre>"},{"location":"go/getting-started/server-quickstart/#step-5-run-your-server","title":"Step 5: Run Your Server","text":"<pre><code>go run main.go\n</code></pre> <p>Output: <pre><code>Server listening on :8080\n</code></pre></p>"},{"location":"go/getting-started/server-quickstart/#step-6-test-it","title":"Step 6: Test It","text":"<p>Test free endpoint: <pre><code>curl http://localhost:8080/api/free\n</code></pre></p> <p>Response: <pre><code>{\n  \"message\": \"Free data\",\n  \"data\": \"Available to everyone\"\n}\n</code></pre></p> <p>Test premium endpoint (will get 402): <pre><code>curl http://localhost:8080/api/premium\n</code></pre></p> <p>Response (402 Payment Required): <pre><code>{\n  \"max_amount_required\": \"0.10\",\n  \"asset_type\": \"SPL\",\n  \"asset_address\": \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\",\n  \"payment_address\": \"YOUR_WALLET_ADDRESS\",\n  \"network\": \"solana-devnet\",\n  \"expires_at\": \"2025-01-01T00:05:00Z\",\n  \"payment_id\": \"...\",\n  \"resource\": \"/api/premium\",\n  \"description\": \"Premium data access\"\n}\n</code></pre></p>"},{"location":"go/getting-started/server-quickstart/#with-echo-framework","title":"With Echo Framework","text":"<p>Prefer Echo? It's even simpler:</p> <pre><code>go get github.com/openlibx402/go/openlibx402-echo\n</code></pre> <pre><code>package main\n\nimport (\n    \"net/http\"\n    \"os\"\n\n    \"github.com/labstack/echo/v4\"\n    echox402 \"github.com/openlibx402/go/openlibx402-echo\"\n)\n\nfunc main() {\n    echox402.InitX402(&amp;echox402.Config{\n        PaymentAddress: os.Getenv(\"X402_PAYMENT_ADDRESS\"),\n        TokenMint:      os.Getenv(\"X402_TOKEN_MINT\"),\n        Network:        \"solana-devnet\",\n        AutoVerify:     true,\n    })\n\n    e := echo.New()\n\n    // Free endpoint\n    e.GET(\"/api/free\", func(c echo.Context) error {\n        return c.JSON(http.StatusOK, map[string]string{\n            \"message\": \"Free data\",\n        })\n    })\n\n    // Premium endpoint\n    e.GET(\"/api/premium\", premiumHandler, echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n        Amount:      \"0.10\",\n        Description: \"Premium data access\",\n    }))\n\n    e.Start(\":8080\")\n}\n\nfunc premiumHandler(c echo.Context) error {\n    // Access payment details\n    auth := echox402.GetPaymentAuthorization(c)\n    if auth != nil {\n        c.Logger().Infof(\"Payment: %s USDC\", auth.ActualAmount)\n    }\n\n    return c.JSON(http.StatusOK, map[string]interface{}{\n        \"message\": \"Premium data\",\n        \"premium\": true,\n    })\n}\n</code></pre>"},{"location":"go/getting-started/server-quickstart/#adding-multiple-price-tiers","title":"Adding Multiple Price Tiers","text":"<pre><code>// Basic tier: $0.05\nhttp.Handle(\"/api/basic\", nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n    Amount:      \"0.05\",\n    Description: \"Basic data access\",\n})(basicHandler))\n\n// Standard tier: $0.10\nhttp.Handle(\"/api/standard\", nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n    Amount:      \"0.10\",\n    Description: \"Standard data access\",\n})(standardHandler))\n\n// Premium tier: $1.00\nhttp.Handle(\"/api/premium\", nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n    Amount:      \"1.00\",\n    Description: \"Premium data access\",\n})(premiumHandler))\n</code></pre>"},{"location":"go/getting-started/server-quickstart/#accessing-payment-details","title":"Accessing Payment Details","text":"<p>Your handlers can access payment information:</p> <pre><code>func myHandler(w http.ResponseWriter, r *http.Request) {\n    auth := nethttp.GetPaymentAuthorization(r)\n    if auth != nil {\n        // Access payment details\n        log.Printf(\"Payment ID: %s\", auth.PaymentID)\n        log.Printf(\"Amount: %s\", auth.ActualAmount)\n        log.Printf(\"Payer: %s\", auth.PublicKey)\n        log.Printf(\"TX Hash: %s\", auth.TransactionHash)\n    }\n\n    // Serve premium content\n    json.NewEncoder(w).Encode(premiumData)\n}\n</code></pre>"},{"location":"go/getting-started/server-quickstart/#configuration-options","title":"Configuration Options","text":"<pre><code>nethttp.InitX402(&amp;nethttp.Config{\n    PaymentAddress: \"wallet_address\",     // Required: where payments go\n    TokenMint:      \"token_mint_address\", // Required: which token\n    Network:        \"solana-devnet\",      // Optional: solana-mainnet for production\n    RPCURL:         \"https://...\",        // Optional: custom RPC endpoint\n    AutoVerify:     true,                 // Optional: verify payments on-chain\n})\n</code></pre>"},{"location":"go/getting-started/server-quickstart/#payment-options","title":"Payment Options","text":"<pre><code>nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n    Amount:      \"0.10\",                  // Required: payment amount\n    PaymentAddress: \"override_address\",   // Optional: override global\n    TokenMint:    \"override_mint\",        // Optional: override global\n    Network:      \"solana-mainnet\",       // Optional: override global\n    Description:  \"Premium data access\", // Optional: description shown to user\n    ExpiresIn:    300,                    // Optional: expiration in seconds\n    AutoVerify:   true,                   // Optional: verify payment on-chain\n})\n</code></pre>"},{"location":"go/getting-started/server-quickstart/#next-steps","title":"Next Steps","text":"<ul> <li>Production Setup: Configure for Solana mainnet</li> <li>Full Example: See net/http Server Example</li> <li>Client Development: Client Quick Start</li> <li>API Reference: Core Library Documentation</li> </ul>"},{"location":"go/getting-started/server-quickstart/#common-patterns","title":"Common Patterns","text":""},{"location":"go/getting-started/server-quickstart/#dynamic-pricing","title":"Dynamic Pricing","text":"<pre><code>func getPriceTier(tier string) string {\n    switch tier {\n    case \"basic\":\n        return \"0.05\"\n    case \"premium\":\n        return \"0.10\"\n    case \"ultimate\":\n        return \"1.00\"\n    default:\n        return \"0.05\"\n    }\n}\n</code></pre>"},{"location":"go/getting-started/server-quickstart/#rate-limiting-per-payment","title":"Rate Limiting Per Payment","text":"<pre><code>func rateLimitHandler(w http.ResponseWriter, r *http.Request) {\n    auth := nethttp.GetPaymentAuthorization(r)\n\n    // Allow 100 requests per $1 paid\n    if auth != nil {\n        amount, _ := strconv.ParseFloat(auth.ActualAmount, 64)\n        requestsAllowed := int(amount * 100)\n        // Implement rate limiting based on payment\n    }\n\n    json.NewEncoder(w).Encode(data)\n}\n</code></pre>"},{"location":"go/getting-started/server-quickstart/#logging-payments","title":"Logging Payments","text":"<pre><code>func logPayment(auth *core.PaymentAuthorization) {\n    if auth != nil {\n        log.Printf(\"[PAYMENT] ID:%s Amount:%s Payer:%s TX:%s\",\n            auth.PaymentID,\n            auth.ActualAmount,\n            auth.PublicKey,\n            auth.TransactionHash)\n    }\n}\n</code></pre>"},{"location":"go/getting-started/server-quickstart/#troubleshooting","title":"Troubleshooting","text":""},{"location":"go/getting-started/server-quickstart/#x402-not-initialized-error","title":"\"X402 not initialized\" error","text":"<p>Make sure to call <code>InitX402()</code> before defining handlers.</p>"},{"location":"go/getting-started/server-quickstart/#paymentaddress-and-tokenmint-must-be-configured","title":"\"paymentAddress and tokenMint must be configured\"","text":"<p>Check that environment variables are set: <pre><code>echo $X402_PAYMENT_ADDRESS\necho $X402_TOKEN_MINT\n</code></pre></p>"},{"location":"go/getting-started/server-quickstart/#payment-verification-failures","title":"Payment verification failures","text":"<ul> <li>Ensure RPC endpoint is accessible</li> <li>Check network configuration matches (devnet vs mainnet)</li> <li>Verify transaction hash is valid</li> </ul>"},{"location":"go/getting-started/server-quickstart/#support","title":"Support","text":"<ul> <li>Examples</li> <li>API Reference</li> <li>Error Handling</li> </ul>"},{"location":"go/libraries/client/","title":"Client Library","text":"<p>HTTP client with automatic and explicit payment handling for accessing X402-protected APIs.</p>"},{"location":"go/libraries/client/#overview","title":"Overview","text":"<p>The <code>openlibx402-client</code> package provides two client types:</p> <ul> <li>X402Client: Explicit, manual payment control</li> <li>X402AutoClient: Automatic payment handling</li> </ul>"},{"location":"go/libraries/client/#installation","title":"Installation","text":"<pre><code>go get github.com/openlibx402/go/openlibx402-client\n</code></pre>"},{"location":"go/libraries/client/#x402client-explicit-mode","title":"X402Client (Explicit Mode)","text":"<p>Manual control over the payment flow.</p>"},{"location":"go/libraries/client/#constructor","title":"Constructor","text":"<pre><code>client := client.NewX402Client(\n    walletKeypair,  // solana.PrivateKey\n    rpcURL,         // Optional: defaults to devnet\n    httpClient,     // Optional: custom *http.Client\n    allowLocal,     // bool: allow localhost URLs\n)\ndefer client.Close()\n</code></pre>"},{"location":"go/libraries/client/#methods","title":"Methods","text":""},{"location":"go/libraries/client/#get","title":"Get()","text":"<p>Execute a GET request.</p> <pre><code>resp, err := client.Get(ctx, url, nil)\nif err != nil {\n    log.Fatal(err)\n}\ndefer resp.Body.Close()\n</code></pre> <p>With payment authorization:</p> <pre><code>resp, err := client.Get(ctx, url, paymentAuth)\n</code></pre>"},{"location":"go/libraries/client/#post","title":"Post()","text":"<p>Execute a POST request.</p> <pre><code>body := []byte(`{\"data\": \"value\"}`)\nresp, err := client.Post(ctx, url, body, nil)\n</code></pre>"},{"location":"go/libraries/client/#put","title":"Put()","text":"<p>Execute a PUT request.</p> <pre><code>body := []byte(`{\"update\": \"value\"}`)\nresp, err := client.Put(ctx, url, body, nil)\n</code></pre>"},{"location":"go/libraries/client/#delete","title":"Delete()","text":"<p>Execute a DELETE request.</p> <pre><code>resp, err := client.Delete(ctx, url, nil)\n</code></pre>"},{"location":"go/libraries/client/#do","title":"Do()","text":"<p>Execute any HTTP request.</p> <pre><code>req, _ := http.NewRequest(\"PATCH\", url, body)\nresp, err := client.Do(ctx, req, nil)\n</code></pre>"},{"location":"go/libraries/client/#paymentrequired","title":"PaymentRequired()","text":"<p>Check if response is 402 Payment Required.</p> <pre><code>if client.PaymentRequired(resp) {\n    // Handle payment\n}\n</code></pre>"},{"location":"go/libraries/client/#parsepaymentrequest","title":"ParsePaymentRequest()","text":"<p>Parse PaymentRequest from 402 response.</p> <pre><code>paymentReq, err := client.ParsePaymentRequest(resp)\nif err != nil {\n    log.Fatal(err)\n}\n\nlog.Printf(\"Amount: %s\", paymentReq.MaxAmountRequired)\n</code></pre>"},{"location":"go/libraries/client/#createpayment","title":"CreatePayment()","text":"<p>Create and broadcast a payment transaction.</p> <pre><code>auth, err := client.CreatePayment(ctx, paymentReq, \"\")\nif err != nil {\n    log.Fatal(err)\n}\n\nlog.Printf(\"Sent: %s\", auth.TransactionHash)\n</code></pre> <p>Optional custom amount:</p> <pre><code>auth, err := client.CreatePayment(ctx, paymentReq, \"0.05\")\n</code></pre>"},{"location":"go/libraries/client/#close","title":"Close()","text":"<p>Close client and cleanup resources.</p> <pre><code>defer client.Close()\n</code></pre>"},{"location":"go/libraries/client/#x402autoclient-automatic-mode","title":"X402AutoClient (Automatic Mode)","text":"<p>Automatically handles payment flow.</p>"},{"location":"go/libraries/client/#constructor_1","title":"Constructor","text":"<pre><code>client := client.NewAutoClient(\n    walletKeypair,  // solana.PrivateKey\n    rpcURL,         // Optional: defaults to devnet\n    options,        // Optional: *client.AutoClientOptions\n)\ndefer client.Close()\n</code></pre>"},{"location":"go/libraries/client/#options","title":"Options","text":"<pre><code>&amp;client.AutoClientOptions{\n    MaxPaymentAmount: \"10.0\",  // Safety limit\n    AutoRetry:        true,    // Auto-pay on 402\n    AllowLocal:       false,   // Allow localhost URLs\n}\n</code></pre>"},{"location":"go/libraries/client/#methods_1","title":"Methods","text":""},{"location":"go/libraries/client/#get_1","title":"Get()","text":"<p>Execute GET request (auto-pays if needed).</p> <pre><code>resp, err := client.Get(ctx, url)\nif err != nil {\n    log.Fatal(err)\n}\ndefer resp.Body.Close()\n// Payment was handled automatically if needed\n</code></pre>"},{"location":"go/libraries/client/#post_1","title":"Post()","text":"<p>Execute POST request (auto-pays if needed).</p> <pre><code>body := []byte(`{\"data\": \"value\"}`)\nresp, err := client.Post(ctx, url, body)\n</code></pre>"},{"location":"go/libraries/client/#put_1","title":"Put()","text":"<p>Execute PUT request (auto-pays if needed).</p> <pre><code>body := []byte(`{\"update\": \"value\"}`)\nresp, err := client.Put(ctx, url, body)\n</code></pre>"},{"location":"go/libraries/client/#delete_1","title":"Delete()","text":"<p>Execute DELETE request (auto-pays if needed).</p> <pre><code>resp, err := client.Delete(ctx, url)\n</code></pre>"},{"location":"go/libraries/client/#close_1","title":"Close()","text":"<p>Close client and cleanup.</p> <pre><code>defer client.Close()\n</code></pre>"},{"location":"go/libraries/client/#usage-patterns","title":"Usage Patterns","text":""},{"location":"go/libraries/client/#simple-auto-payment","title":"Simple Auto-Payment","text":"<pre><code>client := client.NewAutoClient(keypair, \"\", &amp;client.AutoClientOptions{\n    MaxPaymentAmount: \"10.0\",\n})\ndefer client.Close()\n\n// Just call the endpoint - payment handled automatically\nresp, err := client.Get(ctx, \"https://api.example.com/premium\")\nif err != nil {\n    log.Fatal(err)\n}\n\ndata, _ := io.ReadAll(resp.Body)\nresp.Body.Close()\nlog.Println(string(data))\n</code></pre>"},{"location":"go/libraries/client/#explicit-payment-flow","title":"Explicit Payment Flow","text":"<pre><code>client := client.NewX402Client(keypair, \"\", nil, false)\ndefer client.Close()\n\n// Step 1: Initial request\nresp, err := client.Get(ctx, url, nil)\nif err != nil {\n    log.Fatal(err)\n}\n\n// Step 2: Check if payment needed\nif client.PaymentRequired(resp) {\n    // Step 3: Parse request\n    paymentReq, err := client.ParsePaymentRequest(resp)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // Step 4: User confirmation (optional)\n    if !userConfirms(paymentReq) {\n        log.Fatal(\"Payment declined\")\n    }\n\n    // Step 5: Create payment\n    auth, err := client.CreatePayment(ctx, paymentReq, \"\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // Step 6: Retry with payment\n    resp, err = client.Get(ctx, url, auth)\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n\n// Step 7: Process response\ndata, _ := io.ReadAll(resp.Body)\nresp.Body.Close()\n</code></pre>"},{"location":"go/libraries/client/#multiple-endpoints","title":"Multiple Endpoints","text":"<pre><code>client := client.NewAutoClient(keypair, \"\", &amp;client.AutoClientOptions{\n    MaxPaymentAmount: \"10.0\",\n})\ndefer client.Close()\n\nendpoints := map[string]string{\n    \"users\":   \"https://api.example.com/users\",\n    \"posts\":   \"https://api.example.com/posts\",\n    \"premium\": \"https://api.example.com/premium\",\n}\n\nfor name, endpoint := range endpoints {\n    resp, err := client.Get(ctx, endpoint)\n    if err != nil {\n        log.Printf(\"Error accessing %s: %v\", name, err)\n        continue\n    }\n\n    data, _ := io.ReadAll(resp.Body)\n    resp.Body.Close()\n    log.Printf(\"%s: %s\", name, string(data))\n}\n</code></pre>"},{"location":"go/libraries/client/#with-payment-tracking","title":"With Payment Tracking","text":"<pre><code>type PaymentTracker struct {\n    totalSpent float64\n    maxSpend   float64\n    payments   []string\n}\n\nfunc (pt *PaymentTracker) trackPayment(auth *core.PaymentAuthorization) {\n    amount, _ := strconv.ParseFloat(auth.ActualAmount, 64)\n    pt.totalSpent += amount\n    pt.payments = append(pt.payments, auth.TransactionHash)\n    log.Printf(\"Total spent: %.2f / %.2f\", pt.totalSpent, pt.maxSpend)\n}\n\n// Usage\ntracker := &amp;PaymentTracker{\n    totalSpent: 0,\n    maxSpend:   10.0,\n}\n\nclient := client.NewAutoClient(keypair, \"\", &amp;client.AutoClientOptions{\n    MaxPaymentAmount: \"5.0\",  // Prevent individual payments over $5\n})\n\n// Track payments by monitoring response\n// Note: Auto client doesn't expose auth, so you'd need explicit mode for tracking\n</code></pre>"},{"location":"go/libraries/client/#custom-http-client","title":"Custom HTTP Client","text":"<pre><code>httpClient := &amp;http.Client{\n    Timeout: 30 * time.Second,\n    Transport: &amp;http.Transport{\n        MaxIdleConns: 10,\n    },\n}\n\nclient := client.NewX402Client(keypair, \"\", httpClient, false)\n</code></pre>"},{"location":"go/libraries/client/#context-with-timeout","title":"Context with Timeout","text":"<pre><code>ctx, cancel := context.WithTimeout(context.Background(), 60*time.Second)\ndefer cancel()\n\nresp, err := client.Get(ctx, url, nil)\nif errors.Is(err, context.DeadlineExceeded) {\n    log.Println(\"Request timeout\")\n}\n</code></pre>"},{"location":"go/libraries/client/#error-handling","title":"Error Handling","text":"<pre><code>import \"github.com/openlibx402/go/openlibx402-core\"\n\nresp, err := client.Get(ctx, url, nil)\nif err != nil {\n    switch e := err.(type) {\n    case *core.PaymentExpiredError:\n        log.Println(\"Payment request expired\")\n        // Retry or request new payment\n\n    case *core.InsufficientFundsError:\n        log.Printf(\"Insufficient balance: %s\", e.RequiredAmount)\n        // Cannot proceed - need funds\n\n    case *core.PaymentVerificationError:\n        log.Println(\"Payment verification failed\")\n        // Retry - might be temporary\n\n    case *core.InvalidPaymentRequestError:\n        log.Println(\"Invalid payment request\")\n        // Contact API provider\n\n    default:\n        log.Println(\"Unknown error:\", err)\n    }\n}\n</code></pre>"},{"location":"go/libraries/client/#configuration","title":"Configuration","text":""},{"location":"go/libraries/client/#environment-variables","title":"Environment Variables","text":"<pre><code>import \"os\"\n\nrpcURL := os.Getenv(\"X402_RPC_URL\")\nif rpcURL == \"\" {\n    rpcURL = \"https://api.devnet.solana.com\"\n}\n\nmaxPayment := os.Getenv(\"X402_MAX_PAYMENT\")\nif maxPayment == \"\" {\n    maxPayment = \"10.0\"\n}\n</code></pre>"},{"location":"go/libraries/client/#from-config-file","title":"From Config File","text":"<pre><code>type ClientConfig struct {\n    WalletPrivateKey string\n    RPCURL          string\n    MaxPaymentAmount string\n    AutoRetry       bool\n    AllowLocal      bool\n}\n\n// Load from JSON, YAML, TOML, etc\nconfig := loadConfig(\"config.yaml\")\n\nprivateKeyBytes := base58.Decode(config.WalletPrivateKey)\nkeypair := solana.PrivateKey(privateKeyBytes)\n\nclient := client.NewAutoClient(\n    keypair,\n    config.RPCURL,\n    &amp;client.AutoClientOptions{\n        MaxPaymentAmount: config.MaxPaymentAmount,\n        AutoRetry:        config.AutoRetry,\n        AllowLocal:       config.AllowLocal,\n    },\n)\n</code></pre>"},{"location":"go/libraries/client/#security-best-practices","title":"Security Best Practices","text":""},{"location":"go/libraries/client/#do_1","title":"\u2705 Do","text":"<pre><code>// Use payment limits\nclient := client.NewAutoClient(keypair, \"\", &amp;client.AutoClientOptions{\n    MaxPaymentAmount: \"10.0\",  // Prevent overspending\n})\n\n// Use context timeout\nctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)\ndefer cancel()\n\n// Close client when done\ndefer client.Close()\n\n// Validate URLs in explicit mode\n// Client validates URLs automatically\n</code></pre>"},{"location":"go/libraries/client/#dont","title":"\u274c Don't","text":"<pre><code>// Don't use without payment limit\nclient := client.NewAutoClient(keypair, \"\", nil)\n\n// Don't allow local in production\nclient := client.NewAutoClient(keypair, \"\", &amp;client.AutoClientOptions{\n    AllowLocal: true,  // Only for dev!\n})\n\n// Don't forget to close\nclient := client.NewAutoClient(keypair, \"\", nil)\n// Missing: defer client.Close()\n\n// Don't hardcode URLs\nclient.Get(ctx, \"http://192.168.1.1/api\")  // SSRF risk\n</code></pre>"},{"location":"go/libraries/client/#performance-tips","title":"Performance Tips","text":""},{"location":"go/libraries/client/#connection-reuse","title":"Connection Reuse","text":"<pre><code>// Good: Reuse client for multiple requests\nclient := client.NewAutoClient(keypair, \"\", nil)\ndefer client.Close()\n\nfor _, url := range urls {\n    resp, _ := client.Get(ctx, url)\n    // Use response\n}\n</code></pre>"},{"location":"go/libraries/client/#timeout-configuration","title":"Timeout Configuration","text":"<pre><code>// Different timeouts for different needs\nshortTimeout := 10 * time.Second\nlongTimeout := 60 * time.Second\n\nfor _, url := range urls {\n    ctx, cancel := context.WithTimeout(context.Background(), shortTimeout)\n    resp, _ := client.Get(ctx, url)\n    cancel()\n}\n</code></pre>"},{"location":"go/libraries/client/#batch-processing","title":"Batch Processing","text":"<pre><code>// Process multiple endpoints efficiently\nresults := make(chan string)\nfor _, url := range urls {\n    go func(u string) {\n        resp, _ := client.Get(ctx, u)\n        data, _ := io.ReadAll(resp.Body)\n        results &lt;- string(data)\n        resp.Body.Close()\n    }(url)\n}\n\nfor range urls {\n    log.Println(&lt;-results)\n}\n</code></pre>"},{"location":"go/libraries/client/#see-also","title":"See Also","text":"<ul> <li>Core Library - Underlying payment types</li> <li>Server Quick Start</li> <li>Client Quick Start</li> <li>Error Reference</li> </ul>"},{"location":"go/libraries/core/","title":"Core Library","text":"<p>The core library provides the fundamental data structures and Solana blockchain operations for the X402 protocol.</p>"},{"location":"go/libraries/core/#overview","title":"Overview","text":"<p>The <code>openlibx402-core</code> package contains:</p> <ul> <li>Models: <code>PaymentRequest</code>, <code>PaymentAuthorization</code></li> <li>Errors: Complete error hierarchy</li> <li>SolanaPaymentProcessor: Blockchain operations</li> <li>Utilities: Helper functions and types</li> </ul>"},{"location":"go/libraries/core/#installation","title":"Installation","text":"<pre><code>go get github.com/openlibx402/go/openlibx402-core\n</code></pre>"},{"location":"go/libraries/core/#paymentrequest","title":"PaymentRequest","text":"<p>Represents a 402 payment request from a server.</p>"},{"location":"go/libraries/core/#structure","title":"Structure","text":"<pre><code>type PaymentRequest struct {\n    MaxAmountRequired string    // Amount in token units (e.g., \"0.10\")\n    AssetType         string    // \"SPL\" for Solana tokens\n    AssetAddress      string    // Token mint address\n    PaymentAddress    string    // Recipient's wallet address\n    Network           string    // \"solana-devnet\" | \"solana-mainnet\"\n    ExpiresAt         time.Time // Expiration timestamp\n    Nonce             string    // Unique identifier for replay protection\n    PaymentID         string    // Unique payment request ID\n    Resource          string    // API endpoint being accessed\n    Description       string    // Human-readable description (optional)\n}\n</code></pre>"},{"location":"go/libraries/core/#methods","title":"Methods","text":""},{"location":"go/libraries/core/#isexpired","title":"IsExpired()","text":"<p>Check if the payment request has expired.</p> <pre><code>if paymentRequest.IsExpired() {\n    return core.NewPaymentExpiredError(paymentRequest, \"\")\n}\n</code></pre>"},{"location":"go/libraries/core/#tojson","title":"ToJSON()","text":"<p>Convert to JSON string.</p> <pre><code>jsonStr, err := paymentRequest.ToJSON()\n</code></pre>"},{"location":"go/libraries/core/#paymentrequestfromjson","title":"PaymentRequestFromJSON()","text":"<p>Parse from JSON string.</p> <pre><code>paymentReq, err := core.PaymentRequestFromJSON(jsonStr)\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>"},{"location":"go/libraries/core/#paymentauthorization","title":"PaymentAuthorization","text":"<p>Represents a signed payment authorization to include in retry requests.</p>"},{"location":"go/libraries/core/#structure_1","title":"Structure","text":"<pre><code>type PaymentAuthorization struct {\n    PaymentID       string    // From payment request\n    ActualAmount    string    // Amount being paid (\u2264 max_amount_required)\n    PaymentAddress  string    // Recipient address\n    AssetAddress    string    // Token mint address\n    Network         string    // Blockchain network\n    Timestamp       time.Time // Authorization timestamp\n    Signature       string    // Solana signature\n    PublicKey       string    // Payer's public key\n    TransactionHash string    // On-chain tx hash (after broadcast)\n}\n</code></pre>"},{"location":"go/libraries/core/#methods_1","title":"Methods","text":""},{"location":"go/libraries/core/#toheadervalue","title":"ToHeaderValue()","text":"<p>Encode as base64 JSON for HTTP header.</p> <pre><code>headerValue, err := authorization.ToHeaderValue()\n// Use in X-Payment-Authorization header\n</code></pre>"},{"location":"go/libraries/core/#fromheader","title":"FromHeader()","text":"<p>Parse from HTTP header.</p> <pre><code>auth, err := core.PaymentAuthorizationFromHeader(headerValue)\n</code></pre>"},{"location":"go/libraries/core/#tojson_1","title":"ToJSON()","text":"<p>Convert to JSON string.</p> <pre><code>jsonStr, err := authorization.ToJSON()\n</code></pre>"},{"location":"go/libraries/core/#solanapaymentprocessor","title":"SolanaPaymentProcessor","text":"<p>Handles Solana blockchain operations.</p>"},{"location":"go/libraries/core/#constructor","title":"Constructor","text":"<pre><code>processor := core.NewSolanaPaymentProcessor(\n    \"https://api.devnet.solana.com\",  // RPC endpoint\n    &amp;walletKeypair,                    // Optional keypair\n)\ndefer processor.Close()\n</code></pre>"},{"location":"go/libraries/core/#methods_2","title":"Methods","text":""},{"location":"go/libraries/core/#createpaymenttransaction","title":"CreatePaymentTransaction()","text":"<p>Create a Solana transaction for payment.</p> <pre><code>tx, err := processor.CreatePaymentTransaction(\n    ctx,                    // context\n    paymentRequest,         // PaymentRequest\n    \"0.10\",                // amount\n    walletKeypair,         // payer keypair\n)\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>"},{"location":"go/libraries/core/#signandsendtransaction","title":"SignAndSendTransaction()","text":"<p>Sign and broadcast transaction to Solana.</p> <pre><code>txHash, err := processor.SignAndSendTransaction(ctx, tx, walletKeypair)\nif err != nil {\n    log.Fatal(err)\n}\nlog.Printf(\"Sent: %s\", txHash)\n</code></pre>"},{"location":"go/libraries/core/#verifytransaction","title":"VerifyTransaction()","text":"<p>Verify that a transaction exists on-chain and matches parameters.</p> <pre><code>verified, err := processor.VerifyTransaction(\n    ctx,\n    \"transaction_hash\",\n    \"expected_recipient\",\n    \"0.10\",\n    \"token_mint_address\",\n)\nif err != nil || !verified {\n    log.Fatal(\"Verification failed\")\n}\n</code></pre>"},{"location":"go/libraries/core/#gettokenbalance","title":"GetTokenBalance()","text":"<p>Get SPL token balance for a wallet.</p> <pre><code>balance, err := processor.GetTokenBalance(\n    ctx,\n    \"wallet_address\",\n    \"token_mint\",\n)\nif err != nil {\n    log.Fatal(err)\n}\nlog.Printf(\"Balance: %f\", balance)\n</code></pre>"},{"location":"go/libraries/core/#getdefaultrpcurl","title":"GetDefaultRPCURL()","text":"<p>Get the default RPC URL for a network.</p> <pre><code>rpcURL := core.GetDefaultRPCURL(\"solana-devnet\")\n// Returns: \"https://api.devnet.solana.com\"\n</code></pre>"},{"location":"go/libraries/core/#error-types","title":"Error Types","text":""},{"location":"go/libraries/core/#x402error","title":"X402Error","text":"<p>Base error type with code and details.</p> <pre><code>type X402Error struct {\n    Message string\n    Code    string\n    Details map[string]interface{}\n}\n\n// Use\nif err := someFunction(); err != nil {\n    if x402Err, ok := err.(*core.X402Error); ok {\n        log.Printf(\"Code: %s\", x402Err.Code)\n        log.Printf(\"Message: %s\", x402Err.Message)\n    }\n}\n</code></pre>"},{"location":"go/libraries/core/#paymentrequirederror","title":"PaymentRequiredError","text":"<p>Raised when a 402 response is received.</p> <pre><code>return core.NewPaymentRequiredError(paymentRequest, \"\")\n\n// With custom message\nreturn core.NewPaymentRequiredError(\n    paymentRequest,\n    \"Payment required for premium access\",\n)\n</code></pre>"},{"location":"go/libraries/core/#paymentexpirederror","title":"PaymentExpiredError","text":"<p>Payment request has expired.</p> <pre><code>return core.NewPaymentExpiredError(paymentRequest, \"\")\n</code></pre>"},{"location":"go/libraries/core/#insufficientfundserror","title":"InsufficientFundsError","text":"<p>Wallet lacks sufficient funds.</p> <pre><code>return core.NewInsufficientFundsError(\"0.10\", \"0.05\")\n</code></pre>"},{"location":"go/libraries/core/#paymentverificationerror","title":"PaymentVerificationError","text":"<p>Payment verification failed.</p> <pre><code>return core.NewPaymentVerificationError(\"transaction not found\")\n</code></pre>"},{"location":"go/libraries/core/#transactionbroadcasterror","title":"TransactionBroadcastError","text":"<p>Failed to broadcast transaction.</p> <pre><code>return core.NewTransactionBroadcastError(\"network error\")\n</code></pre>"},{"location":"go/libraries/core/#invalidpaymentrequesterror","title":"InvalidPaymentRequestError","text":"<p>Invalid payment request format.</p> <pre><code>return core.NewInvalidPaymentRequestError(\"missing payment_id\")\n</code></pre>"},{"location":"go/libraries/core/#error-codes-reference","title":"Error Codes Reference","text":"<pre><code>core.ErrorCodes[\"PAYMENT_REQUIRED\"]\ncore.ErrorCodes[\"PAYMENT_EXPIRED\"]\ncore.ErrorCodes[\"INSUFFICIENT_FUNDS\"]\ncore.ErrorCodes[\"PAYMENT_VERIFICATION_FAILED\"]\ncore.ErrorCodes[\"TRANSACTION_BROADCAST_FAILED\"]\ncore.ErrorCodes[\"INVALID_PAYMENT_REQUEST\"]\n</code></pre> <p>Each error code includes: - <code>Code</code>: Error code string - <code>Message</code>: Default message - <code>Retry</code>: Whether to retry - <code>UserAction</code>: What user should do</p>"},{"location":"go/libraries/core/#usage-examples","title":"Usage Examples","text":""},{"location":"go/libraries/core/#parse-and-validate-payment-request","title":"Parse and Validate Payment Request","text":"<pre><code>// From 402 response\njsonStr := `{...}`\npaymentReq, err := core.PaymentRequestFromJSON(jsonStr)\nif err != nil {\n    return err\n}\n\n// Check if expired\nif paymentReq.IsExpired() {\n    return core.NewPaymentExpiredError(paymentReq, \"\")\n}\n\n// Use details\nlog.Printf(\"Pay %s to %s\", paymentReq.MaxAmountRequired, paymentReq.PaymentAddress)\n</code></pre>"},{"location":"go/libraries/core/#create-and-verify-payment","title":"Create and Verify Payment","text":"<pre><code>// Create transaction\nprocessor := core.NewSolanaPaymentProcessor(rpcURL, nil)\ndefer processor.Close()\n\ntx, err := processor.CreatePaymentTransaction(ctx, paymentReq, amount, keypair)\nif err != nil {\n    return err\n}\n\n// Broadcast\ntxHash, err := processor.SignAndSendTransaction(ctx, tx, keypair)\nif err != nil {\n    return err\n}\n\n// Verify\nverified, err := processor.VerifyTransaction(\n    ctx,\n    txHash,\n    paymentReq.PaymentAddress,\n    amount,\n    paymentReq.AssetAddress,\n)\nif !verified {\n    return core.NewPaymentVerificationError(\"verification failed\")\n}\n</code></pre>"},{"location":"go/libraries/core/#handle-errors","title":"Handle Errors","text":"<pre><code>resp, err := client.Get(ctx, url)\nif err != nil {\n    switch e := err.(type) {\n    case *core.PaymentRequiredError:\n        log.Println(\"Payment needed\")\n        handlePayment(e.PaymentRequest)\n\n    case *core.InsufficientFundsError:\n        log.Printf(\"Need: %s, Have: %s\", e.RequiredAmount, e.AvailableAmount)\n        // Direct user to add funds\n\n    case *core.PaymentExpiredError:\n        log.Println(\"Request expired, retrying...\")\n        // Retry fresh request\n\n    case *core.PaymentVerificationError:\n        log.Println(\"Verification failed\")\n        // Log and retry\n\n    default:\n        log.Println(\"Unknown error:\", err)\n    }\n}\n</code></pre>"},{"location":"go/libraries/core/#network-configuration","title":"Network Configuration","text":""},{"location":"go/libraries/core/#supported-networks","title":"Supported Networks","text":"<pre><code>// Devnet (testing)\ncore.GetDefaultRPCURL(\"solana-devnet\")\n// \u2192 \"https://api.devnet.solana.com\"\n\n// Testnet\ncore.GetDefaultRPCURL(\"solana-testnet\")\n// \u2192 \"https://api.testnet.solana.com\"\n\n// Mainnet (production)\ncore.GetDefaultRPCURL(\"solana-mainnet\")\n// \u2192 \"https://api.mainnet-beta.solana.com\"\n</code></pre>"},{"location":"go/libraries/core/#custom-rpc-endpoint","title":"Custom RPC Endpoint","text":"<pre><code>processor := core.NewSolanaPaymentProcessor(\n    \"https://your-rpc-endpoint.com\",\n    &amp;keypair,\n)\n</code></pre>"},{"location":"go/libraries/core/#best-practices","title":"Best Practices","text":""},{"location":"go/libraries/core/#do","title":"\u2705 Do","text":"<pre><code>// Check balance before attempting payment\nbalance, _ := processor.GetTokenBalance(ctx, wallet, mint)\nif balance &gt;= requiredAmount {\n    // Safe to proceed\n}\n\n// Validate request not expired\nif !paymentRequest.IsExpired() {\n    // Safe to proceed\n}\n\n// Verify payment on-chain\nverified, _ := processor.VerifyTransaction(ctx, hash, recipient, amount, mint)\n</code></pre>"},{"location":"go/libraries/core/#dont","title":"\u274c Don't","text":"<pre><code>// Don't ignore errors\nprocessor.CreatePaymentTransaction(ctx, req, amount, key)\n\n// Don't skip expiration check\n_ = paymentRequest.IsExpired()\n\n// Don't trust unverified payments\n</code></pre>"},{"location":"go/libraries/core/#see-also","title":"See Also","text":"<ul> <li>Client Library - HTTP client using core library</li> <li>Middleware - Server-side payment handling</li> <li>Error Reference - Complete error documentation</li> </ul>"},{"location":"go/middleware/echo/","title":"Echo Middleware","text":"<p>Server-side X402 payment handling for the Echo web framework.</p>"},{"location":"go/middleware/echo/#overview","title":"Overview","text":"<p>The <code>openlibx402-echo</code> package provides middleware for Echo to require payments for endpoints.</p>"},{"location":"go/middleware/echo/#installation","title":"Installation","text":"<pre><code>go get github.com/openlibx402/go/openlibx402-echo\n</code></pre>"},{"location":"go/middleware/echo/#quick-start","title":"Quick Start","text":"<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"os\"\n\n    \"github.com/labstack/echo/v4\"\n    echox402 \"github.com/openlibx402/go/openlibx402-echo\"\n)\n\nfunc main() {\n    // Initialize configuration\n    echox402.InitX402(&amp;echox402.Config{\n        PaymentAddress: os.Getenv(\"X402_PAYMENT_ADDRESS\"),\n        TokenMint:      os.Getenv(\"X402_TOKEN_MINT\"),\n        Network:        \"solana-devnet\",\n        AutoVerify:     true,\n    })\n\n    e := echo.New()\n\n    // Free endpoint\n    e.GET(\"/api/free\", freeHandler)\n\n    // Protected endpoint\n    e.GET(\"/api/premium\", premiumHandler, echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n        Amount: \"0.10\",\n    }))\n\n    e.Start(\":8080\")\n}\n\nfunc freeHandler(c echo.Context) error {\n    return c.JSON(http.StatusOK, map[string]string{\"data\": \"free\"})\n}\n\nfunc premiumHandler(c echo.Context) error {\n    return c.JSON(http.StatusOK, map[string]string{\"data\": \"premium\"})\n}\n</code></pre>"},{"location":"go/middleware/echo/#configuration","title":"Configuration","text":""},{"location":"go/middleware/echo/#initx402","title":"InitX402()","text":"<p>Initialize global X402 configuration. Call once at startup.</p> <pre><code>echox402.InitX402(&amp;echox402.Config{\n    PaymentAddress: \"YOUR_SOLANA_WALLET\",      // Required\n    TokenMint:      \"USDC_MINT_ADDRESS\",       // Required\n    Network:        \"solana-devnet\",           // Optional\n    RPCURL:         \"https://api.devnet...\",   // Optional\n    AutoVerify:     true,                      // Optional\n})\n</code></pre>"},{"location":"go/middleware/echo/#config-fields","title":"Config Fields","text":"Field Type Required Default Description PaymentAddress string Yes - Wallet receiving payments TokenMint string Yes - SPL token mint address Network string No \"solana-devnet\" Solana network RPCURL string No Auto RPC endpoint AutoVerify bool No false Verify payments on-chain"},{"location":"go/middleware/echo/#middleware","title":"Middleware","text":""},{"location":"go/middleware/echo/#paymentrequired","title":"PaymentRequired()","text":"<p>Add payment requirement to routes.</p> <pre><code>e.GET(\"/api/premium\", handler, echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n    Amount: \"0.10\",\n}))\n</code></pre> <p>Multiple routes:</p> <pre><code>admin := e.Group(\"/admin\", echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n    Amount: \"1.00\",\n}))\nadmin.GET(\"/users\", adminHandler)\nadmin.GET(\"/config\", configHandler)\n</code></pre>"},{"location":"go/middleware/echo/#options","title":"Options","text":"<pre><code>echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n    Amount:         \"0.10\",                 // Required: payment amount\n    PaymentAddress: \"override_address\",     // Optional: override global\n    TokenMint:      \"override_mint\",        // Optional: override global\n    Network:        \"solana-mainnet\",       // Optional: override global\n    Description:    \"Premium data access\", // Optional: human-readable\n    ExpiresIn:      300,                    // Optional: seconds\n    AutoVerify:     true,                   // Optional: verify on-chain\n})\n</code></pre>"},{"location":"go/middleware/echo/#accessing-payment-details","title":"Accessing Payment Details","text":"<p>Use <code>GetPaymentAuthorization()</code> in your handler:</p> <pre><code>func myHandler(c echo.Context) error {\n    auth := echox402.GetPaymentAuthorization(c)\n    if auth != nil {\n        c.Logger().Infof(\"Payment: %s USDC\", auth.ActualAmount)\n    }\n\n    return c.JSON(http.StatusOK, data)\n}\n\ne.GET(\"/api/data\", myHandler, echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n    Amount: \"0.10\",\n}))\n</code></pre>"},{"location":"go/middleware/echo/#paymentauthorization-fields","title":"PaymentAuthorization Fields","text":"<pre><code>type PaymentAuthorization struct {\n    PaymentID       string    // From payment request\n    ActualAmount    string    // Amount paid\n    PaymentAddress  string    // Recipient wallet\n    AssetAddress    string    // Token mint\n    Network         string    // Blockchain network\n    Timestamp       time.Time // When authorized\n    Signature       string    // Transaction signature\n    PublicKey       string    // Payer's wallet\n    TransactionHash string    // On-chain tx hash\n}\n</code></pre>"},{"location":"go/middleware/echo/#patterns","title":"Patterns","text":""},{"location":"go/middleware/echo/#multiple-pricing-tiers","title":"Multiple Pricing Tiers","text":"<pre><code>// Free tier\ne.GET(\"/api/free\", freeHandler)\n\n// Basic tier ($0.05)\ne.GET(\"/api/basic\", basicHandler, echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n    Amount: \"0.05\",\n}))\n\n// Standard tier ($0.10)\ne.GET(\"/api/standard\", standardHandler, echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n    Amount: \"0.10\",\n}))\n\n// Premium tier ($1.00)\ne.GET(\"/api/premium\", premiumHandler, echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n    Amount: \"1.00\",\n}))\n</code></pre>"},{"location":"go/middleware/echo/#route-groups-with-payment","title":"Route Groups with Payment","text":"<pre><code>// Basic API group (free)\napi := e.Group(\"/api\")\napi.GET(\"/public\", publicHandler)\napi.GET(\"/data\", dataHandler)\n\n// Premium API group ($0.10)\npremium := e.Group(\"/api/premium\", echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n    Amount: \"0.10\",\n}))\npremium.GET(\"/data\", premiumDataHandler)\npremium.POST(\"/process\", processHandler)\n\n// Enterprise group ($5.00)\nenterprise := e.Group(\"/api/enterprise\", echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n    Amount: \"5.00\",\n}))\nenterprise.GET(\"/analytics\", analyticsHandler)\nenterprise.GET(\"/export\", exportHandler)\n</code></pre>"},{"location":"go/middleware/echo/#dynamic-pricing","title":"Dynamic Pricing","text":"<pre><code>func dynamicPricingHandler(c echo.Context) error {\n    // Determine price based on request\n    tier := c.QueryParam(\"tier\")\n    var price string\n\n    switch tier {\n    case \"basic\":\n        price = \"0.05\"\n    case \"standard\":\n        price = \"0.10\"\n    case \"premium\":\n        price = \"1.00\"\n    default:\n        price = \"0.05\"\n    }\n\n    // Would need to apply middleware with dynamic amount\n    // This shows how you'd handle it in the handler\n    auth := echox402.GetPaymentAuthorization(c)\n    if auth != nil {\n        c.Logger().Infof(\"Tier: %s, Price: %s\", tier, price)\n    }\n\n    return c.JSON(http.StatusOK, map[string]string{\"tier\": tier})\n}\n\n// For dynamic pricing, apply appropriate middleware:\ne.GET(\"/api/data\", dynamicPricingHandler,\n    echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n        Amount: \"0.10\",  // Use highest expected amount\n    }))\n</code></pre>"},{"location":"go/middleware/echo/#logging-and-analytics","title":"Logging and Analytics","text":"<pre><code>func analyticsHandler(c echo.Context) error {\n    auth := echox402.GetPaymentAuthorization(c)\n    if auth != nil {\n        // Log payment for analytics\n        logPayment(PaymentLog{\n            PaymentID:    auth.PaymentID,\n            Amount:       auth.ActualAmount,\n            Payer:        auth.PublicKey,\n            Endpoint:     c.Request().URL.Path,\n            Timestamp:    auth.Timestamp,\n            Transaction:  auth.TransactionHash,\n        })\n    }\n\n    return c.JSON(http.StatusOK, analyticsData)\n}\n\ne.GET(\"/api/analytics\", analyticsHandler, echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n    Amount: \"0.50\",\n}))\n</code></pre>"},{"location":"go/middleware/echo/#rate-limiting-by-payment","title":"Rate Limiting by Payment","text":"<pre><code>func rateLimitedByPayment(c echo.Context) error {\n    auth := echox402.GetPaymentAuthorization(c)\n    if auth != nil {\n        amount, _ := strconv.ParseFloat(auth.ActualAmount, 64)\n        // Allow 100 requests per $1 paid\n        requestsAllowed := int(amount * 100)\n        c.Set(\"requests_allowed\", requestsAllowed)\n    }\n\n    return c.JSON(http.StatusOK, data)\n}\n\ne.GET(\"/api/data\", rateLimitedByPayment, echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n    Amount: \"0.10\",\n}))\n</code></pre>"},{"location":"go/middleware/echo/#jwt-with-payment","title":"JWT with Payment","text":"<pre><code>import \"github.com/golang-jwt/jwt\"\n\nfunc tokenWithPayment(c echo.Context) error {\n    auth := echox402.GetPaymentAuthorization(c)\n\n    claims := jwt.MapClaims{\n        \"payment_id\": auth.PaymentID,\n        \"payer\":      auth.PublicKey,\n        \"amount\":     auth.ActualAmount,\n        \"exp\":        time.Now().Add(24 * time.Hour).Unix(),\n    }\n\n    token := jwt.NewWithClaims(jwt.SigningMethodHS256, claims)\n    t, _ := token.SignedString([]byte(\"secret\"))\n\n    return c.JSON(http.StatusOK, map[string]string{\"token\": t})\n}\n\ne.GET(\"/api/token\", tokenWithPayment, echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n    Amount: \"0.10\",\n}))\n</code></pre>"},{"location":"go/middleware/echo/#middleware-composition","title":"Middleware Composition","text":""},{"location":"go/middleware/echo/#custom-middleware-payment","title":"Custom Middleware + Payment","text":"<pre><code>func customMiddleware() echo.MiddlewareFunc {\n    return func(next echo.HandlerFunc) echo.HandlerFunc {\n        return func(c echo.Context) error {\n            // Custom logic before\n            c.Set(\"request_id\", uuid.New().String())\n\n            err := next(c)\n\n            // Custom logic after\n            return err\n        }\n    }\n}\n\ne.GET(\"/api/data\", handler,\n    customMiddleware(),\n    echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n        Amount: \"0.10\",\n    }))\n</code></pre>"},{"location":"go/middleware/echo/#logging-middleware","title":"Logging Middleware","text":"<pre><code>e.Use(middleware.LoggerWithConfig(middleware.LoggerConfig{\n    Format: \"${time_rfc3339} ${method} ${uri} ${status}\\n\",\n}))\n\ne.GET(\"/api/data\", handler, echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n    Amount: \"0.10\",\n}))\n</code></pre>"},{"location":"go/middleware/echo/#error-handling","title":"Error Handling","text":"<p>The middleware automatically handles errors:</p> <ul> <li>No payment header: Returns 402 with PaymentRequest</li> <li>Invalid payment: Returns 400 Bad Request</li> <li>Verification failed: Returns 403 Forbidden</li> <li>Amount insufficient: Returns 403 Forbidden</li> <li>Address mismatch: Returns 403 Forbidden</li> </ul> <p>Your handler won't be called if payment fails.</p>"},{"location":"go/middleware/echo/#configuration-override","title":"Configuration Override","text":""},{"location":"go/middleware/echo/#per-route-override","title":"Per-Route Override","text":"<pre><code>echox402.InitX402(&amp;echox402.Config{\n    PaymentAddress: \"default_address\",\n    TokenMint:      \"default_mint\",\n})\n\n// Override for specific route\ne.GET(\"/premium\",\n    handler,\n    echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n        Amount:         \"0.10\",\n        PaymentAddress: \"different_address\",\n    }))\n</code></pre>"},{"location":"go/middleware/echo/#environment-based-configuration","title":"Environment-Based Configuration","text":"<pre><code>config := &amp;echox402.Config{\n    PaymentAddress: os.Getenv(\"X402_PAYMENT_ADDRESS\"),\n    TokenMint:      os.Getenv(\"X402_TOKEN_MINT\"),\n}\n\nif os.Getenv(\"ENVIRONMENT\") == \"production\" {\n    config.Network = \"solana-mainnet\"\n    config.RPCURL = \"https://api.mainnet-beta.solana.com\"\n    config.AutoVerify = true\n} else {\n    config.Network = \"solana-devnet\"\n    config.RPCURL = \"https://api.devnet.solana.com\"\n    config.AutoVerify = false\n}\n\nechox402.InitX402(config)\n</code></pre>"},{"location":"go/middleware/echo/#production-setup","title":"Production Setup","text":""},{"location":"go/middleware/echo/#configuration_1","title":"Configuration","text":"<pre><code># Environment variables\nX402_PAYMENT_ADDRESS=\"YOUR_MAINNET_WALLET\"\nX402_TOKEN_MINT=\"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\"\nX402_NETWORK=\"solana-mainnet\"\nX402_RPC_URL=\"https://api.mainnet-beta.solana.com\"\n</code></pre>"},{"location":"go/middleware/echo/#https","title":"HTTPS","text":"<pre><code>e.StartTLS(\":443\", \"cert.pem\", \"key.pem\")\n</code></pre>"},{"location":"go/middleware/echo/#graceful-shutdown","title":"Graceful Shutdown","text":"<pre><code>e.Use(middleware.Logger())\ne.Use(middleware.Recover())\n\ngo func() {\n    if err := e.Start(\":8080\"); err != nil {\n        e.Logger.Info(\"shutting down:\", err)\n    }\n}()\n\nquit := make(chan os.Signal, 1)\nsignal.Notify(quit, syscall.SIGINT, syscall.SIGTERM)\n&lt;-quit\n\nctx, cancel := context.WithTimeout(context.Background(), 10*time.Second)\ndefer cancel()\nif err := e.Shutdown(ctx); err != nil {\n    e.Logger.Fatal(err)\n}\n</code></pre>"},{"location":"go/middleware/echo/#testing","title":"Testing","text":""},{"location":"go/middleware/echo/#unit-test","title":"Unit Test","text":"<pre><code>func TestPremiumHandler(t *testing.T) {\n    e := echo.New()\n\n    echox402.InitX402(&amp;echox402.Config{\n        PaymentAddress: \"test_address\",\n        TokenMint:      \"test_mint\",\n    })\n\n    e.GET(\"/api/premium\", premiumHandler, echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n        Amount: \"0.10\",\n    }))\n\n    req := httptest.NewRequest(echo.GET, \"/api/premium\", nil)\n    rec := httptest.NewRecorder()\n    c := e.NewContext(req, rec)\n\n    // Should return 402 without payment\n    assert.Equal(t, http.StatusPaymentRequired, rec.Code)\n}\n</code></pre>"},{"location":"go/middleware/echo/#troubleshooting","title":"Troubleshooting","text":""},{"location":"go/middleware/echo/#x402-not-initialized","title":"\"X402 not initialized\"","text":"<p>Solution: Call <code>InitX402()</code> before defining routes.</p> <pre><code>echox402.InitX402(&amp;echox402.Config{...})\ne := echo.New()\ne.GET(\"/api\", handler)\n</code></pre>"},{"location":"go/middleware/echo/#payment-not-recognized","title":"Payment not recognized","text":"<p>Solution: Ensure middleware is in correct position.</p> <pre><code>// Correct: middleware last\ne.GET(\"/api/data\", handler, echox402.PaymentRequired(opts))\n\n// Incorrect: middleware first\ne.GET(\"/api/data\", echox402.PaymentRequired(opts), handler)\n</code></pre>"},{"location":"go/middleware/echo/#see-also","title":"See Also","text":"<ul> <li>net/http Middleware - Alternative for standard library</li> <li>Server Quick Start</li> <li>Core Library</li> <li>Error Reference</li> </ul>"},{"location":"go/middleware/nethttp/","title":"net/http Middleware","text":"<p>Server-side X402 payment handling for Go's standard <code>net/http</code> package.</p>"},{"location":"go/middleware/nethttp/#overview","title":"Overview","text":"<p>The <code>openlibx402-nethttp</code> package provides middleware to require payments for HTTP endpoints using the standard library.</p>"},{"location":"go/middleware/nethttp/#installation","title":"Installation","text":"<pre><code>go get github.com/openlibx402/go/openlibx402-nethttp\n</code></pre>"},{"location":"go/middleware/nethttp/#quick-start","title":"Quick Start","text":"<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"net/http\"\n    \"os\"\n\n    nethttp \"github.com/openlibx402/go/openlibx402-nethttp\"\n)\n\nfunc main() {\n    // Initialize global configuration\n    nethttp.InitX402(&amp;nethttp.Config{\n        PaymentAddress: os.Getenv(\"X402_PAYMENT_ADDRESS\"),\n        TokenMint:      os.Getenv(\"X402_TOKEN_MINT\"),\n        Network:        \"solana-devnet\",\n        AutoVerify:     true,\n    })\n\n    // Free endpoint\n    http.HandleFunc(\"/api/free\", freeHandler)\n\n    // Protected endpoint\n    http.Handle(\"/api/premium\", nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n        Amount: \"0.10\",\n    })(http.HandlerFunc(premiumHandler)))\n\n    http.ListenAndServe(\":8080\", nil)\n}\n\nfunc freeHandler(w http.ResponseWriter, r *http.Request) {\n    json.NewEncoder(w).Encode(map[string]string{\"data\": \"free\"})\n}\n\nfunc premiumHandler(w http.ResponseWriter, r *http.Request) {\n    json.NewEncoder(w).Encode(map[string]string{\"data\": \"premium\"})\n}\n</code></pre>"},{"location":"go/middleware/nethttp/#configuration","title":"Configuration","text":""},{"location":"go/middleware/nethttp/#initx402","title":"InitX402()","text":"<p>Initialize global X402 configuration. Call once at startup.</p> <pre><code>nethttp.InitX402(&amp;nethttp.Config{\n    PaymentAddress: \"YOUR_SOLANA_WALLET\",      // Required\n    TokenMint:      \"USDC_MINT_ADDRESS\",       // Required\n    Network:        \"solana-devnet\",           // Optional: default shown\n    RPCURL:         \"https://api.devnet...\",   // Optional\n    AutoVerify:     true,                      // Optional: default shown\n})\n</code></pre>"},{"location":"go/middleware/nethttp/#config-fields","title":"Config Fields","text":"Field Type Required Default Description PaymentAddress string Yes - Wallet receiving payments TokenMint string Yes - SPL token mint address Network string No \"solana-devnet\" Solana network RPCURL string No Auto RPC endpoint AutoVerify bool No false Verify payments on-chain"},{"location":"go/middleware/nethttp/#middleware","title":"Middleware","text":""},{"location":"go/middleware/nethttp/#paymentrequired","title":"PaymentRequired()","text":"<p>Add payment requirement to endpoints.</p> <pre><code>http.Handle(\"/endpoint\", nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n    Amount: \"0.10\",\n})(handler))\n</code></pre>"},{"location":"go/middleware/nethttp/#options","title":"Options","text":"<pre><code>nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n    Amount:         \"0.10\",                 // Required: payment amount\n    PaymentAddress: \"override_address\",     // Optional: override global\n    TokenMint:      \"override_mint\",        // Optional: override global\n    Network:        \"solana-mainnet\",       // Optional: override global\n    Description:    \"Premium data access\", // Optional: human-readable\n    ExpiresIn:      300,                    // Optional: seconds\n    AutoVerify:     true,                   // Optional: verify on-chain\n})\n</code></pre>"},{"location":"go/middleware/nethttp/#accessing-payment-details","title":"Accessing Payment Details","text":"<p>Use <code>GetPaymentAuthorization()</code> in your handler:</p> <pre><code>func myHandler(w http.ResponseWriter, r *http.Request) {\n    auth := nethttp.GetPaymentAuthorization(r)\n    if auth != nil {\n        log.Printf(\"Payment ID: %s\", auth.PaymentID)\n        log.Printf(\"Amount: %s\", auth.ActualAmount)\n        log.Printf(\"Payer: %s\", auth.PublicKey)\n    }\n\n    // Serve content\n    json.NewEncoder(w).Encode(data)\n}\n</code></pre>"},{"location":"go/middleware/nethttp/#paymentauthorization-fields","title":"PaymentAuthorization Fields","text":"<pre><code>type PaymentAuthorization struct {\n    PaymentID       string    // From payment request\n    ActualAmount    string    // Amount paid\n    PaymentAddress  string    // Recipient wallet\n    AssetAddress    string    // Token mint\n    Network         string    // Blockchain network\n    Timestamp       time.Time // When authorized\n    Signature       string    // Transaction signature\n    PublicKey       string    // Payer's wallet\n    TransactionHash string    // On-chain tx hash\n}\n</code></pre>"},{"location":"go/middleware/nethttp/#patterns","title":"Patterns","text":""},{"location":"go/middleware/nethttp/#multiple-pricing-tiers","title":"Multiple Pricing Tiers","text":"<pre><code>// Free tier\nhttp.HandleFunc(\"/api/free\", freeHandler)\n\n// Basic tier ($0.05)\nhttp.Handle(\"/api/basic\",\n    nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n        Amount: \"0.05\",\n    })(http.HandlerFunc(basicHandler)))\n\n// Standard tier ($0.10)\nhttp.Handle(\"/api/standard\",\n    nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n        Amount: \"0.10\",\n    })(http.HandlerFunc(standardHandler)))\n\n// Premium tier ($1.00)\nhttp.Handle(\"/api/premium\",\n    nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n        Amount: \"1.00\",\n    })(http.HandlerFunc(premiumHandler)))\n</code></pre>"},{"location":"go/middleware/nethttp/#different-token-per-endpoint","title":"Different Token Per Endpoint","text":"<pre><code>// USDC endpoint\nhttp.Handle(\"/api/usdc\",\n    nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n        Amount: \"0.10\",\n        TokenMint: \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\",\n    })(handler))\n\n// Custom token endpoint\nhttp.Handle(\"/api/custom\",\n    nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n        Amount: \"100.00\",\n        TokenMint: \"YOUR_CUSTOM_TOKEN_MINT\",\n    })(handler))\n</code></pre>"},{"location":"go/middleware/nethttp/#logging-payments","title":"Logging Payments","text":"<pre><code>func loggedPaymentHandler(w http.ResponseWriter, r *http.Request) {\n    auth := nethttp.GetPaymentAuthorization(r)\n    if auth != nil {\n        log.Printf(\"[PAYMENT] %s paid %s USDC (TX: %s)\",\n            auth.PublicKey[:8],\n            auth.ActualAmount,\n            auth.TransactionHash[:8])\n    }\n\n    json.NewEncoder(w).Encode(data)\n}\n\nhttp.Handle(\"/api/logged\",\n    nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n        Amount: \"0.10\",\n    })(http.HandlerFunc(loggedPaymentHandler)))\n</code></pre>"},{"location":"go/middleware/nethttp/#custom-handler-wrapper","title":"Custom Handler Wrapper","text":"<pre><code>func withPayment(amount string, handler http.HandlerFunc) http.Handler {\n    return nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n        Amount: amount,\n    })(handler)\n}\n\n// Usage\nhttp.Handle(\"/api/data\", withPayment(\"0.10\", myDataHandler))\nhttp.Handle(\"/api/export\", withPayment(\"1.00\", myExportHandler))\n</code></pre>"},{"location":"go/middleware/nethttp/#conditional-payment","title":"Conditional Payment","text":"<pre><code>func conditionalHandler(w http.ResponseWriter, r *http.Request) {\n    // Get query parameter\n    tier := r.URL.Query().Get(\"tier\")\n\n    // Determine if payment needed\n    if tier != \"free\" &amp;&amp; tier != \"\" {\n        // Payment was required before reaching here\n        // Middleware already handled it\n        auth := nethttp.GetPaymentAuthorization(r)\n        if auth == nil {\n            http.Error(w, \"Payment required\", http.StatusForbidden)\n            return\n        }\n    }\n\n    json.NewEncoder(w).Encode(data)\n}\n\n// Note: For conditional payment, you may need custom logic\n// or use explicit payment in your handler\n</code></pre>"},{"location":"go/middleware/nethttp/#request-metadata","title":"Request Metadata","text":"<pre><code>func trackingHandler(w http.ResponseWriter, r *http.Request) {\n    auth := nethttp.GetPaymentAuthorization(r)\n\n    // Log request details\n    log.Printf(\"Request: %s %s\", r.Method, r.URL.Path)\n    log.Printf(\"Payer: %s\", auth.PublicKey)\n    log.Printf(\"Amount: %s\", auth.ActualAmount)\n\n    // Could update analytics, billing, etc.\n    updateAnalytics(r.URL.Path, auth.PublicKey, auth.ActualAmount)\n\n    json.NewEncoder(w).Encode(data)\n}\n\nhttp.Handle(\"/api/tracked\",\n    nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n        Amount: \"0.10\",\n    })(http.HandlerFunc(trackingHandler)))\n</code></pre>"},{"location":"go/middleware/nethttp/#error-handling","title":"Error Handling","text":"<p>The middleware automatically handles errors:</p> <ul> <li>No payment header: Returns 402 with PaymentRequest</li> <li>Invalid payment: Returns 400 Bad Request</li> <li>Verification failed: Returns 403 Forbidden</li> <li>Amount insufficient: Returns 403 Forbidden</li> <li>Address mismatch: Returns 403 Forbidden</li> </ul> <p>Your handler won't be called if payment fails.</p>"},{"location":"go/middleware/nethttp/#configuration-override","title":"Configuration Override","text":""},{"location":"go/middleware/nethttp/#per-handler-override","title":"Per-Handler Override","text":"<pre><code>nethttp.InitX402(&amp;nethttp.Config{\n    PaymentAddress: \"default_address\",\n    TokenMint:      \"default_mint\",\n})\n\n// Override for specific endpoint\nhttp.Handle(\"/api/premium\",\n    nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n        Amount:         \"0.10\",\n        PaymentAddress: \"different_address\",\n        TokenMint:      \"different_mint\",\n    })(handler))\n</code></pre>"},{"location":"go/middleware/nethttp/#environment-based-configuration","title":"Environment-Based Configuration","text":"<pre><code>config := &amp;nethttp.Config{\n    PaymentAddress: os.Getenv(\"X402_PAYMENT_ADDRESS\"),\n    TokenMint:      os.Getenv(\"X402_TOKEN_MINT\"),\n}\n\nif os.Getenv(\"X402_MAINNET\") == \"true\" {\n    config.Network = \"solana-mainnet\"\n    config.RPCURL = \"https://api.mainnet-beta.solana.com\"\n} else {\n    config.Network = \"solana-devnet\"\n    config.RPCURL = \"https://api.devnet.solana.com\"\n}\n\nnethttp.InitX402(config)\n</code></pre>"},{"location":"go/middleware/nethttp/#production-setup","title":"Production Setup","text":""},{"location":"go/middleware/nethttp/#configuration_1","title":"Configuration","text":"<pre><code># .env or environment variables\nX402_PAYMENT_ADDRESS=\"YOUR_MAINNET_WALLET\"\nX402_TOKEN_MINT=\"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\"\nX402_NETWORK=\"solana-mainnet\"\nX402_RPC_URL=\"https://api.mainnet-beta.solana.com\"\nPORT=443\n</code></pre>"},{"location":"go/middleware/nethttp/#ssltls","title":"SSL/TLS","text":"<pre><code>http.ListenAndServeTLS(\":443\", \"cert.pem\", \"key.pem\", nil)\n</code></pre>"},{"location":"go/middleware/nethttp/#rate-limiting","title":"Rate Limiting","text":"<pre><code>import \"golang.org/x/time/rate\"\n\nvar limiter = rate.NewLimiter(100, 10) // 100 req/s, burst 10\n\nfunc rateLimited(handler http.HandlerFunc) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n        if !limiter.Allow() {\n            http.Error(w, \"Rate limited\", http.StatusTooManyRequests)\n            return\n        }\n        handler(w, r)\n    }\n}\n\nhttp.Handle(\"/api/data\",\n    rateLimited(nethttp.PaymentRequired(opts)(handler)))\n</code></pre>"},{"location":"go/middleware/nethttp/#testing","title":"Testing","text":""},{"location":"go/middleware/nethttp/#mock-payment","title":"Mock Payment","text":"<p>For testing without real payments:</p> <pre><code>func testHandler(t *testing.T) {\n    // In test, you can mock the middleware\n    // Or use devnet with test tokens\n    rec := httptest.NewRecorder()\n    req := httptest.NewRequest(\"GET\", \"/api/premium\", nil)\n\n    // Handler will return 402 in test without payment auth\n    handler(rec, req)\n    assert.Equal(t, http.StatusPaymentRequired, rec.Code)\n}\n</code></pre>"},{"location":"go/middleware/nethttp/#troubleshooting","title":"Troubleshooting","text":""},{"location":"go/middleware/nethttp/#x402-not-initialized-error","title":"\"X402 not initialized\" error","text":"<pre><code>Error: X402 not initialized. Call InitX402() first.\n</code></pre> <p>Solution: Call <code>InitX402()</code> before defining routes.</p> <pre><code>nethttp.InitX402(&amp;nethttp.Config{...})\nhttp.Handle(\"/api\", myHandler)\n</code></pre>"},{"location":"go/middleware/nethttp/#paymentaddress-and-tokenmint-must-be-configured","title":"\"paymentAddress and tokenMint must be configured\"","text":"<p>Solution: Set environment variables or pass to <code>InitX402()</code>.</p> <pre><code>export X402_PAYMENT_ADDRESS=\"YOUR_ADDRESS\"\nexport X402_TOKEN_MINT=\"YOUR_MINT\"\n</code></pre>"},{"location":"go/middleware/nethttp/#payment-verification-failures","title":"Payment verification failures","text":"<p>Solution: Check RPC endpoint and network configuration.</p> <pre><code>config := nethttp.Config{\n    Network: \"solana-devnet\",\n    RPCURL:  \"https://api.devnet.solana.com\",\n    AutoVerify: false,  // Disable if RPC is slow\n}\n</code></pre>"},{"location":"go/middleware/nethttp/#see-also","title":"See Also","text":"<ul> <li>Echo Middleware - Alternative framework</li> <li>Server Quick Start</li> <li>Core Library</li> <li>Error Reference</li> </ul>"},{"location":"go/reference/api-reference/","title":"API Reference","text":"<p>Complete API reference for all X402 Go packages.</p>"},{"location":"go/reference/api-reference/#core-package-openlibx402-core","title":"Core Package (<code>openlibx402-core</code>)","text":""},{"location":"go/reference/api-reference/#paymentrequest","title":"PaymentRequest","text":"<p>Represents a 402 payment request from a server.</p>"},{"location":"go/reference/api-reference/#structure","title":"Structure","text":"<pre><code>type PaymentRequest struct {\n    MaxAmountRequired string\n    AssetType         string\n    AssetAddress      string\n    PaymentAddress    string\n    Network           string\n    ExpiresAt         time.Time\n    Nonce             string\n    PaymentID         string\n    Resource          string\n    Description       string\n}\n</code></pre>"},{"location":"go/reference/api-reference/#methods","title":"Methods","text":"Method Signature Returns Description <code>IsExpired()</code> <code>IsExpired() bool</code> <code>bool</code> Check if payment request has expired <code>ToJSON()</code> <code>ToJSON() (string, error)</code> <code>(string, error)</code> Convert to JSON string"},{"location":"go/reference/api-reference/#functions","title":"Functions","text":"Function Signature Returns Description <code>PaymentRequestFromJSON()</code> <code>PaymentRequestFromJSON(jsonStr string) (*PaymentRequest, error)</code> <code>(*PaymentRequest, error)</code> Parse from JSON string"},{"location":"go/reference/api-reference/#paymentauthorization","title":"PaymentAuthorization","text":"<p>Represents a signed payment authorization for retry requests.</p>"},{"location":"go/reference/api-reference/#structure_1","title":"Structure","text":"<pre><code>type PaymentAuthorization struct {\n    PaymentID       string\n    ActualAmount    string\n    PaymentAddress  string\n    AssetAddress    string\n    Network         string\n    Timestamp       time.Time\n    Signature       string\n    PublicKey       string\n    TransactionHash string\n}\n</code></pre>"},{"location":"go/reference/api-reference/#methods_1","title":"Methods","text":"Method Signature Returns Description <code>ToHeaderValue()</code> <code>ToHeaderValue() (string, error)</code> <code>(string, error)</code> Encode as base64 JSON for HTTP header <code>ToJSON()</code> <code>ToJSON() (string, error)</code> <code>(string, error)</code> Convert to JSON string"},{"location":"go/reference/api-reference/#functions_1","title":"Functions","text":"Function Signature Returns Description <code>PaymentAuthorizationFromHeader()</code> <code>PaymentAuthorizationFromHeader(headerValue string) (*PaymentAuthorization, error)</code> <code>(*PaymentAuthorization, error)</code> Parse from HTTP header"},{"location":"go/reference/api-reference/#solanapaymentprocessor","title":"SolanaPaymentProcessor","text":"<p>Handles Solana blockchain operations.</p>"},{"location":"go/reference/api-reference/#constructor","title":"Constructor","text":"<pre><code>func NewSolanaPaymentProcessor(\n    rpcURL string,\n    keypair *solana.PrivateKey,\n) *SolanaPaymentProcessor\n</code></pre>"},{"location":"go/reference/api-reference/#methods_2","title":"Methods","text":"Method Signature Returns Description <code>CreatePaymentTransaction()</code> <code>CreatePaymentTransaction(ctx context.Context, paymentReq *PaymentRequest, amount string, keypair solana.PrivateKey) (*solana.Transaction, error)</code> <code>(*solana.Transaction, error)</code> Create payment transaction <code>SignAndSendTransaction()</code> <code>SignAndSendTransaction(ctx context.Context, tx *solana.Transaction, keypair solana.PrivateKey) (string, error)</code> <code>(string, error)</code> Sign and broadcast transaction <code>VerifyTransaction()</code> <code>VerifyTransaction(ctx context.Context, txHash string, recipient string, amount string, tokenMint string) (bool, error)</code> <code>(bool, error)</code> Verify transaction on-chain <code>GetTokenBalance()</code> <code>GetTokenBalance(ctx context.Context, walletAddress string, tokenMint string) (float64, error)</code> <code>(float64, error)</code> Get SPL token balance <code>Close()</code> <code>Close()</code> - Close processor and cleanup resources"},{"location":"go/reference/api-reference/#functions_2","title":"Functions","text":"Function Signature Returns Description <code>GetDefaultRPCURL()</code> <code>GetDefaultRPCURL(network string) string</code> <code>string</code> Get default RPC URL for network"},{"location":"go/reference/api-reference/#error-types","title":"Error Types","text":""},{"location":"go/reference/api-reference/#x402error","title":"X402Error","text":"<p>Base error type.</p> <pre><code>type X402Error struct {\n    Message string\n    Code    string\n    Details map[string]interface{}\n}\n</code></pre>"},{"location":"go/reference/api-reference/#paymentrequirederror","title":"PaymentRequiredError","text":"<p>Raised when 402 response is received.</p> <pre><code>func NewPaymentRequiredError(paymentReq *PaymentRequest, message string) error\n</code></pre>"},{"location":"go/reference/api-reference/#paymentexpirederror","title":"PaymentExpiredError","text":"<p>Payment request has expired.</p> <pre><code>func NewPaymentExpiredError(paymentReq *PaymentRequest, message string) error\n</code></pre>"},{"location":"go/reference/api-reference/#insufficientfundserror","title":"InsufficientFundsError","text":"<p>Wallet lacks sufficient funds.</p> <pre><code>func NewInsufficientFundsError(required string, available string) error\n</code></pre>"},{"location":"go/reference/api-reference/#paymentverificationerror","title":"PaymentVerificationError","text":"<p>Payment verification failed.</p> <pre><code>func NewPaymentVerificationError(message string) error\n</code></pre>"},{"location":"go/reference/api-reference/#transactionbroadcasterror","title":"TransactionBroadcastError","text":"<p>Failed to broadcast transaction.</p> <pre><code>func NewTransactionBroadcastError(message string) error\n</code></pre>"},{"location":"go/reference/api-reference/#invalidpaymentrequesterror","title":"InvalidPaymentRequestError","text":"<p>Invalid payment request format.</p> <pre><code>func NewInvalidPaymentRequestError(message string) error\n</code></pre>"},{"location":"go/reference/api-reference/#client-package-openlibx402-client","title":"Client Package (<code>openlibx402-client</code>)","text":""},{"location":"go/reference/api-reference/#x402client-explicit-mode","title":"X402Client (Explicit Mode)","text":"<p>Manual payment control HTTP client.</p>"},{"location":"go/reference/api-reference/#constructor_1","title":"Constructor","text":"<pre><code>func NewX402Client(\n    walletKeypair solana.PrivateKey,\n    rpcURL string,\n    httpClient *http.Client,\n    allowLocal bool,\n) *X402Client\n</code></pre>"},{"location":"go/reference/api-reference/#methods_3","title":"Methods","text":"Method Signature Returns Description <code>Get()</code> <code>Get(ctx context.Context, url string, auth *core.PaymentAuthorization) (*http.Response, error)</code> <code>(*http.Response, error)</code> Execute GET request <code>Post()</code> <code>Post(ctx context.Context, url string, body []byte, auth *core.PaymentAuthorization) (*http.Response, error)</code> <code>(*http.Response, error)</code> Execute POST request <code>Put()</code> <code>Put(ctx context.Context, url string, body []byte, auth *core.PaymentAuthorization) (*http.Response, error)</code> <code>(*http.Response, error)</code> Execute PUT request <code>Delete()</code> <code>Delete(ctx context.Context, url string, auth *core.PaymentAuthorization) (*http.Response, error)</code> <code>(*http.Response, error)</code> Execute DELETE request <code>Do()</code> <code>Do(ctx context.Context, req *http.Request, auth *core.PaymentAuthorization) (*http.Response, error)</code> <code>(*http.Response, error)</code> Execute any HTTP request <code>PaymentRequired()</code> <code>PaymentRequired(resp *http.Response) bool</code> <code>bool</code> Check if response is 402 Payment Required <code>ParsePaymentRequest()</code> <code>ParsePaymentRequest(resp *http.Response) (*core.PaymentRequest, error)</code> <code>(*core.PaymentRequest, error)</code> Parse PaymentRequest from 402 response <code>CreatePayment()</code> <code>CreatePayment(ctx context.Context, paymentReq *core.PaymentRequest, customAmount string) (*core.PaymentAuthorization, error)</code> <code>(*core.PaymentAuthorization, error)</code> Create and broadcast payment <code>Close()</code> <code>Close()</code> - Close client and cleanup"},{"location":"go/reference/api-reference/#x402autoclient-automatic-mode","title":"X402AutoClient (Automatic Mode)","text":"<p>Automatic payment handling HTTP client.</p>"},{"location":"go/reference/api-reference/#constructor_2","title":"Constructor","text":"<pre><code>func NewAutoClient(\n    walletKeypair solana.PrivateKey,\n    rpcURL string,\n    options *AutoClientOptions,\n) *X402AutoClient\n</code></pre>"},{"location":"go/reference/api-reference/#options","title":"Options","text":"<pre><code>type AutoClientOptions struct {\n    MaxPaymentAmount string // e.g., \"10.0\"\n    AutoRetry        bool\n    AllowLocal       bool\n}\n</code></pre>"},{"location":"go/reference/api-reference/#methods_4","title":"Methods","text":"Method Signature Returns Description <code>Get()</code> <code>Get(ctx context.Context, url string) (*http.Response, error)</code> <code>(*http.Response, error)</code> GET (auto-pays if needed) <code>Post()</code> <code>Post(ctx context.Context, url string, body []byte) (*http.Response, error)</code> <code>(*http.Response, error)</code> POST (auto-pays if needed) <code>Put()</code> <code>Put(ctx context.Context, url string, body []byte) (*http.Response, error)</code> <code>(*http.Response, error)</code> PUT (auto-pays if needed) <code>Delete()</code> <code>Delete(ctx context.Context, url string) (*http.Response, error)</code> <code>(*http.Response, error)</code> DELETE (auto-pays if needed) <code>Close()</code> <code>Close()</code> - Close client and cleanup"},{"location":"go/reference/api-reference/#nethttp-middleware-openlibx402-nethttp","title":"net/http Middleware (<code>openlibx402-nethttp</code>)","text":""},{"location":"go/reference/api-reference/#initialization","title":"Initialization","text":"<pre><code>func InitX402(config *Config)\n</code></pre>"},{"location":"go/reference/api-reference/#config","title":"Config","text":"<pre><code>type Config struct {\n    PaymentAddress string // Required\n    TokenMint      string // Required\n    Network        string // Optional, default: \"solana-devnet\"\n    RPCURL         string // Optional\n    AutoVerify     bool   // Optional, default: false\n}\n</code></pre>"},{"location":"go/reference/api-reference/#middleware","title":"Middleware","text":"<pre><code>func PaymentRequired(options PaymentRequiredOptions) func(http.Handler) http.Handler\n</code></pre>"},{"location":"go/reference/api-reference/#paymentrequiredoptions","title":"PaymentRequiredOptions","text":"<pre><code>type PaymentRequiredOptions struct {\n    Amount         string // Required\n    PaymentAddress string // Optional\n    TokenMint      string // Optional\n    Network        string // Optional\n    Description    string // Optional\n    ExpiresIn      int    // Optional, default: 300 seconds\n    AutoVerify     bool   // Optional\n}\n</code></pre>"},{"location":"go/reference/api-reference/#helper-functions","title":"Helper Functions","text":"<pre><code>// Get payment authorization from request\nfunc GetPaymentAuthorization(r *http.Request) *core.PaymentAuthorization\n</code></pre>"},{"location":"go/reference/api-reference/#echo-middleware-openlibx402-echo","title":"Echo Middleware (<code>openlibx402-echo</code>)","text":""},{"location":"go/reference/api-reference/#initialization_1","title":"Initialization","text":"<pre><code>func InitX402(config *Config)\n</code></pre>"},{"location":"go/reference/api-reference/#config_1","title":"Config","text":"<pre><code>type Config struct {\n    PaymentAddress string // Required\n    TokenMint      string // Required\n    Network        string // Optional, default: \"solana-devnet\"\n    RPCURL         string // Optional\n    AutoVerify     bool   // Optional, default: false\n}\n</code></pre>"},{"location":"go/reference/api-reference/#middleware_1","title":"Middleware","text":"<pre><code>func PaymentRequired(options PaymentRequiredOptions) echo.MiddlewareFunc\n</code></pre>"},{"location":"go/reference/api-reference/#paymentrequiredoptions_1","title":"PaymentRequiredOptions","text":"<pre><code>type PaymentRequiredOptions struct {\n    Amount         string // Required\n    PaymentAddress string // Optional\n    TokenMint      string // Optional\n    Network        string // Optional\n    Description    string // Optional\n    ExpiresIn      int    // Optional, default: 300 seconds\n    AutoVerify     bool   // Optional\n}\n</code></pre>"},{"location":"go/reference/api-reference/#helper-functions_1","title":"Helper Functions","text":"<pre><code>// Get payment authorization from Echo context\nfunc GetPaymentAuthorization(c echo.Context) *core.PaymentAuthorization\n</code></pre>"},{"location":"go/reference/api-reference/#http-headers","title":"HTTP Headers","text":""},{"location":"go/reference/api-reference/#request-headers","title":"Request Headers","text":""},{"location":"go/reference/api-reference/#x-payment-authorization","title":"X-Payment-Authorization","text":"<p>Payment authorization header included in requests after 402 response.</p> <pre><code>X-Payment-Authorization: &lt;base64-encoded-json&gt;\n</code></pre> <p>Format: <pre><code>{\n  \"payment_id\": \"...\",\n  \"actual_amount\": \"0.10\",\n  \"payment_address\": \"...\",\n  \"asset_address\": \"...\",\n  \"network\": \"solana-devnet\",\n  \"timestamp\": \"2024-01-01T00:00:00Z\",\n  \"signature\": \"...\",\n  \"public_key\": \"...\",\n  \"transaction_hash\": \"...\"\n}\n</code></pre></p>"},{"location":"go/reference/api-reference/#response-headers","title":"Response Headers","text":""},{"location":"go/reference/api-reference/#402-payment-required","title":"402 Payment Required","text":"<p>Status code: <code>402</code></p> <p>Response body (JSON): <pre><code>{\n  \"max_amount_required\": \"0.10\",\n  \"asset_type\": \"SPL\",\n  \"asset_address\": \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\",\n  \"payment_address\": \"YOUR_WALLET_ADDRESS\",\n  \"network\": \"solana-devnet\",\n  \"expires_at\": \"2025-01-01T00:05:00Z\",\n  \"nonce\": \"abc123...\",\n  \"payment_id\": \"def456...\",\n  \"resource\": \"/api/endpoint\",\n  \"description\": \"Endpoint description\"\n}\n</code></pre></p>"},{"location":"go/reference/api-reference/#error-codes","title":"Error Codes","text":""},{"location":"go/reference/api-reference/#payment-required-402","title":"Payment Required (402)","text":"<pre><code>Code: PAYMENT_REQUIRED\nHTTP Status: 402\nRetry: Yes\nUser Action: Make payment and retry with authorization header\n</code></pre>"},{"location":"go/reference/api-reference/#payment-expired","title":"Payment Expired","text":"<pre><code>Code: PAYMENT_EXPIRED\nHTTP Status: 402 or 400\nRetry: Yes\nUser Action: Request new payment\n</code></pre>"},{"location":"go/reference/api-reference/#insufficient-funds","title":"Insufficient Funds","text":"<pre><code>Code: INSUFFICIENT_FUNDS\nHTTP Status: 400\nRetry: No\nUser Action: Add funds to wallet\n</code></pre>"},{"location":"go/reference/api-reference/#payment-verification-failed","title":"Payment Verification Failed","text":"<pre><code>Code: PAYMENT_VERIFICATION_FAILED\nHTTP Status: 403\nRetry: Yes\nUser Action: Retry or contact support\n</code></pre>"},{"location":"go/reference/api-reference/#transaction-broadcast-failed","title":"Transaction Broadcast Failed","text":"<pre><code>Code: TRANSACTION_BROADCAST_FAILED\nHTTP Status: 500\nRetry: Yes\nUser Action: Check network connectivity and retry\n</code></pre>"},{"location":"go/reference/api-reference/#invalid-payment-request","title":"Invalid Payment Request","text":"<pre><code>Code: INVALID_PAYMENT_REQUEST\nHTTP Status: 400\nRetry: No\nUser Action: Contact API provider\n</code></pre>"},{"location":"go/reference/api-reference/#constants-and-defaults","title":"Constants and Defaults","text":""},{"location":"go/reference/api-reference/#solana-networks","title":"Solana Networks","text":"<pre><code>const (\n    NetworkDevnet   = \"solana-devnet\"\n    NetworkTestnet  = \"solana-testnet\"\n    NetworkMainnet  = \"solana-mainnet\"\n)\n</code></pre>"},{"location":"go/reference/api-reference/#default-rpc-endpoints","title":"Default RPC Endpoints","text":"Network URL devnet <code>https://api.devnet.solana.com</code> testnet <code>https://api.testnet.solana.com</code> mainnet <code>https://api.mainnet-beta.solana.com</code>"},{"location":"go/reference/api-reference/#default-values","title":"Default Values","text":"<pre><code>const (\n    DefaultNetwork         = \"solana-devnet\"\n    DefaultExpiresIn       = 300  // seconds\n    DefaultMaxPaymentLimit = \"10.0\"\n)\n</code></pre>"},{"location":"go/reference/api-reference/#type-aliases","title":"Type Aliases","text":"<pre><code>// Solana types\ntype Address = string        // Base58-encoded wallet address\ntype Signature = string      // Solana transaction signature\ntype TokenMint = string      // SPL token mint address\ntype Amount = string         // Token amount as decimal string\n</code></pre>"},{"location":"go/reference/api-reference/#common-patterns","title":"Common Patterns","text":""},{"location":"go/reference/api-reference/#create-client","title":"Create Client","text":"<p>Explicit Mode: <pre><code>client := client.NewX402Client(keypair, \"\", nil, false)\ndefer client.Close()\n</code></pre></p> <p>Automatic Mode: <pre><code>client := client.NewAutoClient(keypair, \"\", &amp;client.AutoClientOptions{\n    MaxPaymentAmount: \"10.0\",\n})\ndefer client.Close()\n</code></pre></p>"},{"location":"go/reference/api-reference/#initialize-middleware","title":"Initialize Middleware","text":"<p>net/http: <pre><code>nethttp.InitX402(&amp;nethttp.Config{\n    PaymentAddress: os.Getenv(\"X402_PAYMENT_ADDRESS\"),\n    TokenMint:      os.Getenv(\"X402_TOKEN_MINT\"),\n})\n</code></pre></p> <p>Echo: <pre><code>echox402.InitX402(&amp;echox402.Config{\n    PaymentAddress: os.Getenv(\"X402_PAYMENT_ADDRESS\"),\n    TokenMint:      os.Getenv(\"X402_TOKEN_MINT\"),\n})\n</code></pre></p>"},{"location":"go/reference/api-reference/#protect-endpoint","title":"Protect Endpoint","text":"<p>net/http: <pre><code>http.Handle(\"/api/premium\", nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n    Amount: \"0.10\",\n})(handler))\n</code></pre></p> <p>Echo: <pre><code>e.GET(\"/api/premium\", handler, echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n    Amount: \"0.10\",\n}))\n</code></pre></p>"},{"location":"go/reference/api-reference/#access-payment-info","title":"Access Payment Info","text":"<p>net/http: <pre><code>auth := nethttp.GetPaymentAuthorization(r)\nif auth != nil {\n    log.Printf(\"Payment: %s\", auth.ActualAmount)\n}\n</code></pre></p> <p>Echo: <pre><code>auth := echox402.GetPaymentAuthorization(c)\nif auth != nil {\n    log.Printf(\"Payment: %s\", auth.ActualAmount)\n}\n</code></pre></p>"},{"location":"go/reference/api-reference/#see-also","title":"See Also","text":"<ul> <li>Core Library Documentation</li> <li>Client Library Documentation</li> <li>net/http Middleware</li> <li>Echo Middleware</li> </ul>"},{"location":"go/reference/configuration/","title":"Configuration Reference","text":"<p>Complete guide to configuring X402 for different use cases and environments.</p>"},{"location":"go/reference/configuration/#environment-variables","title":"Environment Variables","text":""},{"location":"go/reference/configuration/#core-configuration","title":"Core Configuration","text":""},{"location":"go/reference/configuration/#x402_payment_address-required","title":"X402_PAYMENT_ADDRESS (Required)","text":"<p>The Solana wallet address that receives payments.</p> <pre><code>export X402_PAYMENT_ADDRESS=\"YOUR_SOLANA_WALLET_ADDRESS\"\n</code></pre> <p>Format: Base58-encoded Solana wallet address Example: <code>EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v</code> Used by: Server middleware</p>"},{"location":"go/reference/configuration/#x402_token_mint-required","title":"X402_TOKEN_MINT (Required)","text":"<p>The SPL token mint address for payments.</p> <pre><code>export X402_TOKEN_MINT=\"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\"\n</code></pre> <p>Format: Base58-encoded token mint address Example (USDC devnet): <code>EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v</code> Example (USDC mainnet): <code>EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v</code> Used by: Server middleware, payment processor</p>"},{"location":"go/reference/configuration/#network-configuration","title":"Network Configuration","text":""},{"location":"go/reference/configuration/#x402_network-optional","title":"X402_NETWORK (Optional)","text":"<p>Solana network to use.</p> <pre><code>export X402_NETWORK=\"solana-devnet\"  # Development\nexport X402_NETWORK=\"solana-testnet\"  # Testing\nexport X402_NETWORK=\"solana-mainnet\"  # Production\n</code></pre> <p>Default: <code>solana-devnet</code> Valid values: <code>solana-devnet</code>, <code>solana-testnet</code>, <code>solana-mainnet</code> Used by: Core processor, all clients</p>"},{"location":"go/reference/configuration/#x402_rpc_url-optional","title":"X402_RPC_URL (Optional)","text":"<p>Custom Solana RPC endpoint.</p> <pre><code># Use default for network\n# Omit to use automatic endpoint\n\n# Or specify custom endpoint\nexport X402_RPC_URL=\"https://api.devnet.solana.com\"\nexport X402_RPC_URL=\"https://api.testnet.solana.com\"\nexport X402_RPC_URL=\"https://api.mainnet-beta.solana.com\"\n\n# Or use custom RPC service\nexport X402_RPC_URL=\"https://your-custom-rpc.com\"\n</code></pre> <p>Default: Auto-selected based on network Used by: Core processor, payment verification</p>"},{"location":"go/reference/configuration/#client-configuration","title":"Client Configuration","text":""},{"location":"go/reference/configuration/#x402_private_key-client-only","title":"X402_PRIVATE_KEY (Client Only)","text":"<p>Base58-encoded wallet private key for client.</p> <pre><code>export X402_PRIVATE_KEY=\"your-base58-private-key\"\n</code></pre> <p>Format: Base58-encoded Solana private key Security: Store in secure environment variable, never hardcode Used by: Client library</p>"},{"location":"go/reference/configuration/#x402_max_payment-optional","title":"X402_MAX_PAYMENT (Optional)","text":"<p>Maximum amount to pay per transaction (safety limit).</p> <pre><code>export X402_MAX_PAYMENT=\"10.0\"  # Maximum 10 USDC\n</code></pre> <p>Default: <code>10.0</code> (if using AutoClient with no options) Format: Decimal string representing token units Used by: AutoClient for payment limits</p>"},{"location":"go/reference/configuration/#server-configuration","title":"Server Configuration","text":""},{"location":"go/reference/configuration/#port-optional","title":"PORT (Optional)","text":"<p>Server listening port.</p> <pre><code>export PORT=\"8080\"  # Default for development\nexport PORT=\"443\"   # HTTPS in production\n</code></pre> <p>Default: <code>8080</code> Used by: Example servers</p>"},{"location":"go/reference/configuration/#middleware-configuration","title":"Middleware Configuration","text":""},{"location":"go/reference/configuration/#nethttp-middleware","title":"net/http Middleware","text":""},{"location":"go/reference/configuration/#initx402-config-structure","title":"InitX402() Config Structure","text":"<pre><code>type Config struct {\n    PaymentAddress string // Required\n    TokenMint      string // Required\n    Network        string // Optional, default: \"solana-devnet\"\n    RPCURL         string // Optional\n    AutoVerify     bool   // Optional, default: false\n}\n</code></pre> <p>Example: <pre><code>nethttp.InitX402(&amp;nethttp.Config{\n    PaymentAddress: os.Getenv(\"X402_PAYMENT_ADDRESS\"),\n    TokenMint:      os.Getenv(\"X402_TOKEN_MINT\"),\n    Network:        \"solana-devnet\",\n    RPCURL:         \"https://api.devnet.solana.com\",\n    AutoVerify:     true,\n})\n</code></pre></p>"},{"location":"go/reference/configuration/#echo-middleware","title":"Echo Middleware","text":""},{"location":"go/reference/configuration/#initx402-config-structure_1","title":"InitX402() Config Structure","text":"<pre><code>type Config struct {\n    PaymentAddress string // Required\n    TokenMint      string // Required\n    Network        string // Optional, default: \"solana-devnet\"\n    RPCURL         string // Optional\n    AutoVerify     bool   // Optional, default: false\n}\n</code></pre> <p>Example: <pre><code>echox402.InitX402(&amp;echox402.Config{\n    PaymentAddress: os.Getenv(\"X402_PAYMENT_ADDRESS\"),\n    TokenMint:      os.Getenv(\"X402_TOKEN_MINT\"),\n    Network:        \"solana-devnet\",\n    AutoVerify:     true,\n})\n</code></pre></p>"},{"location":"go/reference/configuration/#paymentrequired-options","title":"PaymentRequired Options","text":""},{"location":"go/reference/configuration/#nethttp-paymentrequiredoptions","title":"net/http PaymentRequiredOptions","text":"<pre><code>type PaymentRequiredOptions struct {\n    Amount         string // Required\n    PaymentAddress string // Optional: override global\n    TokenMint      string // Optional: override global\n    Network        string // Optional: override global\n    Description    string // Optional\n    ExpiresIn      int    // Optional, default: 300 seconds\n    AutoVerify     bool   // Optional: override global\n}\n</code></pre> <p>Example: <pre><code>nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n    Amount:      \"0.10\",\n    Description: \"Premium data access\",\n    ExpiresIn:   600,  // 10 minutes\n    AutoVerify:  true,\n})\n</code></pre></p>"},{"location":"go/reference/configuration/#echo-paymentrequiredoptions","title":"Echo PaymentRequiredOptions","text":"<pre><code>type PaymentRequiredOptions struct {\n    Amount         string // Required\n    PaymentAddress string // Optional: override global\n    TokenMint      string // Optional: override global\n    Network        string // Optional: override global\n    Description    string // Optional\n    ExpiresIn      int    // Optional, default: 300 seconds\n    AutoVerify     bool   // Optional: override global\n}\n</code></pre> <p>Example: <pre><code>echox402.PaymentRequired(echox402.PaymentRequiredOptions{\n    Amount:      \"0.10\",\n    Description: \"Premium data access\",\n    ExpiresIn:   600,\n    AutoVerify:  true,\n})\n</code></pre></p>"},{"location":"go/reference/configuration/#client-configuration_1","title":"Client Configuration","text":""},{"location":"go/reference/configuration/#x402client-options","title":"X402Client Options","text":"<pre><code>func NewX402Client(\n    walletKeypair solana.PrivateKey,\n    rpcURL string,\n    httpClient *http.Client,\n    allowLocal bool,\n) *X402Client\n</code></pre> <p>Parameters: - <code>walletKeypair</code>: Solana private key for signing payments - <code>rpcURL</code>: Custom RPC URL (empty string for default) - <code>httpClient</code>: Custom HTTP client (nil for default) - <code>allowLocal</code>: Allow localhost URLs (for development only)</p> <p>Example: <pre><code>client := client.NewX402Client(\n    walletKeypair,\n    \"https://api.devnet.solana.com\",\n    nil,\n    false,\n)\n</code></pre></p>"},{"location":"go/reference/configuration/#x402autoclient-options","title":"X402AutoClient Options","text":"<pre><code>type AutoClientOptions struct {\n    MaxPaymentAmount string // e.g., \"10.0\"\n    AutoRetry        bool\n    AllowLocal       bool\n}\n\nfunc NewAutoClient(\n    walletKeypair solana.PrivateKey,\n    rpcURL string,\n    options *AutoClientOptions,\n) *X402AutoClient\n</code></pre> <p>Example: <pre><code>client := client.NewAutoClient(\n    walletKeypair,\n    \"https://api.devnet.solana.com\",\n    &amp;client.AutoClientOptions{\n        MaxPaymentAmount: \"10.0\",\n        AutoRetry:        true,\n        AllowLocal:       false,\n    },\n)\n</code></pre></p>"},{"location":"go/reference/configuration/#environment-based-configuration","title":"Environment-Based Configuration","text":""},{"location":"go/reference/configuration/#development-setup","title":"Development Setup","text":"<pre><code># .env.development\nX402_PAYMENT_ADDRESS=\"YOUR_DEVNET_WALLET\"\nX402_TOKEN_MINT=\"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\"\nX402_NETWORK=\"solana-devnet\"\nX402_RPC_URL=\"https://api.devnet.solana.com\"\nPORT=8080\nX402_MAX_PAYMENT=\"10.0\"\n</code></pre> <p>Go Code: <pre><code>if os.Getenv(\"ENVIRONMENT\") == \"\" || os.Getenv(\"ENVIRONMENT\") == \"development\" {\n    nethttp.InitX402(&amp;nethttp.Config{\n        PaymentAddress: os.Getenv(\"X402_PAYMENT_ADDRESS\"),\n        TokenMint:      os.Getenv(\"X402_TOKEN_MINT\"),\n        Network:        \"solana-devnet\",\n        AutoVerify:     false,  // Skip for faster testing\n    })\n}\n</code></pre></p>"},{"location":"go/reference/configuration/#staging-setup","title":"Staging Setup","text":"<pre><code># .env.staging\nX402_PAYMENT_ADDRESS=\"YOUR_TESTNET_WALLET\"\nX402_TOKEN_MINT=\"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\"\nX402_NETWORK=\"solana-testnet\"\nX402_RPC_URL=\"https://api.testnet.solana.com\"\nPORT=8080\nX402_MAX_PAYMENT=\"100.0\"\n</code></pre> <p>Go Code: <pre><code>if os.Getenv(\"ENVIRONMENT\") == \"staging\" {\n    nethttp.InitX402(&amp;nethttp.Config{\n        PaymentAddress: os.Getenv(\"X402_PAYMENT_ADDRESS\"),\n        TokenMint:      os.Getenv(\"X402_TOKEN_MINT\"),\n        Network:        \"solana-testnet\",\n        AutoVerify:     true,\n    })\n}\n</code></pre></p>"},{"location":"go/reference/configuration/#production-setup","title":"Production Setup","text":"<pre><code># .env.production\nX402_PAYMENT_ADDRESS=\"YOUR_MAINNET_WALLET\"\nX402_TOKEN_MINT=\"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\"\nX402_NETWORK=\"solana-mainnet\"\nX402_RPC_URL=\"https://api.mainnet-beta.solana.com\"\nPORT=443\nX402_MAX_PAYMENT=\"50.0\"\n</code></pre> <p>Go Code: <pre><code>if os.Getenv(\"ENVIRONMENT\") == \"production\" {\n    nethttp.InitX402(&amp;nethttp.Config{\n        PaymentAddress: os.Getenv(\"X402_PAYMENT_ADDRESS\"),\n        TokenMint:      os.Getenv(\"X402_TOKEN_MINT\"),\n        Network:        \"solana-mainnet\",\n        RPCURL:         os.Getenv(\"X402_RPC_URL\"),\n        AutoVerify:     true,\n    })\n}\n</code></pre></p>"},{"location":"go/reference/configuration/#configuration-patterns","title":"Configuration Patterns","text":""},{"location":"go/reference/configuration/#global-configuration-recommended","title":"Global Configuration (Recommended)","text":"<p>Initialize once at startup, use everywhere:</p> <pre><code>func init() {\n    nethttp.InitX402(&amp;nethttp.Config{\n        PaymentAddress: os.Getenv(\"X402_PAYMENT_ADDRESS\"),\n        TokenMint:      os.Getenv(\"X402_TOKEN_MINT\"),\n    })\n}\n\nfunc main() {\n    // Uses global configuration\n    http.Handle(\"/api/premium\", nethttp.PaymentRequired(opts)(handler))\n}\n</code></pre>"},{"location":"go/reference/configuration/#per-route-configuration","title":"Per-Route Configuration","text":"<p>Override defaults for specific routes:</p> <pre><code>nethttp.InitX402(&amp;nethttp.Config{\n    PaymentAddress: \"default_wallet\",\n    TokenMint:      \"default_mint\",\n})\n\n// Override for specific route\nhttp.Handle(\"/api/partner\", nethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n    Amount:         \"0.10\",\n    PaymentAddress: \"partner_wallet\",  // Different recipient\n})(handler))\n</code></pre>"},{"location":"go/reference/configuration/#configuration-from-file","title":"Configuration from File","text":"<p>Load configuration from external file:</p> <pre><code>type AppConfig struct {\n    Payment struct {\n        Address string `json:\"address\"`\n        Mint    string `json:\"mint\"`\n        Network string `json:\"network\"`\n    } `json:\"payment\"`\n    Server struct {\n        Port string `json:\"port\"`\n    } `json:\"server\"`\n}\n\nfunc loadConfig(path string) (*AppConfig, error) {\n    data, err := ioutil.ReadFile(path)\n    if err != nil {\n        return nil, err\n    }\n    var config AppConfig\n    err = json.Unmarshal(data, &amp;config)\n    return &amp;config, err\n}\n\nfunc main() {\n    config, _ := loadConfig(\"config.json\")\n    nethttp.InitX402(&amp;nethttp.Config{\n        PaymentAddress: config.Payment.Address,\n        TokenMint:      config.Payment.Mint,\n        Network:        config.Payment.Network,\n    })\n}\n</code></pre> <p>config.json: <pre><code>{\n  \"payment\": {\n    \"address\": \"YOUR_WALLET_ADDRESS\",\n    \"mint\": \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\",\n    \"network\": \"solana-devnet\"\n  },\n  \"server\": {\n    \"port\": \"8080\"\n  }\n}\n</code></pre></p>"},{"location":"go/reference/configuration/#advanced-configuration","title":"Advanced Configuration","text":""},{"location":"go/reference/configuration/#dynamic-pricing","title":"Dynamic Pricing","text":"<p>Configure pricing based on request parameters:</p> <pre><code>func getPricing(tier string) string {\n    pricing := map[string]string{\n        \"basic\":    \"0.05\",\n        \"standard\": \"0.10\",\n        \"premium\":  \"0.50\",\n        \"enterprise\": \"5.00\",\n    }\n    if price, ok := pricing[tier]; ok {\n        return price\n    }\n    return \"0.05\"  // Default\n}\n\ne.GET(\"/api/data/:tier\", handler, echox402.PaymentRequired(\n    echox402.PaymentRequiredOptions{\n        Amount: \"0.10\",  // Adjusted dynamically in handler\n    },\n))\n</code></pre>"},{"location":"go/reference/configuration/#multi-tenant-configuration","title":"Multi-Tenant Configuration","text":"<p>Configure per tenant:</p> <pre><code>type TenantConfig struct {\n    PaymentAddress string\n    TokenMint      string\n    PaymentAmount  string\n}\n\nvar tenantConfigs = map[string]*TenantConfig{\n    \"tenant1\": {\n        PaymentAddress: \"wallet_1\",\n        TokenMint:      \"mint_1\",\n        PaymentAmount:  \"0.10\",\n    },\n    \"tenant2\": {\n        PaymentAddress: \"wallet_2\",\n        TokenMint:      \"mint_2\",\n        PaymentAmount:  \"0.20\",\n    },\n}\n\nfunc tenantMiddleware(tenantID string) nethttp.PaymentRequiredOptions {\n    config := tenantConfigs[tenantID]\n    return nethttp.PaymentRequiredOptions{\n        Amount:         config.PaymentAmount,\n        PaymentAddress: config.PaymentAddress,\n        TokenMint:      config.TokenMint,\n    }\n}\n</code></pre>"},{"location":"go/reference/configuration/#regional-configuration","title":"Regional Configuration","text":"<p>Configure based on region:</p> <pre><code>func getRegionalConfig(region string) *nethttp.Config {\n    configs := map[string]*nethttp.Config{\n        \"us\": {\n            PaymentAddress: \"us_wallet\",\n            TokenMint:      \"us_mint\",\n            Network:        \"solana-mainnet\",\n        },\n        \"eu\": {\n            PaymentAddress: \"eu_wallet\",\n            TokenMint:      \"eu_mint\",\n            Network:        \"solana-mainnet\",\n        },\n    }\n    return configs[region]\n}\n</code></pre>"},{"location":"go/reference/configuration/#security-best-practices","title":"Security Best Practices","text":""},{"location":"go/reference/configuration/#do","title":"\u2705 Do","text":"<pre><code>// Use environment variables\npaymentAddress := os.Getenv(\"X402_PAYMENT_ADDRESS\")\n\n// Keep private keys secure\nprivateKeyBytes := base58.Decode(os.Getenv(\"X402_PRIVATE_KEY\"))\nkeypair := solana.PrivateKey(privateKeyBytes)\n\n// Use HTTPS in production\ne.StartTLS(\":443\", \"cert.pem\", \"key.pem\")\n\n// Enable payment verification\nnethttp.InitX402(&amp;nethttp.Config{\n    AutoVerify: true,\n})\n\n// Use allowLocal=false in production\nclient := client.NewAutoClient(keypair, \"\", &amp;client.AutoClientOptions{\n    AllowLocal: false,\n})\n\n// Set payment limits\nclient := client.NewAutoClient(keypair, \"\", &amp;client.AutoClientOptions{\n    MaxPaymentAmount: \"10.0\",\n})\n</code></pre>"},{"location":"go/reference/configuration/#dont","title":"\u274c Don't","text":"<pre><code>// Don't hardcode secrets\nconfig := nethttp.Config{\n    PaymentAddress: \"actual_wallet_address\",\n    TokenMint:      \"actual_token\",\n}\n\n// Don't store private keys in code\nkeypair := solana.PrivateKey([]byte(\"my_secret_key\"))\n\n// Don't use HTTP in production\nhttp.ListenAndServe(\":8080\", nil)\n\n// Don't disable payment verification\nnethttp.InitX402(&amp;nethttp.Config{\n    AutoVerify: false,  // Bad for production\n})\n\n// Don't allow local in production\nclient := client.NewAutoClient(keypair, \"\", &amp;client.AutoClientOptions{\n    AllowLocal: true,  // Only for dev!\n})\n\n// Don't set unlimited payment amounts\nclient := client.NewAutoClient(keypair, \"\", nil)\n</code></pre>"},{"location":"go/reference/configuration/#troubleshooting-configuration","title":"Troubleshooting Configuration","text":""},{"location":"go/reference/configuration/#issue-x402-not-initialized","title":"Issue: \"X402 not initialized\"","text":"<p>Solution: <pre><code>// Call InitX402() before defining routes\nnethttp.InitX402(&amp;nethttp.Config{...})\nhttp.Handle(\"/api\", handler)\n</code></pre></p>"},{"location":"go/reference/configuration/#issue-paymentaddress-and-tokenmint-must-be-configured","title":"Issue: \"paymentAddress and tokenMint must be configured\"","text":"<p>Solution: <pre><code># Set environment variables\nexport X402_PAYMENT_ADDRESS=\"YOUR_ADDRESS\"\nexport X402_TOKEN_MINT=\"YOUR_MINT\"\n\n# Or pass to InitX402()\nnethttp.InitX402(&amp;nethttp.Config{\n    PaymentAddress: \"YOUR_ADDRESS\",\n    TokenMint:      \"YOUR_MINT\",\n})\n</code></pre></p>"},{"location":"go/reference/configuration/#issue-payment-verification-always-fails","title":"Issue: \"Payment verification always fails\"","text":"<p>Solution: <pre><code>// Check RPC endpoint\nnethttp.InitX402(&amp;nethttp.Config{\n    RPCURL: \"https://api.devnet.solana.com\",\n    AutoVerify: true,\n})\n\n// Or disable for development\nnethttp.InitX402(&amp;nethttp.Config{\n    AutoVerify: false,\n})\n</code></pre></p>"},{"location":"go/reference/configuration/#default-values","title":"Default Values","text":"<pre><code>const (\n    DefaultNetwork         = \"solana-devnet\"\n    DefaultExpiresIn       = 300  // seconds (5 minutes)\n    DefaultMaxPaymentLimit = \"10.0\"  // USDC\n)\n</code></pre>"},{"location":"go/reference/configuration/#supported-networks","title":"Supported Networks","text":"Network RPC URL Use Case <code>solana-devnet</code> https://api.devnet.solana.com Development/Testing <code>solana-testnet</code> https://api.testnet.solana.com Staging <code>solana-mainnet</code> https://api.mainnet-beta.solana.com Production"},{"location":"go/reference/configuration/#token-addresses","title":"Token Addresses","text":""},{"location":"go/reference/configuration/#usdc-recommended","title":"USDC (Recommended)","text":"Network Address devnet EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v mainnet EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"},{"location":"go/reference/configuration/#other-tokens","title":"Other Tokens","text":"<p>Use your custom token mint address in configuration.</p>"},{"location":"go/reference/configuration/#see-also","title":"See Also","text":"<ul> <li>Getting Started</li> <li>API Reference</li> <li>Environment Variables Overview</li> </ul>"},{"location":"go/reference/errors/","title":"Error Reference","text":"<p>Complete guide to X402 errors, error codes, and error handling patterns.</p>"},{"location":"go/reference/errors/#error-types","title":"Error Types","text":""},{"location":"go/reference/errors/#x402error-base-type","title":"X402Error (Base Type)","text":"<p>The base error type for all X402 errors.</p> <pre><code>type X402Error struct {\n    Message string\n    Code    string\n    Details map[string]interface{}\n}\n\nfunc (e *X402Error) Error() string\n</code></pre>"},{"location":"go/reference/errors/#example","title":"Example","text":"<pre><code>resp, err := client.Get(ctx, url, nil)\nif err != nil {\n    if x402Err, ok := err.(*core.X402Error); ok {\n        log.Printf(\"Error Code: %s\", x402Err.Code)\n        log.Printf(\"Error Message: %s\", x402Err.Message)\n        log.Printf(\"Details: %v\", x402Err.Details)\n    }\n}\n</code></pre>"},{"location":"go/reference/errors/#paymentrequirederror","title":"PaymentRequiredError","text":"<p>Raised when a server responds with HTTP 402 Payment Required.</p> <pre><code>type PaymentRequiredError struct {\n    X402Error\n    PaymentRequest *PaymentRequest\n}\n\nfunc NewPaymentRequiredError(paymentReq *PaymentRequest, message string) error\n</code></pre>"},{"location":"go/reference/errors/#error-code","title":"Error Code","text":"<pre><code>PAYMENT_REQUIRED\n</code></pre>"},{"location":"go/reference/errors/#http-status","title":"HTTP Status","text":"<pre><code>402 Payment Required\n</code></pre>"},{"location":"go/reference/errors/#causes","title":"Causes","text":"<ul> <li>Endpoint requires payment but no authorization header provided</li> <li>Payment authorization missing or invalid</li> <li>First request to paid endpoint</li> </ul>"},{"location":"go/reference/errors/#user-action","title":"User Action","text":"<ul> <li>Make payment using client</li> <li>Include payment authorization in retry request</li> </ul>"},{"location":"go/reference/errors/#example_1","title":"Example","text":"<pre><code>resp, err := client.Get(ctx, url, nil)\nif err != nil {\n    if x402Err, ok := err.(*core.PaymentRequiredError); ok {\n        log.Printf(\"Amount Required: %s\", x402Err.PaymentRequest.MaxAmountRequired)\n        log.Printf(\"Recipient: %s\", x402Err.PaymentRequest.PaymentAddress)\n\n        // Create payment\n        auth, _ := client.CreatePayment(ctx, x402Err.PaymentRequest, \"\")\n\n        // Retry with payment\n        resp, _ = client.Get(ctx, url, auth)\n    }\n}\n</code></pre>"},{"location":"go/reference/errors/#paymentexpirederror","title":"PaymentExpiredError","text":"<p>Raised when a payment request has expired.</p> <pre><code>type PaymentExpiredError struct {\n    X402Error\n    PaymentRequest *PaymentRequest\n}\n\nfunc NewPaymentExpiredError(paymentReq *PaymentRequest, message string) error\n</code></pre>"},{"location":"go/reference/errors/#error-code_1","title":"Error Code","text":"<pre><code>PAYMENT_EXPIRED\n</code></pre>"},{"location":"go/reference/errors/#http-status_1","title":"HTTP Status","text":"<pre><code>402 Payment Required (during validation)\n</code></pre>"},{"location":"go/reference/errors/#causes_1","title":"Causes","text":"<ul> <li>Payment request timestamp has passed expiration time</li> <li>Server took too long to process payment</li> <li>Default expiration is 5 minutes (300 seconds)</li> </ul>"},{"location":"go/reference/errors/#user-action_1","title":"User Action","text":"<ul> <li>Request new payment from server</li> <li>Reduce payment processing time</li> <li>Check system clock accuracy</li> </ul>"},{"location":"go/reference/errors/#example_2","title":"Example","text":"<pre><code>paymentReq, err := client.ParsePaymentRequest(resp)\nif err != nil {\n    log.Fatal(err)\n}\n\nif paymentReq.IsExpired() {\n    log.Println(\"Payment request expired\")\n    // Request new payment\n    resp, _ = client.Get(ctx, url, nil)\n    paymentReq, _ = client.ParsePaymentRequest(resp)\n}\n</code></pre>"},{"location":"go/reference/errors/#prevention","title":"Prevention","text":"<pre><code>// Check expiration before creating payment\nif paymentReq.IsExpired() {\n    return core.NewPaymentExpiredError(paymentReq, \"\")\n}\n\n// Request with longer expiration\nnethttp.PaymentRequired(nethttp.PaymentRequiredOptions{\n    Amount:   \"0.10\",\n    ExpiresIn: 600,  // 10 minutes\n})\n</code></pre>"},{"location":"go/reference/errors/#insufficientfundserror","title":"InsufficientFundsError","text":"<p>Raised when wallet lacks sufficient token balance.</p> <pre><code>type InsufficientFundsError struct {\n    X402Error\n    RequiredAmount  string\n    AvailableAmount string\n}\n\nfunc NewInsufficientFundsError(required string, available string) error\n</code></pre>"},{"location":"go/reference/errors/#error-code_2","title":"Error Code","text":"<pre><code>INSUFFICIENT_FUNDS\n</code></pre>"},{"location":"go/reference/errors/#http-status_2","title":"HTTP Status","text":"<pre><code>400 Bad Request\n</code></pre>"},{"location":"go/reference/errors/#causes_2","title":"Causes","text":"<ul> <li>Wallet balance is less than payment amount</li> <li>Token account doesn't exist</li> <li>Token account is empty</li> </ul>"},{"location":"go/reference/errors/#user-action_2","title":"User Action","text":"<ul> <li>Add funds to wallet</li> <li>Use different wallet with sufficient balance</li> <li>Request smaller payment amount (if allowed)</li> </ul>"},{"location":"go/reference/errors/#example_3","title":"Example","text":"<pre><code>resp, err := client.Get(ctx, url, nil)\nif err != nil {\n    if insuffErr, ok := err.(*core.InsufficientFundsError); ok {\n        log.Printf(\"Required: %s\", insuffErr.RequiredAmount)\n        log.Printf(\"Available: %s\", insuffErr.AvailableAmount)\n        log.Println(\"Please add more funds to your wallet\")\n    }\n}\n</code></pre>"},{"location":"go/reference/errors/#prevention_1","title":"Prevention","text":"<pre><code>// Check balance before payment\nprocessor := core.NewSolanaPaymentProcessor(rpcURL, nil)\ndefer processor.Close()\n\nbalance, err := processor.GetTokenBalance(ctx, walletAddress, tokenMint)\nif err != nil {\n    log.Fatal(err)\n}\n\namount, _ := strconv.ParseFloat(paymentReq.MaxAmountRequired, 64)\nif balance &lt; amount {\n    return core.NewInsufficientFundsError(\n        paymentReq.MaxAmountRequired,\n        fmt.Sprintf(\"%.2f\", balance),\n    )\n}\n</code></pre>"},{"location":"go/reference/errors/#paymentverificationerror","title":"PaymentVerificationError","text":"<p>Raised when payment verification fails.</p> <pre><code>type PaymentVerificationError struct {\n    X402Error\n}\n\nfunc NewPaymentVerificationError(message string) error\n</code></pre>"},{"location":"go/reference/errors/#error-code_3","title":"Error Code","text":"<pre><code>PAYMENT_VERIFICATION_FAILED\n</code></pre>"},{"location":"go/reference/errors/#http-status_3","title":"HTTP Status","text":"<pre><code>403 Forbidden\n</code></pre>"},{"location":"go/reference/errors/#causes_3","title":"Causes","text":"<ul> <li>Transaction not found on-chain</li> <li>Payment amount doesn't match request</li> <li>Recipient address doesn't match</li> <li>Token mint doesn't match</li> <li>Transaction not yet confirmed</li> <li>RPC endpoint is unavailable</li> </ul>"},{"location":"go/reference/errors/#user-action_3","title":"User Action","text":"<ul> <li>Retry the payment (transaction may be confirming)</li> <li>Check network connectivity</li> <li>Verify wallet address and token mint</li> <li>Contact API support if persistent</li> </ul>"},{"location":"go/reference/errors/#example_4","title":"Example","text":"<pre><code>resp, err := client.Get(ctx, url, auth)\nif err != nil {\n    if verifyErr, ok := err.(*core.PaymentVerificationError); ok {\n        log.Printf(\"Verification failed: %s\", verifyErr.Message)\n        log.Println(\"Transaction may still be confirming, retry in a few seconds\")\n\n        // Retry logic\n        time.Sleep(3 * time.Second)\n        resp, _ = client.Get(ctx, url, auth)\n    }\n}\n</code></pre>"},{"location":"go/reference/errors/#prevention_2","title":"Prevention","text":"<pre><code>// Verify before sending request\nverified, err := processor.VerifyTransaction(\n    ctx,\n    txHash,\n    paymentReq.PaymentAddress,\n    amount,\n    paymentReq.AssetAddress,\n)\nif err != nil || !verified {\n    return core.NewPaymentVerificationError(\"verification failed\")\n}\n</code></pre>"},{"location":"go/reference/errors/#transactionbroadcasterror","title":"TransactionBroadcastError","text":"<p>Raised when transaction broadcasting fails.</p> <pre><code>type TransactionBroadcastError struct {\n    X402Error\n}\n\nfunc NewTransactionBroadcastError(message string) error\n</code></pre>"},{"location":"go/reference/errors/#error-code_4","title":"Error Code","text":"<pre><code>TRANSACTION_BROADCAST_FAILED\n</code></pre>"},{"location":"go/reference/errors/#http-status_4","title":"HTTP Status","text":"<pre><code>500 Internal Server Error\n</code></pre>"},{"location":"go/reference/errors/#causes_4","title":"Causes","text":"<ul> <li>Network connectivity issue</li> <li>RPC endpoint is unavailable</li> <li>Solana network congestion</li> <li>Invalid transaction</li> <li>Node is not responding</li> </ul>"},{"location":"go/reference/errors/#user-action_4","title":"User Action","text":"<ul> <li>Retry after a delay</li> <li>Check internet connectivity</li> <li>Verify RPC endpoint</li> <li>Try different RPC endpoint</li> <li>Wait for network to stabilize</li> </ul>"},{"location":"go/reference/errors/#example_5","title":"Example","text":"<pre><code>resp, err := client.Get(ctx, url, nil)\nif err != nil {\n    if broadcastErr, ok := err.(*core.TransactionBroadcastError); ok {\n        log.Printf(\"Broadcast failed: %s\", broadcastErr.Message)\n        log.Println(\"Retrying...\")\n\n        // Exponential backoff retry\n        for attempt := 1; attempt &lt;= 3; attempt++ {\n            time.Sleep(time.Duration(math.Pow(2, float64(attempt-1))) * time.Second)\n            resp, err = client.Get(ctx, url, nil)\n            if err == nil {\n                break\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"go/reference/errors/#invalidpaymentrequesterror","title":"InvalidPaymentRequestError","text":"<p>Raised when payment request format is invalid.</p> <pre><code>type InvalidPaymentRequestError struct {\n    X402Error\n}\n\nfunc NewInvalidPaymentRequestError(message string) error\n</code></pre>"},{"location":"go/reference/errors/#error-code_5","title":"Error Code","text":"<pre><code>INVALID_PAYMENT_REQUEST\n</code></pre>"},{"location":"go/reference/errors/#http-status_5","title":"HTTP Status","text":"<pre><code>400 Bad Request\n</code></pre>"},{"location":"go/reference/errors/#causes_5","title":"Causes","text":"<ul> <li>Missing required fields in payment request</li> <li>Invalid JSON format</li> <li>Malformed payment request structure</li> <li>Server returned unexpected format</li> </ul>"},{"location":"go/reference/errors/#user-action_5","title":"User Action","text":"<ul> <li>Contact API provider</li> <li>Check API documentation</li> <li>Verify server is responding correctly</li> <li>Report issue to API maintainer</li> </ul>"},{"location":"go/reference/errors/#example_6","title":"Example","text":"<pre><code>paymentReq, err := client.ParsePaymentRequest(resp)\nif err != nil {\n    if invalidErr, ok := err.(*core.InvalidPaymentRequestError); ok {\n        log.Printf(\"Invalid payment request: %s\", invalidErr.Message)\n        log.Println(\"Please contact API support\")\n    }\n}\n</code></pre>"},{"location":"go/reference/errors/#error-handling-patterns","title":"Error Handling Patterns","text":""},{"location":"go/reference/errors/#basic-error-handling","title":"Basic Error Handling","text":"<pre><code>resp, err := client.Get(ctx, url, nil)\nif err != nil {\n    log.Printf(\"Error: %v\", err)\n    return err\n}\n</code></pre>"},{"location":"go/reference/errors/#type-based-error-handling","title":"Type-Based Error Handling","text":"<pre><code>resp, err := client.Get(ctx, url, nil)\nif err != nil {\n    switch e := err.(type) {\n    case *core.PaymentRequiredError:\n        log.Println(\"Payment needed\")\n\n    case *core.InsufficientFundsError:\n        log.Printf(\"Need more funds: %s\", e.RequiredAmount)\n\n    case *core.PaymentExpiredError:\n        log.Println(\"Payment request expired, retrying...\")\n\n    case *core.PaymentVerificationError:\n        log.Println(\"Verification failed, retrying...\")\n\n    case *core.TransactionBroadcastError:\n        log.Println(\"Network error, retrying...\")\n\n    default:\n        log.Printf(\"Unknown error: %v\", err)\n    }\n    return err\n}\n</code></pre>"},{"location":"go/reference/errors/#retry-with-exponential-backoff","title":"Retry with Exponential Backoff","text":"<pre><code>func retryWithBackoff(fn func() error, maxAttempts int) error {\n    for attempt := 1; attempt &lt;= maxAttempts; attempt++ {\n        err := fn()\n        if err == nil {\n            return nil\n        }\n\n        // Don't retry for non-retriable errors\n        if x402Err, ok := err.(*core.X402Error); ok {\n            if !shouldRetry(x402Err.Code) {\n                return err\n            }\n        }\n\n        if attempt &lt; maxAttempts {\n            backoff := time.Duration(math.Pow(2, float64(attempt-1))) * time.Second\n            time.Sleep(backoff)\n        }\n    }\n    return fmt.Errorf(\"max retry attempts exceeded\")\n}\n\nfunc shouldRetry(code string) bool {\n    switch code {\n    case \"PAYMENT_EXPIRED\", \"PAYMENT_VERIFICATION_FAILED\", \"TRANSACTION_BROADCAST_FAILED\":\n        return true\n    default:\n        return false\n    }\n}\n</code></pre>"},{"location":"go/reference/errors/#explicit-payment-flow-with-error-handling","title":"Explicit Payment Flow with Error Handling","text":"<pre><code>func paymentFlow(ctx context.Context, client *client.X402Client, url string) (*http.Response, error) {\n    // Step 1: Initial request\n    resp, err := client.Get(ctx, url, nil)\n    if err != nil {\n        return nil, err\n    }\n\n    // Step 2: Check if payment needed\n    if !client.PaymentRequired(resp) {\n        return resp, nil\n    }\n\n    // Step 3: Parse payment request\n    paymentReq, err := client.ParsePaymentRequest(resp)\n    if err != nil {\n        if invalidErr, ok := err.(*core.InvalidPaymentRequestError); ok {\n            return nil, fmt.Errorf(\"invalid payment request: %w\", invalidErr)\n        }\n        return nil, err\n    }\n\n    // Step 4: Check expiration\n    if paymentReq.IsExpired() {\n        return nil, core.NewPaymentExpiredError(paymentReq, \"\")\n    }\n\n    // Step 5: User confirmation (optional)\n    if !userConfirms(paymentReq) {\n        return nil, fmt.Errorf(\"user declined payment\")\n    }\n\n    // Step 6: Create payment\n    auth, err := client.CreatePayment(ctx, paymentReq, \"\")\n    if err != nil {\n        switch e := err.(type) {\n        case *core.InsufficientFundsError:\n            return nil, fmt.Errorf(\"insufficient funds: need %s, have %s\",\n                e.RequiredAmount, e.AvailableAmount)\n        case *core.TransactionBroadcastError:\n            return nil, fmt.Errorf(\"network error: %w\", e)\n        default:\n            return nil, err\n        }\n    }\n\n    // Step 7: Retry with payment\n    resp, err = client.Get(ctx, url, auth)\n    if err != nil {\n        if verifyErr, ok := err.(*core.PaymentVerificationError); ok {\n            // Transaction may still be confirming\n            return nil, fmt.Errorf(\"payment verification failed: %w\", verifyErr)\n        }\n        return nil, err\n    }\n\n    return resp, nil\n}\n</code></pre>"},{"location":"go/reference/errors/#automatic-client-error-handling","title":"Automatic Client Error Handling","text":"<pre><code>func autoClientFlow(ctx context.Context, client *client.X402AutoClient, url string) (*http.Response, error) {\n    resp, err := client.Get(ctx, url)\n    if err != nil {\n        // Auto client handles most cases, but still check for errors\n        if x402Err, ok := err.(*core.X402Error); ok {\n            switch x402Err.Code {\n            case \"INSUFFICIENT_FUNDS\":\n                log.Println(\"Cannot make payment: insufficient funds\")\n            case \"PAYMENT_EXPIRED\":\n                log.Println(\"Payment request expired\")\n            default:\n                log.Printf(\"Payment error: %s\", x402Err.Code)\n            }\n        }\n        return nil, err\n    }\n    return resp, nil\n}\n</code></pre>"},{"location":"go/reference/errors/#middleware-error-handling","title":"Middleware Error Handling","text":""},{"location":"go/reference/errors/#nethttp-middleware-errors","title":"net/http Middleware Errors","text":"<p>The middleware automatically returns appropriate HTTP status codes:</p> <pre><code>// No payment header provided\n// Returns: 402 Payment Required\n\n// Invalid payment format\n// Returns: 400 Bad Request\n\n// Payment verification failed\n// Returns: 403 Forbidden\n\n// Amount insufficient\n// Returns: 403 Forbidden\n\n// Address mismatch\n// Returns: 403 Forbidden\n</code></pre>"},{"location":"go/reference/errors/#echo-middleware-errors","title":"Echo Middleware Errors","text":"<p>Echo middleware follows the same pattern:</p> <pre><code>// Handler won't be called if payment fails\n// Appropriate error response is sent automatically\ne.GET(\"/api/premium\", handler, echox402.PaymentRequired(opts))\n</code></pre>"},{"location":"go/reference/errors/#error-code-reference","title":"Error Code Reference","text":"Code HTTP Status Retriable User Action <code>PAYMENT_REQUIRED</code> 402 Yes Make payment and retry <code>PAYMENT_EXPIRED</code> 402 Yes Request new payment <code>INSUFFICIENT_FUNDS</code> 400 No Add funds to wallet <code>PAYMENT_VERIFICATION_FAILED</code> 403 Yes Retry (wait for confirmation) <code>TRANSACTION_BROADCAST_FAILED</code> 500 Yes Retry or check network <code>INVALID_PAYMENT_REQUEST</code> 400 No Contact API support"},{"location":"go/reference/errors/#common-error-scenarios","title":"Common Error Scenarios","text":""},{"location":"go/reference/errors/#scenario-payment-required-on-first-request","title":"Scenario: \"Payment Required\" on First Request","text":"<p>Symptoms: <pre><code>Error: PAYMENT_REQUIRED\n</code></pre></p> <p>Cause: - Endpoint requires payment, first request doesn't include authorization</p> <p>Solution: <pre><code>if x402Err, ok := err.(*core.PaymentRequiredError); ok {\n    auth, _ := client.CreatePayment(ctx, x402Err.PaymentRequest, \"\")\n    resp, _ = client.Get(ctx, url, auth)\n}\n</code></pre></p>"},{"location":"go/reference/errors/#scenario-insufficient-funds-error","title":"Scenario: \"Insufficient Funds\" Error","text":"<p>Symptoms: <pre><code>Error: INSUFFICIENT_FUNDS\nRequired: 0.10\nAvailable: 0.05\n</code></pre></p> <p>Cause: - Wallet doesn't have enough tokens for payment</p> <p>Solution: <pre><code>// Option 1: Add funds to wallet\n// (Manual: use faucet or transfer tokens)\n\n// Option 2: Use different wallet\nclient := client.NewX402Client(differentKeypair, \"\", nil, false)\n\n// Option 3: Request payment plan (if available)\n// Contact API provider\n</code></pre></p>"},{"location":"go/reference/errors/#scenario-payment-expired-error","title":"Scenario: \"Payment Expired\" Error","text":"<p>Symptoms: <pre><code>Error: PAYMENT_EXPIRED\n</code></pre></p> <p>Cause: - Too much time passed between receiving and processing payment request - Default expiration: 5 minutes</p> <p>Solution: <pre><code>// Request new payment\nresp, _ := client.Get(ctx, url, nil)\npaymentReq, _ := client.ParsePaymentRequest(resp)\n\n// Increase server-side expiration\nechox402.PaymentRequired(echox402.PaymentRequiredOptions{\n    Amount:    \"0.10\",\n    ExpiresIn: 600,  // 10 minutes instead of 5\n})\n</code></pre></p>"},{"location":"go/reference/errors/#scenario-verification-failed-intermittent-error","title":"Scenario: \"Verification Failed\" Intermittent Error","text":"<p>Symptoms: <pre><code>Error: PAYMENT_VERIFICATION_FAILED\n</code></pre></p> <p>Cause: - Transaction is still confirming on-chain - RPC endpoint hasn't received confirmation yet</p> <p>Solution: <pre><code>// Retry after delay\nfor attempt := 1; attempt &lt;= 3; attempt++ {\n    auth, _ := client.CreatePayment(ctx, paymentReq, \"\")\n    resp, err := client.Get(ctx, url, auth)\n    if err == nil {\n        break\n    }\n    time.Sleep(2 * time.Second)\n}\n</code></pre></p>"},{"location":"go/reference/errors/#scenario-network-connectivity-issues","title":"Scenario: Network Connectivity Issues","text":"<p>Symptoms: <pre><code>Error: TRANSACTION_BROADCAST_FAILED\nError: Context deadline exceeded\n</code></pre></p> <p>Cause: - No internet connectivity - RPC endpoint unavailable - Network timeout</p> <p>Solution: <pre><code>// Use exponential backoff with timeout\nctx, cancel := context.WithTimeout(context.Background(), 60*time.Second)\ndefer cancel()\n\n// Retry with exponential backoff\nfor attempt := 1; attempt &lt;= 5; attempt++ {\n    resp, err := client.Get(ctx, url, nil)\n    if err == nil {\n        break\n    }\n    time.Sleep(time.Duration(math.Pow(2, float64(attempt))) * time.Second)\n}\n</code></pre></p>"},{"location":"go/reference/errors/#best-practices","title":"Best Practices","text":""},{"location":"go/reference/errors/#do","title":"\u2705 Do","text":"<pre><code>// Check error types\nswitch e := err.(type) {\ncase *core.InsufficientFundsError:\n    // Handle specific case\n\n// Use context with timeout\nctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)\ndefer cancel()\n\n// Retry retriable errors\nif shouldRetry(err) {\n    resp, _ = client.Get(ctx, url, auth)\n}\n\n// Close client\ndefer client.Close()\n</code></pre>"},{"location":"go/reference/errors/#dont","title":"\u274c Don't","text":"<pre><code>// Don't ignore errors\nclient.Get(ctx, url, nil)\n\n// Don't retry non-retriable errors\nif err != nil {\n    client.Get(ctx, url, nil)  // Infinite loop on INSUFFICIENT_FUNDS\n}\n\n// Don't assume payment succeeded\nauth, _ := client.CreatePayment(ctx, req, \"\")\n\n// Don't forget to close\nclient := client.NewAutoClient(keypair, \"\", nil)\n// Missing: defer client.Close()\n</code></pre>"},{"location":"go/reference/errors/#see-also","title":"See Also","text":"<ul> <li>API Reference</li> <li>Core Library Documentation</li> <li>Client Library Documentation</li> </ul>"},{"location":"java/","title":"OpenLibX402 Java SDK","text":"<p>Welcome to the OpenLibX402 Java SDK documentation. This SDK provides a complete implementation of the X402 payment protocol for Java applications.</p>"},{"location":"java/#overview","title":"Overview","text":"<p>The Java SDK consists of two main packages:</p> <ul> <li><code>openlibx402-core</code>: Core payment protocol implementation with blockchain integration</li> <li><code>openlibx402-client</code>: HTTP client libraries with manual and automatic payment handling</li> </ul>"},{"location":"java/#key-features","title":"Key Features","text":"<ul> <li>\u2615 Java 11+ Compatible: Works with modern Java versions</li> <li>\ud83d\udd12 AutoCloseable Resources: Proper resource management with try-with-resources</li> <li>\ud83d\udd04 Sync &amp; Async Support: CompletableFuture-ready architecture</li> <li>\ud83d\udee1\ufe0f SSRF Protection: Built-in security against server-side request forgery</li> <li>\ud83d\udce6 Maven Integration: Standard Maven project structure</li> <li>\ud83d\udcda Comprehensive JavaDoc: Complete API documentation</li> </ul>"},{"location":"java/#quick-start","title":"Quick Start","text":""},{"location":"java/#installation","title":"Installation","text":"<p>Add to your <code>pom.xml</code>:</p> <pre><code>&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.openlibx402&lt;/groupId&gt;\n        &lt;artifactId&gt;openlibx402-core&lt;/artifactId&gt;\n        &lt;version&gt;0.1.0&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.openlibx402&lt;/groupId&gt;\n        &lt;artifactId&gt;openlibx402-client&lt;/artifactId&gt;\n        &lt;version&gt;0.1.0&lt;/version&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n</code></pre>"},{"location":"java/#simple-example","title":"Simple Example","text":"<pre><code>import org.openlibx402.client.X402AutoClient;\nimport org.p2p.solanaj.core.Account;\nimport okhttp3.Response;\n\npublic class Example {\n    public static void main(String[] args) throws Exception {\n        Account account = new Account(secretKeyBytes);\n\n        X402AutoClient client = new X402AutoClient.Builder(account)\n            .rpcUrl(\"https://api.devnet.solana.com\")\n            .maxPaymentAmount(\"1.0\")\n            .build();\n\n        try (client) {\n            Response response = client.get(\"https://api.example.com/data\");\n            System.out.println(response.body().string());\n        }\n    }\n}\n</code></pre>"},{"location":"java/#architecture","title":"Architecture","text":""},{"location":"java/#two-package-design","title":"Two-Package Design","text":"<p>The Java SDK follows a modular architecture:</p> <pre><code>openlibx402-core/\n\u251c\u2500\u2500 models/           # PaymentRequest, PaymentAuthorization\n\u251c\u2500\u2500 errors/           # Exception hierarchy\n\u251c\u2500\u2500 blockchain/       # SolanaPaymentProcessor\n\u2514\u2500\u2500 util/             # ErrorCodes and utilities\n\nopenlibx402-client/\n\u251c\u2500\u2500 X402Client        # Manual payment control\n\u2514\u2500\u2500 X402AutoClient    # Automatic payment handling\n</code></pre>"},{"location":"java/#payment-flow","title":"Payment Flow","text":"<pre><code>Client Request \u2192 402 Response \u2192 Payment Creation \u2192\nTransaction Broadcast \u2192 Payment Verification \u2192 Retry with Auth \u2192\n200 Response\n</code></pre>"},{"location":"java/#client-types","title":"Client Types","text":""},{"location":"java/#x402client-explicit-control","title":"X402Client (Explicit Control)","text":"<p>For applications that need manual control over the payment flow:</p> <pre><code>X402Client client = new X402Client(account, rpcUrl, true);\n\ntry {\n    Response response = client.get(url);\n} catch (PaymentRequiredError e) {\n    PaymentRequest request = e.getPaymentRequest();\n    PaymentAuthorization auth = client.createPayment(request, null);\n    Response retryResponse = client.get(url, auth);\n}\n</code></pre>"},{"location":"java/#x402autoclient-automatic-handling","title":"X402AutoClient (Automatic Handling)","text":"<p>For seamless automatic payment processing:</p> <pre><code>X402AutoClient client = new X402AutoClient.Builder(account)\n    .maxPaymentAmount(\"5.0\")\n    .maxRetries(2)\n    .build();\n\nResponse response = client.get(url);  // Automatically handles payments\n</code></pre>"},{"location":"java/#error-handling","title":"Error Handling","text":"<p>All errors extend <code>X402Error</code>:</p> <pre><code>try {\n    Response response = client.get(url);\n} catch (PaymentRequiredError e) {\n    // Handle 402 payment required\n} catch (InsufficientFundsError e) {\n    // Handle low balance\n    System.out.println(\"Need: \" + e.getRequiredAmount());\n} catch (X402Error e) {\n    // Handle other payment errors\n    System.out.println(\"Error: \" + e.getCode());\n}\n</code></pre>"},{"location":"java/#security","title":"Security","text":"<ul> <li>SSRF Protection: Blocks localhost and private IP addresses by default</li> <li>Payment Limits: Set maximum payment amounts to prevent overspending</li> <li>Key Management: Private keys handled securely with proper cleanup</li> <li>Resource Cleanup: AutoCloseable ensures proper resource release</li> </ul>"},{"location":"java/#next-steps","title":"Next Steps","text":"<ul> <li>Installation Guide</li> <li>Core Library Reference</li> <li>Client Library Reference</li> <li>Examples</li> <li>API Reference</li> </ul>"},{"location":"java/examples/basic-usage/","title":"Java Basic Usage Examples","text":"<p>This guide provides practical examples of using the OpenLibX402 Java SDK.</p>"},{"location":"java/examples/basic-usage/#prerequisites","title":"Prerequisites","text":"<pre><code>&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.openlibx402&lt;/groupId&gt;\n        &lt;artifactId&gt;openlibx402-core&lt;/artifactId&gt;\n        &lt;version&gt;0.1.0&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.openlibx402&lt;/groupId&gt;\n        &lt;artifactId&gt;openlibx402-client&lt;/artifactId&gt;\n        &lt;version&gt;0.1.0&lt;/version&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n</code></pre>"},{"location":"java/examples/basic-usage/#example-1-manual-payment-handling","title":"Example 1: Manual Payment Handling","text":"<p>This example demonstrates explicit control over the payment flow using <code>X402Client</code>.</p> <pre><code>import org.openlibx402.client.X402Client;\nimport org.openlibx402.core.errors.*;\nimport org.openlibx402.core.models.*;\nimport org.p2p.solanaj.core.Account;\nimport okhttp3.Response;\n\npublic class ManualPaymentExample {\n    public static void main(String[] args) {\n        // Load Solana account (securely in production!)\n        byte[] secretKey = loadSecretKey();\n        Account account = new Account(secretKey);\n\n        // Create client\n        try (X402Client client = new X402Client(\n            account,\n            \"https://api.devnet.solana.com\",\n            true  // allowLocal for development only\n        )) {\n            String url = \"https://api.example.com/premium-data\";\n\n            // Make initial request\n            try {\n                Response response = client.get(url);\n                System.out.println(\"Success: \" + response.body().string());\n\n            } catch (PaymentRequiredError e) {\n                System.out.println(\"Payment required!\");\n\n                // Get payment request details\n                PaymentRequest request = e.getPaymentRequest();\n                System.out.println(\"Amount: \" + request.getMaxAmountRequired());\n                System.out.println(\"Asset: \" + request.getAssetType());\n                System.out.println(\"Description: \" + request.getDescription());\n\n                // Create payment\n                PaymentAuthorization auth = client.createPayment(request);\n                System.out.println(\"Payment created: \" + auth.getSignature());\n\n                // Retry request with payment authorization\n                Response retryResponse = client.get(url, auth);\n                System.out.println(\"Success: \" + retryResponse.body().string());\n            }\n\n        } catch (InsufficientFundsError e) {\n            System.err.println(\"Insufficient funds!\");\n            System.err.println(\"Required: \" + e.getRequiredAmount());\n            System.err.println(\"Available: \" + e.getAvailableAmount());\n\n        } catch (X402Error e) {\n            System.err.println(\"X402 Error: \" + e.getCode());\n            System.err.println(\"Message: \" + e.getMessage());\n\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n\n    private static byte[] loadSecretKey() {\n        // In production, load from secure storage\n        String keyEnv = System.getenv(\"SOLANA_SECRET_KEY\");\n        if (keyEnv != null) {\n            return java.util.Base64.getDecoder().decode(keyEnv);\n        }\n\n        // For demo: generate random account\n        System.out.println(\"\u26a0\ufe0f  Using random account for demo\");\n        return new Account().getSecretKey();\n    }\n}\n</code></pre>"},{"location":"java/examples/basic-usage/#example-2-automatic-payment-handling","title":"Example 2: Automatic Payment Handling","text":"<p>This example shows automatic payment handling using <code>X402AutoClient</code>.</p> <pre><code>import org.openlibx402.client.X402AutoClient;\nimport org.openlibx402.core.errors.*;\nimport org.p2p.solanaj.core.Account;\nimport okhttp3.Response;\n\npublic class AutoPaymentExample {\n    public static void main(String[] args) {\n        byte[] secretKey = loadSecretKey();\n        Account account = new Account(secretKey);\n\n        // Build auto-client with payment limits\n        try (X402AutoClient client = new X402AutoClient.Builder(account)\n            .rpcUrl(\"https://api.devnet.solana.com\")\n            .maxPaymentAmount(\"1.0\")      // Max 1 USDC per request\n            .maxRetries(3)                 // Retry up to 3 times\n            .allowLocal(true)              // Development only\n            .build()\n        ) {\n            // Client automatically handles 402 and retries\n            String url = \"https://api.example.com/premium-data\";\n            Response response = client.get(url);\n\n            System.out.println(\"Success: \" + response.body().string());\n\n        } catch (InsufficientFundsError e) {\n            System.err.println(\"Insufficient funds for payment\");\n\n        } catch (PaymentRequiredError e) {\n            System.err.println(\"Payment required but max retries exceeded\");\n\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n\n    private static byte[] loadSecretKey() {\n        String keyEnv = System.getenv(\"SOLANA_SECRET_KEY\");\n        if (keyEnv != null) {\n            return java.util.Base64.getDecoder().decode(keyEnv);\n        }\n        return new Account().getSecretKey();\n    }\n}\n</code></pre>"},{"location":"java/examples/basic-usage/#example-3-post-requests-with-json","title":"Example 3: POST Requests with JSON","text":"<p>Making POST requests with JSON body.</p> <pre><code>import org.openlibx402.client.X402Client;\nimport org.p2p.solanaj.core.Account;\nimport okhttp3.Response;\n\npublic class PostRequestExample {\n    public static void main(String[] args) {\n        Account account = new Account(loadSecretKey());\n\n        try (X402Client client = new X402Client(account, null, true)) {\n            String url = \"https://api.example.com/process\";\n\n            // JSON request body\n            String jsonBody = \"{\"\n                + \"\\\"query\\\": \\\"Analyze this data\\\",\"\n                + \"\\\"options\\\": {\\\"format\\\": \\\"json\\\"}\"\n                + \"}\";\n\n            try {\n                // Make POST request\n                Response response = client.post(url, jsonBody);\n                System.out.println(\"Result: \" + response.body().string());\n\n            } catch (PaymentRequiredError e) {\n                // Handle payment\n                PaymentAuthorization auth = client.createPayment(e.getPaymentRequest());\n\n                // Retry with payment\n                Response retryResponse = client.post(url, jsonBody, auth);\n                System.out.println(\"Result: \" + retryResponse.body().string());\n            }\n\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n\n    private static byte[] loadSecretKey() {\n        return new Account().getSecretKey();\n    }\n}\n</code></pre>"},{"location":"java/examples/basic-usage/#example-4-error-handling-patterns","title":"Example 4: Error Handling Patterns","text":"<p>Comprehensive error handling for production applications.</p> <pre><code>import org.openlibx402.client.X402Client;\nimport org.openlibx402.core.errors.*;\nimport org.p2p.solanaj.core.Account;\nimport okhttp3.Response;\nimport java.io.IOException;\nimport java.util.logging.Logger;\n\npublic class ErrorHandlingExample {\n    private static final Logger logger = Logger.getLogger(ErrorHandlingExample.class.getName());\n\n    public static void main(String[] args) {\n        Account account = new Account(loadSecretKey());\n\n        try (X402Client client = new X402Client(account, null, false)) {\n            Response response = makePaymentEnabledRequest(client, \"https://api.example.com/data\");\n            logger.info(\"Success: \" + response.body().string());\n\n        } catch (Exception e) {\n            logger.severe(\"Fatal error: \" + e.getMessage());\n        }\n    }\n\n    private static Response makePaymentEnabledRequest(X402Client client, String url) throws Exception {\n        try {\n            return client.get(url);\n\n        } catch (PaymentRequiredError e) {\n            logger.info(\"Payment required, creating payment...\");\n            return handlePayment(client, url, e.getPaymentRequest());\n\n        } catch (InsufficientFundsError e) {\n            logger.severe(\"Insufficient funds!\");\n            logger.severe(\"Required: \" + e.getRequiredAmount());\n            logger.severe(\"Available: \" + e.getAvailableAmount());\n            throw new RuntimeException(\"Cannot complete payment\", e);\n\n        } catch (PaymentExpiredError e) {\n            logger.warning(\"Payment request expired\");\n            // Retry to get new payment request\n            return makePaymentEnabledRequest(client, url);\n\n        } catch (PaymentVerificationError e) {\n            logger.severe(\"Payment verification failed: \" + e.getMessage());\n            throw new RuntimeException(\"Payment not accepted\", e);\n\n        } catch (TransactionBroadcastError e) {\n            logger.severe(\"Transaction broadcast failed: \" + e.getMessage());\n            throw new RuntimeException(\"Cannot broadcast payment\", e);\n\n        } catch (InvalidPaymentRequestError e) {\n            logger.severe(\"Invalid payment request: \" + e.getMessage());\n            throw new RuntimeException(\"Server sent invalid payment request\", e);\n\n        } catch (IOException e) {\n            logger.severe(\"Network error: \" + e.getMessage());\n            throw new RuntimeException(\"Network communication failed\", e);\n        }\n    }\n\n    private static Response handlePayment(X402Client client, String url, PaymentRequest request) throws Exception {\n        // Check if expired\n        if (request.isExpired()) {\n            logger.warning(\"Payment request already expired\");\n            throw new PaymentExpiredError(request);\n        }\n\n        // Validate amount\n        double amount = Double.parseDouble(request.getMaxAmountRequired());\n        if (amount &gt; 10.0) {\n            logger.warning(\"Payment exceeds maximum allowed amount\");\n            throw new RuntimeException(\"Payment too high: \" + amount);\n        }\n\n        // Create payment\n        PaymentAuthorization auth = client.createPayment(request);\n        logger.info(\"Payment created: \" + auth.getSignature());\n\n        // Retry request\n        return client.get(url, auth);\n    }\n\n    private static byte[] loadSecretKey() {\n        return new Account().getSecretKey();\n    }\n}\n</code></pre>"},{"location":"java/examples/basic-usage/#example-5-custom-http-configuration","title":"Example 5: Custom HTTP Configuration","text":"<p>Using a custom OkHttp client with specific configuration.</p> <pre><code>import org.openlibx402.client.X402AutoClient;\nimport org.p2p.solanaj.core.Account;\nimport okhttp3.OkHttpClient;\nimport okhttp3.Response;\nimport java.util.concurrent.TimeUnit;\n\npublic class CustomHttpExample {\n    public static void main(String[] args) {\n        Account account = new Account(loadSecretKey());\n\n        // Custom HTTP client with longer timeouts\n        OkHttpClient httpClient = new OkHttpClient.Builder()\n            .connectTimeout(60, TimeUnit.SECONDS)\n            .readTimeout(120, TimeUnit.SECONDS)\n            .writeTimeout(60, TimeUnit.SECONDS)\n            .retryOnConnectionFailure(true)\n            .build();\n\n        // Use custom client\n        try (X402AutoClient client = new X402AutoClient.Builder(account)\n            .rpcUrl(\"https://api.mainnet-beta.solana.com\")\n            .maxPaymentAmount(\"5.0\")\n            .httpClient(httpClient)\n            .build()\n        ) {\n            Response response = client.get(\"https://api.example.com/slow-endpoint\");\n            System.out.println(\"Success: \" + response.body().string());\n\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n\n    private static byte[] loadSecretKey() {\n        return new Account().getSecretKey();\n    }\n}\n</code></pre>"},{"location":"java/examples/basic-usage/#example-6-checking-balance-before-payment","title":"Example 6: Checking Balance Before Payment","text":"<p>Verify sufficient funds before attempting payment.</p> <pre><code>import org.openlibx402.client.X402Client;\nimport org.openlibx402.core.blockchain.SolanaPaymentProcessor;\nimport org.openlibx402.core.models.*;\nimport org.p2p.solanaj.core.Account;\nimport okhttp3.Response;\n\npublic class BalanceCheckExample {\n    public static void main(String[] args) {\n        Account account = new Account(loadSecretKey());\n\n        try (X402Client client = new X402Client(account, null, true)) {\n            // Check balance first\n            SolanaPaymentProcessor processor = client.getProcessor();\n            String balance = processor.getBalance(account.getPublicKey());\n            System.out.println(\"Current balance: \" + balance + \" USDC\");\n\n            // Make request\n            try {\n                Response response = client.get(\"https://api.example.com/premium-data\");\n                System.out.println(\"Success: \" + response.body().string());\n\n            } catch (PaymentRequiredError e) {\n                PaymentRequest request = e.getPaymentRequest();\n                double required = Double.parseDouble(request.getMaxAmountRequired());\n                double available = Double.parseDouble(balance);\n\n                if (available &lt; required) {\n                    System.err.println(\"Insufficient funds!\");\n                    System.err.println(\"Required: \" + required);\n                    System.err.println(\"Available: \" + available);\n                    System.err.println(\"Please add \" + (required - available) + \" USDC\");\n                    return;\n                }\n\n                // Create payment\n                PaymentAuthorization auth = client.createPayment(request);\n\n                // Retry\n                Response retryResponse = client.get(\"https://api.example.com/premium-data\", auth);\n                System.out.println(\"Success: \" + retryResponse.body().string());\n\n                // Check new balance\n                String newBalance = processor.getBalance(account.getPublicKey());\n                System.out.println(\"New balance: \" + newBalance + \" USDC\");\n            }\n\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n\n    private static byte[] loadSecretKey() {\n        return new Account().getSecretKey();\n    }\n}\n</code></pre>"},{"location":"java/examples/basic-usage/#example-7-multi-threaded-usage","title":"Example 7: Multi-threaded Usage","text":"<p>Using clients in a multi-threaded environment.</p> <pre><code>import org.openlibx402.client.X402AutoClient;\nimport org.p2p.solanaj.core.Account;\nimport okhttp3.Response;\nimport java.util.concurrent.*;\n\npublic class MultiThreadedExample {\n    public static void main(String[] args) throws InterruptedException {\n        Account account = new Account(loadSecretKey());\n        ExecutorService executor = Executors.newFixedThreadPool(5);\n\n        // Submit multiple concurrent requests\n        for (int i = 0; i &lt; 10; i++) {\n            final int taskId = i;\n            executor.submit(() -&gt; makeRequest(account, taskId));\n        }\n\n        executor.shutdown();\n        executor.awaitTermination(5, TimeUnit.MINUTES);\n    }\n\n    private static void makeRequest(Account account, int taskId) {\n        // Each thread gets its own client\n        try (X402AutoClient client = new X402AutoClient.Builder(account)\n            .rpcUrl(\"https://api.devnet.solana.com\")\n            .maxPaymentAmount(\"1.0\")\n            .build()\n        ) {\n            String url = \"https://api.example.com/data?id=\" + taskId;\n            Response response = client.get(url);\n\n            System.out.println(\"Task \" + taskId + \": \" + response.body().string());\n\n        } catch (Exception e) {\n            System.err.println(\"Task \" + taskId + \" failed: \" + e.getMessage());\n        }\n    }\n\n    private static byte[] loadSecretKey() {\n        return new Account().getSecretKey();\n    }\n}\n</code></pre>"},{"location":"java/examples/basic-usage/#complete-example-application","title":"Complete Example Application","text":"<p>For a complete working example, see the simple-client example in the repository.</p> <pre><code># Clone repository\ngit clone https://github.com/openlibx402/openlibx402.git\ncd openlibx402/examples/java/simple-client\n\n# Run example\nmvn clean compile exec:java\n</code></pre>"},{"location":"java/examples/basic-usage/#best-practices","title":"Best Practices","text":"<ol> <li>Secure Key Management: Never hardcode secret keys</li> <li>Use Try-with-Resources: Ensures proper cleanup</li> <li>Handle All Errors: Catch specific exception types</li> <li>Check Balances: Verify funds before payments</li> <li>Set Payment Limits: Use <code>maxPaymentAmount</code> in production</li> <li>Production Security: Never use <code>allowLocal=true</code> in production</li> <li>Thread Safety: Create separate clients for each thread</li> <li>Logging: Log payment activities for auditing</li> </ol>"},{"location":"java/examples/basic-usage/#related-documentation","title":"Related Documentation","text":"<ul> <li>Installation Guide</li> <li>Client Quickstart</li> <li>Client Library Reference</li> <li>Error Handling</li> </ul>"},{"location":"java/getting-started/client-quickstart/","title":"Java Client Quickstart","text":"<p>Get started with the OpenLibX402 Java client in 5 minutes.</p>"},{"location":"java/getting-started/client-quickstart/#prerequisites","title":"Prerequisites","text":"<ul> <li>Java 11 or higher installed</li> <li>Maven or Gradle configured</li> <li>OpenLibX402 packages added to your project</li> </ul> <p>See Installation Guide if you haven't set these up yet.</p>"},{"location":"java/getting-started/client-quickstart/#step-1-create-a-solana-account","title":"Step 1: Create a Solana Account","text":"<pre><code>import org.p2p.solanaj.core.Account;\n\n// For development: generate a new account\nAccount account = new Account();\nSystem.out.println(\"Public Key: \" + account.getPublicKey());\nSystem.out.println(\"Secret Key (save this!): \" +\n    java.util.Base64.getEncoder().encodeToString(account.getSecretKey()));\n</code></pre> <p>For production, load from secure storage:</p> <pre><code>// Load from environment variable\nString keyEnv = System.getenv(\"SOLANA_SECRET_KEY\");\nbyte[] secretKey = java.util.Base64.getDecoder().decode(keyEnv);\nAccount account = new Account(secretKey);\n</code></pre>"},{"location":"java/getting-started/client-quickstart/#step-2-choose-your-client-type","title":"Step 2: Choose Your Client Type","text":""},{"location":"java/getting-started/client-quickstart/#option-a-automatic-client-recommended-for-beginners","title":"Option A: Automatic Client (Recommended for Beginners)","text":"<p>Best for quick integration with automatic payment handling.</p> <pre><code>import org.openlibx402.client.X402AutoClient;\nimport okhttp3.Response;\n\n// Create client with automatic payment handling\nX402AutoClient client = new X402AutoClient.Builder(account)\n    .rpcUrl(\"https://api.devnet.solana.com\")\n    .maxPaymentAmount(\"1.0\")      // Max 1 USDC per request\n    .maxRetries(3)                 // Retry up to 3 times\n    .allowLocal(true)              // Development only\n    .build();\n\ntry {\n    // Automatically handles 402 and retries with payment\n    Response response = client.get(\"https://api.example.com/premium-data\");\n    System.out.println(response.body().string());\n} finally {\n    client.close();\n}\n</code></pre>"},{"location":"java/getting-started/client-quickstart/#option-b-manual-client","title":"Option B: Manual Client","text":"<p>Best when you need explicit control over payments.</p> <pre><code>import org.openlibx402.client.X402Client;\nimport org.openlibx402.core.errors.PaymentRequiredError;\nimport org.openlibx402.core.models.PaymentAuthorization;\nimport okhttp3.Response;\n\n// Create client with manual payment control\nX402Client client = new X402Client(\n    account,\n    \"https://api.devnet.solana.com\",\n    true  // allowLocal for development\n);\n\ntry {\n    // Make initial request\n    Response response = client.get(\"https://api.example.com/premium-data\");\n    System.out.println(response.body().string());\n\n} catch (PaymentRequiredError e) {\n    // Handle 402: create payment manually\n    PaymentAuthorization auth = client.createPayment(e.getPaymentRequest());\n\n    // Retry with payment\n    Response retryResponse = client.get(\"https://api.example.com/premium-data\", auth);\n    System.out.println(retryResponse.body().string());\n\n} finally {\n    client.close();\n}\n</code></pre>"},{"location":"java/getting-started/client-quickstart/#step-3-make-payment-enabled-requests","title":"Step 3: Make Payment-Enabled Requests","text":""},{"location":"java/getting-started/client-quickstart/#get-request","title":"GET Request","text":"<pre><code>Response response = client.get(\"https://api.example.com/data\");\nSystem.out.println(response.body().string());\n</code></pre>"},{"location":"java/getting-started/client-quickstart/#post-request-with-json","title":"POST Request with JSON","text":"<pre><code>String jsonBody = \"{\\\"query\\\": \\\"process this\\\"}\";\nResponse response = client.post(\"https://api.example.com/process\", jsonBody);\nSystem.out.println(response.body().string());\n</code></pre>"},{"location":"java/getting-started/client-quickstart/#put-request","title":"PUT Request","text":"<pre><code>String jsonBody = \"{\\\"id\\\": 123, \\\"data\\\": \\\"updated\\\"}\";\nResponse response = client.put(\"https://api.example.com/update\", jsonBody);\n</code></pre>"},{"location":"java/getting-started/client-quickstart/#delete-request","title":"DELETE Request","text":"<pre><code>Response response = client.delete(\"https://api.example.com/resource/123\");\n</code></pre>"},{"location":"java/getting-started/client-quickstart/#step-4-handle-errors","title":"Step 4: Handle Errors","text":"<pre><code>import org.openlibx402.core.errors.*;\n\ntry {\n    Response response = client.get(url);\n    System.out.println(response.body().string());\n\n} catch (InsufficientFundsError e) {\n    System.err.println(\"Not enough funds!\");\n    System.err.println(\"Required: \" + e.getRequiredAmount());\n    System.err.println(\"Available: \" + e.getAvailableAmount());\n\n} catch (PaymentExpiredError e) {\n    System.err.println(\"Payment request expired, retry...\");\n\n} catch (PaymentVerificationError e) {\n    System.err.println(\"Payment not accepted: \" + e.getMessage());\n\n} catch (X402Error e) {\n    System.err.println(\"X402 Error: \" + e.getCode());\n\n} catch (Exception e) {\n    e.printStackTrace();\n}\n</code></pre>"},{"location":"java/getting-started/client-quickstart/#complete-example","title":"Complete Example","text":"<p>Here's a complete working example:</p> <pre><code>package com.example;\n\nimport org.openlibx402.client.X402AutoClient;\nimport org.openlibx402.core.errors.*;\nimport org.p2p.solanaj.core.Account;\nimport okhttp3.Response;\n\npublic class QuickStart {\n    public static void main(String[] args) {\n        // Load or create account\n        Account account = getAccount();\n\n        // Create auto client\n        try (X402AutoClient client = new X402AutoClient.Builder(account)\n            .rpcUrl(\"https://api.devnet.solana.com\")\n            .maxPaymentAmount(\"1.0\")\n            .maxRetries(3)\n            .allowLocal(true)  // Development only\n            .build()\n        ) {\n            // Make payment-enabled request\n            String url = \"https://api.example.com/premium-data\";\n            Response response = client.get(url);\n\n            // Process response\n            String data = response.body().string();\n            System.out.println(\"Success! Data: \" + data);\n\n        } catch (InsufficientFundsError e) {\n            System.err.println(\"Insufficient funds!\");\n            System.err.println(\"Please add funds to: \" + account.getPublicKey());\n\n        } catch (PaymentRequiredError e) {\n            System.err.println(\"Payment required but max retries exceeded\");\n\n        } catch (X402Error e) {\n            System.err.println(\"X402 Error: \" + e.getMessage());\n\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n\n    private static Account getAccount() {\n        // Try loading from environment\n        String keyEnv = System.getenv(\"SOLANA_SECRET_KEY\");\n        if (keyEnv != null) {\n            byte[] secretKey = java.util.Base64.getDecoder().decode(keyEnv);\n            return new Account(secretKey);\n        }\n\n        // Development: generate new account\n        System.out.println(\"\u26a0\ufe0f  Using random account for demo\");\n        return new Account();\n    }\n}\n</code></pre>"},{"location":"java/getting-started/client-quickstart/#running-the-example","title":"Running the Example","text":""},{"location":"java/getting-started/client-quickstart/#maven","title":"Maven","text":"<pre><code># Add to pom.xml\n&lt;build&gt;\n    &lt;plugins&gt;\n        &lt;plugin&gt;\n            &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;\n            &lt;artifactId&gt;exec-maven-plugin&lt;/artifactId&gt;\n            &lt;version&gt;3.1.0&lt;/version&gt;\n            &lt;configuration&gt;\n                &lt;mainClass&gt;com.example.QuickStart&lt;/mainClass&gt;\n            &lt;/configuration&gt;\n        &lt;/plugin&gt;\n    &lt;/plugins&gt;\n&lt;/build&gt;\n\n# Run\nmvn clean compile exec:java\n</code></pre>"},{"location":"java/getting-started/client-quickstart/#gradle","title":"Gradle","text":"<pre><code># Add to build.gradle\napplication {\n    mainClass = 'com.example.QuickStart'\n}\n\n# Run\ngradle run\n</code></pre>"},{"location":"java/getting-started/client-quickstart/#with-environment-variable","title":"With Environment Variable","text":"<pre><code>export SOLANA_SECRET_KEY=\"your-base64-encoded-key\"\nmvn exec:java\n</code></pre>"},{"location":"java/getting-started/client-quickstart/#next-steps","title":"Next Steps","text":""},{"location":"java/getting-started/client-quickstart/#1-learn-more-patterns","title":"1. Learn More Patterns","text":"<p>Explore Basic Usage Examples for: - Error handling patterns - Multi-threaded usage - Custom HTTP configuration - Balance checking</p>"},{"location":"java/getting-started/client-quickstart/#2-understand-the-api","title":"2. Understand the API","text":"<p>Read the Client Library Reference for: - Complete API documentation - All available methods - Configuration options - Best practices</p>"},{"location":"java/getting-started/client-quickstart/#3-set-up-for-production","title":"3. Set Up for Production","text":"<p>See Error Handling Guide for: - Comprehensive error handling - Production deployment - Security considerations - Monitoring and logging</p>"},{"location":"java/getting-started/client-quickstart/#common-issues","title":"Common Issues","text":""},{"location":"java/getting-started/client-quickstart/#paymentrequirederror-payment-required","title":"\"PaymentRequiredError: Payment Required\"","text":"<p>Cause: API requires payment, but automatic payment failed.</p> <p>Solutions: 1. Check balance: <code>processor.getBalance(account.getPublicKey())</code> 2. Increase <code>maxRetries</code> in builder 3. Increase <code>maxPaymentAmount</code> if payment exceeds limit</p>"},{"location":"java/getting-started/client-quickstart/#insufficientfundserror","title":"\"InsufficientFundsError\"","text":"<p>Cause: Not enough USDC in your account.</p> <p>Solution: Add funds to your Solana account: <pre><code># Get your public key\nSystem.out.println(account.getPublicKey());\n\n# Fund on devnet (development)\n# Use Solana faucet or transfer USDC to this address\n</code></pre></p>"},{"location":"java/getting-started/client-quickstart/#illegalargumentexception-requests-to-localhost-are-blocked","title":"\"IllegalArgumentException: Requests to localhost are blocked\"","text":"<p>Cause: SSRF protection blocking local URLs.</p> <p>Solution: For development only, use <code>allowLocal(true)</code>: <pre><code>.allowLocal(true)  // Only for development!\n</code></pre></p>"},{"location":"java/getting-started/client-quickstart/#ioexception-connection-timeout","title":"\"IOException: Connection timeout\"","text":"<p>Cause: Network issues or slow RPC endpoint.</p> <p>Solution: Use custom HTTP client with longer timeouts: <pre><code>OkHttpClient httpClient = new OkHttpClient.Builder()\n    .connectTimeout(60, TimeUnit.SECONDS)\n    .readTimeout(60, TimeUnit.SECONDS)\n    .build();\n\nX402AutoClient client = new X402AutoClient.Builder(account)\n    .httpClient(httpClient)\n    .build();\n</code></pre></p>"},{"location":"java/getting-started/client-quickstart/#tips-for-success","title":"Tips for Success","text":"<ol> <li>Start with AutoClient: Use <code>X402AutoClient</code> for quick integration</li> <li>Use try-with-resources: Ensures proper cleanup</li> <li>Development mode: Use <code>allowLocal(true)</code> and devnet for testing</li> <li>Production mode: Use mainnet RPC and <code>allowLocal(false)</code></li> <li>Handle errors: Always catch <code>InsufficientFundsError</code> and other exceptions</li> <li>Set limits: Configure <code>maxPaymentAmount</code> to prevent overspending</li> <li>Secure keys: Never hardcode secret keys, use environment variables</li> <li>Check balance: Verify funds before making many requests</li> </ol>"},{"location":"java/getting-started/client-quickstart/#resources","title":"Resources","text":"<ul> <li>Full Example Application</li> <li>Client Library Documentation</li> <li>Core Library Documentation</li> <li>API Reference</li> <li>Error Handling</li> </ul>"},{"location":"java/getting-started/client-quickstart/#support","title":"Support","text":"<p>Need help?</p> <ul> <li>Check GitHub Issues</li> <li>Read Full Documentation</li> <li>See More Examples</li> </ul>"},{"location":"java/getting-started/installation/","title":"Java Installation Guide","text":"<p>This guide walks you through installing and setting up the OpenLibX402 Java SDK.</p>"},{"location":"java/getting-started/installation/#prerequisites","title":"Prerequisites","text":""},{"location":"java/getting-started/installation/#java-development-kit-jdk","title":"Java Development Kit (JDK)","text":"<p>OpenLibX402 requires Java 11 or higher.</p>"},{"location":"java/getting-started/installation/#macos","title":"macOS","text":"<pre><code># Using Homebrew\nbrew install openjdk@11\n\n# Or use SDKMAN!\ncurl -s \"https://get.sdkman.io\" | bash\nsdk install java 11.0.20-tem\n</code></pre>"},{"location":"java/getting-started/installation/#ubuntudebian","title":"Ubuntu/Debian","text":"<pre><code>sudo apt-get update\nsudo apt-get install openjdk-11-jdk\n</code></pre>"},{"location":"java/getting-started/installation/#windows","title":"Windows","text":"<p>Download and install from Oracle or Adoptium.</p>"},{"location":"java/getting-started/installation/#verify-installation","title":"Verify Installation","text":"<pre><code>java -version\n# Should show: openjdk version \"11.0.x\" or higher\n\njavac -version\n# Should show: javac 11.0.x or higher\n</code></pre>"},{"location":"java/getting-started/installation/#build-tool","title":"Build Tool","text":"<p>Choose either Maven or Gradle.</p>"},{"location":"java/getting-started/installation/#maven","title":"Maven","text":"<p>macOS: <pre><code>brew install maven\n</code></pre></p> <p>Ubuntu/Debian: <pre><code>sudo apt-get install maven\n</code></pre></p> <p>Windows: Download from Maven's website and add to PATH.</p> <p>Verify: <pre><code>mvn -version\n# Should show: Apache Maven 3.6.x or higher\n</code></pre></p>"},{"location":"java/getting-started/installation/#gradle","title":"Gradle","text":"<p>macOS: <pre><code>brew install gradle\n</code></pre></p> <p>Ubuntu/Debian: <pre><code>sdk install gradle 8.4\n</code></pre></p> <p>Windows: Download from Gradle's website and add to PATH.</p> <p>Verify: <pre><code>gradle -version\n# Should show: Gradle 7.x or higher\n</code></pre></p>"},{"location":"java/getting-started/installation/#installation-methods","title":"Installation Methods","text":""},{"location":"java/getting-started/installation/#option-1-maven-recommended","title":"Option 1: Maven (Recommended)","text":"<p>Add to your <code>pom.xml</code>:</p> <pre><code>&lt;project&gt;\n    &lt;dependencies&gt;\n        &lt;!-- Core package --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.openlibx402&lt;/groupId&gt;\n            &lt;artifactId&gt;openlibx402-core&lt;/artifactId&gt;\n            &lt;version&gt;0.1.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- Client package --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.openlibx402&lt;/groupId&gt;\n            &lt;artifactId&gt;openlibx402-client&lt;/artifactId&gt;\n            &lt;version&gt;0.1.0&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n&lt;/project&gt;\n</code></pre> <p>Install dependencies:</p> <pre><code>mvn clean install\n</code></pre>"},{"location":"java/getting-started/installation/#option-2-gradle-kotlin-dsl","title":"Option 2: Gradle (Kotlin DSL)","text":"<p>Add to your <code>build.gradle.kts</code>:</p> <pre><code>dependencies {\n    implementation(\"org.openlibx402:openlibx402-core:0.1.0\")\n    implementation(\"org.openlibx402:openlibx402-client:0.1.0\")\n}\n</code></pre>"},{"location":"java/getting-started/installation/#option-3-gradle-groovy-dsl","title":"Option 3: Gradle (Groovy DSL)","text":"<p>Add to your <code>build.gradle</code>:</p> <pre><code>dependencies {\n    implementation 'org.openlibx402:openlibx402-core:0.1.0'\n    implementation 'org.openlibx402:openlibx402-client:0.1.0'\n}\n</code></pre> <p>Install dependencies:</p> <pre><code>gradle build\n</code></pre>"},{"location":"java/getting-started/installation/#option-4-local-installation-development","title":"Option 4: Local Installation (Development)","text":"<p>For local development or testing unreleased versions:</p> <pre><code># Clone repository\ngit clone https://github.com/openlibx402/openlibx402.git\ncd openlibx402\n\n# Install core package\ncd packages/java/openlibx402-core\nmvn clean install\n\n# Install client package\ncd ../openlibx402-client\nmvn clean install\n</code></pre> <p>Then use in your project with the same Maven/Gradle configuration as above.</p>"},{"location":"java/getting-started/installation/#quick-start","title":"Quick Start","text":""},{"location":"java/getting-started/installation/#create-a-new-maven-project","title":"Create a New Maven Project","text":"<pre><code>mvn archetype:generate \\\n    -DgroupId=com.example \\\n    -DartifactId=my-x402-app \\\n    -DarchetypeArtifactId=maven-archetype-quickstart \\\n    -DarchetypeVersion=1.4 \\\n    -DinteractiveMode=false\n\ncd my-x402-app\n</code></pre> <p>Edit <code>pom.xml</code> to add OpenLibX402 dependencies:</p> <pre><code>&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0\n                             http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;groupId&gt;com.example&lt;/groupId&gt;\n    &lt;artifactId&gt;my-x402-app&lt;/artifactId&gt;\n    &lt;version&gt;1.0.0&lt;/version&gt;\n\n    &lt;properties&gt;\n        &lt;maven.compiler.source&gt;11&lt;/maven.compiler.source&gt;\n        &lt;maven.compiler.target&gt;11&lt;/maven.compiler.target&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n    &lt;/properties&gt;\n\n    &lt;dependencies&gt;\n        &lt;!-- OpenLibX402 --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.openlibx402&lt;/groupId&gt;\n            &lt;artifactId&gt;openlibx402-core&lt;/artifactId&gt;\n            &lt;version&gt;0.1.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.openlibx402&lt;/groupId&gt;\n            &lt;artifactId&gt;openlibx402-client&lt;/artifactId&gt;\n            &lt;version&gt;0.1.0&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n&lt;/project&gt;\n</code></pre>"},{"location":"java/getting-started/installation/#create-your-first-application","title":"Create Your First Application","text":"<p>Create <code>src/main/java/com/example/App.java</code>:</p> <pre><code>package com.example;\n\nimport org.openlibx402.client.X402AutoClient;\nimport org.p2p.solanaj.core.Account;\nimport okhttp3.Response;\n\npublic class App {\n    public static void main(String[] args) {\n        // Create Solana account\n        Account account = new Account();\n        System.out.println(\"Public Key: \" + account.getPublicKey());\n\n        // Create client\n        try (X402AutoClient client = new X402AutoClient.Builder(account)\n            .rpcUrl(\"https://api.devnet.solana.com\")\n            .maxPaymentAmount(\"1.0\")\n            .allowLocal(true)  // Development only\n            .build()\n        ) {\n            // Make payment-enabled request\n            Response response = client.get(\"https://api.example.com/data\");\n            System.out.println(\"Success: \" + response.body().string());\n\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>"},{"location":"java/getting-started/installation/#build-and-run","title":"Build and Run","text":"<pre><code># Compile\nmvn clean compile\n\n# Run\nmvn exec:java -Dexec.mainClass=\"com.example.App\"\n</code></pre>"},{"location":"java/getting-started/installation/#verify-installation_1","title":"Verify Installation","text":"<p>Create a test file to verify everything is working:</p> <pre><code>import org.openlibx402.core.models.PaymentRequest;\nimport org.openlibx402.client.X402Client;\n\npublic class VerifyInstallation {\n    public static void main(String[] args) {\n        System.out.println(\"OpenLibX402 installed successfully!\");\n        System.out.println(\"Core version: 0.1.0\");\n        System.out.println(\"Client version: 0.1.0\");\n\n        // Test imports\n        PaymentRequest.class.getName();\n        X402Client.class.getName();\n\n        System.out.println(\"All imports working!\");\n    }\n}\n</code></pre> <p>Run: <pre><code>javac -cp \"target/dependency/*\" VerifyInstallation.java\njava -cp \".:target/dependency/*\" VerifyInstallation\n</code></pre></p> <p>Expected output: <pre><code>OpenLibX402 installed successfully!\nCore version: 0.1.0\nClient version: 0.1.0\nAll imports working!\n</code></pre></p>"},{"location":"java/getting-started/installation/#package-structure","title":"Package Structure","text":"<p>OpenLibX402 is split into two packages:</p>"},{"location":"java/getting-started/installation/#core-package-openlibx402-core","title":"Core Package (<code>openlibx402-core</code>)","text":"<p>Provides core functionality: - Payment models (<code>PaymentRequest</code>, <code>PaymentAuthorization</code>) - Error types (<code>X402Error</code> hierarchy) - Blockchain integration (<code>SolanaPaymentProcessor</code>)</p> <p>When to use: - Building custom payment logic - Integrating with existing HTTP clients - Creating middleware or frameworks</p>"},{"location":"java/getting-started/installation/#client-package-openlibx402-client","title":"Client Package (<code>openlibx402-client</code>)","text":"<p>Provides HTTP client implementations: - <code>X402Client</code> - Manual payment control - <code>X402AutoClient</code> - Automatic payment handling</p> <p>When to use: - Making HTTP requests with payments - Quick integration with automatic payments - Standard client-server communication</p>"},{"location":"java/getting-started/installation/#typical-setup","title":"Typical Setup","text":"<p>Most applications need both packages:</p> <pre><code>&lt;dependencies&gt;\n    &lt;!-- Both core and client --&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.openlibx402&lt;/groupId&gt;\n        &lt;artifactId&gt;openlibx402-core&lt;/artifactId&gt;\n        &lt;version&gt;0.1.0&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.openlibx402&lt;/groupId&gt;\n        &lt;artifactId&gt;openlibx402-client&lt;/artifactId&gt;\n        &lt;version&gt;0.1.0&lt;/version&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n</code></pre>"},{"location":"java/getting-started/installation/#ide-setup","title":"IDE Setup","text":""},{"location":"java/getting-started/installation/#intellij-idea","title":"IntelliJ IDEA","text":"<ol> <li>Open Project:</li> <li>File \u2192 Open \u2192 Select your <code>pom.xml</code> or project directory</li> <li> <p>IntelliJ will automatically detect Maven/Gradle and import dependencies</p> </li> <li> <p>Refresh Dependencies:</p> </li> <li>Right-click <code>pom.xml</code> \u2192 Maven \u2192 Reload Project</li> <li> <p>Or: View \u2192 Tool Windows \u2192 Maven \u2192 Click refresh icon</p> </li> <li> <p>Verify:</p> </li> <li>Check that dependencies appear in External Libraries</li> <li>Try auto-complete for <code>import org.openlibx402.*</code></li> </ol>"},{"location":"java/getting-started/installation/#eclipse","title":"Eclipse","text":"<ol> <li>Import Project:</li> <li>File \u2192 Import \u2192 Maven \u2192 Existing Maven Projects</li> <li> <p>Select project directory</p> </li> <li> <p>Update Dependencies:</p> </li> <li>Right-click project \u2192 Maven \u2192 Update Project</li> <li> <p>Check \"Force Update of Snapshots/Releases\"</p> </li> <li> <p>Verify:</p> </li> <li>Check Maven Dependencies in Project Explorer</li> <li>Try importing OpenLibX402 classes</li> </ol>"},{"location":"java/getting-started/installation/#vs-code","title":"VS Code","text":"<ol> <li>Install Extensions:</li> <li>Extension Pack for Java</li> <li> <p>Maven for Java</p> </li> <li> <p>Open Project:</p> </li> <li>File \u2192 Open Folder \u2192 Select project directory</li> <li> <p>VS Code will detect <code>pom.xml</code> automatically</p> </li> <li> <p>Refresh:</p> </li> <li>Command Palette (Cmd/Ctrl+Shift+P) \u2192 \"Java: Clean Java Language Server Workspace\"</li> </ol>"},{"location":"java/getting-started/installation/#troubleshooting","title":"Troubleshooting","text":""},{"location":"java/getting-started/installation/#package-orgopenlibx402-does-not-exist","title":"\"Package org.openlibx402 does not exist\"","text":"<p>Solution: Run dependency install: <pre><code>mvn clean install\n# or\ngradle build --refresh-dependencies\n</code></pre></p>"},{"location":"java/getting-started/installation/#unsupported-class-file-major-version","title":"\"Unsupported class file major version\"","text":"<p>Cause: Using Java 8 or older.</p> <p>Solution: Upgrade to Java 11 or higher: <pre><code>java -version  # Check current version\n# Install Java 11+ (see Prerequisites above)\n</code></pre></p>"},{"location":"java/getting-started/installation/#maven-central-connection-issues","title":"Maven Central Connection Issues","text":"<p>Symptoms: Cannot download dependencies.</p> <p>Solution 1: Check internet connection and retry: <pre><code>mvn clean install -U  # Force update\n</code></pre></p> <p>Solution 2: Add Maven Central explicitly to <code>pom.xml</code>: <pre><code>&lt;repositories&gt;\n    &lt;repository&gt;\n        &lt;id&gt;central&lt;/id&gt;\n        &lt;url&gt;https://repo.maven.apache.org/maven2&lt;/url&gt;\n    &lt;/repository&gt;\n&lt;/repositories&gt;\n</code></pre></p>"},{"location":"java/getting-started/installation/#dependency-conflicts","title":"Dependency Conflicts","text":"<p>Symptoms: NoClassDefFoundError or ClassNotFoundException.</p> <p>Solution: Check for conflicts: <pre><code>mvn dependency:tree\n</code></pre></p> <p>Exclude conflicting dependencies: <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.openlibx402&lt;/groupId&gt;\n    &lt;artifactId&gt;openlibx402-client&lt;/artifactId&gt;\n    &lt;version&gt;0.1.0&lt;/version&gt;\n    &lt;exclusions&gt;\n        &lt;exclusion&gt;\n            &lt;groupId&gt;conflicting.group&lt;/groupId&gt;\n            &lt;artifactId&gt;conflicting-artifact&lt;/artifactId&gt;\n        &lt;/exclusion&gt;\n    &lt;/exclusions&gt;\n&lt;/dependency&gt;\n</code></pre></p>"},{"location":"java/getting-started/installation/#local-installation-not-found","title":"Local Installation Not Found","text":"<p>Symptoms: Package not found after <code>mvn install</code>.</p> <p>Solution: Check local repository: <pre><code>ls ~/.m2/repository/org/openlibx402/\n</code></pre></p> <p>If empty, reinstall: <pre><code>cd packages/java/openlibx402-core\nmvn clean install -U\n\ncd ../openlibx402-client\nmvn clean install -U\n</code></pre></p>"},{"location":"java/getting-started/installation/#environment-setup","title":"Environment Setup","text":""},{"location":"java/getting-started/installation/#solana-account","title":"Solana Account","text":"<p>For development, you can use a test account:</p> <pre><code># Set environment variable\nexport SOLANA_SECRET_KEY=\"your-base64-encoded-key\"\n</code></pre> <p>In Java: <pre><code>String keyString = System.getenv(\"SOLANA_SECRET_KEY\");\nbyte[] secretKey = java.util.Base64.getDecoder().decode(keyString);\nAccount account = new Account(secretKey);\n</code></pre></p>"},{"location":"java/getting-started/installation/#network-configuration","title":"Network Configuration","text":"<p>Devnet (Testing): <pre><code>String rpcUrl = \"https://api.devnet.solana.com\";\n</code></pre></p> <p>Mainnet (Production): <pre><code>String rpcUrl = \"https://api.mainnet-beta.solana.com\";\n</code></pre></p>"},{"location":"java/getting-started/installation/#next-steps","title":"Next Steps","text":"<p>Now that you have OpenLibX402 installed:</p> <ol> <li>Client Quickstart - Build your first payment-enabled client</li> <li>Basic Usage Examples - Learn common patterns</li> <li>API Reference - Explore the full API</li> </ol>"},{"location":"java/getting-started/installation/#version-updates","title":"Version Updates","text":"<p>Check for updates: <pre><code># Maven\nmvn versions:display-dependency-updates\n\n# Or check Maven Central\nhttps://search.maven.org/artifact/org.openlibx402/openlibx402-core\n</code></pre></p> <p>Update to latest version in your <code>pom.xml</code>: <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.openlibx402&lt;/groupId&gt;\n    &lt;artifactId&gt;openlibx402-core&lt;/artifactId&gt;\n    &lt;version&gt;LATEST_VERSION&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre></p>"},{"location":"java/getting-started/installation/#support","title":"Support","text":"<ul> <li>Documentation: https://docs.openlibx402.org</li> <li>GitHub Issues: https://github.com/openlibx402/openlibx402/issues</li> <li>Examples: https://github.com/openlibx402/openlibx402/tree/main/examples/java</li> </ul>"},{"location":"java/libraries/client/","title":"Java Client Library","text":"<p>The <code>openlibx402-client</code> package provides HTTP client implementations for making X402 payment-enabled requests in Java applications.</p>"},{"location":"java/libraries/client/#overview","title":"Overview","text":"<p>The client library offers two main classes:</p> <ul> <li>X402Client: Manual payment control for maximum flexibility</li> <li>X402AutoClient: Automatic payment handling for convenience</li> </ul>"},{"location":"java/libraries/client/#installation","title":"Installation","text":"<p>Add to your <code>pom.xml</code>:</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.openlibx402&lt;/groupId&gt;\n    &lt;artifactId&gt;openlibx402-client&lt;/artifactId&gt;\n    &lt;version&gt;0.1.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>Or with Gradle:</p> <pre><code>implementation 'org.openlibx402:openlibx402-client:0.1.0'\n</code></pre>"},{"location":"java/libraries/client/#x402client","title":"X402Client","text":"<p>Manual payment control client for explicit payment flow management.</p>"},{"location":"java/libraries/client/#features","title":"Features","text":"<ul> <li>Manual payment request handling</li> <li>Full control over payment decisions</li> <li>Support for GET, POST, PUT, DELETE methods</li> <li>SSRF protection (blocks localhost and private IPs)</li> <li>Resource management with <code>AutoCloseable</code></li> </ul>"},{"location":"java/libraries/client/#basic-usage","title":"Basic Usage","text":"<pre><code>import org.openlibx402.client.X402Client;\nimport org.openlibx402.core.errors.*;\nimport org.openlibx402.core.models.*;\nimport org.p2p.solanaj.core.Account;\nimport okhttp3.Response;\n\n// Initialize client\nAccount account = new Account(secretKey);\nX402Client client = new X402Client(\n    account,\n    \"https://api.devnet.solana.com\",\n    true  // allowLocal for development only\n);\n\ntry {\n    // Make request\n    Response response = client.get(\"https://api.example.com/premium-data\");\n    System.out.println(response.body().string());\n\n} catch (PaymentRequiredError e) {\n    // Handle 402 Payment Required\n    PaymentRequest request = e.getPaymentRequest();\n\n    // Create payment\n    PaymentAuthorization auth = client.createPayment(request);\n\n    // Retry with payment\n    Response retryResponse = client.get(\"https://api.example.com/premium-data\", auth);\n    System.out.println(retryResponse.body().string());\n\n} finally {\n    client.close();\n}\n</code></pre>"},{"location":"java/libraries/client/#constructor-parameters","title":"Constructor Parameters","text":"Parameter Type Description Default <code>walletAccount</code> <code>Account</code> Solana account for signing transactions Required <code>rpcUrl</code> <code>String</code> Solana RPC endpoint URL <code>null</code> (uses devnet) <code>allowLocal</code> <code>boolean</code> Allow localhost URLs (development only) <code>false</code>"},{"location":"java/libraries/client/#http-methods","title":"HTTP Methods","text":""},{"location":"java/libraries/client/#get-request","title":"GET Request","text":"<pre><code>Response response = client.get(url);\nResponse response = client.get(url, paymentAuth);\n</code></pre>"},{"location":"java/libraries/client/#post-request","title":"POST Request","text":"<pre><code>String jsonBody = \"{\\\"key\\\": \\\"value\\\"}\";\nResponse response = client.post(url, jsonBody);\nResponse response = client.post(url, jsonBody, paymentAuth);\n</code></pre>"},{"location":"java/libraries/client/#put-request","title":"PUT Request","text":"<pre><code>String jsonBody = \"{\\\"key\\\": \\\"updated\\\"}\";\nResponse response = client.put(url, jsonBody);\nResponse response = client.put(url, jsonBody, paymentAuth);\n</code></pre>"},{"location":"java/libraries/client/#delete-request","title":"DELETE Request","text":"<pre><code>Response response = client.delete(url);\nResponse response = client.delete(url, paymentAuth);\n</code></pre>"},{"location":"java/libraries/client/#payment-methods","title":"Payment Methods","text":""},{"location":"java/libraries/client/#create-payment","title":"Create Payment","text":"<pre><code>PaymentAuthorization auth = client.createPayment(paymentRequest);\nPaymentAuthorization auth = client.createPayment(paymentRequest, \"0.05\"); // specific amount\n</code></pre>"},{"location":"java/libraries/client/#parse-payment-request","title":"Parse Payment Request","text":"<pre><code>Response response = client.get(url);\nif (client.paymentRequired(response)) {\n    PaymentRequest request = client.parsePaymentRequest(response);\n    // ... handle payment\n}\n</code></pre>"},{"location":"java/libraries/client/#access-processor","title":"Access Processor","text":"<pre><code>SolanaPaymentProcessor processor = client.getProcessor();\nString balance = processor.getBalance(account.getPublicKey());\n</code></pre>"},{"location":"java/libraries/client/#error-handling","title":"Error Handling","text":"<pre><code>try {\n    Response response = client.get(url);\n} catch (PaymentRequiredError e) {\n    // 402 Payment Required\n    PaymentRequest request = e.getPaymentRequest();\n} catch (InsufficientFundsError e) {\n    // Not enough funds for payment\n    System.err.println(\"Need: \" + e.getRequiredAmount());\n    System.err.println(\"Have: \" + e.getAvailableAmount());\n} catch (PaymentExpiredError e) {\n    // Payment request expired\n    System.err.println(\"Request expired at: \" + e.getPaymentRequest().getExpiresAt());\n} catch (X402Error e) {\n    // Other X402 errors\n    System.err.println(\"Error: \" + e.getMessage());\n} catch (IOException e) {\n    // Network or HTTP errors\n    System.err.println(\"Network error: \" + e.getMessage());\n}\n</code></pre>"},{"location":"java/libraries/client/#ssrf-protection","title":"SSRF Protection","text":"<p>By default, the client blocks requests to: - <code>localhost</code>, <code>127.0.0.1</code>, <code>::1</code> - Private IP ranges (10.x.x.x, 172.16.x.x, 192.168.x.x)</p> <pre><code>// Development mode - allows local URLs\nX402Client devClient = new X402Client(account, null, true);\n\n// Production mode - blocks local URLs (default)\nX402Client prodClient = new X402Client(account, null, false);\n</code></pre> <p>Security</p> <p>Never use <code>allowLocal=true</code> in production environments. This protection prevents Server-Side Request Forgery (SSRF) attacks.</p>"},{"location":"java/libraries/client/#x402autoclient","title":"X402AutoClient","text":"<p>Automatic payment handling client with retry logic and payment limits.</p>"},{"location":"java/libraries/client/#features_1","title":"Features","text":"<ul> <li>Automatic 402 detection and payment</li> <li>Configurable payment limits</li> <li>Automatic retry on payment</li> <li>Builder pattern for configuration</li> <li>Built on top of X402Client</li> </ul>"},{"location":"java/libraries/client/#basic-usage_1","title":"Basic Usage","text":"<pre><code>import org.openlibx402.client.X402AutoClient;\n\n// Build client with configuration\nX402AutoClient client = new X402AutoClient.Builder(account)\n    .rpcUrl(\"https://api.devnet.solana.com\")\n    .maxPaymentAmount(\"1.0\")      // Max 1 USDC per request\n    .maxRetries(3)                 // Retry up to 3 times\n    .allowLocal(true)              // Development only\n    .build();\n\ntry {\n    // Automatically handles 402 and retries\n    Response response = client.get(\"https://api.example.com/premium-data\");\n    System.out.println(response.body().string());\n} finally {\n    client.close();\n}\n</code></pre>"},{"location":"java/libraries/client/#builder-configuration","title":"Builder Configuration","text":"Method Parameter Description Default <code>rpcUrl(String)</code> RPC endpoint Solana RPC URL Devnet <code>maxPaymentAmount(String)</code> Amount Maximum payment per request <code>\"1.0\"</code> <code>maxRetries(int)</code> Count Maximum retry attempts <code>3</code> <code>allowLocal(boolean)</code> Allow local Allow localhost URLs <code>false</code> <code>httpClient(OkHttpClient)</code> Client Custom HTTP client Default"},{"location":"java/libraries/client/#example-custom-configuration","title":"Example: Custom Configuration","text":"<pre><code>import okhttp3.OkHttpClient;\nimport java.util.concurrent.TimeUnit;\n\n// Custom HTTP client\nOkHttpClient httpClient = new OkHttpClient.Builder()\n    .connectTimeout(60, TimeUnit.SECONDS)\n    .readTimeout(60, TimeUnit.SECONDS)\n    .build();\n\n// Build auto client\nX402AutoClient client = new X402AutoClient.Builder(account)\n    .rpcUrl(\"https://api.mainnet-beta.solana.com\")\n    .maxPaymentAmount(\"5.0\")\n    .maxRetries(2)\n    .httpClient(httpClient)\n    .build();\n</code></pre>"},{"location":"java/libraries/client/#automatic-payment-flow","title":"Automatic Payment Flow","text":"<pre><code>try {\n    // 1. Makes initial request\n    // 2. Receives 402 Payment Required\n    // 3. Automatically creates payment\n    // 4. Retries request with authorization\n    // 5. Returns successful response\n    Response response = client.post(\n        \"https://api.example.com/data\",\n        \"{\\\"query\\\": \\\"process this\\\"}\"\n    );\n\n    System.out.println(\"Success: \" + response.body().string());\n\n} catch (InsufficientFundsError e) {\n    System.err.println(\"Payment failed: not enough funds\");\n} catch (PaymentRequiredError e) {\n    // Only thrown if max retries exceeded\n    System.err.println(\"Payment required but max retries exceeded\");\n}\n</code></pre>"},{"location":"java/libraries/client/#payment-limits","title":"Payment Limits","text":"<p>The client enforces payment limits to prevent excessive charges:</p> <pre><code>// This will throw an error if payment exceeds 1.0 USDC\nX402AutoClient client = new X402AutoClient.Builder(account)\n    .maxPaymentAmount(\"1.0\")\n    .build();\n\ntry {\n    Response response = client.get(url);\n} catch (PaymentRequiredError e) {\n    PaymentRequest request = e.getPaymentRequest();\n    if (request.getMaxAmountRequired().compareTo(\"1.0\") &gt; 0) {\n        System.err.println(\"Payment exceeds limit: \" + request.getMaxAmountRequired());\n    }\n}\n</code></pre>"},{"location":"java/libraries/client/#access-underlying-client","title":"Access Underlying Client","text":"<pre><code>// Access the base X402Client\nX402Client baseClient = autoClient.getBaseClient();\n\n// Access the processor\nSolanaPaymentProcessor processor = autoClient.getProcessor();\nString balance = processor.getBalance(account.getPublicKey());\n</code></pre>"},{"location":"java/libraries/client/#comparison-manual-vs-automatic","title":"Comparison: Manual vs Automatic","text":"Feature X402Client X402AutoClient Payment Control Manual Automatic Retry Logic Manual Automatic Payment Limits Manual Built-in Use Case Maximum control Convenience Error Handling Explicit Simplified Configuration Constructor Builder"},{"location":"java/libraries/client/#when-to-use-each","title":"When to Use Each","text":"<p>Use X402Client when you need: - Fine-grained control over payments - Custom payment decision logic - Explicit user approval for payments - Complex payment workflows - Integration with existing payment systems</p> <p>Use X402AutoClient when you need: - Quick integration with automatic payments - Simplified error handling - Built-in retry logic - Payment limit enforcement - Reduced boilerplate code</p>"},{"location":"java/libraries/client/#thread-safety","title":"Thread Safety","text":"<p>Both clients are not thread-safe. Create separate instances for concurrent requests:</p> <pre><code>// Thread-safe usage\nExecutorService executor = Executors.newFixedThreadPool(10);\n\nfor (int i = 0; i &lt; 10; i++) {\n    executor.submit(() -&gt; {\n        // Each thread gets its own client\n        try (X402Client client = new X402Client(account, null, false)) {\n            Response response = client.get(\"https://api.example.com/data\");\n            // ... process response\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    });\n}\n</code></pre>"},{"location":"java/libraries/client/#resource-management","title":"Resource Management","text":"<p>Both clients implement <code>AutoCloseable</code> for proper resource cleanup:</p> <pre><code>// Try-with-resources (recommended)\ntry (X402Client client = new X402Client(account)) {\n    Response response = client.get(url);\n    // Client automatically closed\n}\n\n// Manual cleanup\nX402Client client = new X402Client(account);\ntry {\n    Response response = client.get(url);\n} finally {\n    client.close();  // Must call close\n}\n</code></pre>"},{"location":"java/libraries/client/#best-practices","title":"Best Practices","text":"<ol> <li>Use try-with-resources: Ensures proper cleanup</li> <li>Don't share clients: Create separate instances for threads</li> <li>Set reasonable timeouts: Configure HTTP client timeouts</li> <li>Handle all errors: Catch specific X402Error types</li> <li>Never use allowLocal in production: Security risk</li> <li>Close responses: Call <code>response.close()</code> or use try-with-resources</li> <li>Validate payment amounts: Check before creating payments</li> <li>Log payment activities: Track payments for auditing</li> </ol>"},{"location":"java/libraries/client/#example-production-setup","title":"Example: Production Setup","text":"<pre><code>import org.openlibx402.client.X402AutoClient;\nimport org.openlibx402.core.errors.*;\nimport org.p2p.solanaj.core.Account;\nimport okhttp3.Response;\nimport java.util.logging.Logger;\n\npublic class ProductionExample {\n    private static final Logger logger = Logger.getLogger(ProductionExample.class.getName());\n\n    public static void main(String[] args) {\n        // Load account securely\n        Account account = loadAccountFromSecureStorage();\n\n        // Configure production client\n        X402AutoClient client = new X402AutoClient.Builder(account)\n            .rpcUrl(\"https://api.mainnet-beta.solana.com\")\n            .maxPaymentAmount(\"10.0\")\n            .maxRetries(2)\n            .allowLocal(false)  // Production security\n            .build();\n\n        try {\n            logger.info(\"Making payment-enabled request\");\n\n            Response response = client.get(\"https://api.production.com/premium-data\");\n            String data = response.body().string();\n\n            logger.info(\"Request successful: \" + data);\n\n        } catch (InsufficientFundsError e) {\n            logger.severe(\"Insufficient funds: \" + e.getMessage());\n            // Alert user to add funds\n\n        } catch (PaymentRequiredError e) {\n            logger.severe(\"Payment failed after retries\");\n            // Escalate to support\n\n        } catch (X402Error e) {\n            logger.severe(\"X402 error: \" + e.getCode() + \" - \" + e.getMessage());\n\n        } catch (Exception e) {\n            logger.severe(\"Unexpected error: \" + e.getMessage());\n\n        } finally {\n            client.close();\n        }\n    }\n\n    private static Account loadAccountFromSecureStorage() {\n        // Load from environment, key vault, etc.\n        String secretKey = System.getenv(\"SOLANA_SECRET_KEY\");\n        return new Account(decodeSecretKey(secretKey));\n    }\n\n    private static byte[] decodeSecretKey(String key) {\n        // Implement secure key decoding\n        return java.util.Base64.getDecoder().decode(key);\n    }\n}\n</code></pre>"},{"location":"java/libraries/client/#related-documentation","title":"Related Documentation","text":"<ul> <li>Core Library - Payment models and blockchain integration</li> <li>API Reference - Complete API documentation</li> <li>Error Handling - Error types and handling</li> <li>Examples - More usage examples</li> </ul>"},{"location":"java/libraries/core/","title":"OpenLibX402 Core Library (Java)","text":"<p>The <code>openlibx402-core</code> package provides the fundamental payment protocol components for Java applications.</p>"},{"location":"java/libraries/core/#installation","title":"Installation","text":"<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.openlibx402&lt;/groupId&gt;\n    &lt;artifactId&gt;openlibx402-core&lt;/artifactId&gt;\n    &lt;version&gt;0.1.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>"},{"location":"java/libraries/core/#package-structure","title":"Package Structure","text":"<pre><code>org.openlibx402.core/\n\u251c\u2500\u2500 models/\n\u2502   \u251c\u2500\u2500 PaymentRequest\n\u2502   \u2514\u2500\u2500 PaymentAuthorization\n\u251c\u2500\u2500 errors/\n\u2502   \u251c\u2500\u2500 X402Error\n\u2502   \u251c\u2500\u2500 PaymentRequiredError\n\u2502   \u251c\u2500\u2500 PaymentExpiredError\n\u2502   \u251c\u2500\u2500 InsufficientFundsError\n\u2502   \u251c\u2500\u2500 PaymentVerificationError\n\u2502   \u251c\u2500\u2500 TransactionBroadcastError\n\u2502   \u2514\u2500\u2500 InvalidPaymentRequestError\n\u251c\u2500\u2500 blockchain/\n\u2502   \u2514\u2500\u2500 SolanaPaymentProcessor\n\u2514\u2500\u2500 util/\n    \u2514\u2500\u2500 ErrorCodes\n</code></pre>"},{"location":"java/libraries/core/#models","title":"Models","text":""},{"location":"java/libraries/core/#paymentrequest","title":"PaymentRequest","text":"<p>Represents a 402 payment request from a server.</p> <pre><code>import org.openlibx402.core.models.PaymentRequest;\n\n// Parse from JSON\nPaymentRequest request = PaymentRequest.fromJson(jsonString);\n\n// Access fields\nString amount = request.getMaxAmountRequired();\nString paymentAddress = request.getPaymentAddress();\nInstant expiresAt = request.getExpiresAt();\n\n// Check expiration\nboolean expired = request.isExpired();\n\n// Convert to JSON\nString json = request.toJson();\n\n// Convert to Map\nMap&lt;String, Object&gt; map = request.toMap();\n</code></pre> <p>Fields: - <code>maxAmountRequired</code> - Maximum payment amount (decimal string) - <code>assetType</code> - Asset type (e.g., \"SPL\") - <code>assetAddress</code> - Token mint address - <code>paymentAddress</code> - Recipient wallet address - <code>network</code> - Blockchain network (e.g., \"solana-devnet\") - <code>expiresAt</code> - Expiration timestamp - <code>nonce</code> - Unique nonce for replay protection - <code>paymentId</code> - Unique payment identifier - <code>resource</code> - API resource endpoint - <code>description</code> - Optional description</p>"},{"location":"java/libraries/core/#paymentauthorization","title":"PaymentAuthorization","text":"<p>Represents proof of payment for accessing protected resources.</p> <pre><code>import org.openlibx402.core.models.PaymentAuthorization;\n\n// Create authorization\nPaymentAuthorization auth = new PaymentAuthorization(\n    paymentId,\n    actualAmount,\n    paymentAddress,\n    assetAddress,\n    network,\n    timestamp,\n    signature,\n    publicKey,\n    transactionHash\n);\n\n// Convert to header value (base64-encoded JSON)\nString headerValue = auth.toHeaderValue();\n\n// Parse from header\nPaymentAuthorization parsed = PaymentAuthorization.fromHeader(headerValue);\n\n// Parse from JSON\nPaymentAuthorization fromJson = PaymentAuthorization.fromJson(jsonString);\n</code></pre> <p>Fields: - <code>paymentId</code> - Payment identifier from request - <code>actualAmount</code> - Amount paid - <code>paymentAddress</code> - Recipient address - <code>assetAddress</code> - Token mint address - <code>network</code> - Network identifier - <code>timestamp</code> - Authorization timestamp - <code>signature</code> - Transaction signature - <code>publicKey</code> - Payer's public key - <code>transactionHash</code> - Transaction hash</p>"},{"location":"java/libraries/core/#error-handling","title":"Error Handling","text":""},{"location":"java/libraries/core/#x402error","title":"X402Error","text":"<p>Base exception class for all payment errors.</p> <pre><code>import org.openlibx402.core.errors.*;\n\ntry {\n    // Payment operation\n} catch (X402Error e) {\n    String code = e.getCode();\n    String message = e.getMessage();\n    Map&lt;String, Object&gt; details = e.getDetails();\n}\n</code></pre>"},{"location":"java/libraries/core/#specific-error-types","title":"Specific Error Types","text":"<p>PaymentRequiredError <pre><code>catch (PaymentRequiredError e) {\n    PaymentRequest request = e.getPaymentRequest();\n    // Code: PAYMENT_REQUIRED\n    // Retry: true\n}\n</code></pre></p> <p>InsufficientFundsError <pre><code>catch (InsufficientFundsError e) {\n    String required = e.getRequiredAmount();\n    String available = e.getAvailableAmount();\n    // Code: INSUFFICIENT_FUNDS\n    // Retry: false\n}\n</code></pre></p> <p>PaymentExpiredError <pre><code>catch (PaymentExpiredError e) {\n    PaymentRequest request = e.getPaymentRequest();\n    // Code: PAYMENT_EXPIRED\n    // Retry: true\n}\n</code></pre></p> <p>PaymentVerificationError <pre><code>catch (PaymentVerificationError e) {\n    String reason = e.getReason();\n    // Code: PAYMENT_VERIFICATION_FAILED\n    // Retry: true\n}\n</code></pre></p> <p>TransactionBroadcastError <pre><code>catch (TransactionBroadcastError e) {\n    String reason = e.getReason();\n    // Code: TRANSACTION_BROADCAST_FAILED\n    // Retry: true\n}\n</code></pre></p> <p>InvalidPaymentRequestError <pre><code>catch (InvalidPaymentRequestError e) {\n    String reason = e.getReason();\n    // Code: INVALID_PAYMENT_REQUEST\n    // Retry: false\n}\n</code></pre></p>"},{"location":"java/libraries/core/#blockchain-integration","title":"Blockchain Integration","text":""},{"location":"java/libraries/core/#solanapaymentprocessor","title":"SolanaPaymentProcessor","text":"<p>Handles Solana blockchain operations.</p> <pre><code>import org.openlibx402.core.blockchain.SolanaPaymentProcessor;\nimport org.p2p.solanaj.core.Account;\n\n// Create processor\nSolanaPaymentProcessor processor = new SolanaPaymentProcessor(\n    \"https://api.devnet.solana.com\"\n);\n\ntry (processor) {\n    // Create payment\n    Account account = new Account(secretKey);\n    PaymentAuthorization auth = processor.createPayment(\n        paymentRequest,\n        account,\n        \"0.10\"  // Optional amount\n    );\n\n    // Check balance\n    PublicKey pubkey = new PublicKey(\"...\");\n    double balance = processor.getBalance(pubkey);\n\n    // Verify transaction\n    boolean valid = processor.verifyTransaction(\n        txHash,\n        recipientAddress,\n        amount,\n        tokenMint\n    );\n}\n</code></pre> <p>Methods: - <code>createPayment(request, account, amount)</code> - Create and broadcast payment - <code>getBalance(publicKey)</code> - Get SOL balance - <code>getTokenBalance(address, mint)</code> - Get SPL token balance - <code>verifyTransaction(hash, recipient, amount, mint)</code> - Verify on-chain transaction - <code>close()</code> - Clean up resources</p>"},{"location":"java/libraries/core/#error-codes","title":"Error Codes","text":""},{"location":"java/libraries/core/#errorcodes-utility","title":"ErrorCodes Utility","text":"<p>Access error metadata and retry information.</p> <pre><code>import org.openlibx402.core.util.ErrorCodes;\n\n// Get error info\nErrorCodes.ErrorCodeInfo info = ErrorCodes.getInfo(\"PAYMENT_REQUIRED\");\nString message = info.getMessage();\nboolean retryable = info.isRetry();\nString userAction = info.getUserAction();\n\n// Check if retryable\nboolean canRetry = ErrorCodes.isRetryable(\"INSUFFICIENT_FUNDS\");  // false\n\n// Get all codes\nMap&lt;String, ErrorCodes.ErrorCodeInfo&gt; allCodes = ErrorCodes.getAllCodes();\n</code></pre> <p>Available Error Codes: - <code>PAYMENT_REQUIRED</code> - Payment required (retry: true) - <code>PAYMENT_EXPIRED</code> - Payment expired (retry: true) - <code>INSUFFICIENT_FUNDS</code> - Insufficient balance (retry: false) - <code>PAYMENT_VERIFICATION_FAILED</code> - Verification failed (retry: true) - <code>TRANSACTION_BROADCAST_FAILED</code> - Broadcast failed (retry: true) - <code>INVALID_PAYMENT_REQUEST</code> - Invalid request (retry: false)</p>"},{"location":"java/libraries/core/#thread-safety","title":"Thread Safety","text":"<p>All core classes are thread-safe: - Models are immutable - SolanaPaymentProcessor uses thread-safe RPC client - Error instances are immutable</p>"},{"location":"java/libraries/core/#resource-management","title":"Resource Management","text":"<p>Use try-with-resources for proper cleanup:</p> <pre><code>try (SolanaPaymentProcessor processor = new SolanaPaymentProcessor(rpcUrl)) {\n    // Use processor\n}  // Automatically closed\n</code></pre>"},{"location":"java/libraries/core/#next-steps","title":"Next Steps","text":"<ul> <li>Client Library</li> <li>Getting Started</li> <li>Examples</li> </ul>"},{"location":"java/reference/api-reference/","title":"Java API Reference","text":"<p>Complete API reference for the OpenLibX402 Java SDK.</p>"},{"location":"java/reference/api-reference/#package-orgopenlibx402client","title":"Package: org.openlibx402.client","text":""},{"location":"java/reference/api-reference/#x402client","title":"X402Client","text":"<p>Manual payment control HTTP client.</p>"},{"location":"java/reference/api-reference/#constructor","title":"Constructor","text":"<pre><code>public X402Client(\n    Account walletAccount,\n    String rpcUrl,\n    boolean allowLocal\n)\n</code></pre> <p>Parameters: - <code>walletAccount</code> (Account): Solana account for signing transactions - <code>rpcUrl</code> (String): Solana RPC endpoint URL (null for devnet default) - <code>allowLocal</code> (boolean): Allow localhost URLs (false for production)</p>"},{"location":"java/reference/api-reference/#http-methods","title":"HTTP Methods","text":""},{"location":"java/reference/api-reference/#get","title":"get()","text":"<pre><code>public Response get(String url) throws IOException, X402Error\npublic Response get(String url, PaymentAuthorization payment) throws IOException, X402Error\n</code></pre> <p>Performs a GET request.</p> <p>Returns: OkHttp Response object</p> <p>Throws: - <code>PaymentRequiredError</code> - 402 response received - <code>IOException</code> - Network error</p>"},{"location":"java/reference/api-reference/#post","title":"post()","text":"<pre><code>public Response post(String url, String body) throws IOException, X402Error\npublic Response post(String url, String body, PaymentAuthorization payment) throws IOException, X402Error\n</code></pre> <p>Performs a POST request with JSON body.</p>"},{"location":"java/reference/api-reference/#put","title":"put()","text":"<pre><code>public Response put(String url, String body) throws IOException, X402Error\npublic Response put(String url, String body, PaymentAuthorization payment) throws IOException, X402Error\n</code></pre> <p>Performs a PUT request with JSON body.</p>"},{"location":"java/reference/api-reference/#delete","title":"delete()","text":"<pre><code>public Response delete(String url) throws IOException, X402Error\npublic Response delete(String url, PaymentAuthorization payment) throws IOException, X402Error\n</code></pre> <p>Performs a DELETE request.</p>"},{"location":"java/reference/api-reference/#payment-methods","title":"Payment Methods","text":""},{"location":"java/reference/api-reference/#createpayment","title":"createPayment()","text":"<pre><code>public PaymentAuthorization createPayment(PaymentRequest request, String amount)\n    throws X402Error\n</code></pre> <p>Creates a payment for a payment request.</p> <p>Parameters: - <code>request</code> (PaymentRequest): The payment request - <code>amount</code> (String): Specific amount (null for max amount)</p> <p>Returns: PaymentAuthorization to include in retry request</p> <p>Throws: - <code>InsufficientFundsError</code> - Not enough funds - <code>PaymentExpiredError</code> - Request expired - <code>TransactionBroadcastError</code> - Broadcast failed</p>"},{"location":"java/reference/api-reference/#parsepaymentrequest","title":"parsePaymentRequest()","text":"<pre><code>public PaymentRequest parsePaymentRequest(Response response)\n    throws InvalidPaymentRequestError\n</code></pre> <p>Parses payment request from 402 response.</p>"},{"location":"java/reference/api-reference/#paymentrequired","title":"paymentRequired()","text":"<pre><code>public boolean paymentRequired(Response response)\n</code></pre> <p>Checks if response indicates payment is required.</p>"},{"location":"java/reference/api-reference/#access-methods","title":"Access Methods","text":""},{"location":"java/reference/api-reference/#getprocessor","title":"getProcessor()","text":"<pre><code>public SolanaPaymentProcessor getProcessor()\n</code></pre> <p>Gets the underlying payment processor.</p>"},{"location":"java/reference/api-reference/#isclosed","title":"isClosed()","text":"<pre><code>public boolean isClosed()\n</code></pre> <p>Checks if client has been closed.</p>"},{"location":"java/reference/api-reference/#close","title":"close()","text":"<pre><code>public void close()\n</code></pre> <p>Closes the client and releases resources.</p>"},{"location":"java/reference/api-reference/#x402autoclient","title":"X402AutoClient","text":"<p>Automatic payment handling HTTP client with Builder pattern.</p>"},{"location":"java/reference/api-reference/#builder","title":"Builder","text":"<pre><code>X402AutoClient.Builder builder = new X402AutoClient.Builder(account);\nbuilder.rpcUrl(String)\n       .maxPaymentAmount(String)\n       .maxRetries(int)\n       .allowLocal(boolean)\n       .httpClient(OkHttpClient);\nX402AutoClient client = builder.build();\n</code></pre> <p>Builder Methods:</p> Method Parameter Description Default <code>rpcUrl(String)</code> RPC URL Solana RPC endpoint Devnet <code>maxPaymentAmount(String)</code> Amount Maximum payment per request \"1.0\" <code>maxRetries(int)</code> Count Maximum retry attempts 3 <code>allowLocal(boolean)</code> Allow Allow localhost URLs false <code>httpClient(OkHttpClient)</code> Client Custom HTTP client Default"},{"location":"java/reference/api-reference/#http-methods_1","title":"HTTP Methods","text":"<p>Same as X402Client, but automatically handles 402 responses:</p> <pre><code>public Response get(String url) throws IOException, X402Error\npublic Response post(String url, String body) throws IOException, X402Error\npublic Response put(String url, String body) throws IOException, X402Error\npublic Response delete(String url) throws IOException, X402Error\n</code></pre>"},{"location":"java/reference/api-reference/#access-methods_1","title":"Access Methods","text":"<pre><code>public X402Client getBaseClient()\npublic SolanaPaymentProcessor getProcessor()\npublic void close()\n</code></pre>"},{"location":"java/reference/api-reference/#package-orgopenlibx402coremodels","title":"Package: org.openlibx402.core.models","text":""},{"location":"java/reference/api-reference/#paymentrequest","title":"PaymentRequest","text":"<p>Payment request details from 402 response.</p>"},{"location":"java/reference/api-reference/#fields","title":"Fields","text":"<pre><code>private final String maxAmountRequired;\nprivate final String assetType;\nprivate final String assetAddress;\nprivate final String paymentAddress;\nprivate final String network;\nprivate final String expiresAt;\nprivate final String nonce;\nprivate final String paymentId;\nprivate final String resource;\nprivate final String description;\n</code></pre>"},{"location":"java/reference/api-reference/#methods","title":"Methods","text":""},{"location":"java/reference/api-reference/#fromjson","title":"fromJson()","text":"<pre><code>public static PaymentRequest fromJson(String json)\n</code></pre> <p>Parses PaymentRequest from JSON string.</p>"},{"location":"java/reference/api-reference/#tojson","title":"toJson()","text":"<pre><code>public String toJson()\n</code></pre> <p>Serializes to JSON string.</p>"},{"location":"java/reference/api-reference/#isexpired","title":"isExpired()","text":"<pre><code>public boolean isExpired()\n</code></pre> <p>Checks if payment request has expired.</p>"},{"location":"java/reference/api-reference/#getters","title":"Getters","text":"<pre><code>public String getMaxAmountRequired()\npublic String getAssetType()\npublic String getAssetAddress()\npublic String getPaymentAddress()\npublic String getNetwork()\npublic String getExpiresAt()\npublic String getNonce()\npublic String getPaymentId()\npublic String getResource()\npublic String getDescription()\n</code></pre>"},{"location":"java/reference/api-reference/#paymentauthorization","title":"PaymentAuthorization","text":"<p>Payment authorization to include in requests.</p>"},{"location":"java/reference/api-reference/#fields_1","title":"Fields","text":"<pre><code>private final String signature;\nprivate final String payerPublicKey;\nprivate final String paymentAddress;\nprivate final String amount;\nprivate final String timestamp;\nprivate final String nonce;\n</code></pre>"},{"location":"java/reference/api-reference/#methods_1","title":"Methods","text":""},{"location":"java/reference/api-reference/#toheadervalue","title":"toHeaderValue()","text":"<pre><code>public String toHeaderValue()\n</code></pre> <p>Converts to base64-encoded header value for <code>X-Payment-Authorization</code>.</p>"},{"location":"java/reference/api-reference/#fromheader","title":"fromHeader()","text":"<pre><code>public static PaymentAuthorization fromHeader(String headerValue)\n</code></pre> <p>Parses from header value.</p>"},{"location":"java/reference/api-reference/#getters_1","title":"Getters","text":"<pre><code>public String getSignature()\npublic String getPayerPublicKey()\npublic String getPaymentAddress()\npublic String getAmount()\npublic String getTimestamp()\npublic String getNonce()\n</code></pre>"},{"location":"java/reference/api-reference/#package-orgopenlibx402coreblockchain","title":"Package: org.openlibx402.core.blockchain","text":""},{"location":"java/reference/api-reference/#solanapaymentprocessor","title":"SolanaPaymentProcessor","text":"<p>Handles Solana blockchain payment operations.</p>"},{"location":"java/reference/api-reference/#constructor_1","title":"Constructor","text":"<pre><code>public SolanaPaymentProcessor(String rpcUrl)\n</code></pre> <p>Parameters: - <code>rpcUrl</code> (String): Solana RPC endpoint URL</p>"},{"location":"java/reference/api-reference/#methods_2","title":"Methods","text":""},{"location":"java/reference/api-reference/#createpayment_1","title":"createPayment()","text":"<pre><code>public PaymentAuthorization createPayment(\n    PaymentRequest request,\n    Account payerAccount,\n    String amount\n) throws X402Error\n</code></pre> <p>Creates and broadcasts a payment transaction.</p> <p>Returns: PaymentAuthorization with transaction signature</p> <p>Throws: - <code>InsufficientFundsError</code> - Not enough funds - <code>TransactionBroadcastError</code> - Broadcast failed - <code>PaymentVerificationError</code> - Verification failed</p>"},{"location":"java/reference/api-reference/#getbalance","title":"getBalance()","text":"<pre><code>public String getBalance(PublicKey publicKey) throws Exception\n</code></pre> <p>Gets USDC balance for a public key.</p> <p>Returns: Balance as string (e.g., \"10.50\")</p>"},{"location":"java/reference/api-reference/#verifytransaction","title":"verifyTransaction()","text":"<pre><code>public boolean verifyTransaction(String signature) throws Exception\n</code></pre> <p>Verifies a transaction has been confirmed.</p> <p>Returns: true if confirmed, false otherwise</p>"},{"location":"java/reference/api-reference/#close_1","title":"close()","text":"<pre><code>public void close()\n</code></pre> <p>Closes RPC connection and releases resources.</p>"},{"location":"java/reference/api-reference/#package-orgopenlibx402coreerrors","title":"Package: org.openlibx402.core.errors","text":""},{"location":"java/reference/api-reference/#x402error-base-class","title":"X402Error (Base Class)","text":"<p>Base exception for all X402 errors.</p> <pre><code>public class X402Error extends Exception {\n    private final String code;\n    private final Map&lt;String, Object&gt; details;\n\n    public String getCode()\n    public Map&lt;String, Object&gt; getDetails()\n}\n</code></pre>"},{"location":"java/reference/api-reference/#paymentrequirederror","title":"PaymentRequiredError","text":"<p>Thrown when 402 Payment Required response received.</p> <pre><code>public class PaymentRequiredError extends X402Error {\n    private final PaymentRequest paymentRequest;\n\n    public PaymentRequest getPaymentRequest()\n}\n</code></pre> <p>Error Code: <code>PAYMENT_REQUIRED</code></p>"},{"location":"java/reference/api-reference/#insufficientfundserror","title":"InsufficientFundsError","text":"<p>Thrown when account has insufficient funds.</p> <pre><code>public class InsufficientFundsError extends X402Error {\n    private final String requiredAmount;\n    private final String availableAmount;\n\n    public String getRequiredAmount()\n    public String getAvailableAmount()\n}\n</code></pre> <p>Error Code: <code>INSUFFICIENT_FUNDS</code></p>"},{"location":"java/reference/api-reference/#paymentexpirederror","title":"PaymentExpiredError","text":"<p>Thrown when payment request has expired.</p> <pre><code>public class PaymentExpiredError extends X402Error {\n    private final PaymentRequest paymentRequest;\n\n    public PaymentRequest getPaymentRequest()\n}\n</code></pre> <p>Error Code: <code>PAYMENT_EXPIRED</code></p>"},{"location":"java/reference/api-reference/#paymentverificationerror","title":"PaymentVerificationError","text":"<p>Thrown when payment verification fails.</p> <pre><code>public class PaymentVerificationError extends X402Error {\n    // Standard X402Error methods\n}\n</code></pre> <p>Error Code: <code>PAYMENT_VERIFICATION_FAILED</code></p>"},{"location":"java/reference/api-reference/#transactionbroadcasterror","title":"TransactionBroadcastError","text":"<p>Thrown when transaction broadcast fails.</p> <pre><code>public class TransactionBroadcastError extends X402Error {\n    // Standard X402Error methods\n}\n</code></pre> <p>Error Code: <code>TRANSACTION_BROADCAST_FAILED</code></p>"},{"location":"java/reference/api-reference/#invalidpaymentrequesterror","title":"InvalidPaymentRequestError","text":"<p>Thrown when payment request is invalid or malformed.</p> <pre><code>public class InvalidPaymentRequestError extends X402Error {\n    // Standard X402Error methods\n}\n</code></pre> <p>Error Code: <code>INVALID_PAYMENT_REQUEST</code></p>"},{"location":"java/reference/api-reference/#error-codes","title":"Error Codes","text":"<p>All error codes are defined in <code>ErrorCodes</code> utility class:</p> <pre><code>public class ErrorCodes {\n    public static final String PAYMENT_REQUIRED = \"PAYMENT_REQUIRED\";\n    public static final String INSUFFICIENT_FUNDS = \"INSUFFICIENT_FUNDS\";\n    public static final String PAYMENT_EXPIRED = \"PAYMENT_EXPIRED\";\n    public static final String PAYMENT_VERIFICATION_FAILED = \"PAYMENT_VERIFICATION_FAILED\";\n    public static final String TRANSACTION_BROADCAST_FAILED = \"TRANSACTION_BROADCAST_FAILED\";\n    public static final String INVALID_PAYMENT_REQUEST = \"INVALID_PAYMENT_REQUEST\";\n\n    public static Map&lt;String, Object&gt; getErrorMetadata(String code)\n}\n</code></pre>"},{"location":"java/reference/api-reference/#usage-examples","title":"Usage Examples","text":""},{"location":"java/reference/api-reference/#creating-a-client","title":"Creating a Client","text":"<pre><code>Account account = new Account(secretKey);\nX402Client client = new X402Client(\n    account,\n    \"https://api.devnet.solana.com\",\n    false\n);\n</code></pre>"},{"location":"java/reference/api-reference/#making-a-request","title":"Making a Request","text":"<pre><code>try {\n    Response response = client.get(\"https://api.example.com/data\");\n} catch (PaymentRequiredError e) {\n    PaymentRequest request = e.getPaymentRequest();\n    PaymentAuthorization auth = client.createPayment(request, null);\n    Response retry = client.get(\"https://api.example.com/data\", auth);\n}\n</code></pre>"},{"location":"java/reference/api-reference/#using-auto-client","title":"Using Auto Client","text":"<pre><code>X402AutoClient client = new X402AutoClient.Builder(account)\n    .maxPaymentAmount(\"5.0\")\n    .build();\n\nResponse response = client.get(\"https://api.example.com/data\");\n</code></pre>"},{"location":"java/reference/api-reference/#checking-balance","title":"Checking Balance","text":"<pre><code>SolanaPaymentProcessor processor = client.getProcessor();\nString balance = processor.getBalance(account.getPublicKey());\nSystem.out.println(\"Balance: \" + balance + \" USDC\");\n</code></pre>"},{"location":"java/reference/api-reference/#thread-safety","title":"Thread Safety","text":"<ul> <li>X402Client: Not thread-safe. Create separate instances per thread.</li> <li>X402AutoClient: Not thread-safe. Create separate instances per thread.</li> <li>SolanaPaymentProcessor: Not thread-safe.</li> <li>PaymentRequest: Immutable, thread-safe.</li> <li>PaymentAuthorization: Immutable, thread-safe.</li> </ul>"},{"location":"java/reference/api-reference/#resource-management","title":"Resource Management","text":"<p>All client classes implement <code>AutoCloseable</code>:</p> <pre><code>try (X402Client client = new X402Client(account, null, false)) {\n    // Use client\n} // Automatically closed\n</code></pre> <p>Or manual cleanup:</p> <pre><code>X402Client client = new X402Client(account, null, false);\ntry {\n    // Use client\n} finally {\n    client.close();\n}\n</code></pre>"},{"location":"java/reference/api-reference/#related-documentation","title":"Related Documentation","text":"<ul> <li>Client Library Guide</li> <li>Core Library Guide</li> <li>Error Handling</li> <li>Examples</li> </ul>"},{"location":"java/reference/errors/","title":"Java Error Handling","text":"<p>Comprehensive guide to error handling in the OpenLibX402 Java SDK.</p>"},{"location":"java/reference/errors/#error-hierarchy","title":"Error Hierarchy","text":"<p>All X402 errors extend the base <code>X402Error</code> class:</p> <pre><code>X402Error (extends Exception)\n\u251c\u2500\u2500 PaymentRequiredError\n\u251c\u2500\u2500 InsufficientFundsError\n\u251c\u2500\u2500 PaymentExpiredError\n\u251c\u2500\u2500 PaymentVerificationError\n\u251c\u2500\u2500 TransactionBroadcastError\n\u2514\u2500\u2500 InvalidPaymentRequestError\n</code></pre>"},{"location":"java/reference/errors/#base-error-class","title":"Base Error Class","text":""},{"location":"java/reference/errors/#x402error","title":"X402Error","text":"<p>Base exception for all X402-related errors.</p> <pre><code>public class X402Error extends Exception {\n    private final String code;\n    private final Map&lt;String, Object&gt; details;\n\n    public String getCode() { return code; }\n    public Map&lt;String, Object&gt; getDetails() { return details; }\n    public String getMessage() { return message; }\n}\n</code></pre> <p>Common Fields: - <code>code</code>: Error code string (e.g., \"PAYMENT_REQUIRED\") - <code>message</code>: Human-readable error message - <code>details</code>: Additional error context</p>"},{"location":"java/reference/errors/#error-types","title":"Error Types","text":""},{"location":"java/reference/errors/#paymentrequirederror","title":"PaymentRequiredError","text":"<p>Thrown when server returns 402 Payment Required.</p> <pre><code>public class PaymentRequiredError extends X402Error {\n    private final PaymentRequest paymentRequest;\n\n    public PaymentRequest getPaymentRequest() { return paymentRequest; }\n}\n</code></pre> <p>Error Code: <code>PAYMENT_REQUIRED</code></p> <p>When Thrown: - Server responds with HTTP 402 - Payment is required to access resource</p> <p>How to Handle: <pre><code>try {\n    Response response = client.get(url);\n} catch (PaymentRequiredError e) {\n    PaymentRequest request = e.getPaymentRequest();\n    System.out.println(\"Payment required: \" + request.getMaxAmountRequired());\n\n    // Create payment and retry\n    PaymentAuthorization auth = client.createPayment(request);\n    Response retry = client.get(url, auth);\n}\n</code></pre></p>"},{"location":"java/reference/errors/#insufficientfundserror","title":"InsufficientFundsError","text":"<p>Thrown when account doesn't have enough funds for payment.</p> <pre><code>public class InsufficientFundsError extends X402Error {\n    private final String requiredAmount;\n    private final String availableAmount;\n\n    public String getRequiredAmount() { return requiredAmount; }\n    public String getAvailableAmount() { return availableAmount; }\n}\n</code></pre> <p>Error Code: <code>INSUFFICIENT_FUNDS</code></p> <p>When Thrown: - Account balance is less than required payment - Attempting to create payment without sufficient funds</p> <p>How to Handle: <pre><code>try {\n    PaymentAuthorization auth = client.createPayment(request);\n} catch (InsufficientFundsError e) {\n    System.err.println(\"Insufficient funds!\");\n    System.err.println(\"Required: \" + e.getRequiredAmount() + \" USDC\");\n    System.err.println(\"Available: \" + e.getAvailableAmount() + \" USDC\");\n    System.err.println(\"Shortfall: \" +\n        (Double.parseDouble(e.getRequiredAmount()) -\n         Double.parseDouble(e.getAvailableAmount())) + \" USDC\");\n\n    // Prompt user to add funds\n    alertUserToAddFunds(account.getPublicKey());\n}\n</code></pre></p>"},{"location":"java/reference/errors/#paymentexpirederror","title":"PaymentExpiredError","text":"<p>Thrown when payment request has expired.</p> <pre><code>public class PaymentExpiredError extends X402Error {\n    private final PaymentRequest paymentRequest;\n\n    public PaymentRequest getPaymentRequest() { return paymentRequest; }\n}\n</code></pre> <p>Error Code: <code>PAYMENT_EXPIRED</code></p> <p>When Thrown: - Payment request's <code>expiresAt</code> timestamp has passed - Attempting to create payment for expired request</p> <p>How to Handle: <pre><code>try {\n    PaymentAuthorization auth = client.createPayment(request);\n} catch (PaymentExpiredError e) {\n    System.out.println(\"Payment request expired, retrying...\");\n\n    // Make new request to get fresh payment details\n    try {\n        Response response = client.get(url);\n    } catch (PaymentRequiredError e2) {\n        // Handle new payment request\n        PaymentRequest newRequest = e2.getPaymentRequest();\n        PaymentAuthorization auth = client.createPayment(newRequest);\n        Response retry = client.get(url, auth);\n    }\n}\n</code></pre></p>"},{"location":"java/reference/errors/#paymentverificationerror","title":"PaymentVerificationError","text":"<p>Thrown when payment cannot be verified on blockchain.</p> <pre><code>public class PaymentVerificationError extends X402Error {\n    // Standard X402Error methods\n}\n</code></pre> <p>Error Code: <code>PAYMENT_VERIFICATION_FAILED</code></p> <p>When Thrown: - Transaction not found on blockchain - Transaction failed or was not confirmed - Server rejected payment proof</p> <p>How to Handle: <pre><code>try {\n    PaymentAuthorization auth = client.createPayment(request);\n    Response response = client.get(url, auth);\n} catch (PaymentVerificationError e) {\n    System.err.println(\"Payment verification failed: \" + e.getMessage());\n\n    // Check transaction status\n    SolanaPaymentProcessor processor = client.getProcessor();\n    boolean confirmed = processor.verifyTransaction(auth.getSignature());\n\n    if (!confirmed) {\n        System.err.println(\"Transaction not confirmed, wait and retry\");\n        Thread.sleep(5000);\n        // Retry verification\n    } else {\n        System.err.println(\"Transaction confirmed but server rejected it\");\n        // Contact support\n    }\n}\n</code></pre></p>"},{"location":"java/reference/errors/#transactionbroadcasterror","title":"TransactionBroadcastError","text":"<p>Thrown when transaction cannot be broadcast to blockchain.</p> <pre><code>public class TransactionBroadcastError extends X402Error {\n    // Standard X402Error methods\n}\n</code></pre> <p>Error Code: <code>TRANSACTION_BROADCAST_FAILED</code></p> <p>When Thrown: - Network error during transaction broadcast - RPC endpoint unavailable - Transaction rejected by blockchain</p> <p>How to Handle: <pre><code>try {\n    PaymentAuthorization auth = client.createPayment(request);\n} catch (TransactionBroadcastError e) {\n    System.err.println(\"Failed to broadcast transaction: \" + e.getMessage());\n\n    // Check if it's a network issue\n    Map&lt;String, Object&gt; details = e.getDetails();\n    if (details.containsKey(\"networkError\")) {\n        System.err.println(\"Network error, retrying...\");\n        Thread.sleep(2000);\n        // Retry payment creation\n    } else {\n        System.err.println(\"Transaction rejected\");\n        // Log and alert\n    }\n}\n</code></pre></p>"},{"location":"java/reference/errors/#invalidpaymentrequesterror","title":"InvalidPaymentRequestError","text":"<p>Thrown when payment request format is invalid.</p> <pre><code>public class InvalidPaymentRequestError extends X402Error {\n    // Standard X402Error methods\n}\n</code></pre> <p>Error Code: <code>INVALID_PAYMENT_REQUEST</code></p> <p>When Thrown: - 402 response has invalid JSON format - Required fields missing from payment request - Payment request has invalid values</p> <p>How to Handle: <pre><code>try {\n    PaymentRequest request = client.parsePaymentRequest(response);\n} catch (InvalidPaymentRequestError e) {\n    System.err.println(\"Invalid payment request: \" + e.getMessage());\n    System.err.println(\"Server sent malformed payment request\");\n\n    // Log for debugging\n    logger.error(\"Invalid payment request from: \" + url);\n    logger.error(\"Response body: \" + response.body().string());\n\n    // Contact API provider\n    throw new RuntimeException(\"API sent invalid payment request\", e);\n}\n</code></pre></p>"},{"location":"java/reference/errors/#comprehensive-error-handling-pattern","title":"Comprehensive Error Handling Pattern","text":""},{"location":"java/reference/errors/#pattern-1-explicit-error-handling","title":"Pattern 1: Explicit Error Handling","text":"<p>Handle each error type explicitly:</p> <pre><code>public Response makePaymentEnabledRequest(X402Client client, String url) {\n    try {\n        // Attempt request\n        return client.get(url);\n\n    } catch (PaymentRequiredError e) {\n        // Handle 402: create payment and retry\n        try {\n            PaymentRequest request = e.getPaymentRequest();\n            PaymentAuthorization auth = client.createPayment(request);\n            return client.get(url, auth);\n        } catch (X402Error nested) {\n            throw new RuntimeException(\"Payment failed\", nested);\n        }\n\n    } catch (InsufficientFundsError e) {\n        // Alert user to add funds\n        logger.error(\"Insufficient funds: need \" + e.getRequiredAmount());\n        throw new RuntimeException(\"Cannot complete payment: insufficient funds\", e);\n\n    } catch (PaymentExpiredError e) {\n        // Retry to get fresh payment request\n        logger.warn(\"Payment expired, retrying...\");\n        return makePaymentEnabledRequest(client, url);\n\n    } catch (PaymentVerificationError e) {\n        // Payment created but not accepted\n        logger.error(\"Payment verification failed: \" + e.getMessage());\n        throw new RuntimeException(\"Payment not accepted\", e);\n\n    } catch (TransactionBroadcastError e) {\n        // Network or broadcast issue\n        logger.error(\"Transaction broadcast failed: \" + e.getMessage());\n        throw new RuntimeException(\"Cannot broadcast payment\", e);\n\n    } catch (InvalidPaymentRequestError e) {\n        // Server sent invalid payment request\n        logger.error(\"Invalid payment request: \" + e.getMessage());\n        throw new RuntimeException(\"API error: invalid payment request\", e);\n\n    } catch (IOException e) {\n        // Network error\n        logger.error(\"Network error: \" + e.getMessage());\n        throw new RuntimeException(\"Network communication failed\", e);\n\n    } catch (Exception e) {\n        // Unexpected error\n        logger.error(\"Unexpected error: \" + e.getMessage(), e);\n        throw new RuntimeException(\"Unexpected error\", e);\n    }\n}\n</code></pre>"},{"location":"java/reference/errors/#pattern-2-error-recovery-with-retries","title":"Pattern 2: Error Recovery with Retries","text":"<p>Implement retry logic with exponential backoff:</p> <pre><code>public Response makeRequestWithRetry(X402Client client, String url, int maxRetries) {\n    int attempt = 0;\n    long backoffMs = 1000;\n\n    while (attempt &lt; maxRetries) {\n        try {\n            return client.get(url);\n\n        } catch (PaymentRequiredError e) {\n            // Handle payment\n            PaymentAuthorization auth = client.createPayment(e.getPaymentRequest());\n            return client.get(url, auth);\n\n        } catch (PaymentExpiredError e) {\n            // Retry immediately for expired requests\n            logger.warn(\"Payment expired, retrying...\");\n            attempt++;\n            continue;\n\n        } catch (TransactionBroadcastError e) {\n            // Retry with backoff for broadcast errors\n            if (attempt &lt; maxRetries - 1) {\n                logger.warn(\"Broadcast failed, retrying in \" + backoffMs + \"ms\");\n                Thread.sleep(backoffMs);\n                backoffMs *= 2;\n                attempt++;\n                continue;\n            }\n            throw new RuntimeException(\"Max retries exceeded\", e);\n\n        } catch (X402Error | IOException e) {\n            throw new RuntimeException(\"Request failed\", e);\n        }\n    }\n\n    throw new RuntimeException(\"Max retries exceeded\");\n}\n</code></pre>"},{"location":"java/reference/errors/#pattern-3-user-friendly-error-messages","title":"Pattern 3: User-Friendly Error Messages","text":"<p>Convert technical errors to user-friendly messages:</p> <pre><code>public String getUserFriendlyErrorMessage(Exception e) {\n    if (e instanceof InsufficientFundsError) {\n        InsufficientFundsError err = (InsufficientFundsError) e;\n        return String.format(\n            \"You don't have enough funds. Required: %s USDC, Available: %s USDC. \" +\n            \"Please add funds to continue.\",\n            err.getRequiredAmount(),\n            err.getAvailableAmount()\n        );\n\n    } else if (e instanceof PaymentRequiredError) {\n        PaymentRequiredError err = (PaymentRequiredError) e;\n        return String.format(\n            \"This resource requires a payment of %s USDC. Would you like to proceed?\",\n            err.getPaymentRequest().getMaxAmountRequired()\n        );\n\n    } else if (e instanceof PaymentExpiredError) {\n        return \"The payment request expired. Please try again.\";\n\n    } else if (e instanceof PaymentVerificationError) {\n        return \"Your payment couldn't be verified. Please contact support if this persists.\";\n\n    } else if (e instanceof TransactionBroadcastError) {\n        return \"There was a problem processing your payment. Please check your connection and try again.\";\n\n    } else if (e instanceof InvalidPaymentRequestError) {\n        return \"The server sent an invalid payment request. Please contact the API provider.\";\n\n    } else if (e instanceof IOException) {\n        return \"Network error. Please check your internet connection and try again.\";\n\n    } else {\n        return \"An unexpected error occurred. Please try again later.\";\n    }\n}\n</code></pre>"},{"location":"java/reference/errors/#pattern-4-logging-and-monitoring","title":"Pattern 4: Logging and Monitoring","text":"<p>Implement comprehensive logging:</p> <pre><code>import java.util.logging.Logger;\nimport java.util.logging.Level;\n\npublic class PaymentLogger {\n    private static final Logger logger = Logger.getLogger(PaymentLogger.class.getName());\n\n    public static void logPaymentAttempt(PaymentRequest request) {\n        logger.info(String.format(\n            \"Payment attempt - Amount: %s, Address: %s, ID: %s\",\n            request.getMaxAmountRequired(),\n            request.getPaymentAddress(),\n            request.getPaymentId()\n        ));\n    }\n\n    public static void logPaymentSuccess(PaymentAuthorization auth) {\n        logger.info(String.format(\n            \"Payment successful - Signature: %s, Amount: %s\",\n            auth.getSignature(),\n            auth.getAmount()\n        ));\n    }\n\n    public static void logPaymentError(X402Error error, PaymentRequest request) {\n        logger.log(Level.SEVERE, String.format(\n            \"Payment failed - Code: %s, Message: %s, Payment ID: %s\",\n            error.getCode(),\n            error.getMessage(),\n            request != null ? request.getPaymentId() : \"N/A\"\n        ), error);\n\n        // Send to monitoring service\n        sendToMonitoring(error);\n    }\n\n    private static void sendToMonitoring(X402Error error) {\n        // Integrate with monitoring service (Datadog, New Relic, etc.)\n    }\n}\n</code></pre>"},{"location":"java/reference/errors/#production-best-practices","title":"Production Best Practices","text":""},{"location":"java/reference/errors/#1-always-handle-insufficient-funds","title":"1. Always Handle Insufficient Funds","text":"<pre><code>try {\n    Response response = autoClient.get(url);\n} catch (InsufficientFundsError e) {\n    // Alert user immediately\n    notifyUser(\"Please add funds to your account\");\n\n    // Log for monitoring\n    logger.error(\"Insufficient funds for user: \" + userId);\n\n    // Send alert to admin dashboard\n    alertDashboard(\"User \" + userId + \" has insufficient funds\");\n}\n</code></pre>"},{"location":"java/reference/errors/#2-set-payment-limits","title":"2. Set Payment Limits","text":"<pre><code>X402AutoClient client = new X402AutoClient.Builder(account)\n    .maxPaymentAmount(\"10.0\")  // Never pay more than 10 USDC\n    .build();\n</code></pre>"},{"location":"java/reference/errors/#3-validate-before-payment","title":"3. Validate Before Payment","text":"<pre><code>PaymentRequest request = e.getPaymentRequest();\n\n// Check amount\ndouble amount = Double.parseDouble(request.getMaxAmountRequired());\nif (amount &gt; MAX_ALLOWED_PAYMENT) {\n    throw new RuntimeException(\"Payment exceeds maximum allowed: \" + amount);\n}\n\n// Check expiration\nif (request.isExpired()) {\n    throw new PaymentExpiredError(request);\n}\n\n// Check balance\nString balance = processor.getBalance(account.getPublicKey());\nif (Double.parseDouble(balance) &lt; amount) {\n    throw new InsufficientFundsError(\n        request.getMaxAmountRequired(),\n        balance,\n        \"Insufficient funds\"\n    );\n}\n\n// Proceed with payment\nPaymentAuthorization auth = client.createPayment(request);\n</code></pre>"},{"location":"java/reference/errors/#4-implement-circuit-breaker","title":"4. Implement Circuit Breaker","text":"<pre><code>public class CircuitBreaker {\n    private int failureCount = 0;\n    private static final int FAILURE_THRESHOLD = 5;\n    private static final long COOLDOWN_MS = 60000;\n    private long lastFailureTime = 0;\n\n    public boolean shouldAttemptPayment() {\n        if (failureCount &gt;= FAILURE_THRESHOLD) {\n            if (System.currentTimeMillis() - lastFailureTime &lt; COOLDOWN_MS) {\n                return false;  // Circuit open\n            } else {\n                reset();  // Try again after cooldown\n            }\n        }\n        return true;\n    }\n\n    public void recordFailure() {\n        failureCount++;\n        lastFailureTime = System.currentTimeMillis();\n    }\n\n    public void recordSuccess() {\n        reset();\n    }\n\n    private void reset() {\n        failureCount = 0;\n    }\n}\n</code></pre>"},{"location":"java/reference/errors/#5-audit-trail","title":"5. Audit Trail","text":"<pre><code>public class PaymentAuditor {\n    public static void logPaymentActivity(\n        String userId,\n        PaymentRequest request,\n        PaymentAuthorization auth,\n        boolean success,\n        Exception error\n    ) {\n        Map&lt;String, Object&gt; auditEntry = new HashMap&lt;&gt;();\n        auditEntry.put(\"timestamp\", Instant.now().toString());\n        auditEntry.put(\"userId\", userId);\n        auditEntry.put(\"paymentId\", request.getPaymentId());\n        auditEntry.put(\"amount\", request.getMaxAmountRequired());\n        auditEntry.put(\"paymentAddress\", request.getPaymentAddress());\n        auditEntry.put(\"success\", success);\n\n        if (auth != null) {\n            auditEntry.put(\"signature\", auth.getSignature());\n        }\n\n        if (error != null) {\n            auditEntry.put(\"errorCode\", ((X402Error) error).getCode());\n            auditEntry.put(\"errorMessage\", error.getMessage());\n        }\n\n        // Save to audit log\n        saveToAuditLog(auditEntry);\n    }\n\n    private static void saveToAuditLog(Map&lt;String, Object&gt; entry) {\n        // Persist to database, file, or logging service\n    }\n}\n</code></pre>"},{"location":"java/reference/errors/#testing-error-handling","title":"Testing Error Handling","text":""},{"location":"java/reference/errors/#unit-tests","title":"Unit Tests","text":"<pre><code>import org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\npublic class ErrorHandlingTest {\n\n    @Test\n    public void testInsufficientFundsError() {\n        InsufficientFundsError error = new InsufficientFundsError(\n            \"1.0\",\n            \"0.5\",\n            \"Insufficient funds\"\n        );\n\n        assertEquals(\"INSUFFICIENT_FUNDS\", error.getCode());\n        assertEquals(\"1.0\", error.getRequiredAmount());\n        assertEquals(\"0.5\", error.getAvailableAmount());\n    }\n\n    @Test\n    public void testPaymentExpired() {\n        PaymentRequest request = createExpiredPaymentRequest();\n        assertTrue(request.isExpired());\n\n        PaymentExpiredError error = new PaymentExpiredError(request);\n        assertEquals(\"PAYMENT_EXPIRED\", error.getCode());\n        assertEquals(request, error.getPaymentRequest());\n    }\n}\n</code></pre>"},{"location":"java/reference/errors/#related-documentation","title":"Related Documentation","text":"<ul> <li>API Reference</li> <li>Client Library</li> <li>Examples</li> </ul>"},{"location":"kotlin/","title":"OpenLibX402 Kotlin SDK","text":"<p>Welcome to the OpenLibX402 Kotlin SDK documentation. This SDK provides a coroutine-first implementation of the X402 payment protocol for Kotlin applications.</p>"},{"location":"kotlin/#overview","title":"Overview","text":"<p>The Kotlin SDK consists of two main packages:</p> <ul> <li><code>openlibx402-core</code>: Core payment protocol with suspend functions and sealed classes</li> <li><code>openlibx402-client</code>: HTTP client libraries with coroutine support</li> </ul>"},{"location":"kotlin/#key-features","title":"Key Features","text":"<ul> <li>\ud83c\udfaf Coroutine-First API: All I/O operations use suspend functions</li> <li>\ud83d\udd12 Sealed Class Errors: Type-safe exhaustive error handling</li> <li>\ud83c\udfd7\ufe0f DSL Builders: Idiomatic Kotlin configuration</li> <li>\ud83d\udce6 Data Classes: Immutable models with kotlinx.serialization</li> <li>\ud83d\ude80 Extension Functions: Fluent, expressive API</li> <li>\ud83d\udee1\ufe0f SSRF Protection: Built-in security features</li> <li>\ud83d\udcda KDoc Documentation: Complete API documentation</li> </ul>"},{"location":"kotlin/#quick-start","title":"Quick Start","text":""},{"location":"kotlin/#installation","title":"Installation","text":"<p>Add to your <code>build.gradle.kts</code>:</p> <pre><code>dependencies {\n    implementation(\"org.openlibx402:openlibx402-core:0.1.0\")\n    implementation(\"org.openlibx402:openlibx402-client:0.1.0\")\n}\n</code></pre>"},{"location":"kotlin/#simple-example","title":"Simple Example","text":"<pre><code>import kotlinx.coroutines.runBlocking\nimport org.openlibx402.client.X402AutoClient\nimport org.p2p.solanaj.core.Account\n\nsuspend fun main() {\n    val account = Account(secretKeyBytes)\n\n    val client = X402AutoClient(account) {\n        rpcUrl = \"https://api.devnet.solana.com\"\n        maxPaymentAmount = \"1.0\"\n        allowLocal = true\n    }\n\n    client.use {\n        val response = it.get(\"https://api.example.com/data\")\n        println(response.body?.string())\n    }\n}\n</code></pre>"},{"location":"kotlin/#architecture","title":"Architecture","text":""},{"location":"kotlin/#two-package-design","title":"Two-Package Design","text":"<p>The Kotlin SDK follows a modular coroutine-based architecture:</p> <pre><code>openlibx402-core/\n\u251c\u2500\u2500 models/           # PaymentRequest, PaymentAuthorization (data classes)\n\u251c\u2500\u2500 errors/           # X402Error (sealed class)\n\u251c\u2500\u2500 blockchain/       # SolanaPaymentProcessor (suspend functions)\n\u2514\u2500\u2500 util/             # Extension functions\n\nopenlibx402-client/\n\u251c\u2500\u2500 X402Client        # Manual control with suspend functions\n\u2514\u2500\u2500 X402AutoClient    # Automatic handling with coroutines\n</code></pre>"},{"location":"kotlin/#payment-flow","title":"Payment Flow","text":"<pre><code>Suspend Call \u2192 402 Response \u2192 Coroutine Payment Creation \u2192\nAsync Transaction Broadcast \u2192 Payment Verification \u2192 Retry with Auth \u2192\n200 Response\n</code></pre>"},{"location":"kotlin/#client-types","title":"Client Types","text":""},{"location":"kotlin/#x402client-explicit-control","title":"X402Client (Explicit Control)","text":"<p>For applications that need manual control with suspend functions:</p> <pre><code>val client = X402Client(\n    walletAccount = account,\n    rpcUrl = \"https://api.devnet.solana.com\",\n    allowLocal = true\n)\n\ntry {\n    val response = client.get(url)\n} catch (e: X402Error.PaymentRequired) {\n    val request = e.paymentRequest\n    val auth = client.createPayment(request)\n    val retryResponse = client.get(url, auth)\n}\n</code></pre>"},{"location":"kotlin/#x402autoclient-automatic-handling","title":"X402AutoClient (Automatic Handling)","text":"<p>For seamless automatic payment processing with coroutines:</p> <pre><code>val client = X402AutoClient(account) {\n    maxPaymentAmount = \"5.0\"\n    maxRetries = 2\n}\n\nval response = client.get(url)  // Automatically handles payments\n</code></pre>"},{"location":"kotlin/#coroutines","title":"Coroutines","text":"<p>All I/O operations are suspend functions running on the IO dispatcher:</p> <pre><code>import kotlinx.coroutines.*\n\nsuspend fun fetchData() {\n    val client = X402AutoClient(account)\n\n    client.use {\n        // Runs on IO dispatcher\n        val response = it.get(\"https://api.example.com/data\")\n        println(response.body?.string())\n    }\n}\n\n// Run in coroutine scope\nrunBlocking {\n    fetchData()\n}\n</code></pre>"},{"location":"kotlin/#parallel-requests","title":"Parallel Requests","text":"<pre><code>suspend fun fetchMultiple() = coroutineScope {\n    val client = X402AutoClient(account)\n\n    client.use {\n        val deferred1 = async { it.get(\"https://api.example.com/data1\") }\n        val deferred2 = async { it.get(\"https://api.example.com/data2\") }\n\n        val response1 = deferred1.await()\n        val response2 = deferred2.await()\n    }\n}\n</code></pre>"},{"location":"kotlin/#error-handling","title":"Error Handling","text":"<p>Type-safe exhaustive error handling with sealed classes:</p> <pre><code>try {\n    val response = client.get(url)\n} catch (e: X402Error) {\n    when (e) {\n        is X402Error.PaymentRequired -&gt; {\n            // Handle 402\n            val request = e.paymentRequest\n        }\n        is X402Error.InsufficientFunds -&gt; {\n            // Handle low balance\n            println(\"Need: ${e.requiredAmount}\")\n        }\n        is X402Error.PaymentExpired -&gt; {\n            // Handle expired payment\n        }\n        is X402Error.PaymentVerificationFailed -&gt; {\n            // Handle verification failure\n        }\n        is X402Error.TransactionBroadcastFailed -&gt; {\n            // Handle broadcast failure\n        }\n        is X402Error.InvalidPaymentRequest -&gt; {\n            // Handle invalid request\n        }\n        is X402Error.Generic -&gt; {\n            // Handle other errors\n            println(\"Error: ${e.code}\")\n        }\n    }\n}\n</code></pre>"},{"location":"kotlin/#kotlin-features","title":"Kotlin Features","text":""},{"location":"kotlin/#dsl-builder-pattern","title":"DSL Builder Pattern","text":"<pre><code>val client = X402AutoClient(account) {\n    rpcUrl = \"https://api.mainnet-beta.solana.com\"\n    maxPaymentAmount = \"5.0\"\n    maxRetries = 3\n    autoRetry = true\n    allowLocal = false\n}\n</code></pre>"},{"location":"kotlin/#extension-functions","title":"Extension Functions","text":"<pre><code>// Use .use for automatic resource management\nX402Client(account).use { client -&gt;\n    val response = client.get(url)\n    // client automatically closed\n}\n</code></pre>"},{"location":"kotlin/#data-classes","title":"Data Classes","text":"<pre><code>val request = PaymentRequest(\n    maxAmountRequired = \"0.10\",\n    assetType = \"SPL\",\n    assetAddress = \"...\",\n    paymentAddress = \"...\",\n    network = \"solana-devnet\",\n    expiresAt = Clock.System.now() + 5.minutes,\n    nonce = \"unique-nonce\",\n    paymentId = \"pay_123\",\n    resource = \"/api/data\"\n)\n\n// Immutable with copy()\nval updated = request.copy(maxAmountRequired = \"0.20\")\n</code></pre>"},{"location":"kotlin/#security","title":"Security","text":"<ul> <li>SSRF Protection: Blocks localhost and private IP addresses by default</li> <li>Payment Limits: Set maximum payment amounts to prevent overspending</li> <li>Coroutine Safety: Thread-safe operations with structured concurrency</li> <li>Resource Cleanup: Closeable ensures proper resource release</li> </ul>"},{"location":"kotlin/#next-steps","title":"Next Steps","text":"<ul> <li>Installation Guide</li> <li>Core Library Reference</li> <li>Client Library Reference</li> <li>Examples</li> <li>API Reference</li> </ul>"},{"location":"kotlin/examples/basic-usage/","title":"Kotlin Basic Usage Examples","text":"<p>This guide provides practical examples of using the OpenLibX402 Kotlin SDK with coroutines.</p>"},{"location":"kotlin/examples/basic-usage/#prerequisites","title":"Prerequisites","text":"<pre><code>// build.gradle.kts\ndependencies {\n    implementation(\"org.openlibx402:openlibx402-core:0.1.0\")\n    implementation(\"org.openlibx402:openlibx402-client:0.1.0\")\n\n    implementation(\"org.jetbrains.kotlinx:kotlinx-coroutines-core:1.7.3\")\n    implementation(\"org.jetbrains.kotlinx:kotlinx-serialization-json:1.6.0\")\n    implementation(\"org.jetbrains.kotlinx:kotlinx-datetime:0.4.1\")\n}\n</code></pre>"},{"location":"kotlin/examples/basic-usage/#example-1-manual-payment-handling-with-coroutines","title":"Example 1: Manual Payment Handling with Coroutines","text":"<p>This example demonstrates explicit control over the payment flow using <code>X402Client</code> with suspend functions.</p> <pre><code>import kotlinx.coroutines.runBlocking\nimport org.openlibx402.client.X402Client\nimport org.openlibx402.core.errors.X402Error\nimport org.openlibx402.core.models.PaymentAuthorization\nimport org.p2p.solanaj.core.Account\n\nsuspend fun manualPaymentExample() {\n    // Load Solana account (securely in production!)\n    val secretKey = loadSecretKey()\n    val account = Account(secretKey)\n\n    // Create client\n    val client = X402Client(\n        walletAccount = account,\n        rpcUrl = \"https://api.devnet.solana.com\",\n        allowLocal = true  // Development only\n    )\n\n    client.use {\n        val url = \"https://api.example.com/premium-data\"\n\n        try {\n            // Make initial request (suspend function)\n            val response = it.get(url)\n            println(\"Success: ${response.body?.string()}\")\n\n        } catch (e: X402Error.PaymentRequired) {\n            println(\"Payment required!\")\n\n            // Get payment request details\n            val request = e.paymentRequest\n            println(\"Amount: ${request.maxAmountRequired}\")\n            println(\"Asset: ${request.assetType}\")\n            println(\"Description: ${request.description}\")\n\n            // Create payment (suspend function)\n            val auth = it.createPayment(request)\n            println(\"Payment created: ${auth.signature}\")\n\n            // Retry request with payment authorization\n            val retryResponse = it.get(url, auth)\n            println(\"Success: ${retryResponse.body?.string()}\")\n        }\n    }\n}\n\nfun main() = runBlocking {\n    try {\n        manualPaymentExample()\n    } catch (e: X402Error) {\n        when (e) {\n            is X402Error.InsufficientFunds -&gt; {\n                println(\"Insufficient funds!\")\n                println(\"Required: ${e.requiredAmount}\")\n                println(\"Available: ${e.availableAmount}\")\n            }\n            else -&gt; {\n                println(\"Error: ${e.message}\")\n            }\n        }\n    } catch (e: Exception) {\n        e.printStackTrace()\n    }\n}\n\nprivate fun loadSecretKey(): ByteArray {\n    // In production, load from secure storage\n    val keyEnv = System.getenv(\"SOLANA_SECRET_KEY\")\n    if (keyEnv != null) {\n        return java.util.Base64.getDecoder().decode(keyEnv)\n    }\n\n    // For demo: generate random account\n    println(\"Warning: Using random account for demo\")\n    return Account().secretKey\n}\n</code></pre>"},{"location":"kotlin/examples/basic-usage/#example-2-automatic-payment-with-dsl-builder","title":"Example 2: Automatic Payment with DSL Builder","text":"<p>This example shows automatic payment handling using <code>X402AutoClient</code> with Kotlin DSL.</p> <pre><code>import kotlinx.coroutines.runBlocking\nimport org.openlibx402.client.X402AutoClient\nimport org.openlibx402.core.errors.X402Error\nimport org.p2p.solanaj.core.Account\n\nsuspend fun autoPaymentExample() {\n    val secretKey = loadSecretKey()\n    val account = Account(secretKey)\n\n    // Build auto-client with DSL\n    val client = X402AutoClient(account) {\n        rpcUrl = \"https://api.devnet.solana.com\"\n        maxPaymentAmount = \"1.0\"      // Max 1 USDC per request\n        maxRetries = 2                // Retry up to 2 times\n        allowLocal = true             // Development only\n    }\n\n    client.use {\n        // Client automatically handles 402 and retries\n        val url = \"https://api.example.com/premium-data\"\n        val response = it.get(url)\n\n        println(\"Success: ${response.body?.string()}\")\n    }\n}\n\nfun main() = runBlocking {\n    try {\n        autoPaymentExample()\n    } catch (e: X402Error.InsufficientFunds) {\n        println(\"Insufficient funds for payment\")\n    } catch (e: X402Error.PaymentRequired) {\n        println(\"Payment required but max retries exceeded\")\n    } catch (e: X402Error) {\n        println(\"Error: ${e.message}\")\n    } catch (e: Exception) {\n        e.printStackTrace()\n    }\n}\n\nprivate fun loadSecretKey(): ByteArray {\n    val keyEnv = System.getenv(\"SOLANA_SECRET_KEY\")\n    return keyEnv?.let { java.util.Base64.getDecoder().decode(it) }\n        ?: Account().secretKey\n}\n</code></pre>"},{"location":"kotlin/examples/basic-usage/#example-3-post-requests-with-json","title":"Example 3: POST Requests with JSON","text":"<p>Making POST requests with JSON body using suspend functions.</p> <pre><code>import kotlinx.coroutines.runBlocking\nimport kotlinx.serialization.Serializable\nimport kotlinx.serialization.encodeToString\nimport kotlinx.serialization.json.Json\nimport org.openlibx402.client.X402Client\nimport org.p2p.solanaj.core.Account\n\n@Serializable\ndata class QueryRequest(\n    val query: String,\n    val options: Map&lt;String, String&gt; = emptyMap()\n)\n\nsuspend fun postRequestExample() {\n    val account = Account(loadSecretKey())\n    val client = X402Client(account, allowLocal = true)\n\n    client.use {\n        val url = \"https://api.example.com/process\"\n\n        // Create request with kotlinx.serialization\n        val requestData = QueryRequest(\n            query = \"Analyze this data\",\n            options = mapOf(\"format\" to \"json\")\n        )\n        val jsonBody = Json.encodeToString(requestData)\n\n        try {\n            // Make POST request (suspend function)\n            val response = it.post(url, jsonBody)\n            println(\"Result: ${response.body?.string()}\")\n\n        } catch (e: X402Error.PaymentRequired) {\n            // Handle payment\n            val auth = it.createPayment(e.paymentRequest)\n\n            // Retry with payment\n            val retryResponse = it.post(url, jsonBody, auth)\n            println(\"Result: ${retryResponse.body?.string()}\")\n        }\n    }\n}\n\nfun main() = runBlocking {\n    try {\n        postRequestExample()\n    } catch (e: Exception) {\n        e.printStackTrace()\n    }\n}\n\nprivate fun loadSecretKey() = Account().secretKey\n</code></pre>"},{"location":"kotlin/examples/basic-usage/#example-4-type-safe-error-handling-with-when-expressions","title":"Example 4: Type-Safe Error Handling with When Expressions","text":"<p>Comprehensive error handling using sealed classes with exhaustive when expressions.</p> <pre><code>import kotlinx.coroutines.runBlocking\nimport org.openlibx402.client.X402Client\nimport org.openlibx402.core.errors.X402Error\nimport org.p2p.solanaj.core.Account\nimport okhttp3.Response\nimport mu.KotlinLogging\n\nprivate val logger = KotlinLogging.logger {}\n\nsuspend fun errorHandlingExample() {\n    val account = Account(loadSecretKey())\n    val client = X402Client(account, allowLocal = false)\n\n    client.use {\n        val response = makePaymentEnabledRequest(it, \"https://api.example.com/data\")\n        logger.info { \"Success: ${response.body?.string()}\" }\n    }\n}\n\nprivate suspend fun makePaymentEnabledRequest(\n    client: X402Client,\n    url: String\n): Response {\n    try {\n        return client.get(url)\n\n    } catch (e: X402Error) {\n        // Exhaustive when expression with sealed class\n        when (e) {\n            is X402Error.PaymentRequired -&gt; {\n                logger.info { \"Payment required, creating payment...\" }\n                return handlePayment(client, url, e.paymentRequest)\n            }\n            is X402Error.InsufficientFunds -&gt; {\n                logger.error { \"Insufficient funds!\" }\n                logger.error { \"Required: ${e.requiredAmount}\" }\n                logger.error { \"Available: ${e.availableAmount}\" }\n                throw RuntimeException(\"Cannot complete payment\", e)\n            }\n            is X402Error.PaymentExpired -&gt; {\n                logger.warn { \"Payment request expired, retrying...\" }\n                // Retry to get new payment request\n                return makePaymentEnabledRequest(client, url)\n            }\n            is X402Error.PaymentVerificationFailed -&gt; {\n                logger.error { \"Payment verification failed: ${e.reason}\" }\n                throw RuntimeException(\"Payment not accepted\", e)\n            }\n            is X402Error.TransactionBroadcastFailed -&gt; {\n                logger.error { \"Transaction broadcast failed: ${e.reason}\" }\n                throw RuntimeException(\"Cannot broadcast payment\", e)\n            }\n            is X402Error.InvalidPaymentRequest -&gt; {\n                logger.error { \"Invalid payment request: ${e.reason}\" }\n                throw RuntimeException(\"Server sent invalid payment request\", e)\n            }\n            is X402Error.Generic -&gt; {\n                logger.error { \"Generic error: ${e.code} - ${e.message}\" }\n                throw RuntimeException(\"X402 error\", e)\n            }\n        }\n    }\n}\n\nprivate suspend fun handlePayment(\n    client: X402Client,\n    url: String,\n    request: org.openlibx402.core.models.PaymentRequest\n): Response {\n    // Check if expired\n    if (request.isExpired()) {\n        logger.warn { \"Payment request already expired\" }\n        throw X402Error.PaymentExpired(request)\n    }\n\n    // Validate amount\n    val amount = request.maxAmountRequired.toDouble()\n    if (amount &gt; 10.0) {\n        logger.warn { \"Payment exceeds maximum allowed amount\" }\n        throw RuntimeException(\"Payment too high: $amount\")\n    }\n\n    // Create payment\n    val auth = client.createPayment(request)\n    logger.info { \"Payment created: ${auth.signature}\" }\n\n    // Retry request\n    return client.get(url, auth)\n}\n\nfun main() = runBlocking {\n    try {\n        errorHandlingExample()\n    } catch (e: Exception) {\n        logger.error(e) { \"Fatal error\" }\n    }\n}\n\nprivate fun loadSecretKey() = Account().secretKey\n</code></pre>"},{"location":"kotlin/examples/basic-usage/#example-5-custom-http-configuration","title":"Example 5: Custom HTTP Configuration","text":"<p>Using a custom OkHttp client with specific configuration.</p> <pre><code>import kotlinx.coroutines.runBlocking\nimport okhttp3.OkHttpClient\nimport org.openlibx402.client.X402AutoClient\nimport org.p2p.solanaj.core.Account\nimport java.util.concurrent.TimeUnit\n\nsuspend fun customHttpExample() {\n    val account = Account(loadSecretKey())\n\n    // Custom HTTP client with longer timeouts\n    val httpClient = OkHttpClient.Builder()\n        .connectTimeout(60, TimeUnit.SECONDS)\n        .readTimeout(120, TimeUnit.SECONDS)\n        .writeTimeout(60, TimeUnit.SECONDS)\n        .retryOnConnectionFailure(true)\n        .build()\n\n    // Use custom client with DSL\n    val client = X402AutoClient(account) {\n        rpcUrl = \"https://api.mainnet-beta.solana.com\"\n        maxPaymentAmount = \"5.0\"\n        this.httpClient = httpClient\n    }\n\n    client.use {\n        val response = it.get(\"https://api.example.com/slow-endpoint\")\n        println(\"Success: ${response.body?.string()}\")\n    }\n}\n\nfun main() = runBlocking {\n    try {\n        customHttpExample()\n    } catch (e: Exception) {\n        e.printStackTrace()\n    }\n}\n\nprivate fun loadSecretKey() = Account().secretKey\n</code></pre>"},{"location":"kotlin/examples/basic-usage/#example-6-checking-balance-before-payment","title":"Example 6: Checking Balance Before Payment","text":"<p>Verify sufficient funds before attempting payment using suspend functions.</p> <pre><code>import kotlinx.coroutines.runBlocking\nimport org.openlibx402.client.X402Client\nimport org.openlibx402.core.blockchain.SolanaPaymentProcessor\nimport org.openlibx402.core.errors.X402Error\nimport org.p2p.solanaj.core.Account\n\nsuspend fun balanceCheckExample() {\n    val account = Account(loadSecretKey())\n    val client = X402Client(account, allowLocal = true)\n\n    client.use {\n        // Access processor (internal visibility)\n        val processor = it::class.java\n            .getDeclaredField(\"processor\")\n            .also { field -&gt; field.isAccessible = true }\n            .get(it) as SolanaPaymentProcessor\n\n        // Check balance first (blocking operation)\n        val balance = processor.getBalance(account.publicKey)\n        println(\"Current balance: $balance USDC\")\n\n        val url = \"https://api.example.com/premium-data\"\n\n        try {\n            // Make request (suspend function)\n            val response = it.get(url)\n            println(\"Success: ${response.body?.string()}\")\n\n        } catch (e: X402Error.PaymentRequired) {\n            val request = e.paymentRequest\n            val required = request.maxAmountRequired.toDouble()\n            val available = balance.toDouble()\n\n            if (available &lt; required) {\n                println(\"Insufficient funds!\")\n                println(\"Required: $required\")\n                println(\"Available: $available\")\n                println(\"Please add ${required - available} USDC\")\n                return\n            }\n\n            // Create payment (suspend function)\n            val auth = it.createPayment(request)\n\n            // Retry\n            val retryResponse = it.get(url, auth)\n            println(\"Success: ${retryResponse.body?.string()}\")\n\n            // Check new balance\n            val newBalance = processor.getBalance(account.publicKey)\n            println(\"New balance: $newBalance USDC\")\n        }\n    }\n}\n\nfun main() = runBlocking {\n    try {\n        balanceCheckExample()\n    } catch (e: Exception) {\n        e.printStackTrace()\n    }\n}\n\nprivate fun loadSecretKey() = Account().secretKey\n</code></pre>"},{"location":"kotlin/examples/basic-usage/#example-7-concurrent-requests-with-coroutines","title":"Example 7: Concurrent Requests with Coroutines","text":"<p>Using coroutines for parallel payment-enabled requests.</p> <pre><code>import kotlinx.coroutines.*\nimport org.openlibx402.client.X402AutoClient\nimport org.p2p.solanaj.core.Account\n\nsuspend fun concurrentRequestsExample() {\n    val account = Account(loadSecretKey())\n\n    val client = X402AutoClient(account) {\n        rpcUrl = \"https://api.devnet.solana.com\"\n        maxPaymentAmount = \"5.0\"\n        maxRetries = 2\n    }\n\n    client.use {\n        // Launch multiple requests concurrently\n        coroutineScope {\n            val urls = listOf(\n                \"https://api.example.com/data1\",\n                \"https://api.example.com/data2\",\n                \"https://api.example.com/data3\"\n            )\n\n            val responses = urls.map { url -&gt;\n                async(Dispatchers.IO) {\n                    try {\n                        val response = it.get(url)\n                        url to response.body?.string()\n                    } catch (e: Exception) {\n                        url to \"Error: ${e.message}\"\n                    }\n                }\n            }.awaitAll()\n\n            responses.forEach { (url, data) -&gt;\n                println(\"$url: $data\")\n            }\n        }\n    }\n}\n\nfun main() = runBlocking {\n    concurrentRequestsExample()\n}\n\nprivate fun loadSecretKey() = Account().secretKey\n</code></pre>"},{"location":"kotlin/examples/basic-usage/#example-8-structured-concurrency-with-error-handling","title":"Example 8: Structured Concurrency with Error Handling","text":"<p>Demonstrating structured concurrency patterns with proper error handling.</p> <pre><code>import kotlinx.coroutines.*\nimport org.openlibx402.client.X402Client\nimport org.openlibx402.core.errors.X402Error\nimport org.p2p.solanaj.core.Account\n\nsuspend fun structuredConcurrencyExample() = coroutineScope {\n    val account = Account(loadSecretKey())\n    val client = X402Client(account, allowLocal = true)\n\n    client.use {\n        try {\n            // All child coroutines are cancelled if any fails\n            val response = it.get(\"https://api.example.com/data\")\n\n            // Process in parallel with structured concurrency\n            val job1 = launch(Dispatchers.IO) {\n                processData(response.body?.string() ?: \"\")\n            }\n\n            val job2 = launch(Dispatchers.IO) {\n                saveToDatabase(response.body?.string() ?: \"\")\n            }\n\n            // Wait for both to complete\n            job1.join()\n            job2.join()\n\n            println(\"All processing complete\")\n\n        } catch (e: X402Error) {\n            // All child coroutines are automatically cancelled\n            println(\"Error: ${e.message}\")\n            // Cancel parent scope if needed\n            throw e\n        }\n    }\n}\n\nprivate suspend fun processData(data: String) = withContext(Dispatchers.Default) {\n    println(\"Processing data: ${data.take(50)}\")\n    delay(1000)\n    println(\"Processing complete\")\n}\n\nprivate suspend fun saveToDatabase(data: String) = withContext(Dispatchers.IO) {\n    println(\"Saving to database\")\n    delay(1500)\n    println(\"Save complete\")\n}\n\nfun main() = runBlocking {\n    try {\n        structuredConcurrencyExample()\n    } catch (e: Exception) {\n        println(\"Fatal error: ${e.message}\")\n    }\n}\n\nprivate fun loadSecretKey() = Account().secretKey\n</code></pre>"},{"location":"kotlin/examples/basic-usage/#example-9-using-flow-for-streaming-responses","title":"Example 9: Using Flow for Streaming Responses","text":"<p>Demonstrating Flow-based streaming with payment-enabled requests.</p> <pre><code>import kotlinx.coroutines.*\nimport kotlinx.coroutines.flow.*\nimport org.openlibx402.client.X402AutoClient\nimport org.openlibx402.core.errors.X402Error\nimport org.p2p.solanaj.core.Account\n\nsuspend fun streamingRequestsExample() {\n    val account = Account(loadSecretKey())\n\n    val client = X402AutoClient(account) {\n        rpcUrl = \"https://api.devnet.solana.com\"\n        maxPaymentAmount = \"10.0\"\n    }\n\n    client.use {\n        // Create a flow of URLs to process\n        val urls = flowOf(\n            \"https://api.example.com/stream/1\",\n            \"https://api.example.com/stream/2\",\n            \"https://api.example.com/stream/3\",\n            \"https://api.example.com/stream/4\"\n        )\n\n        // Process each URL with payment handling\n        urls\n            .map { url -&gt;\n                try {\n                    val response = it.get(url)\n                    Result.success(url to response.body?.string())\n                } catch (e: X402Error) {\n                    Result.failure&lt;Pair&lt;String, String?&gt;&gt;(e)\n                }\n            }\n            .collect { result -&gt;\n                result.onSuccess { (url, data) -&gt;\n                    println(\"$url: $data\")\n                }.onFailure { e -&gt;\n                    println(\"Failed: ${e.message}\")\n                }\n            }\n    }\n}\n\nfun main() = runBlocking {\n    streamingRequestsExample()\n}\n\nprivate fun loadSecretKey() = Account().secretKey\n</code></pre>"},{"location":"kotlin/examples/basic-usage/#example-10-data-class-features-and-extension-functions","title":"Example 10: Data Class Features and Extension Functions","text":"<p>Leveraging Kotlin data classes and extension functions.</p> <pre><code>import kotlinx.datetime.Clock\nimport kotlinx.datetime.Instant\nimport org.openlibx402.core.models.PaymentRequest\nimport kotlin.time.Duration.Companion.minutes\n\n// Extension function for PaymentRequest\nfun PaymentRequest.isAffordable(balance: Double): Boolean =\n    balance &gt;= maxAmountRequired.toDouble()\n\n// Extension function to check if expiring soon\nfun PaymentRequest.isExpiringSoon(threshold: kotlin.time.Duration = 5.minutes): Boolean {\n    val now = Clock.System.now()\n    val timeUntilExpiry = expiresAt - now\n    return timeUntilExpiry &lt; threshold\n}\n\nfun dataClassExample() {\n    // Create payment request with data class\n    val request = PaymentRequest(\n        maxAmountRequired = \"0.10\",\n        assetType = \"SPL\",\n        assetAddress = \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\",\n        paymentAddress = \"7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU\",\n        network = \"solana-devnet\",\n        expiresAt = Clock.System.now() + 10.minutes,\n        nonce = \"unique-nonce\",\n        paymentId = \"pay_123\",\n        resource = \"/api/data\",\n        description = \"Premium data access\"\n    )\n\n    // Data class destructuring\n    val (amount, assetType, address) = request\n    println(\"Amount: $amount, Asset: $assetType, Address: $address\")\n\n    // Immutable copy with changes\n    val updated = request.copy(maxAmountRequired = \"0.20\")\n    println(\"Updated amount: ${updated.maxAmountRequired}\")\n\n    // Extension functions\n    val balance = 1.0\n    println(\"Is affordable: ${request.isAffordable(balance)}\")\n    println(\"Expiring soon: ${request.isExpiringSoon()}\")\n\n    // Serialize to JSON\n    val json = request.toJson()\n    println(\"JSON: $json\")\n\n    // Deserialize from JSON\n    val parsed = PaymentRequest.fromJson(json)\n    println(\"Parsed equals original: ${parsed == request}\")\n}\n\nfun main() {\n    dataClassExample()\n}\n</code></pre>"},{"location":"kotlin/examples/basic-usage/#complete-example-application","title":"Complete Example Application","text":"<p>For a complete working example, see the simple-client example in the repository.</p> <pre><code># Clone repository\ngit clone https://github.com/openlibx402/openlibx402.git\ncd openlibx402/examples/kotlin/simple-client\n\n# Run example\n./gradlew run\n</code></pre>"},{"location":"kotlin/examples/basic-usage/#best-practices","title":"Best Practices","text":"<ol> <li>Use Suspend Functions: All HTTP operations are suspend functions - use them in coroutines</li> <li>Structured Concurrency: Use <code>coroutineScope</code> for proper cancellation propagation</li> <li>Resource Management: Use <code>use {}</code> for automatic cleanup</li> <li>Type-Safe Errors: Use exhaustive when expressions with sealed classes</li> <li>DSL Builders: Prefer X402AutoClient DSL for clean configuration</li> <li>Data Classes: Leverage immutability, copy(), and destructuring</li> <li>Extension Functions: Create domain-specific extensions for cleaner code</li> <li>Flow for Streams: Use Flow for processing multiple requests</li> <li>Proper Dispatchers: Use <code>Dispatchers.IO</code> for network operations</li> <li>Cancellation Support: Ensure coroutines are cancellation-aware</li> </ol>"},{"location":"kotlin/examples/basic-usage/#related-documentation","title":"Related Documentation","text":"<ul> <li>Installation Guide</li> <li>Client Quickstart</li> <li>Client Library Reference</li> <li>Error Handling</li> </ul>"},{"location":"kotlin/getting-started/client-quickstart/","title":"Kotlin Client Quickstart","text":"<p>Get started with the OpenLibX402 Kotlin client using coroutines in 5 minutes.</p>"},{"location":"kotlin/getting-started/client-quickstart/#prerequisites","title":"Prerequisites","text":"<ul> <li>Kotlin 1.9.0 or higher installed</li> <li>Gradle or Maven configured</li> <li>OpenLibX402 packages added to your project</li> </ul> <p>See Installation Guide if you haven't set these up yet.</p>"},{"location":"kotlin/getting-started/client-quickstart/#step-1-create-a-solana-account","title":"Step 1: Create a Solana Account","text":"<pre><code>import org.p2p.solanaj.core.Account\nimport java.util.Base64\n\n// For development: generate a new account\nval account = Account()\nprintln(\"Public Key: ${account.publicKey}\")\nprintln(\"Secret Key (save this!): ${\n    Base64.getEncoder().encodeToString(account.secretKey)\n}\")\n</code></pre> <p>For production, load from secure storage:</p> <pre><code>// Load from environment variable\nval keyString = System.getenv(\"SOLANA_SECRET_KEY\")\nval secretKey = Base64.getDecoder().decode(keyString)\nval account = Account(secretKey)\n</code></pre>"},{"location":"kotlin/getting-started/client-quickstart/#step-2-choose-your-client-type","title":"Step 2: Choose Your Client Type","text":""},{"location":"kotlin/getting-started/client-quickstart/#option-a-automatic-client-recommended-for-beginners","title":"Option A: Automatic Client (Recommended for Beginners)","text":"<p>Best for quick integration with automatic payment handling using Kotlin DSL.</p> <pre><code>import kotlinx.coroutines.runBlocking\nimport org.openlibx402.client.X402AutoClient\n\nsuspend fun main() {\n    // Create client with DSL builder\n    val client = X402AutoClient(account) {\n        rpcUrl = \"https://api.devnet.solana.com\"\n        maxPaymentAmount = \"1.0\"      // Max 1 USDC per request\n        maxRetries = 2                // Retry up to 2 times\n        allowLocal = true             // Development only\n    }\n\n    client.use {\n        // Automatically handles 402 and retries with payment\n        val response = it.get(\"https://api.example.com/premium-data\")\n        println(response.body?.string())\n    }\n}\n\n// For gradle run compatibility\nfun main() = runBlocking {\n    main()\n}\n</code></pre>"},{"location":"kotlin/getting-started/client-quickstart/#option-b-manual-client","title":"Option B: Manual Client","text":"<p>Best when you need explicit control over payments with suspend functions.</p> <pre><code>import kotlinx.coroutines.runBlocking\nimport org.openlibx402.client.X402Client\nimport org.openlibx402.core.errors.X402Error\n\nsuspend fun main() {\n    // Create client with manual payment control\n    val client = X402Client(\n        walletAccount = account,\n        rpcUrl = \"https://api.devnet.solana.com\",\n        allowLocal = true  // Development only\n    )\n\n    client.use {\n        try {\n            // Make initial request (suspend function)\n            val response = it.get(\"https://api.example.com/premium-data\")\n            println(response.body?.string())\n\n        } catch (e: X402Error.PaymentRequired) {\n            // Handle 402: create payment manually (suspend function)\n            val auth = it.createPayment(e.paymentRequest)\n\n            // Retry with payment\n            val retryResponse = it.get(\"https://api.example.com/premium-data\", auth)\n            println(retryResponse.body?.string())\n        }\n    }\n}\n\nfun main() = runBlocking {\n    main()\n}\n</code></pre>"},{"location":"kotlin/getting-started/client-quickstart/#step-3-make-payment-enabled-requests","title":"Step 3: Make Payment-Enabled Requests","text":"<p>All HTTP methods are suspend functions that must be called from a coroutine:</p>"},{"location":"kotlin/getting-started/client-quickstart/#get-request","title":"GET Request","text":"<pre><code>suspend fun getExample() {\n    client.use {\n        val response = it.get(\"https://api.example.com/data\")\n        println(response.body?.string())\n    }\n}\n</code></pre>"},{"location":"kotlin/getting-started/client-quickstart/#post-request-with-json","title":"POST Request with JSON","text":"<pre><code>import kotlinx.serialization.Serializable\nimport kotlinx.serialization.encodeToString\nimport kotlinx.serialization.json.Json\n\n@Serializable\ndata class QueryRequest(val query: String)\n\nsuspend fun postExample() {\n    client.use {\n        val requestData = QueryRequest(\"process this\")\n        val jsonBody = Json.encodeToString(requestData)\n\n        val response = it.post(\"https://api.example.com/process\", jsonBody)\n        println(response.body?.string())\n    }\n}\n</code></pre>"},{"location":"kotlin/getting-started/client-quickstart/#put-request","title":"PUT Request","text":"<pre><code>suspend fun putExample() {\n    client.use {\n        val jsonBody = \"\"\"{\"id\": 123, \"data\": \"updated\"}\"\"\"\n        val response = it.put(\"https://api.example.com/update\", jsonBody)\n    }\n}\n</code></pre>"},{"location":"kotlin/getting-started/client-quickstart/#delete-request","title":"DELETE Request","text":"<pre><code>suspend fun deleteExample() {\n    client.use {\n        val response = it.delete(\"https://api.example.com/resource/123\")\n    }\n}\n</code></pre>"},{"location":"kotlin/getting-started/client-quickstart/#step-4-handle-errors-with-sealed-classes","title":"Step 4: Handle Errors with Sealed Classes","text":"<p>Kotlin's sealed classes enable type-safe, exhaustive error handling:</p> <pre><code>import org.openlibx402.core.errors.X402Error\n\nsuspend fun handleErrors() {\n    client.use {\n        try {\n            val response = it.get(url)\n            println(response.body?.string())\n\n        } catch (e: X402Error) {\n            // Exhaustive when expression\n            when (e) {\n                is X402Error.InsufficientFunds -&gt; {\n                    println(\"Not enough funds!\")\n                    println(\"Required: ${e.requiredAmount}\")\n                    println(\"Available: ${e.availableAmount}\")\n                }\n                is X402Error.PaymentExpired -&gt; {\n                    println(\"Payment request expired, retry...\")\n                }\n                is X402Error.PaymentVerificationFailed -&gt; {\n                    println(\"Payment not accepted: ${e.reason}\")\n                }\n                is X402Error.PaymentRequired -&gt; {\n                    println(\"Payment required: ${e.paymentRequest.maxAmountRequired}\")\n                }\n                is X402Error.TransactionBroadcastFailed -&gt; {\n                    println(\"Broadcast failed: ${e.reason}\")\n                }\n                is X402Error.InvalidPaymentRequest -&gt; {\n                    println(\"Invalid request: ${e.reason}\")\n                }\n                is X402Error.Generic -&gt; {\n                    println(\"Error ${e.code}: ${e.message}\")\n                }\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"kotlin/getting-started/client-quickstart/#complete-example","title":"Complete Example","text":"<p>Here's a complete working example with coroutines:</p> <pre><code>package com.example\n\nimport kotlinx.coroutines.runBlocking\nimport org.openlibx402.client.X402AutoClient\nimport org.openlibx402.core.errors.X402Error\nimport org.p2p.solanaj.core.Account\nimport java.util.Base64\n\nsuspend fun main() {\n    // Load or create account\n    val account = getAccount()\n\n    // Create auto client with DSL\n    val client = X402AutoClient(account) {\n        rpcUrl = \"https://api.devnet.solana.com\"\n        maxPaymentAmount = \"1.0\"\n        maxRetries = 2\n        allowLocal = true  // Development only\n    }\n\n    client.use {\n        try {\n            // Make payment-enabled request (suspend function)\n            val url = \"https://api.example.com/premium-data\"\n            val response = it.get(url)\n\n            // Process response\n            val data = response.body?.string()\n            println(\"Success! Data: $data\")\n\n        } catch (e: X402Error) {\n            when (e) {\n                is X402Error.InsufficientFunds -&gt; {\n                    println(\"Insufficient funds!\")\n                    println(\"Please add funds to: ${account.publicKey}\")\n                }\n                is X402Error.PaymentRequired -&gt; {\n                    println(\"Payment required but max retries exceeded\")\n                }\n                else -&gt; {\n                    println(\"Error: ${e.message}\")\n                }\n            }\n        } catch (e: Exception) {\n            e.printStackTrace()\n        }\n    }\n}\n\nprivate fun getAccount(): Account {\n    // Try loading from environment\n    val keyEnv = System.getenv(\"SOLANA_SECRET_KEY\")\n    if (keyEnv != null) {\n        val secretKey = Base64.getDecoder().decode(keyEnv)\n        return Account(secretKey)\n    }\n\n    // Development: generate new account\n    println(\"Warning: Using random account for demo\")\n    return Account()\n}\n\n// For gradle run compatibility\nfun main() = runBlocking {\n    main()\n}\n</code></pre>"},{"location":"kotlin/getting-started/client-quickstart/#running-the-example","title":"Running the Example","text":""},{"location":"kotlin/getting-started/client-quickstart/#gradle","title":"Gradle","text":"<p>Create <code>build.gradle.kts</code>:</p> <pre><code>plugins {\n    kotlin(\"jvm\") version \"1.9.20\"\n    kotlin(\"plugin.serialization\") version \"1.9.20\"\n    application\n}\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    implementation(\"org.openlibx402:openlibx402-core:0.1.0\")\n    implementation(\"org.openlibx402:openlibx402-client:0.1.0\")\n\n    implementation(\"org.jetbrains.kotlinx:kotlinx-coroutines-core:1.7.3\")\n    implementation(\"org.jetbrains.kotlinx:kotlinx-serialization-json:1.6.0\")\n    implementation(\"org.jetbrains.kotlinx:kotlinx-datetime:0.4.1\")\n}\n\napplication {\n    mainClass.set(\"com.example.AppKt\")\n}\n\nkotlin {\n    jvmToolchain(11)\n}\n</code></pre> <p>Run: <pre><code>gradle run\n</code></pre></p>"},{"location":"kotlin/getting-started/client-quickstart/#with-environment-variable","title":"With Environment Variable","text":"<pre><code>export SOLANA_SECRET_KEY=\"your-base64-encoded-key\"\ngradle run\n</code></pre>"},{"location":"kotlin/getting-started/client-quickstart/#as-standalone-script","title":"As Standalone Script","text":"<p>Create <code>QuickStart.main.kts</code>:</p> <pre><code>#!/usr/bin/env kotlin\n\n@file:Repository(\"https://repo.maven.apache.org/maven2/\")\n@file:DependsOn(\"org.openlibx402:openlibx402-client:0.1.0\")\n@file:DependsOn(\"org.jetbrains.kotlinx:kotlinx-coroutines-core:1.7.3\")\n\nimport kotlinx.coroutines.runBlocking\nimport org.openlibx402.client.X402AutoClient\nimport org.p2p.solanaj.core.Account\n\nrunBlocking {\n    val account = Account()\n    val client = X402AutoClient(account) {\n        rpcUrl = \"https://api.devnet.solana.com\"\n        allowLocal = true\n    }\n\n    client.use {\n        try {\n            val response = it.get(\"https://api.example.com/data\")\n            println(\"Success: ${response.code}\")\n        } catch (e: Exception) {\n            println(\"Error: ${e.message}\")\n        }\n    }\n}\n</code></pre> <p>Run: <pre><code>chmod +x QuickStart.main.kts\n./QuickStart.main.kts\n</code></pre></p>"},{"location":"kotlin/getting-started/client-quickstart/#coroutine-best-practices","title":"Coroutine Best Practices","text":""},{"location":"kotlin/getting-started/client-quickstart/#use-proper-coroutine-scopes","title":"Use Proper Coroutine Scopes","text":"<pre><code>import kotlinx.coroutines.*\n\nclass PaymentService {\n    private val scope = CoroutineScope(Dispatchers.IO + SupervisorJob())\n\n    fun makeRequest(url: String) {\n        scope.launch {\n            client.use {\n                val response = it.get(url)\n                // Process response\n            }\n        }\n    }\n\n    fun shutdown() {\n        scope.cancel()\n    }\n}\n</code></pre>"},{"location":"kotlin/getting-started/client-quickstart/#structured-concurrency","title":"Structured Concurrency","text":"<pre><code>suspend fun parallelRequests() = coroutineScope {\n    val client = X402AutoClient(account) {\n        maxPaymentAmount = \"5.0\"\n    }\n\n    client.use {\n        val urls = listOf(\"url1\", \"url2\", \"url3\")\n\n        val responses = urls.map { url -&gt;\n            async { it.get(url) }\n        }.awaitAll()\n\n        responses.forEach { response -&gt;\n            println(\"Response: ${response.code}\")\n        }\n    }\n}\n</code></pre>"},{"location":"kotlin/getting-started/client-quickstart/#timeout-support","title":"Timeout Support","text":"<pre><code>import kotlinx.coroutines.*\n\nsuspend fun requestWithTimeout() {\n    client.use {\n        try {\n            withTimeout(5000) {\n                val response = it.get(\"https://api.example.com/data\")\n                println(response.body?.string())\n            }\n        } catch (e: TimeoutCancellationException) {\n            println(\"Request timed out\")\n        }\n    }\n}\n</code></pre>"},{"location":"kotlin/getting-started/client-quickstart/#next-steps","title":"Next Steps","text":""},{"location":"kotlin/getting-started/client-quickstart/#1-learn-more-patterns","title":"1. Learn More Patterns","text":"<p>Explore Basic Usage Examples for: - Advanced error handling with when expressions - Concurrent requests with coroutines - Custom HTTP configuration - Flow-based streaming - Data class features</p>"},{"location":"kotlin/getting-started/client-quickstart/#2-understand-the-api","title":"2. Understand the API","text":"<p>Read the Client Library Reference for: - Complete API documentation - All available methods with suspend functions - DSL builder options - Coroutine best practices</p>"},{"location":"kotlin/getting-started/client-quickstart/#3-set-up-for-production","title":"3. Set Up for Production","text":"<p>See Error Handling Guide for: - Comprehensive sealed class error handling - Production deployment with coroutines - Security considerations - Monitoring and logging</p>"},{"location":"kotlin/getting-started/client-quickstart/#common-issues","title":"Common Issues","text":""},{"location":"kotlin/getting-started/client-quickstart/#suspend-function-get-should-be-called-only-from-a-coroutine","title":"\"Suspend function 'get' should be called only from a coroutine\"","text":"<p>Cause: Calling suspend functions outside a coroutine.</p> <p>Solution: Wrap in <code>runBlocking</code> or use proper coroutine scope: <pre><code>// Main function\nfun main() = runBlocking {\n    client.get(url)  // Now works\n}\n\n// Or use CoroutineScope\nval scope = CoroutineScope(Dispatchers.IO)\nscope.launch {\n    client.get(url)\n}\n</code></pre></p>"},{"location":"kotlin/getting-started/client-quickstart/#paymentrequired-payment-required","title":"\"PaymentRequired: Payment Required\"","text":"<p>Cause: API requires payment, but automatic payment failed.</p> <p>Solutions: 1. Check balance first 2. Increase <code>maxRetries</code> in DSL builder 3. Increase <code>maxPaymentAmount</code> if payment exceeds limit</p> <pre><code>val client = X402AutoClient(account) {\n    maxRetries = 3\n    maxPaymentAmount = \"5.0\"\n}\n</code></pre>"},{"location":"kotlin/getting-started/client-quickstart/#insufficientfunds","title":"\"InsufficientFunds\"","text":"<p>Cause: Not enough USDC in your account.</p> <p>Solution: Add funds to your Solana account: <pre><code>// Get your public key\nprintln(account.publicKey)\n\n// Fund on devnet (development)\n// Use Solana faucet or transfer USDC to this address\n</code></pre></p>"},{"location":"kotlin/getting-started/client-quickstart/#requests-to-localhost-are-blocked","title":"\"Requests to localhost are blocked\"","text":"<p>Cause: SSRF protection blocking local URLs.</p> <p>Solution: For development only, use <code>allowLocal = true</code>: <pre><code>val client = X402Client(\n    walletAccount = account,\n    allowLocal = true  // Only for development!\n)\n</code></pre></p>"},{"location":"kotlin/getting-started/client-quickstart/#unresolved-reference-runblocking","title":"\"Unresolved reference: runBlocking\"","text":"<p>Cause: Missing coroutines dependency.</p> <p>Solution: Add to <code>build.gradle.kts</code>: <pre><code>dependencies {\n    implementation(\"org.jetbrains.kotlinx:kotlinx-coroutines-core:1.7.3\")\n}\n</code></pre></p>"},{"location":"kotlin/getting-started/client-quickstart/#plugin-id-kotlinx-serialization-was-not-found","title":"\"Plugin [id: 'kotlinx-serialization'] was not found\"","text":"<p>Cause: Missing serialization plugin.</p> <p>Solution: Add to <code>build.gradle.kts</code>: <pre><code>plugins {\n    kotlin(\"plugin.serialization\") version \"1.9.20\"\n}\n</code></pre></p>"},{"location":"kotlin/getting-started/client-quickstart/#tips-for-success","title":"Tips for Success","text":"<ol> <li>Start with AutoClient: Use <code>X402AutoClient</code> with DSL for quick integration</li> <li>Use suspend functions: All HTTP operations are suspend functions</li> <li>Resource management: Use <code>use {}</code> for automatic cleanup</li> <li>Development mode: Use <code>allowLocal = true</code> and devnet for testing</li> <li>Production mode: Use mainnet RPC and <code>allowLocal = false</code></li> <li>Type-safe errors: Use when expressions with sealed classes</li> <li>Set limits: Configure <code>maxPaymentAmount</code> to prevent overspending</li> <li>Secure keys: Never hardcode secret keys, use environment variables</li> <li>Coroutine scopes: Use structured concurrency patterns</li> <li>Cancellation: Support coroutine cancellation in your code</li> </ol>"},{"location":"kotlin/getting-started/client-quickstart/#advanced-features","title":"Advanced Features","text":""},{"location":"kotlin/getting-started/client-quickstart/#extension-functions","title":"Extension Functions","text":"<pre><code>import org.openlibx402.core.models.PaymentRequest\n\nfun PaymentRequest.isAffordable(balance: Double): Boolean =\n    balance &gt;= maxAmountRequired.toDouble()\n\n// Usage\nif (paymentRequest.isAffordable(userBalance)) {\n    val auth = client.createPayment(paymentRequest)\n}\n</code></pre>"},{"location":"kotlin/getting-started/client-quickstart/#data-class-destructuring","title":"Data Class Destructuring","text":"<pre><code>val (amount, assetType, address) = paymentRequest\nprintln(\"Amount: $amount, Asset: $assetType\")\n</code></pre>"},{"location":"kotlin/getting-started/client-quickstart/#immutable-copies","title":"Immutable Copies","text":"<pre><code>val updated = paymentRequest.copy(maxAmountRequired = \"0.20\")\n</code></pre>"},{"location":"kotlin/getting-started/client-quickstart/#flow-based-processing","title":"Flow-Based Processing","text":"<pre><code>import kotlinx.coroutines.flow.*\n\nsuspend fun streamRequests() {\n    flowOf(\"url1\", \"url2\", \"url3\")\n        .map { url -&gt; client.get(url) }\n        .collect { response -&gt;\n            println(response.code)\n        }\n}\n</code></pre>"},{"location":"kotlin/getting-started/client-quickstart/#resources","title":"Resources","text":"<ul> <li>Full Example Application</li> <li>Client Library Documentation</li> <li>API Reference</li> <li>Error Handling</li> <li>Kotlin Coroutines Guide</li> <li>kotlinx.serialization</li> </ul>"},{"location":"kotlin/getting-started/client-quickstart/#support","title":"Support","text":"<p>Need help?</p> <ul> <li>Check GitHub Issues</li> <li>Read Full Documentation</li> <li>See More Examples</li> <li>Join Kotlin Slack</li> </ul>"},{"location":"kotlin/getting-started/installation/","title":"Kotlin Installation Guide","text":"<p>This guide walks you through installing and setting up the OpenLibX402 Kotlin SDK with coroutines support.</p>"},{"location":"kotlin/getting-started/installation/#prerequisites","title":"Prerequisites","text":""},{"location":"kotlin/getting-started/installation/#kotlin-and-jdk","title":"Kotlin and JDK","text":"<p>OpenLibX402 Kotlin SDK requires: - Kotlin 1.9.0 or higher - JDK 11 or higher</p>"},{"location":"kotlin/getting-started/installation/#macos","title":"macOS","text":"<pre><code># Using Homebrew\nbrew install openjdk@11\nbrew install kotlin\n\n# Or use SDKMAN!\ncurl -s \"https://get.sdkman.io\" | bash\nsdk install java 11.0.20-tem\nsdk install kotlin\n</code></pre>"},{"location":"kotlin/getting-started/installation/#ubuntudebian","title":"Ubuntu/Debian","text":"<pre><code>sudo apt-get update\nsudo apt-get install openjdk-11-jdk\n\n# Install Kotlin\ncurl -s \"https://get.sdkman.io\" | bash\nsdk install kotlin\n</code></pre>"},{"location":"kotlin/getting-started/installation/#windows","title":"Windows","text":"<p>Download and install: - JDK from Oracle or Adoptium - Kotlin from kotlinlang.org</p>"},{"location":"kotlin/getting-started/installation/#verify-installation","title":"Verify Installation","text":"<pre><code>java -version\n# Should show: openjdk version \"11.0.x\" or higher\n\nkotlin -version\n# Should show: Kotlin version 1.9.x or higher\n</code></pre>"},{"location":"kotlin/getting-started/installation/#build-tool","title":"Build Tool","text":"<p>Choose either Gradle or Maven. Gradle is recommended for Kotlin projects.</p>"},{"location":"kotlin/getting-started/installation/#gradle-recommended-for-kotlin","title":"Gradle (Recommended for Kotlin)","text":"<p>macOS: <pre><code>brew install gradle\n</code></pre></p> <p>Ubuntu/Debian: <pre><code>sdk install gradle 8.4\n</code></pre></p> <p>Windows: Download from Gradle's website and add to PATH.</p> <p>Verify: <pre><code>gradle -version\n# Should show: Gradle 7.x or higher\n</code></pre></p>"},{"location":"kotlin/getting-started/installation/#maven","title":"Maven","text":"<p>macOS: <pre><code>brew install maven\n</code></pre></p> <p>Ubuntu/Debian: <pre><code>sudo apt-get install maven\n</code></pre></p> <p>Verify: <pre><code>mvn -version\n# Should show: Apache Maven 3.6.x or higher\n</code></pre></p>"},{"location":"kotlin/getting-started/installation/#installation-methods","title":"Installation Methods","text":""},{"location":"kotlin/getting-started/installation/#option-1-gradle-kotlin-dsl-recommended","title":"Option 1: Gradle Kotlin DSL (Recommended)","text":"<p>Add to your <code>build.gradle.kts</code>:</p> <pre><code>plugins {\n    kotlin(\"jvm\") version \"1.9.20\"\n    kotlin(\"plugin.serialization\") version \"1.9.20\"\n}\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    // OpenLibX402 packages\n    implementation(\"org.openlibx402:openlibx402-core:0.1.0\")\n    implementation(\"org.openlibx402:openlibx402-client:0.1.0\")\n\n    // Kotlin coroutines\n    implementation(\"org.jetbrains.kotlinx:kotlinx-coroutines-core:1.7.3\")\n\n    // Kotlinx serialization\n    implementation(\"org.jetbrains.kotlinx:kotlinx-serialization-json:1.6.0\")\n\n    // Kotlinx datetime\n    implementation(\"org.jetbrains.kotlinx:kotlinx-datetime:0.4.1\")\n\n    // Optional: Logging\n    implementation(\"io.github.microutils:kotlin-logging-jvm:3.0.5\")\n    implementation(\"ch.qos.logback:logback-classic:1.4.11\")\n}\n\nkotlin {\n    jvmToolchain(11)\n}\n</code></pre> <p>Install dependencies:</p> <pre><code>gradle build\n</code></pre>"},{"location":"kotlin/getting-started/installation/#option-2-gradle-groovy-dsl","title":"Option 2: Gradle Groovy DSL","text":"<p>Add to your <code>build.gradle</code>:</p> <pre><code>plugins {\n    id 'org.jetbrains.kotlin.jvm' version '1.9.20'\n    id 'org.jetbrains.kotlin.plugin.serialization' version '1.9.20'\n}\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    implementation 'org.openlibx402:openlibx402-core:0.1.0'\n    implementation 'org.openlibx402:openlibx402-client:0.1.0'\n\n    implementation 'org.jetbrains.kotlinx:kotlinx-coroutines-core:1.7.3'\n    implementation 'org.jetbrains.kotlinx:kotlinx-serialization-json:1.6.0'\n    implementation 'org.jetbrains.kotlinx:kotlinx-datetime:0.4.1'\n}\n</code></pre>"},{"location":"kotlin/getting-started/installation/#option-3-maven","title":"Option 3: Maven","text":"<p>Add to your <code>pom.xml</code>:</p> <pre><code>&lt;project&gt;\n    &lt;properties&gt;\n        &lt;kotlin.version&gt;1.9.20&lt;/kotlin.version&gt;\n        &lt;kotlinx.coroutines.version&gt;1.7.3&lt;/kotlinx.coroutines.version&gt;\n        &lt;kotlinx.serialization.version&gt;1.6.0&lt;/kotlinx.serialization.version&gt;\n    &lt;/properties&gt;\n\n    &lt;dependencies&gt;\n        &lt;!-- OpenLibX402 --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.openlibx402&lt;/groupId&gt;\n            &lt;artifactId&gt;openlibx402-core&lt;/artifactId&gt;\n            &lt;version&gt;0.1.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.openlibx402&lt;/groupId&gt;\n            &lt;artifactId&gt;openlibx402-client&lt;/artifactId&gt;\n            &lt;version&gt;0.1.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- Kotlin stdlib --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.jetbrains.kotlin&lt;/groupId&gt;\n            &lt;artifactId&gt;kotlin-stdlib&lt;/artifactId&gt;\n            &lt;version&gt;${kotlin.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- Coroutines --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.jetbrains.kotlinx&lt;/groupId&gt;\n            &lt;artifactId&gt;kotlinx-coroutines-core&lt;/artifactId&gt;\n            &lt;version&gt;${kotlinx.coroutines.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- Serialization --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.jetbrains.kotlinx&lt;/groupId&gt;\n            &lt;artifactId&gt;kotlinx-serialization-json&lt;/artifactId&gt;\n            &lt;version&gt;${kotlinx.serialization.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- DateTime --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.jetbrains.kotlinx&lt;/groupId&gt;\n            &lt;artifactId&gt;kotlinx-datetime&lt;/artifactId&gt;\n            &lt;version&gt;0.4.1&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.jetbrains.kotlin&lt;/groupId&gt;\n                &lt;artifactId&gt;kotlin-maven-plugin&lt;/artifactId&gt;\n                &lt;version&gt;${kotlin.version}&lt;/version&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;id&gt;compile&lt;/id&gt;\n                        &lt;phase&gt;compile&lt;/phase&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;compile&lt;/goal&gt;\n                        &lt;/goals&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n                &lt;configuration&gt;\n                    &lt;compilerPlugins&gt;\n                        &lt;plugin&gt;kotlinx-serialization&lt;/plugin&gt;\n                    &lt;/compilerPlugins&gt;\n                &lt;/configuration&gt;\n                &lt;dependencies&gt;\n                    &lt;dependency&gt;\n                        &lt;groupId&gt;org.jetbrains.kotlin&lt;/groupId&gt;\n                        &lt;artifactId&gt;kotlin-maven-serialization&lt;/artifactId&gt;\n                        &lt;version&gt;${kotlin.version}&lt;/version&gt;\n                    &lt;/dependency&gt;\n                &lt;/dependencies&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n&lt;/project&gt;\n</code></pre> <p>Install dependencies:</p> <pre><code>mvn clean install\n</code></pre>"},{"location":"kotlin/getting-started/installation/#option-4-local-installation-development","title":"Option 4: Local Installation (Development)","text":"<p>For local development or testing unreleased versions:</p> <pre><code># Clone repository\ngit clone https://github.com/openlibx402/openlibx402.git\ncd openlibx402\n\n# Install core package\ncd packages/kotlin/openlibx402-core\ngradle publishToMavenLocal\n\n# Install client package\ncd ../openlibx402-client\ngradle publishToMavenLocal\n</code></pre> <p>Then use in your project with the same Gradle/Maven configuration as above.</p>"},{"location":"kotlin/getting-started/installation/#quick-start","title":"Quick Start","text":""},{"location":"kotlin/getting-started/installation/#create-a-new-kotlin-project-with-gradle","title":"Create a New Kotlin Project with Gradle","text":"<pre><code>mkdir my-x402-app\ncd my-x402-app\n\n# Initialize Gradle project\ngradle init --type kotlin-application --dsl kotlin\n\n# Or with specific settings\ngradle init \\\n    --type kotlin-application \\\n    --dsl kotlin \\\n    --test-framework kotlintest \\\n    --package com.example \\\n    --project-name my-x402-app\n</code></pre> <p>Edit <code>build.gradle.kts</code> to add OpenLibX402 dependencies:</p> <pre><code>plugins {\n    kotlin(\"jvm\") version \"1.9.20\"\n    kotlin(\"plugin.serialization\") version \"1.9.20\"\n    application\n}\n\ngroup = \"com.example\"\nversion = \"1.0.0\"\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    // OpenLibX402\n    implementation(\"org.openlibx402:openlibx402-core:0.1.0\")\n    implementation(\"org.openlibx402:openlibx402-client:0.1.0\")\n\n    // Kotlin coroutines\n    implementation(\"org.jetbrains.kotlinx:kotlinx-coroutines-core:1.7.3\")\n\n    // Kotlinx serialization\n    implementation(\"org.jetbrains.kotlinx:kotlinx-serialization-json:1.6.0\")\n\n    // Kotlinx datetime\n    implementation(\"org.jetbrains.kotlinx:kotlinx-datetime:0.4.1\")\n\n    // Testing\n    testImplementation(kotlin(\"test\"))\n}\n\nkotlin {\n    jvmToolchain(11)\n}\n\napplication {\n    mainClass.set(\"com.example.AppKt\")\n}\n\ntasks.test {\n    useJUnitPlatform()\n}\n</code></pre>"},{"location":"kotlin/getting-started/installation/#create-your-first-application","title":"Create Your First Application","text":"<p>Create <code>src/main/kotlin/com/example/App.kt</code>:</p> <pre><code>package com.example\n\nimport kotlinx.coroutines.runBlocking\nimport org.openlibx402.client.X402AutoClient\nimport org.openlibx402.core.errors.X402Error\nimport org.p2p.solanaj.core.Account\n\nsuspend fun main() {\n    // Create Solana account\n    val account = Account()\n    println(\"Public Key: ${account.publicKey}\")\n\n    // Create client with DSL\n    val client = X402AutoClient(account) {\n        rpcUrl = \"https://api.devnet.solana.com\"\n        maxPaymentAmount = \"1.0\"\n        allowLocal = true  // Development only\n    }\n\n    client.use {\n        try {\n            // Make payment-enabled request\n            val response = it.get(\"https://api.example.com/data\")\n            println(\"Success: ${response.body?.string()}\")\n        } catch (e: X402Error) {\n            when (e) {\n                is X402Error.InsufficientFunds -&gt; {\n                    println(\"Insufficient funds!\")\n                    println(\"Required: ${e.requiredAmount}\")\n                    println(\"Available: ${e.availableAmount}\")\n                }\n                else -&gt; {\n                    println(\"Error: ${e.message}\")\n                }\n            }\n        }\n    }\n}\n\n// For gradle run compatibility\nfun main() = runBlocking {\n    main()\n}\n</code></pre>"},{"location":"kotlin/getting-started/installation/#build-and-run","title":"Build and Run","text":"<pre><code># Build\ngradle build\n\n# Run\ngradle run\n\n# Or with arguments\ngradle run --args=\"argument1 argument2\"\n</code></pre>"},{"location":"kotlin/getting-started/installation/#run-as-jar","title":"Run as JAR","text":"<pre><code># Build JAR\ngradle jar\n\n# Run JAR\njava -jar build/libs/my-x402-app-1.0.0.jar\n</code></pre>"},{"location":"kotlin/getting-started/installation/#verify-installation_1","title":"Verify Installation","text":"<p>Create a test file to verify everything is working:</p> <pre><code>import org.openlibx402.core.models.PaymentRequest\nimport org.openlibx402.client.X402Client\nimport kotlinx.datetime.Clock\nimport kotlin.time.Duration.Companion.minutes\n\nfun main() {\n    println(\"OpenLibX402 Kotlin SDK installed successfully!\")\n    println(\"Core version: 0.1.0\")\n    println(\"Client version: 0.1.0\")\n\n    // Test imports\n    println(\"PaymentRequest: ${PaymentRequest::class.simpleName}\")\n    println(\"X402Client: ${X402Client::class.simpleName}\")\n\n    // Test kotlinx libraries\n    println(\"Current time: ${Clock.System.now()}\")\n    println(\"Duration: ${5.minutes}\")\n\n    println(\"\\nAll imports working!\")\n}\n</code></pre> <p>Run: <pre><code>gradle run\n</code></pre></p> <p>Expected output: <pre><code>OpenLibX402 Kotlin SDK installed successfully!\nCore version: 0.1.0\nClient version: 0.1.0\nPaymentRequest: PaymentRequest\nX402Client: X402Client\nCurrent time: 2025-11-05T10:30:00Z\nDuration: 5m\nAll imports working!\n</code></pre></p>"},{"location":"kotlin/getting-started/installation/#package-structure","title":"Package Structure","text":"<p>OpenLibX402 Kotlin SDK is split into two packages:</p>"},{"location":"kotlin/getting-started/installation/#core-package-openlibx402-core","title":"Core Package (<code>openlibx402-core</code>)","text":"<p>Provides core functionality: - Payment models (<code>PaymentRequest</code>, <code>PaymentAuthorization</code>) as data classes - Sealed class error hierarchy (<code>X402Error</code>) - Blockchain integration (<code>SolanaPaymentProcessor</code>) - kotlinx.serialization support - kotlinx.datetime integration</p> <p>When to use: - Building custom payment logic - Integrating with existing HTTP clients - Creating middleware or frameworks</p>"},{"location":"kotlin/getting-started/installation/#client-package-openlibx402-client","title":"Client Package (<code>openlibx402-client</code>)","text":"<p>Provides HTTP client implementations with coroutines: - <code>X402Client</code> - Manual payment control with suspend functions - <code>X402AutoClient</code> - Automatic payment handling with DSL builder</p> <p>When to use: - Making HTTP requests with payments - Quick integration with automatic payments - Coroutine-based applications</p>"},{"location":"kotlin/getting-started/installation/#typical-setup","title":"Typical Setup","text":"<p>Most applications need both packages plus Kotlin dependencies:</p> <pre><code>dependencies {\n    // Both core and client\n    implementation(\"org.openlibx402:openlibx402-core:0.1.0\")\n    implementation(\"org.openlibx402:openlibx402-client:0.1.0\")\n\n    // Kotlin coroutines (required)\n    implementation(\"org.jetbrains.kotlinx:kotlinx-coroutines-core:1.7.3\")\n\n    // Kotlinx serialization (required)\n    implementation(\"org.jetbrains.kotlinx:kotlinx-serialization-json:1.6.0\")\n\n    // Kotlinx datetime (required)\n    implementation(\"org.jetbrains.kotlinx:kotlinx-datetime:0.4.1\")\n}\n</code></pre>"},{"location":"kotlin/getting-started/installation/#ide-setup","title":"IDE Setup","text":""},{"location":"kotlin/getting-started/installation/#intellij-idea-recommended-for-kotlin","title":"IntelliJ IDEA (Recommended for Kotlin)","text":"<ol> <li>Open Project:</li> <li>File \u2192 Open \u2192 Select your <code>build.gradle.kts</code> or project directory</li> <li> <p>IntelliJ will automatically detect Gradle and import dependencies</p> </li> <li> <p>Refresh Dependencies:</p> </li> <li>Click the \"Load Gradle Changes\" icon in the toolbar</li> <li> <p>Or: View \u2192 Tool Windows \u2192 Gradle \u2192 Click refresh icon</p> </li> <li> <p>Enable Kotlin Plugin:</p> </li> <li>IntelliJ comes with Kotlin plugin pre-installed</li> <li> <p>File \u2192 Settings \u2192 Plugins \u2192 Verify \"Kotlin\" is enabled</p> </li> <li> <p>Verify:</p> </li> <li>Check that dependencies appear in External Libraries</li> <li>Try auto-complete for <code>import org.openlibx402.*</code></li> <li>Coroutine support should be available</li> </ol>"},{"location":"kotlin/getting-started/installation/#android-studio","title":"Android Studio","text":"<ol> <li> <p>Same as IntelliJ IDEA - Android Studio is built on IntelliJ</p> </li> <li> <p>Additional Setup for Android: <pre><code>android {\n    kotlinOptions {\n        jvmTarget = \"11\"\n    }\n}\n</code></pre></p> </li> </ol>"},{"location":"kotlin/getting-started/installation/#vs-code","title":"VS Code","text":"<ol> <li>Install Extensions:</li> <li>Kotlin Language</li> <li>Gradle for Java</li> <li> <p>Extension Pack for Java</p> </li> <li> <p>Open Project:</p> </li> <li>File \u2192 Open Folder \u2192 Select project directory</li> <li> <p>VS Code will detect <code>build.gradle.kts</code> automatically</p> </li> <li> <p>Refresh:</p> </li> <li>Command Palette (Cmd/Ctrl+Shift+P) \u2192 \"Gradle: Refresh Dependencies\"</li> </ol>"},{"location":"kotlin/getting-started/installation/#eclipse","title":"Eclipse","text":"<ol> <li>Install Kotlin Plugin:</li> <li>Help \u2192 Eclipse Marketplace \u2192 Search \"Kotlin\"</li> <li> <p>Install \"Kotlin Plugin for Eclipse\"</p> </li> <li> <p>Import Gradle Project:</p> </li> <li>File \u2192 Import \u2192 Gradle \u2192 Existing Gradle Project</li> <li> <p>Select project directory</p> </li> <li> <p>Update Dependencies:</p> </li> <li>Right-click project \u2192 Gradle \u2192 Refresh Gradle Project</li> </ol>"},{"location":"kotlin/getting-started/installation/#troubleshooting","title":"Troubleshooting","text":""},{"location":"kotlin/getting-started/installation/#unresolved-reference-openlibx402","title":"\"Unresolved reference: openlibx402\"","text":"<p>Solution: Refresh dependencies: <pre><code>gradle build --refresh-dependencies\n# or\nmvn clean install -U\n</code></pre></p>"},{"location":"kotlin/getting-started/installation/#kotlin-compiler-version-mismatch","title":"\"Kotlin compiler version mismatch\"","text":"<p>Cause: Mismatched Kotlin versions.</p> <p>Solution: Ensure all Kotlin dependencies use the same version: <pre><code>val kotlinVersion = \"1.9.20\"\n\nplugins {\n    kotlin(\"jvm\") version kotlinVersion\n    kotlin(\"plugin.serialization\") version kotlinVersion\n}\n</code></pre></p>"},{"location":"kotlin/getting-started/installation/#unsupported-class-file-major-version","title":"\"Unsupported class file major version\"","text":"<p>Cause: Using Java 8 or older.</p> <p>Solution: Upgrade to Java 11 or higher: <pre><code>java -version  # Check current version\nsdk install java 11.0.20-tem  # Install Java 11\n</code></pre></p>"},{"location":"kotlin/getting-started/installation/#coroutines-not-working","title":"Coroutines Not Working","text":"<p>Cause: Missing coroutines dependency.</p> <p>Solution: Add kotlinx-coroutines: <pre><code>dependencies {\n    implementation(\"org.jetbrains.kotlinx:kotlinx-coroutines-core:1.7.3\")\n}\n</code></pre></p>"},{"location":"kotlin/getting-started/installation/#serialization-plugin-error","title":"Serialization Plugin Error","text":"<p>Cause: Missing serialization plugin.</p> <p>Solution: Add plugin to <code>build.gradle.kts</code>: <pre><code>plugins {\n    kotlin(\"plugin.serialization\") version \"1.9.20\"\n}\n</code></pre></p>"},{"location":"kotlin/getting-started/installation/#gradle-daemon-issues","title":"Gradle Daemon Issues","text":"<p>Symptoms: Slow builds or stuck processes.</p> <p>Solution: Restart Gradle daemon: <pre><code>gradle --stop\ngradle build\n</code></pre></p>"},{"location":"kotlin/getting-started/installation/#environment-setup","title":"Environment Setup","text":""},{"location":"kotlin/getting-started/installation/#solana-account","title":"Solana Account","text":"<p>For development, you can use a test account:</p> <pre><code># Set environment variable\nexport SOLANA_SECRET_KEY=\"your-base64-encoded-key\"\n</code></pre> <p>In Kotlin: <pre><code>val keyString = System.getenv(\"SOLANA_SECRET_KEY\")\nval secretKey = java.util.Base64.getDecoder().decode(keyString)\nval account = Account(secretKey)\n</code></pre></p>"},{"location":"kotlin/getting-started/installation/#network-configuration","title":"Network Configuration","text":"<p>Devnet (Testing): <pre><code>val client = X402Client(\n    walletAccount = account,\n    rpcUrl = \"https://api.devnet.solana.com\"\n)\n</code></pre></p> <p>Mainnet (Production): <pre><code>val client = X402Client(\n    walletAccount = account,\n    rpcUrl = \"https://api.mainnet-beta.solana.com\"\n)\n</code></pre></p>"},{"location":"kotlin/getting-started/installation/#coroutine-dispatcher-configuration","title":"Coroutine Dispatcher Configuration","text":"<pre><code>import kotlinx.coroutines.Dispatchers\nimport kotlinx.coroutines.asCoroutineDispatcher\nimport java.util.concurrent.Executors\n\n// Custom dispatcher for payment operations\nval paymentDispatcher = Executors.newFixedThreadPool(4)\n    .asCoroutineDispatcher()\n\n// Use in client operations\nwithContext(paymentDispatcher) {\n    client.get(url)\n}\n</code></pre>"},{"location":"kotlin/getting-started/installation/#next-steps","title":"Next Steps","text":"<p>Now that you have OpenLibX402 Kotlin SDK installed:</p> <ol> <li>Client Quickstart - Build your first payment-enabled client with coroutines</li> <li>Basic Usage Examples - Learn common patterns with suspend functions</li> <li>API Reference - Explore the full API</li> <li>Error Handling - Master sealed class error handling</li> </ol>"},{"location":"kotlin/getting-started/installation/#version-updates","title":"Version Updates","text":"<p>Check for updates: <pre><code># Gradle\ngradle dependencyUpdates\n\n# Or check Maven Central\nhttps://search.maven.org/artifact/org.openlibx402/openlibx402-core\n</code></pre></p> <p>Update to latest version in your <code>build.gradle.kts</code>: <pre><code>dependencies {\n    implementation(\"org.openlibx402:openlibx402-core:LATEST_VERSION\")\n    implementation(\"org.openlibx402:openlibx402-client:LATEST_VERSION\")\n}\n</code></pre></p>"},{"location":"kotlin/getting-started/installation/#support","title":"Support","text":"<ul> <li>Documentation: https://docs.openlibx402.org</li> <li>GitHub Issues: https://github.com/openlibx402/openlibx402/issues</li> <li>Examples: https://github.com/openlibx402/openlibx402/tree/main/examples/kotlin</li> <li>Kotlin Docs: https://kotlinlang.org/docs/home.html</li> <li>Coroutines Guide: https://kotlinlang.org/docs/coroutines-guide.html</li> </ul>"},{"location":"kotlin/libraries/client/","title":"Kotlin Client Library","text":"<p>The <code>openlibx402-client</code> package provides coroutine-based HTTP client implementations for making X402 payment-enabled requests in Kotlin applications.</p>"},{"location":"kotlin/libraries/client/#overview","title":"Overview","text":"<p>The client library offers two main classes:</p> <ul> <li>X402Client: Manual payment control with suspend functions for maximum flexibility</li> <li>X402AutoClient: Automatic payment handling with DSL builder pattern for convenience</li> </ul> <p>Both clients use Kotlin coroutines for non-blocking I/O operations on <code>Dispatchers.IO</code>.</p>"},{"location":"kotlin/libraries/client/#installation","title":"Installation","text":"<p>Add to your <code>build.gradle.kts</code>:</p> <pre><code>dependencies {\n    implementation(\"org.openlibx402:openlibx402-core:0.1.0\")\n    implementation(\"org.openlibx402:openlibx402-client:0.1.0\")\n\n    // Required dependencies\n    implementation(\"org.jetbrains.kotlinx:kotlinx-coroutines-core:1.7.3\")\n    implementation(\"org.jetbrains.kotlinx:kotlinx-serialization-json:1.6.0\")\n    implementation(\"org.jetbrains.kotlinx:kotlinx-datetime:0.4.1\")\n}\n</code></pre> <p>Or with Gradle (Groovy):</p> <pre><code>dependencies {\n    implementation 'org.openlibx402:openlibx402-core:0.1.0'\n    implementation 'org.openlibx402:openlibx402-client:0.1.0'\n\n    implementation 'org.jetbrains.kotlinx:kotlinx-coroutines-core:1.7.3'\n    implementation 'org.jetbrains.kotlinx:kotlinx-serialization-json:1.6.0'\n    implementation 'org.jetbrains.kotlinx:kotlinx-datetime:0.4.1'\n}\n</code></pre>"},{"location":"kotlin/libraries/client/#x402client","title":"X402Client","text":"<p>Manual payment control client using Kotlin coroutines with suspend functions.</p>"},{"location":"kotlin/libraries/client/#features","title":"Features","text":"<ul> <li>Suspend functions for non-blocking I/O operations</li> <li>Manual payment request handling</li> <li>Full control over payment decisions</li> <li>Support for GET, POST, PUT, DELETE methods</li> <li>SSRF protection (blocks localhost and private IPs)</li> <li>Resource management with <code>Closeable</code> interface</li> <li>Internal visibility for processor</li> </ul>"},{"location":"kotlin/libraries/client/#basic-usage","title":"Basic Usage","text":"<pre><code>import kotlinx.coroutines.runBlocking\nimport org.openlibx402.client.X402Client\nimport org.openlibx402.core.errors.X402Error\nimport org.openlibx402.core.models.PaymentAuthorization\nimport org.p2p.solanaj.core.Account\n\nsuspend fun main() {\n    // Initialize client\n    val account = Account(secretKey)\n    val client = X402Client(\n        walletAccount = account,\n        rpcUrl = \"https://api.devnet.solana.com\",\n        allowLocal = true  // Development only\n    )\n\n    client.use {\n        try {\n            // Make request (suspend function)\n            val response = it.get(\"https://api.example.com/premium-data\")\n            println(response.body?.string())\n\n        } catch (e: X402Error.PaymentRequired) {\n            // Handle 402 Payment Required\n            val request = e.paymentRequest\n\n            // Create payment (suspend function)\n            val auth = it.createPayment(request)\n\n            // Retry with payment\n            val retryResponse = it.get(\"https://api.example.com/premium-data\", auth)\n            println(retryResponse.body?.string())\n        }\n    }\n}\n</code></pre>"},{"location":"kotlin/libraries/client/#constructor-parameters","title":"Constructor Parameters","text":"<pre><code>class X402Client(\n    walletAccount: Account,\n    rpcUrl: String? = null,\n    httpClient: OkHttpClient = createDefaultHttpClient(),\n    allowLocal: Boolean = false\n)\n</code></pre> Parameter Type Description Default <code>walletAccount</code> <code>Account</code> Solana account for signing transactions Required <code>rpcUrl</code> <code>String?</code> Solana RPC endpoint URL <code>null</code> (devnet) <code>httpClient</code> <code>OkHttpClient</code> Custom HTTP client Default client <code>allowLocal</code> <code>Boolean</code> Allow localhost URLs (development only) <code>false</code>"},{"location":"kotlin/libraries/client/#http-methods","title":"HTTP Methods","text":"<p>All HTTP methods are suspend functions that run on <code>Dispatchers.IO</code>:</p>"},{"location":"kotlin/libraries/client/#get-request","title":"GET Request","text":"<pre><code>suspend fun get(url: String, payment: PaymentAuthorization? = null): Response\n</code></pre> <pre><code>val response = client.get(url)\nval response = client.get(url, paymentAuth)\n</code></pre>"},{"location":"kotlin/libraries/client/#post-request","title":"POST Request","text":"<pre><code>suspend fun post(url: String, body: String? = null, payment: PaymentAuthorization? = null): Response\n</code></pre> <pre><code>val jsonBody = \"\"\"{\"key\": \"value\"}\"\"\"\nval response = client.post(url, jsonBody)\nval response = client.post(url, jsonBody, paymentAuth)\n</code></pre>"},{"location":"kotlin/libraries/client/#put-request","title":"PUT Request","text":"<pre><code>suspend fun put(url: String, body: String? = null, payment: PaymentAuthorization? = null): Response\n</code></pre> <pre><code>val jsonBody = \"\"\"{\"key\": \"updated\"}\"\"\"\nval response = client.put(url, jsonBody)\nval response = client.put(url, jsonBody, paymentAuth)\n</code></pre>"},{"location":"kotlin/libraries/client/#delete-request","title":"DELETE Request","text":"<pre><code>suspend fun delete(url: String, payment: PaymentAuthorization? = null): Response\n</code></pre> <pre><code>val response = client.delete(url)\nval response = client.delete(url, paymentAuth)\n</code></pre>"},{"location":"kotlin/libraries/client/#payment-methods","title":"Payment Methods","text":""},{"location":"kotlin/libraries/client/#create-payment","title":"Create Payment","text":"<pre><code>suspend fun createPayment(\n    request: PaymentRequest,\n    amount: String? = null\n): PaymentAuthorization\n</code></pre> <pre><code>val auth = client.createPayment(paymentRequest)\nval auth = client.createPayment(paymentRequest, \"0.05\") // specific amount\n</code></pre>"},{"location":"kotlin/libraries/client/#parse-payment-request","title":"Parse Payment Request","text":"<pre><code>fun parsePaymentRequest(response: Response): PaymentRequest\n</code></pre> <pre><code>val response = client.get(url)\nif (client.paymentRequired(response)) {\n    val request = client.parsePaymentRequest(response)\n    // ... handle payment\n}\n</code></pre>"},{"location":"kotlin/libraries/client/#error-handling-with-sealed-classes","title":"Error Handling with Sealed Classes","text":"<p>Kotlin's sealed classes provide type-safe, exhaustive error handling:</p> <pre><code>suspend fun makeRequest(client: X402Client, url: String) {\n    try {\n        val response = client.get(url)\n        println(response.body?.string())\n\n    } catch (e: X402Error) {\n        when (e) {\n            is X402Error.PaymentRequired -&gt; {\n                val request = e.paymentRequest\n                val auth = client.createPayment(request)\n                val retry = client.get(url, auth)\n            }\n            is X402Error.InsufficientFunds -&gt; {\n                println(\"Need: ${e.requiredAmount}\")\n                println(\"Have: ${e.availableAmount}\")\n            }\n            is X402Error.PaymentExpired -&gt; {\n                println(\"Request expired at: ${e.paymentRequest.expiresAt}\")\n            }\n            is X402Error.PaymentVerificationFailed -&gt; {\n                println(\"Verification failed: ${e.reason}\")\n            }\n            is X402Error.TransactionBroadcastFailed -&gt; {\n                println(\"Broadcast failed: ${e.reason}\")\n            }\n            is X402Error.InvalidPaymentRequest -&gt; {\n                println(\"Invalid request: ${e.reason}\")\n            }\n            is X402Error.Generic -&gt; {\n                println(\"Error ${e.code}: ${e.message}\")\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"kotlin/libraries/client/#ssrf-protection","title":"SSRF Protection","text":"<p>By default, the client blocks requests to: - <code>localhost</code>, <code>127.0.0.1</code>, <code>::1</code> - Private IP ranges (10.x.x.x, 172.16.x.x, 192.168.x.x)</p> <pre><code>// Development mode - allows local URLs\nval devClient = X402Client(account, allowLocal = true)\n\n// Production mode - blocks local URLs (default)\nval prodClient = X402Client(account, allowLocal = false)\n</code></pre> <p>Security</p> <p>Never use <code>allowLocal=true</code> in production environments. This protection prevents Server-Side Request Forgery (SSRF) attacks.</p>"},{"location":"kotlin/libraries/client/#x402autoclient","title":"X402AutoClient","text":"<p>Automatic payment handling client with DSL builder pattern and retry logic.</p>"},{"location":"kotlin/libraries/client/#features_1","title":"Features","text":"<ul> <li>Automatic 402 detection and payment</li> <li>Configurable payment limits</li> <li>Automatic retry on payment</li> <li>Kotlin DSL builder pattern</li> <li>Suspend functions for non-blocking I/O</li> <li>Built on top of X402Client</li> </ul>"},{"location":"kotlin/libraries/client/#basic-usage_1","title":"Basic Usage","text":"<pre><code>import org.openlibx402.client.X402AutoClient\n\nsuspend fun main() {\n    // Build client with DSL configuration\n    val client = X402AutoClient(account) {\n        rpcUrl = \"https://api.devnet.solana.com\"\n        maxPaymentAmount = \"1.0\"      // Max 1 USDC per request\n        maxRetries = 2                // Retry up to 2 times\n        allowLocal = true             // Development only\n    }\n\n    client.use {\n        // Automatically handles 402 and retries (suspend function)\n        val response = it.get(\"https://api.example.com/premium-data\")\n        println(response.body?.string())\n    }\n}\n</code></pre>"},{"location":"kotlin/libraries/client/#dsl-builder-configuration","title":"DSL Builder Configuration","text":"<pre><code>val client = X402AutoClient(account) {\n    rpcUrl = \"https://api.devnet.solana.com\"\n    httpClient = customOkHttpClient\n    maxPaymentAmount = \"5.0\"\n    maxRetries = 2\n    allowLocal = false\n    autoRetry = true\n}\n</code></pre> Property Type Description Default <code>rpcUrl</code> <code>String?</code> Solana RPC endpoint Devnet <code>httpClient</code> <code>OkHttpClient?</code> Custom HTTP client Default <code>maxPaymentAmount</code> <code>String?</code> Maximum payment per request <code>null</code> (no limit) <code>maxRetries</code> <code>Int</code> Maximum retry attempts <code>1</code> <code>allowLocal</code> <code>Boolean</code> Allow localhost URLs <code>false</code> <code>autoRetry</code> <code>Boolean</code> Enable automatic retry <code>true</code>"},{"location":"kotlin/libraries/client/#alternative-builder-pattern","title":"Alternative Builder Pattern","text":"<p>You can also use the traditional builder pattern:</p> <pre><code>val client = X402AutoClient.Builder(account).apply {\n    rpcUrl = \"https://api.devnet.solana.com\"\n    maxPaymentAmount = \"5.0\"\n    maxRetries = 2\n    allowLocal = true\n}.build()\n</code></pre>"},{"location":"kotlin/libraries/client/#example-custom-configuration","title":"Example: Custom Configuration","text":"<pre><code>import okhttp3.OkHttpClient\nimport java.util.concurrent.TimeUnit\n\nsuspend fun customClientExample() {\n    // Custom HTTP client\n    val httpClient = OkHttpClient.Builder()\n        .connectTimeout(60, TimeUnit.SECONDS)\n        .readTimeout(60, TimeUnit.SECONDS)\n        .build()\n\n    // Build auto client with custom configuration\n    val client = X402AutoClient(account) {\n        rpcUrl = \"https://api.mainnet-beta.solana.com\"\n        httpClient = httpClient\n        maxPaymentAmount = \"10.0\"\n        maxRetries = 2\n    }\n\n    client.use {\n        val response = it.get(\"https://api.example.com/data\")\n        println(response.body?.string())\n    }\n}\n</code></pre>"},{"location":"kotlin/libraries/client/#automatic-payment-flow","title":"Automatic Payment Flow","text":"<pre><code>suspend fun automaticPaymentExample() {\n    val client = X402AutoClient(account) {\n        rpcUrl = \"https://api.devnet.solana.com\"\n        maxPaymentAmount = \"5.0\"\n        maxRetries = 2\n    }\n\n    client.use {\n        try {\n            // 1. Makes initial request\n            // 2. Receives 402 Payment Required\n            // 3. Automatically creates payment\n            // 4. Retries request with authorization\n            // 5. Returns successful response\n            val response = it.post(\n                \"https://api.example.com/data\",\n                \"\"\"{\"query\": \"process this\"}\"\"\"\n            )\n\n            println(\"Success: ${response.body?.string()}\")\n\n        } catch (e: X402Error.InsufficientFunds) {\n            println(\"Payment failed: not enough funds\")\n        } catch (e: X402Error.PaymentRequired) {\n            // Only thrown if max retries exceeded\n            println(\"Payment required but max retries exceeded\")\n        }\n    }\n}\n</code></pre>"},{"location":"kotlin/libraries/client/#payment-limits","title":"Payment Limits","text":"<p>The client enforces payment limits to prevent excessive charges:</p> <pre><code>// This will throw an error if payment exceeds 1.0 USDC\nval client = X402AutoClient(account) {\n    maxPaymentAmount = \"1.0\"\n}\n\nclient.use {\n    try {\n        val response = it.get(url)\n    } catch (e: X402Error.Generic) {\n        if (e.code == \"PAYMENT_LIMIT_EXCEEDED\") {\n            println(\"Payment exceeds configured limit\")\n        }\n    }\n}\n</code></pre>"},{"location":"kotlin/libraries/client/#access-underlying-components","title":"Access Underlying Components","text":"<pre><code>// Access the payment processor\nval processor = client.getProcessor()\nval balance = processor.getBalance(account.publicKey)\n</code></pre>"},{"location":"kotlin/libraries/client/#comparison-manual-vs-automatic","title":"Comparison: Manual vs Automatic","text":"Feature X402Client X402AutoClient Payment Control Manual Automatic Retry Logic Manual Automatic Payment Limits Manual Built-in Configuration Constructor DSL Builder Use Case Maximum control Convenience Error Handling Explicit Simplified Coroutines Suspend functions Suspend functions"},{"location":"kotlin/libraries/client/#when-to-use-each","title":"When to Use Each","text":"<p>Use X402Client when you need: - Fine-grained control over payments - Custom payment decision logic - Explicit user approval for payments - Complex payment workflows - Integration with existing payment systems - Type-safe error handling with when expressions</p> <p>Use X402AutoClient when you need: - Quick integration with automatic payments - Simplified error handling - Built-in retry logic - Payment limit enforcement - Reduced boilerplate code - DSL-based configuration</p>"},{"location":"kotlin/libraries/client/#coroutine-best-practices","title":"Coroutine Best Practices","text":""},{"location":"kotlin/libraries/client/#proper-coroutine-scope-management","title":"Proper Coroutine Scope Management","text":"<pre><code>import kotlinx.coroutines.*\n\n// Application-level coroutine scope\nclass PaymentService {\n    private val scope = CoroutineScope(Dispatchers.IO + SupervisorJob())\n    private val client = X402AutoClient(account) {\n        rpcUrl = \"https://api.devnet.solana.com\"\n    }\n\n    fun makePaymentRequest(url: String) {\n        scope.launch {\n            try {\n                val response = client.get(url)\n                // Process response\n            } catch (e: X402Error) {\n                // Handle error\n            }\n        }\n    }\n\n    fun shutdown() {\n        scope.cancel()\n        client.close()\n    }\n}\n</code></pre>"},{"location":"kotlin/libraries/client/#concurrent-requests-with-async","title":"Concurrent Requests with Async","text":"<pre><code>import kotlinx.coroutines.*\n\nsuspend fun concurrentRequests() = coroutineScope {\n    val client = X402AutoClient(account) {\n        maxPaymentAmount = \"5.0\"\n    }\n\n    client.use {\n        // Launch multiple requests concurrently\n        val deferred1 = async { it.get(\"https://api.example.com/data1\") }\n        val deferred2 = async { it.get(\"https://api.example.com/data2\") }\n        val deferred3 = async { it.get(\"https://api.example.com/data3\") }\n\n        // Wait for all to complete\n        val responses = awaitAll(deferred1, deferred2, deferred3)\n\n        responses.forEach { response -&gt;\n            println(\"Response: ${response.code}\")\n        }\n    }\n}\n</code></pre>"},{"location":"kotlin/libraries/client/#timeout-and-cancellation","title":"Timeout and Cancellation","text":"<pre><code>import kotlinx.coroutines.*\n\nsuspend fun requestWithTimeout() {\n    val client = X402Client(account, allowLocal = true)\n\n    client.use {\n        try {\n            withTimeout(5000) {\n                val response = it.get(\"https://api.example.com/data\")\n                println(response.body?.string())\n            }\n        } catch (e: TimeoutCancellationException) {\n            println(\"Request timed out\")\n        } catch (e: X402Error) {\n            println(\"Payment error: ${e.message}\")\n        }\n    }\n}\n</code></pre>"},{"location":"kotlin/libraries/client/#structured-concurrency","title":"Structured Concurrency","text":"<pre><code>suspend fun structuredPaymentFlow() = coroutineScope {\n    val client = X402Client(account, allowLocal = true)\n\n    client.use {\n        try {\n            // All child coroutines are cancelled if any fails\n            val response = it.get(\"https://api.example.com/data\")\n\n            // Process in parallel\n            val job1 = launch { processData(response) }\n            val job2 = launch { saveToDatabase(response) }\n\n            // Wait for both to complete\n            job1.join()\n            job2.join()\n\n        } catch (e: X402Error) {\n            // All child coroutines are automatically cancelled\n            println(\"Error: ${e.message}\")\n        }\n    }\n}\n</code></pre>"},{"location":"kotlin/libraries/client/#data-classes-and-kotlinxserialization","title":"Data Classes and kotlinx.serialization","text":"<p>The Kotlin SDK uses data classes with kotlinx.serialization for type-safe JSON handling:</p> <pre><code>import org.openlibx402.core.models.PaymentRequest\nimport org.openlibx402.core.models.PaymentAuthorization\n\n// PaymentRequest is a data class with kotlinx.serialization\nval request = PaymentRequest(\n    maxAmountRequired = \"0.10\",\n    assetType = \"SPL\",\n    assetAddress = \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\",\n    paymentAddress = \"7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU\",\n    network = \"solana-devnet\",\n    expiresAt = Clock.System.now() + 5.minutes,\n    nonce = \"unique-nonce\",\n    paymentId = \"pay_123\",\n    resource = \"/api/data\",\n    description = \"Premium data access\"\n)\n\n// Serialize to JSON\nval json = request.toJson()\n\n// Deserialize from JSON\nval parsed = PaymentRequest.fromJson(json)\n\n// Data class features\nval updated = request.copy(maxAmountRequired = \"0.20\")\nval (amount, assetType, address) = request  // Destructuring\n</code></pre>"},{"location":"kotlin/libraries/client/#companion-objects","title":"Companion Objects","text":"<p>The SDK uses companion objects for factory methods and constants:</p> <pre><code>// Parse from JSON\nval request = PaymentRequest.fromJson(jsonString)\nval auth = PaymentAuthorization.fromHeader(headerValue)\n\n// Get error information\nval info = X402Error.getInfo(\"PAYMENT_REQUIRED\")\nval isRetryable = X402Error.isRetryable(\"INSUFFICIENT_FUNDS\")\nval message = X402Error.getMessage(\"PAYMENT_EXPIRED\")\n</code></pre>"},{"location":"kotlin/libraries/client/#resource-management","title":"Resource Management","text":"<p>Both clients implement <code>Closeable</code> for proper resource cleanup:</p> <pre><code>// Try-with-resources pattern (use function)\nclient.use {\n    val response = it.get(url)\n    // Client automatically closed\n}\n\n// Manual cleanup\nval client = X402Client(account)\ntry {\n    val response = client.get(url)\n} finally {\n    client.close()  // Must call close\n}\n</code></pre>"},{"location":"kotlin/libraries/client/#best-practices","title":"Best Practices","text":"<ol> <li>Use suspend functions: All HTTP operations are suspend functions</li> <li>Proper coroutine scope: Use structured concurrency</li> <li>Resource management: Use <code>use {}</code> for automatic cleanup</li> <li>Type-safe errors: Use when expressions with sealed classes</li> <li>Never use allowLocal in production: Security risk</li> <li>DSL builders: Prefer X402AutoClient DSL for configuration</li> <li>Data classes: Leverage immutability and copy()</li> <li>Validate payment amounts: Check before creating payments</li> <li>Log payment activities: Track payments for auditing</li> <li>Handle cancellation: Support coroutine cancellation</li> </ol>"},{"location":"kotlin/libraries/client/#example-production-setup","title":"Example: Production Setup","text":"<pre><code>import kotlinx.coroutines.*\nimport org.openlibx402.client.X402AutoClient\nimport org.openlibx402.core.errors.X402Error\nimport org.p2p.solanaj.core.Account\nimport mu.KotlinLogging\n\nprivate val logger = KotlinLogging.logger {}\n\nclass ProductionPaymentService(\n    private val account: Account,\n    private val scope: CoroutineScope = CoroutineScope(Dispatchers.IO + SupervisorJob())\n) {\n    private val client = X402AutoClient(account) {\n        rpcUrl = \"https://api.mainnet-beta.solana.com\"\n        maxPaymentAmount = \"10.0\"\n        maxRetries = 2\n        allowLocal = false  // Production security\n    }\n\n    suspend fun makeRequest(url: String): Result&lt;String&gt; = withContext(Dispatchers.IO) {\n        try {\n            logger.info { \"Making payment-enabled request to $url\" }\n\n            val response = client.get(url)\n            val data = response.body?.string() ?: \"\"\n\n            logger.info { \"Request successful\" }\n            Result.success(data)\n\n        } catch (e: X402Error) {\n            when (e) {\n                is X402Error.InsufficientFunds -&gt; {\n                    logger.error { \"Insufficient funds: ${e.requiredAmount}\" }\n                    // Alert user to add funds\n                }\n                is X402Error.PaymentRequired -&gt; {\n                    logger.error { \"Payment failed after retries\" }\n                    // Escalate to support\n                }\n                else -&gt; {\n                    logger.error(e) { \"X402 error: ${e.code}\" }\n                }\n            }\n            Result.failure(e)\n\n        } catch (e: Exception) {\n            logger.error(e) { \"Unexpected error\" }\n            Result.failure(e)\n        }\n    }\n\n    fun shutdown() {\n        scope.cancel()\n        client.close()\n    }\n}\n\n// Usage\nsuspend fun main() {\n    val account = loadAccountFromSecureStorage()\n    val service = ProductionPaymentService(account)\n\n    val result = service.makeRequest(\"https://api.production.com/premium-data\")\n\n    result.onSuccess { data -&gt;\n        println(\"Success: $data\")\n    }.onFailure { error -&gt;\n        println(\"Failed: ${error.message}\")\n    }\n\n    service.shutdown()\n}\n\nprivate fun loadAccountFromSecureStorage(): Account {\n    // Load from environment, key vault, etc.\n    val secretKey = System.getenv(\"SOLANA_SECRET_KEY\")\n    return Account(decodeSecretKey(secretKey))\n}\n\nprivate fun decodeSecretKey(key: String): ByteArray {\n    // Implement secure key decoding\n    return java.util.Base64.getDecoder().decode(key)\n}\n</code></pre>"},{"location":"kotlin/libraries/client/#related-documentation","title":"Related Documentation","text":"<ul> <li>API Reference - Complete API documentation</li> <li>Error Handling - Error types and handling</li> <li>Examples - More usage examples</li> <li>Installation - Installation guide</li> </ul>"},{"location":"kotlin/libraries/core/","title":"OpenLibX402 Core Library (Kotlin)","text":"<p>The <code>openlibx402-core</code> package provides the fundamental payment protocol components for Kotlin applications with full coroutine support.</p>"},{"location":"kotlin/libraries/core/#installation","title":"Installation","text":"<pre><code>dependencies {\n    implementation(\"org.openlibx402:openlibx402-core:0.1.0\")\n}\n</code></pre>"},{"location":"kotlin/libraries/core/#package-structure","title":"Package Structure","text":"<pre><code>org.openlibx402.core/\n\u251c\u2500\u2500 models/\n\u2502   \u251c\u2500\u2500 PaymentRequest (data class)\n\u2502   \u2514\u2500\u2500 PaymentAuthorization (data class)\n\u251c\u2500\u2500 errors/\n\u2502   \u2514\u2500\u2500 X402Error (sealed class)\n\u251c\u2500\u2500 blockchain/\n\u2502   \u2514\u2500\u2500 SolanaPaymentProcessor (suspend functions)\n\u2514\u2500\u2500 util/\n    \u2514\u2500\u2500 Extension functions\n</code></pre>"},{"location":"kotlin/libraries/core/#models","title":"Models","text":""},{"location":"kotlin/libraries/core/#paymentrequest","title":"PaymentRequest","text":"<p>Immutable data class representing a 402 payment request.</p> <pre><code>import org.openlibx402.core.models.PaymentRequest\n\n// Parse from JSON\nval request = PaymentRequest.fromJson(jsonString)\n\n// Access fields\nval amount = request.maxAmountRequired\nval paymentAddress = request.paymentAddress\nval expiresAt = request.expiresAt\n\n// Check expiration\nval expired = request.isExpired()\n\n// Convert to JSON\nval json = request.toJson()\n\n// Convert to Map\nval map = request.toMap()\n\n// Copy with changes (immutable)\nval updated = request.copy(maxAmountRequired = \"0.20\")\n</code></pre> <p>Properties: - <code>maxAmountRequired: String</code> - Maximum payment amount - <code>assetType: String</code> - Asset type (e.g., \"SPL\") - <code>assetAddress: String</code> - Token mint address - <code>paymentAddress: String</code> - Recipient wallet address - <code>network: String</code> - Blockchain network - <code>expiresAt: Instant</code> - Expiration timestamp - <code>nonce: String</code> - Unique nonce - <code>paymentId: String</code> - Unique payment identifier - <code>resource: String</code> - API resource endpoint - <code>description: String?</code> - Optional description</p>"},{"location":"kotlin/libraries/core/#paymentauthorization","title":"PaymentAuthorization","text":"<p>Immutable data class representing proof of payment.</p> <pre><code>import org.openlibx402.core.models.PaymentAuthorization\n\n// Create authorization\nval auth = PaymentAuthorization(\n    paymentId = paymentId,\n    actualAmount = actualAmount,\n    paymentAddress = paymentAddress,\n    assetAddress = assetAddress,\n    network = network,\n    timestamp = Clock.System.now(),\n    signature = signature,\n    publicKey = publicKey,\n    transactionHash = transactionHash\n)\n\n// Convert to header value (base64-encoded JSON)\nval headerValue = auth.toHeaderValue()\n\n// Parse from header\nval parsed = PaymentAuthorization.fromHeader(headerValue)\n\n// Parse from JSON\nval fromJson = PaymentAuthorization.fromJson(jsonString)\n</code></pre> <p>Properties: - <code>paymentId: String</code> - Payment identifier - <code>actualAmount: String</code> - Amount paid - <code>paymentAddress: String</code> - Recipient address - <code>assetAddress: String</code> - Token mint address - <code>network: String</code> - Network identifier - <code>timestamp: Instant</code> - Authorization timestamp - <code>signature: String</code> - Transaction signature - <code>publicKey: String</code> - Payer's public key - <code>transactionHash: String</code> - Transaction hash</p>"},{"location":"kotlin/libraries/core/#error-handling","title":"Error Handling","text":""},{"location":"kotlin/libraries/core/#x402error-sealed-class","title":"X402Error (Sealed Class)","text":"<p>Type-safe exhaustive error handling with sealed class hierarchy.</p> <pre><code>import org.openlibx402.core.errors.X402Error\n\ntry {\n    // Payment operation\n} catch (e: X402Error) {\n    when (e) {\n        is X402Error.PaymentRequired -&gt; {\n            val request = e.paymentRequest\n            // Code: PAYMENT_REQUIRED, Retry: true\n        }\n        is X402Error.InsufficientFunds -&gt; {\n            val required = e.requiredAmount\n            val available = e.availableAmount\n            // Code: INSUFFICIENT_FUNDS, Retry: false\n        }\n        is X402Error.PaymentExpired -&gt; {\n            val request = e.paymentRequest\n            // Code: PAYMENT_EXPIRED, Retry: true\n        }\n        is X402Error.PaymentVerificationFailed -&gt; {\n            val reason = e.reason\n            // Code: PAYMENT_VERIFICATION_FAILED, Retry: true\n        }\n        is X402Error.TransactionBroadcastFailed -&gt; {\n            val reason = e.reason\n            // Code: TRANSACTION_BROADCAST_FAILED, Retry: true\n        }\n        is X402Error.InvalidPaymentRequest -&gt; {\n            val reason = e.reason\n            // Code: INVALID_PAYMENT_REQUEST, Retry: false\n        }\n        is X402Error.Generic -&gt; {\n            val code = e.customCode\n            // Custom error\n        }\n    }\n}\n</code></pre>"},{"location":"kotlin/libraries/core/#error-properties","title":"Error Properties","text":"<p>All errors have: - <code>message: String</code> - Error message - <code>code: String</code> - Error code - <code>details: Map&lt;String, Any&gt;</code> - Additional details</p>"},{"location":"kotlin/libraries/core/#blockchain-integration","title":"Blockchain Integration","text":""},{"location":"kotlin/libraries/core/#solanapaymentprocessor","title":"SolanaPaymentProcessor","text":"<p>Handles Solana blockchain operations with suspend functions.</p> <pre><code>import org.openlibx402.core.blockchain.SolanaPaymentProcessor\nimport org.p2p.solanaj.core.Account\nimport kotlinx.coroutines.runBlocking\n\nsuspend fun processPayment() {\n    val processor = SolanaPaymentProcessor(\n        rpcUrl = \"https://api.devnet.solana.com\"\n    )\n\n    processor.use {\n        // Create payment (suspend function)\n        val account = Account(secretKey)\n        val auth = it.createPayment(\n            request = paymentRequest,\n            payerAccount = account,\n            amount = \"0.10\"  // Optional\n        )\n\n        // Check balance (suspend function)\n        val pubkey = PublicKey(\"...\")\n        val balance = it.getBalance(pubkey)\n\n        // Verify transaction (suspend function)\n        val valid = it.verifyTransaction(\n            txHash = txHash,\n            expectedRecipient = recipientAddress,\n            expectedAmount = amount,\n            expectedMint = tokenMint\n        )\n    }\n}\n</code></pre> <p>Suspend Functions: - <code>suspend fun createPayment(request, account, amount)</code> - Create and broadcast payment - <code>suspend fun getBalance(publicKey)</code> - Get SOL balance - <code>suspend fun getTokenBalance(address, mint)</code> - Get SPL token balance - <code>suspend fun verifyTransaction(hash, recipient, amount, mint)</code> - Verify on-chain</p> <p>All I/O operations run on <code>Dispatchers.IO</code>.</p>"},{"location":"kotlin/libraries/core/#error-code-utilities","title":"Error Code Utilities","text":"<p>Access error metadata using companion object:</p> <pre><code>// Get error info\nval info = X402Error.getInfo(\"PAYMENT_REQUIRED\")\nval message = info?.message\nval retryable = info?.retry\nval userAction = info?.userAction\n\n// Check if retryable\nval canRetry = X402Error.isRetryable(\"INSUFFICIENT_FUNDS\")  // false\n\n// Get all codes\nval allCodes = X402Error.getAllCodes()\n</code></pre>"},{"location":"kotlin/libraries/core/#coroutine-safety","title":"Coroutine Safety","text":"<p>All operations are coroutine-safe: - Models are immutable data classes - SolanaPaymentProcessor uses structured concurrency - All suspend functions use appropriate dispatchers</p>"},{"location":"kotlin/libraries/core/#resource-management","title":"Resource Management","text":"<p>Use <code>.use</code> extension function for automatic cleanup:</p> <pre><code>SolanaPaymentProcessor(rpcUrl).use { processor -&gt;\n    // Use processor\n}  // Automatically closed\n</code></pre>"},{"location":"kotlin/libraries/core/#serialization","title":"Serialization","text":"<p>Models use <code>kotlinx.serialization</code>:</p> <pre><code>import kotlinx.serialization.json.Json\n\n// Serialize\nval json = Json.encodeToString(PaymentRequest.serializer(), request)\n\n// Deserialize\nval request = Json.decodeFromString(PaymentRequest.serializer(), json)\n\n// Or use convenience methods\nval request = PaymentRequest.fromJson(json)\nval json = request.toJson()\n</code></pre>"},{"location":"kotlin/libraries/core/#kotlin-features","title":"Kotlin Features","text":""},{"location":"kotlin/libraries/core/#data-classes","title":"Data Classes","text":"<pre><code>// Immutable with structural equality\nval request1 = PaymentRequest(...)\nval request2 = request1.copy(maxAmountRequired = \"0.20\")\n\n// Destructuring\nval (amount, assetType, address) = request\n</code></pre>"},{"location":"kotlin/libraries/core/#extension-functions","title":"Extension Functions","text":"<pre><code>// Check if payment is affordable\nfun PaymentRequest.isAffordable(balance: Double): Boolean =\n    balance &gt;= maxAmountRequired.toDouble()\n\n// Get payment amount in smallest units\nfun PaymentRequest.getAmountLamports(): Long =\n    (maxAmountRequired.toDouble() * 1_000_000_000).toLong()\n</code></pre>"},{"location":"kotlin/libraries/core/#type-safe-builders","title":"Type-Safe Builders","text":"<pre><code>// Use companion object factories\nval request = PaymentRequest.fromJson(json)\nval auth = PaymentAuthorization.fromHeader(headerValue)\n</code></pre>"},{"location":"kotlin/libraries/core/#next-steps","title":"Next Steps","text":"<ul> <li>Client Library</li> <li>Getting Started</li> <li>Examples</li> </ul>"},{"location":"kotlin/reference/api-reference/","title":"Kotlin API Reference","text":"<p>Complete API reference for the OpenLibX402 Kotlin SDK with coroutines support.</p>"},{"location":"kotlin/reference/api-reference/#package-orgopenlibx402client","title":"Package: org.openlibx402.client","text":""},{"location":"kotlin/reference/api-reference/#x402client","title":"X402Client","text":"<p>Manual payment control HTTP client using Kotlin coroutines with suspend functions.</p>"},{"location":"kotlin/reference/api-reference/#constructor","title":"Constructor","text":"<pre><code>class X402Client(\n    private val walletAccount: Account,\n    rpcUrl: String? = null,\n    private val httpClient: OkHttpClient = createDefaultHttpClient(),\n    private val allowLocal: Boolean = false\n) : Closeable\n</code></pre> <p>Parameters: - <code>walletAccount</code> (Account): Solana account for signing transactions - <code>rpcUrl</code> (String?): Solana RPC endpoint URL (null for devnet default) - <code>httpClient</code> (OkHttpClient): Custom OkHttp client (default client if not provided) - <code>allowLocal</code> (Boolean): Allow localhost URLs (false for production)</p> <p>Example: <pre><code>val client = X402Client(\n    walletAccount = account,\n    rpcUrl = \"https://api.devnet.solana.com\",\n    allowLocal = true\n)\n</code></pre></p>"},{"location":"kotlin/reference/api-reference/#http-methods-suspend-functions","title":"HTTP Methods (Suspend Functions)","text":"<p>All HTTP methods are suspend functions that must be called from a coroutine.</p>"},{"location":"kotlin/reference/api-reference/#get","title":"get()","text":"<pre><code>suspend fun get(url: String, payment: PaymentAuthorization? = null): Response\n</code></pre> <p>Performs a GET request. Runs on <code>Dispatchers.IO</code>.</p> <p>Parameters: - <code>url</code> (String): Target URL - <code>payment</code> (PaymentAuthorization?): Optional payment authorization</p> <p>Returns: OkHttp Response object</p> <p>Throws: - <code>X402Error.PaymentRequired</code> - 402 response received - <code>IOException</code> - Network error</p> <p>Example: <pre><code>val response = client.get(\"https://api.example.com/data\")\nval response = client.get(\"https://api.example.com/data\", paymentAuth)\n</code></pre></p>"},{"location":"kotlin/reference/api-reference/#post","title":"post()","text":"<pre><code>suspend fun post(url: String, body: String? = null, payment: PaymentAuthorization? = null): Response\n</code></pre> <p>Performs a POST request with JSON body.</p> <p>Parameters: - <code>url</code> (String): Target URL - <code>body</code> (String?): Request body (JSON string, can be null) - <code>payment</code> (PaymentAuthorization?): Optional payment authorization</p> <p>Example: <pre><code>val jsonBody = \"\"\"{\"key\": \"value\"}\"\"\"\nval response = client.post(url, jsonBody)\n</code></pre></p>"},{"location":"kotlin/reference/api-reference/#put","title":"put()","text":"<pre><code>suspend fun put(url: String, body: String? = null, payment: PaymentAuthorization? = null): Response\n</code></pre> <p>Performs a PUT request with JSON body.</p>"},{"location":"kotlin/reference/api-reference/#delete","title":"delete()","text":"<pre><code>suspend fun delete(url: String, payment: PaymentAuthorization? = null): Response\n</code></pre> <p>Performs a DELETE request.</p>"},{"location":"kotlin/reference/api-reference/#request","title":"request()","text":"<pre><code>suspend fun request(\n    method: String,\n    url: String,\n    body: String? = null,\n    payment: PaymentAuthorization? = null\n): Response\n</code></pre> <p>Generic HTTP request method. All other HTTP methods delegate to this.</p>"},{"location":"kotlin/reference/api-reference/#payment-methods","title":"Payment Methods","text":""},{"location":"kotlin/reference/api-reference/#createpayment","title":"createPayment()","text":"<pre><code>suspend fun createPayment(\n    request: PaymentRequest,\n    amount: String? = null\n): PaymentAuthorization\n</code></pre> <p>Creates a payment for a payment request. This is a suspend function.</p> <p>Parameters: - <code>request</code> (PaymentRequest): The payment request - <code>amount</code> (String?): Specific amount (null for max amount)</p> <p>Returns: PaymentAuthorization to include in retry request</p> <p>Throws: - <code>X402Error.InsufficientFunds</code> - Not enough funds - <code>X402Error.PaymentExpired</code> - Request expired - <code>X402Error.TransactionBroadcastFailed</code> - Broadcast failed</p> <p>Example: <pre><code>val auth = client.createPayment(request)\nval auth = client.createPayment(request, \"0.05\")\n</code></pre></p>"},{"location":"kotlin/reference/api-reference/#parsepaymentrequest","title":"parsePaymentRequest()","text":"<pre><code>fun parsePaymentRequest(response: Response): PaymentRequest\n</code></pre> <p>Parses payment request from 402 response.</p> <p>Throws: - <code>X402Error.InvalidPaymentRequest</code> - Invalid response format - <code>X402Error.PaymentExpired</code> - Request already expired</p>"},{"location":"kotlin/reference/api-reference/#paymentrequired","title":"paymentRequired()","text":"<pre><code>fun paymentRequired(response: Response): Boolean\n</code></pre> <p>Checks if response indicates payment is required.</p> <p>Returns: true if 402 status code, false otherwise</p>"},{"location":"kotlin/reference/api-reference/#resource-management","title":"Resource Management","text":""},{"location":"kotlin/reference/api-reference/#close","title":"close()","text":"<pre><code>override fun close()\n</code></pre> <p>Closes the client and releases resources. Implements <code>Closeable</code>.</p>"},{"location":"kotlin/reference/api-reference/#isclosed","title":"isClosed()","text":"<pre><code>fun isClosed(): Boolean\n</code></pre> <p>Checks if client has been closed.</p>"},{"location":"kotlin/reference/api-reference/#properties","title":"Properties","text":"<pre><code>internal val processor: SolanaPaymentProcessor\n</code></pre> <p>The payment processor. Has <code>internal</code> visibility - not accessible from external code.</p>"},{"location":"kotlin/reference/api-reference/#x402autoclient","title":"X402AutoClient","text":"<p>Automatic payment handling HTTP client with DSL builder pattern and coroutines.</p>"},{"location":"kotlin/reference/api-reference/#dsl-constructor-primary","title":"DSL Constructor (Primary)","text":"<pre><code>companion object {\n    operator fun invoke(\n        walletAccount: Account,\n        builderAction: Builder.() -&gt; Unit = {}\n    ): X402AutoClient\n}\n</code></pre> <p>Creates a client using Kotlin DSL pattern.</p> <p>Example: <pre><code>val client = X402AutoClient(account) {\n    rpcUrl = \"https://api.devnet.solana.com\"\n    maxPaymentAmount = \"1.0\"\n    maxRetries = 2\n    allowLocal = true\n}\n</code></pre></p>"},{"location":"kotlin/reference/api-reference/#builder-class","title":"Builder Class","text":"<pre><code>class Builder(private val walletAccount: Account) {\n    var rpcUrl: String? = null\n    var httpClient: OkHttpClient? = null\n    var allowLocal: Boolean = false\n    var maxRetries: Int = 1\n    var autoRetry: Boolean = true\n    var maxPaymentAmount: String? = null\n\n    fun build(): X402AutoClient\n}\n</code></pre> <p>Properties:</p> Property Type Description Default <code>rpcUrl</code> <code>String?</code> Solana RPC endpoint <code>null</code> (devnet) <code>httpClient</code> <code>OkHttpClient?</code> Custom HTTP client Default client <code>maxPaymentAmount</code> <code>String?</code> Maximum payment per request <code>null</code> (no limit) <code>maxRetries</code> <code>Int</code> Maximum retry attempts <code>1</code> <code>allowLocal</code> <code>Boolean</code> Allow localhost URLs <code>false</code> <code>autoRetry</code> <code>Boolean</code> Enable automatic retry <code>true</code> <p>Traditional Builder Example: <pre><code>val client = X402AutoClient.Builder(account).apply {\n    rpcUrl = \"https://api.devnet.solana.com\"\n    maxPaymentAmount = \"5.0\"\n    maxRetries = 2\n}.build()\n</code></pre></p>"},{"location":"kotlin/reference/api-reference/#http-methods-suspend-functions_1","title":"HTTP Methods (Suspend Functions)","text":"<p>All methods are suspend functions that automatically handle 402 responses.</p> <pre><code>suspend fun get(url: String): Response\nsuspend fun post(url: String, body: String? = null): Response\nsuspend fun put(url: String, body: String? = null): Response\nsuspend fun delete(url: String): Response\n</code></pre> <p>Example: <pre><code>val response = client.get(url)  // Automatically handles payment\n</code></pre></p>"},{"location":"kotlin/reference/api-reference/#access-methods","title":"Access Methods","text":""},{"location":"kotlin/reference/api-reference/#getprocessor","title":"getProcessor()","text":"<pre><code>fun getProcessor(): SolanaPaymentProcessor\n</code></pre> <p>Gets the underlying payment processor.</p>"},{"location":"kotlin/reference/api-reference/#close_1","title":"close()","text":"<pre><code>override fun close()\n</code></pre> <p>Closes the client and releases resources.</p>"},{"location":"kotlin/reference/api-reference/#isclosed_1","title":"isClosed()","text":"<pre><code>fun isClosed(): Boolean\n</code></pre> <p>Checks if client is closed.</p>"},{"location":"kotlin/reference/api-reference/#package-orgopenlibx402coremodels","title":"Package: org.openlibx402.core.models","text":""},{"location":"kotlin/reference/api-reference/#paymentrequest","title":"PaymentRequest","text":"<p>Payment request data class with kotlinx.serialization support.</p>"},{"location":"kotlin/reference/api-reference/#data-class","title":"Data Class","text":"<pre><code>@Serializable\ndata class PaymentRequest(\n    @SerialName(\"max_amount_required\")\n    val maxAmountRequired: String,\n\n    @SerialName(\"asset_type\")\n    val assetType: String,\n\n    @SerialName(\"asset_address\")\n    val assetAddress: String,\n\n    @SerialName(\"payment_address\")\n    val paymentAddress: String,\n\n    @SerialName(\"network\")\n    val network: String,\n\n    @SerialName(\"expires_at\")\n    val expiresAt: Instant,\n\n    @SerialName(\"nonce\")\n    val nonce: String,\n\n    @SerialName(\"payment_id\")\n    val paymentId: String,\n\n    @SerialName(\"resource\")\n    val resource: String,\n\n    @SerialName(\"description\")\n    val description: String? = null\n)\n</code></pre>"},{"location":"kotlin/reference/api-reference/#companion-object-methods","title":"Companion Object Methods","text":""},{"location":"kotlin/reference/api-reference/#fromjson","title":"fromJson()","text":"<pre><code>companion object {\n    fun fromJson(jsonString: String): PaymentRequest\n}\n</code></pre> <p>Parses PaymentRequest from JSON string using kotlinx.serialization.</p> <p>Throws: IllegalArgumentException if JSON is invalid</p>"},{"location":"kotlin/reference/api-reference/#example-with-kotlinxserialization","title":"Example with kotlinx.serialization","text":"<pre><code>import kotlinx.serialization.json.Json\n\nval json = \"\"\"{\"max_amount_required\":\"0.10\", ...}\"\"\"\nval request = PaymentRequest.fromJson(json)\n</code></pre>"},{"location":"kotlin/reference/api-reference/#instance-methods","title":"Instance Methods","text":""},{"location":"kotlin/reference/api-reference/#tojson","title":"toJson()","text":"<pre><code>fun toJson(): String\n</code></pre> <p>Serializes to JSON string using kotlinx.serialization.</p>"},{"location":"kotlin/reference/api-reference/#tomap","title":"toMap()","text":"<pre><code>fun toMap(): Map&lt;String, Any?&gt;\n</code></pre> <p>Converts to Map with snake_case keys.</p>"},{"location":"kotlin/reference/api-reference/#isexpired","title":"isExpired()","text":"<pre><code>fun isExpired(): Boolean\n</code></pre> <p>Checks if payment request has expired using kotlinx.datetime.</p>"},{"location":"kotlin/reference/api-reference/#data-class-features","title":"Data Class Features","text":"<pre><code>// Destructuring\nval (amount, assetType, address) = paymentRequest\n\n// Immutable copy\nval updated = paymentRequest.copy(maxAmountRequired = \"0.20\")\n\n// Equality\nval isEqual = request1 == request2\n\n// toString()\nprintln(paymentRequest)  // Auto-generated toString()\n</code></pre>"},{"location":"kotlin/reference/api-reference/#paymentauthorization","title":"PaymentAuthorization","text":"<p>Payment authorization data class with kotlinx.serialization support.</p>"},{"location":"kotlin/reference/api-reference/#data-class_1","title":"Data Class","text":"<pre><code>@Serializable\ndata class PaymentAuthorization(\n    @SerialName(\"payment_id\")\n    val paymentId: String,\n\n    @SerialName(\"actual_amount\")\n    val actualAmount: String,\n\n    @SerialName(\"payment_address\")\n    val paymentAddress: String,\n\n    @SerialName(\"asset_address\")\n    val assetAddress: String,\n\n    @SerialName(\"network\")\n    val network: String,\n\n    @SerialName(\"timestamp\")\n    val timestamp: Instant,\n\n    @SerialName(\"signature\")\n    val signature: String,\n\n    @SerialName(\"public_key\")\n    val publicKey: String,\n\n    @SerialName(\"transaction_hash\")\n    val transactionHash: String = signature\n)\n</code></pre>"},{"location":"kotlin/reference/api-reference/#companion-object-methods_1","title":"Companion Object Methods","text":""},{"location":"kotlin/reference/api-reference/#fromjson_1","title":"fromJson()","text":"<pre><code>companion object {\n    fun fromJson(jsonString: String): PaymentAuthorization\n}\n</code></pre> <p>Parses from JSON string.</p>"},{"location":"kotlin/reference/api-reference/#fromheader","title":"fromHeader()","text":"<pre><code>companion object {\n    fun fromHeader(headerValue: String): PaymentAuthorization\n}\n</code></pre> <p>Parses from base64-encoded authorization header.</p>"},{"location":"kotlin/reference/api-reference/#instance-methods_1","title":"Instance Methods","text":""},{"location":"kotlin/reference/api-reference/#tojson_1","title":"toJson()","text":"<pre><code>fun toJson(): String\n</code></pre> <p>Serializes to JSON string.</p>"},{"location":"kotlin/reference/api-reference/#toheadervalue","title":"toHeaderValue()","text":"<pre><code>fun toHeaderValue(): String\n</code></pre> <p>Converts to base64-encoded header value for <code>X-Payment-Authorization</code>.</p>"},{"location":"kotlin/reference/api-reference/#tomap_1","title":"toMap()","text":"<pre><code>fun toMap(): Map&lt;String, Any&gt;\n</code></pre> <p>Converts to Map with snake_case keys.</p>"},{"location":"kotlin/reference/api-reference/#package-orgopenlibx402coreblockchain","title":"Package: org.openlibx402.core.blockchain","text":""},{"location":"kotlin/reference/api-reference/#solanapaymentprocessor","title":"SolanaPaymentProcessor","text":"<p>Handles Solana blockchain payment operations.</p>"},{"location":"kotlin/reference/api-reference/#constructor_1","title":"Constructor","text":"<pre><code>class SolanaPaymentProcessor(rpcUrl: String) : Closeable\n</code></pre> <p>Parameters: - <code>rpcUrl</code> (String): Solana RPC endpoint URL</p>"},{"location":"kotlin/reference/api-reference/#methods","title":"Methods","text":""},{"location":"kotlin/reference/api-reference/#createpayment_1","title":"createPayment()","text":"<pre><code>suspend fun createPayment(\n    request: PaymentRequest,\n    payerAccount: Account,\n    amount: String?\n): PaymentAuthorization\n</code></pre> <p>Creates and broadcasts a payment transaction. This is a suspend function.</p> <p>Returns: PaymentAuthorization with transaction signature</p> <p>Throws: - <code>X402Error.InsufficientFunds</code> - Not enough funds - <code>X402Error.TransactionBroadcastFailed</code> - Broadcast failed - <code>X402Error.PaymentVerificationFailed</code> - Verification failed</p>"},{"location":"kotlin/reference/api-reference/#getbalance","title":"getBalance()","text":"<pre><code>fun getBalance(publicKey: PublicKey): String\n</code></pre> <p>Gets USDC balance for a public key. This is a blocking operation.</p> <p>Returns: Balance as string (e.g., \"10.50\")</p>"},{"location":"kotlin/reference/api-reference/#verifytransaction","title":"verifyTransaction()","text":"<pre><code>fun verifyTransaction(signature: String): Boolean\n</code></pre> <p>Verifies a transaction has been confirmed. Blocking operation.</p> <p>Returns: true if confirmed, false otherwise</p>"},{"location":"kotlin/reference/api-reference/#close_2","title":"close()","text":"<pre><code>override fun close()\n</code></pre> <p>Closes RPC connection and releases resources.</p>"},{"location":"kotlin/reference/api-reference/#package-orgopenlibx402coreerrors","title":"Package: org.openlibx402.core.errors","text":""},{"location":"kotlin/reference/api-reference/#x402error-sealed-class","title":"X402Error (Sealed Class)","text":"<p>Base sealed class for all X402 protocol errors. Enables exhaustive when expressions.</p> <pre><code>sealed class X402Error(\n    override val message: String,\n    val code: String,\n    val details: Map&lt;String, Any&gt; = emptyMap()\n) : Exception(message)\n</code></pre> <p>Properties: - <code>message</code> (String): Error message - <code>code</code> (String): Error code - <code>details</code> (Map): Additional error details"},{"location":"kotlin/reference/api-reference/#error-types","title":"Error Types","text":""},{"location":"kotlin/reference/api-reference/#paymentrequired_1","title":"PaymentRequired","text":"<pre><code>data class PaymentRequired(\n    val paymentRequest: PaymentRequest,\n    override val message: String = \"Payment required to access this resource\"\n) : X402Error(\n    message = message,\n    code = \"PAYMENT_REQUIRED\",\n    details = mapOf(\"payment_request\" to paymentRequest.toMap())\n)\n</code></pre> <p>Error Code: <code>PAYMENT_REQUIRED</code></p> <p>Example: <pre><code>catch (e: X402Error.PaymentRequired) {\n    val request = e.paymentRequest\n    println(\"Amount: ${request.maxAmountRequired}\")\n}\n</code></pre></p>"},{"location":"kotlin/reference/api-reference/#insufficientfunds","title":"InsufficientFunds","text":"<pre><code>data class InsufficientFunds(\n    val requiredAmount: String,\n    val availableAmount: String,\n    override val message: String = \"Insufficient funds: required $requiredAmount, available $availableAmount\"\n) : X402Error(...)\n</code></pre> <p>Error Code: <code>INSUFFICIENT_FUNDS</code></p>"},{"location":"kotlin/reference/api-reference/#paymentexpired","title":"PaymentExpired","text":"<pre><code>data class PaymentExpired(\n    val paymentRequest: PaymentRequest,\n    override val message: String = \"Payment request has expired\"\n) : X402Error(...)\n</code></pre> <p>Error Code: <code>PAYMENT_EXPIRED</code></p>"},{"location":"kotlin/reference/api-reference/#paymentverificationfailed","title":"PaymentVerificationFailed","text":"<pre><code>data class PaymentVerificationFailed(\n    val reason: String,\n    override val message: String = \"Payment verification failed: $reason\"\n) : X402Error(...)\n</code></pre> <p>Error Code: <code>PAYMENT_VERIFICATION_FAILED</code></p>"},{"location":"kotlin/reference/api-reference/#transactionbroadcastfailed","title":"TransactionBroadcastFailed","text":"<pre><code>data class TransactionBroadcastFailed(\n    val reason: String,\n    override val message: String = \"Transaction broadcast failed: $reason\",\n    override val cause: Throwable? = null\n) : X402Error(...)\n</code></pre> <p>Error Code: <code>TRANSACTION_BROADCAST_FAILED</code></p>"},{"location":"kotlin/reference/api-reference/#invalidpaymentrequest","title":"InvalidPaymentRequest","text":"<pre><code>data class InvalidPaymentRequest(\n    val reason: String,\n    override val message: String = \"Invalid payment request: $reason\",\n    override val cause: Throwable? = null\n) : X402Error(...)\n</code></pre> <p>Error Code: <code>INVALID_PAYMENT_REQUEST</code></p>"},{"location":"kotlin/reference/api-reference/#generic","title":"Generic","text":"<pre><code>data class Generic(\n    val customCode: String,\n    override val message: String,\n    val customDetails: Map&lt;String, Any&gt; = emptyMap()\n) : X402Error(\n    message = message,\n    code = customCode,\n    details = customDetails\n)\n</code></pre> <p>For cases not covered by specific error types.</p>"},{"location":"kotlin/reference/api-reference/#companion-object-methods_2","title":"Companion Object Methods","text":""},{"location":"kotlin/reference/api-reference/#getinfo","title":"getInfo()","text":"<pre><code>companion object {\n    fun getInfo(code: String): ErrorCodeInfo?\n}\n</code></pre> <p>Gets error code information.</p>"},{"location":"kotlin/reference/api-reference/#isretryable","title":"isRetryable()","text":"<pre><code>companion object {\n    fun isRetryable(code: String): Boolean\n}\n</code></pre> <p>Checks if an error code is retryable.</p>"},{"location":"kotlin/reference/api-reference/#getmessage","title":"getMessage()","text":"<pre><code>companion object {\n    fun getMessage(code: String): String?\n}\n</code></pre> <p>Gets the human-readable message for an error code.</p>"},{"location":"kotlin/reference/api-reference/#getuseraction","title":"getUserAction()","text":"<pre><code>companion object {\n    fun getUserAction(code: String): String?\n}\n</code></pre> <p>Gets the suggested user action for an error code.</p>"},{"location":"kotlin/reference/api-reference/#getallcodes","title":"getAllCodes()","text":"<pre><code>companion object {\n    fun getAllCodes(): Map&lt;String, ErrorCodeInfo&gt;\n}\n</code></pre> <p>Gets all error codes and their metadata.</p>"},{"location":"kotlin/reference/api-reference/#errorcodeinfo-data-class","title":"ErrorCodeInfo Data Class","text":"<pre><code>data class ErrorCodeInfo(\n    val code: String,\n    val message: String,\n    val retry: Boolean,\n    val userAction: String\n)\n</code></pre>"},{"location":"kotlin/reference/api-reference/#usage-examples","title":"Usage Examples","text":""},{"location":"kotlin/reference/api-reference/#creating-a-client","title":"Creating a Client","text":"<pre><code>import kotlinx.coroutines.runBlocking\n\nsuspend fun main() {\n    val account = Account(secretKey)\n    val client = X402Client(\n        walletAccount = account,\n        rpcUrl = \"https://api.devnet.solana.com\",\n        allowLocal = false\n    )\n\n    client.use {\n        // Use client\n    }\n}\n\nfun main() = runBlocking { main() }\n</code></pre>"},{"location":"kotlin/reference/api-reference/#making-a-request-with-coroutines","title":"Making a Request with Coroutines","text":"<pre><code>suspend fun makeRequest() {\n    client.use {\n        try {\n            val response = it.get(\"https://api.example.com/data\")\n            println(response.body?.string())\n        } catch (e: X402Error.PaymentRequired) {\n            val request = e.paymentRequest\n            val auth = it.createPayment(request)\n            val retry = it.get(\"https://api.example.com/data\", auth)\n        }\n    }\n}\n</code></pre>"},{"location":"kotlin/reference/api-reference/#using-auto-client-with-dsl","title":"Using Auto Client with DSL","text":"<pre><code>suspend fun autoClientExample() {\n    val client = X402AutoClient(account) {\n        rpcUrl = \"https://api.devnet.solana.com\"\n        maxPaymentAmount = \"5.0\"\n        maxRetries = 2\n    }\n\n    client.use {\n        val response = it.get(\"https://api.example.com/data\")\n    }\n}\n</code></pre>"},{"location":"kotlin/reference/api-reference/#exhaustive-when-expression","title":"Exhaustive When Expression","text":"<pre><code>try {\n    val response = client.get(url)\n} catch (e: X402Error) {\n    when (e) {\n        is X402Error.PaymentRequired -&gt; { /* handle */ }\n        is X402Error.InsufficientFunds -&gt; { /* handle */ }\n        is X402Error.PaymentExpired -&gt; { /* handle */ }\n        is X402Error.PaymentVerificationFailed -&gt; { /* handle */ }\n        is X402Error.TransactionBroadcastFailed -&gt; { /* handle */ }\n        is X402Error.InvalidPaymentRequest -&gt; { /* handle */ }\n        is X402Error.Generic -&gt; { /* handle */ }\n    }\n}\n</code></pre>"},{"location":"kotlin/reference/api-reference/#data-class-operations","title":"Data Class Operations","text":"<pre><code>// Create with named parameters\nval request = PaymentRequest(\n    maxAmountRequired = \"0.10\",\n    assetType = \"SPL\",\n    // ... other fields\n)\n\n// Destructuring\nval (amount, asset, address) = request\n\n// Copy with changes\nval updated = request.copy(maxAmountRequired = \"0.20\")\n\n// Serialization\nval json = request.toJson()\nval parsed = PaymentRequest.fromJson(json)\n</code></pre>"},{"location":"kotlin/reference/api-reference/#concurrent-requests","title":"Concurrent Requests","text":"<pre><code>import kotlinx.coroutines.*\n\nsuspend fun concurrentRequests() = coroutineScope {\n    val urls = listOf(\"url1\", \"url2\", \"url3\")\n\n    val responses = urls.map { url -&gt;\n        async { client.get(url) }\n    }.awaitAll()\n\n    responses.forEach { println(it.code) }\n}\n</code></pre>"},{"location":"kotlin/reference/api-reference/#coroutine-support","title":"Coroutine Support","text":"<p>All HTTP operations are suspend functions that run on <code>Dispatchers.IO</code>:</p> <pre><code>// Internal implementation\nsuspend fun get(url: String): Response = withContext(Dispatchers.IO) {\n    // HTTP request\n}\n</code></pre> <p>Best Practices: - Always call from a coroutine scope - Use structured concurrency - Support cancellation - Handle timeouts with <code>withTimeout</code> - Use proper dispatchers</p>"},{"location":"kotlin/reference/api-reference/#thread-safety","title":"Thread Safety","text":"<ul> <li>X402Client: Not thread-safe. Create separate instances per coroutine.</li> <li>X402AutoClient: Not thread-safe. Create separate instances per coroutine.</li> <li>SolanaPaymentProcessor: Not thread-safe.</li> <li>PaymentRequest: Immutable data class, thread-safe.</li> <li>PaymentAuthorization: Immutable data class, thread-safe.</li> </ul> <p>Recommendation: Use coroutines instead of threads. Each coroutine can safely use the same client instance.</p>"},{"location":"kotlin/reference/api-reference/#resource-management_1","title":"Resource Management","text":"<p>All client classes implement <code>Closeable</code>. Use Kotlin's <code>use</code> function:</p> <pre><code>client.use {\n    // Use client\n} // Automatically closed\n</code></pre> <p>Or manual cleanup:</p> <pre><code>val client = X402Client(account)\ntry {\n    // Use client\n} finally {\n    client.close()\n}\n</code></pre>"},{"location":"kotlin/reference/api-reference/#related-documentation","title":"Related Documentation","text":"<ul> <li>Client Library Guide</li> <li>Error Handling</li> <li>Examples</li> <li>Installation</li> </ul>"},{"location":"kotlin/reference/errors/","title":"Kotlin Error Handling","text":"<p>Comprehensive guide to error handling in the OpenLibX402 Kotlin SDK using sealed classes and when expressions.</p>"},{"location":"kotlin/reference/errors/#error-hierarchy","title":"Error Hierarchy","text":"<p>All X402 errors are part of a sealed class hierarchy, enabling type-safe, exhaustive error handling:</p> <pre><code>X402Error (sealed class, extends Exception)\n\u251c\u2500\u2500 PaymentRequired (data class)\n\u251c\u2500\u2500 InsufficientFunds (data class)\n\u251c\u2500\u2500 PaymentExpired (data class)\n\u251c\u2500\u2500 PaymentVerificationFailed (data class)\n\u251c\u2500\u2500 TransactionBroadcastFailed (data class)\n\u251c\u2500\u2500 InvalidPaymentRequest (data class)\n\u2514\u2500\u2500 Generic (data class)\n</code></pre>"},{"location":"kotlin/reference/errors/#base-sealed-class","title":"Base Sealed Class","text":""},{"location":"kotlin/reference/errors/#x402error","title":"X402Error","text":"<p>Base sealed class for all X402-related errors.</p> <pre><code>sealed class X402Error(\n    override val message: String,\n    val code: String,\n    val details: Map&lt;String, Any&gt; = emptyMap()\n) : Exception(message)\n</code></pre> <p>Common Properties: - <code>message</code> (String): Human-readable error message - <code>code</code> (String): Error code string (e.g., \"PAYMENT_REQUIRED\") - <code>details</code> (Map): Additional error context <p>Benefits of Sealed Classes: - Exhaustive when expressions (compiler checks all cases) - Type-safe error handling - No need for catch-all branches - IDE support for autocomplete</p>"},{"location":"kotlin/reference/errors/#error-types","title":"Error Types","text":""},{"location":"kotlin/reference/errors/#paymentrequired","title":"PaymentRequired","text":"<p>Thrown when server returns 402 Payment Required.</p> <pre><code>data class PaymentRequired(\n    val paymentRequest: PaymentRequest,\n    override val message: String = \"Payment required to access this resource\"\n) : X402Error(\n    message = message,\n    code = \"PAYMENT_REQUIRED\",\n    details = mapOf(\"payment_request\" to paymentRequest.toMap())\n)\n</code></pre> <p>Error Code: <code>PAYMENT_REQUIRED</code></p> <p>When Thrown: - Server responds with HTTP 402 - Payment is required to access resource</p> <p>How to Handle: <pre><code>suspend fun handlePaymentRequired() {\n    try {\n        val response = client.get(url)\n    } catch (e: X402Error.PaymentRequired) {\n        val request = e.paymentRequest\n        println(\"Payment required: ${request.maxAmountRequired} ${request.assetType}\")\n\n        // Create payment and retry\n        val auth = client.createPayment(request)\n        val retry = client.get(url, auth)\n    }\n}\n</code></pre></p>"},{"location":"kotlin/reference/errors/#insufficientfunds","title":"InsufficientFunds","text":"<p>Thrown when account doesn't have enough funds for payment.</p> <pre><code>data class InsufficientFunds(\n    val requiredAmount: String,\n    val availableAmount: String,\n    override val message: String = \"Insufficient funds: required $requiredAmount, available $availableAmount\"\n) : X402Error(\n    message = message,\n    code = \"INSUFFICIENT_FUNDS\",\n    details = mapOf(\n        \"required_amount\" to requiredAmount,\n        \"available_amount\" to availableAmount\n    )\n)\n</code></pre> <p>Error Code: <code>INSUFFICIENT_FUNDS</code></p> <p>When Thrown: - Account balance is less than required payment - Attempting to create payment without sufficient funds</p> <p>How to Handle: <pre><code>try {\n    val auth = client.createPayment(request)\n} catch (e: X402Error.InsufficientFunds) {\n    println(\"Insufficient funds!\")\n    println(\"Required: ${e.requiredAmount} USDC\")\n    println(\"Available: ${e.availableAmount} USDC\")\n\n    val shortfall = e.requiredAmount.toDouble() - e.availableAmount.toDouble()\n    println(\"Need to add: $shortfall USDC\")\n\n    // Prompt user to add funds\n    alertUserToAddFunds(account.publicKey, shortfall)\n}\n</code></pre></p>"},{"location":"kotlin/reference/errors/#paymentexpired","title":"PaymentExpired","text":"<p>Thrown when payment request has expired.</p> <pre><code>data class PaymentExpired(\n    val paymentRequest: PaymentRequest,\n    override val message: String = \"Payment request has expired\"\n) : X402Error(\n    message = message,\n    code = \"PAYMENT_EXPIRED\",\n    details = mapOf(\n        \"payment_request\" to paymentRequest.toMap(),\n        \"expires_at\" to paymentRequest.expiresAt.toString()\n    )\n)\n</code></pre> <p>Error Code: <code>PAYMENT_EXPIRED</code></p> <p>When Thrown: - Payment request's <code>expiresAt</code> timestamp has passed - Attempting to create payment for expired request</p> <p>How to Handle: <pre><code>suspend fun handleExpiredPayment() {\n    try {\n        val auth = client.createPayment(request)\n    } catch (e: X402Error.PaymentExpired) {\n        println(\"Payment request expired at: ${e.paymentRequest.expiresAt}\")\n        println(\"Retrying to get fresh payment request...\")\n\n        // Make new request to get fresh payment details\n        try {\n            val response = client.get(url)\n        } catch (e2: X402Error.PaymentRequired) {\n            // Handle new payment request\n            val newRequest = e2.paymentRequest\n            val auth = client.createPayment(newRequest)\n            val retry = client.get(url, auth)\n        }\n    }\n}\n</code></pre></p>"},{"location":"kotlin/reference/errors/#paymentverificationfailed","title":"PaymentVerificationFailed","text":"<p>Thrown when payment cannot be verified on blockchain.</p> <pre><code>data class PaymentVerificationFailed(\n    val reason: String,\n    override val message: String = \"Payment verification failed: $reason\"\n) : X402Error(\n    message = message,\n    code = \"PAYMENT_VERIFICATION_FAILED\",\n    details = mapOf(\"reason\" to reason)\n)\n</code></pre> <p>Error Code: <code>PAYMENT_VERIFICATION_FAILED</code></p> <p>When Thrown: - Transaction not found on blockchain - Transaction failed or was not confirmed - Server rejected payment proof</p> <p>How to Handle: <pre><code>import kotlinx.coroutines.delay\n\nsuspend fun handleVerificationFailure() {\n    try {\n        val auth = client.createPayment(request)\n        val response = client.get(url, auth)\n    } catch (e: X402Error.PaymentVerificationFailed) {\n        println(\"Payment verification failed: ${e.reason}\")\n\n        // Check transaction status\n        val processor = client.getProcessor()\n        val confirmed = processor.verifyTransaction(auth.signature)\n\n        if (!confirmed) {\n            println(\"Transaction not confirmed, waiting...\")\n            delay(5000)\n            // Retry verification\n        } else {\n            println(\"Transaction confirmed but server rejected it\")\n            // Contact support\n        }\n    }\n}\n</code></pre></p>"},{"location":"kotlin/reference/errors/#transactionbroadcastfailed","title":"TransactionBroadcastFailed","text":"<p>Thrown when transaction cannot be broadcast to blockchain.</p> <pre><code>data class TransactionBroadcastFailed(\n    val reason: String,\n    override val message: String = \"Transaction broadcast failed: $reason\",\n    override val cause: Throwable? = null\n) : X402Error(\n    message = message,\n    code = \"TRANSACTION_BROADCAST_FAILED\",\n    details = mapOf(\"reason\" to reason)\n) {\n    init {\n        cause?.let { initCause(it) }\n    }\n}\n</code></pre> <p>Error Code: <code>TRANSACTION_BROADCAST_FAILED</code></p> <p>When Thrown: - Network error during transaction broadcast - RPC endpoint unavailable - Transaction rejected by blockchain</p> <p>How to Handle: <pre><code>import kotlinx.coroutines.delay\n\nsuspend fun handleBroadcastFailure() {\n    var retries = 0\n    val maxRetries = 3\n\n    while (retries &lt; maxRetries) {\n        try {\n            val auth = client.createPayment(request)\n            break\n        } catch (e: X402Error.TransactionBroadcastFailed) {\n            println(\"Failed to broadcast transaction: ${e.reason}\")\n\n            // Check if it's a network issue\n            if (e.details[\"networkError\"] == true) {\n                println(\"Network error, retrying...\")\n                delay(2000 * (retries + 1))  // Exponential backoff\n                retries++\n            } else {\n                println(\"Transaction rejected: ${e.reason}\")\n                throw e\n            }\n        }\n    }\n}\n</code></pre></p>"},{"location":"kotlin/reference/errors/#invalidpaymentrequest","title":"InvalidPaymentRequest","text":"<p>Thrown when payment request format is invalid.</p> <pre><code>data class InvalidPaymentRequest(\n    val reason: String,\n    override val message: String = \"Invalid payment request: $reason\",\n    override val cause: Throwable? = null\n) : X402Error(\n    message = message,\n    code = \"INVALID_PAYMENT_REQUEST\",\n    details = mapOf(\"reason\" to reason)\n) {\n    init {\n        cause?.let { initCause(it) }\n    }\n}\n</code></pre> <p>Error Code: <code>INVALID_PAYMENT_REQUEST</code></p> <p>When Thrown: - 402 response has invalid JSON format - Required fields missing from payment request - Payment request has invalid values</p> <p>How to Handle: <pre><code>try {\n    val request = client.parsePaymentRequest(response)\n} catch (e: X402Error.InvalidPaymentRequest) {\n    println(\"Invalid payment request: ${e.reason}\")\n    println(\"Server sent malformed payment request\")\n\n    // Log for debugging\n    logger.error { \"Invalid payment request from: $url\" }\n    logger.error { \"Reason: ${e.reason}\" }\n    logger.error { \"Cause: ${e.cause}\" }\n\n    // Contact API provider\n    throw RuntimeException(\"API sent invalid payment request\", e)\n}\n</code></pre></p>"},{"location":"kotlin/reference/errors/#generic","title":"Generic","text":"<p>Generic error for cases not covered by specific error types.</p> <pre><code>data class Generic(\n    val customCode: String,\n    override val message: String,\n    val customDetails: Map&lt;String, Any&gt; = emptyMap()\n) : X402Error(\n    message = message,\n    code = customCode,\n    details = customDetails\n)\n</code></pre> <p>Example: <pre><code>throw X402Error.Generic(\n    customCode = \"PAYMENT_LIMIT_EXCEEDED\",\n    message = \"Payment amount exceeds configured limit\",\n    customDetails = mapOf(\"limit\" to \"1.0\", \"requested\" to \"5.0\")\n)\n</code></pre></p>"},{"location":"kotlin/reference/errors/#exhaustive-when-expressions","title":"Exhaustive When Expressions","text":"<p>Sealed classes enable exhaustive when expressions. The Kotlin compiler ensures all cases are handled:</p>"},{"location":"kotlin/reference/errors/#pattern-1-exhaustive-error-handling","title":"Pattern 1: Exhaustive Error Handling","text":"<pre><code>suspend fun makeRequestWithExhaustiveHandling(url: String) {\n    try {\n        val response = client.get(url)\n        println(response.body?.string())\n\n    } catch (e: X402Error) {\n        when (e) {\n            is X402Error.PaymentRequired -&gt; {\n                val request = e.paymentRequest\n                val auth = client.createPayment(request)\n                client.get(url, auth)\n            }\n            is X402Error.InsufficientFunds -&gt; {\n                println(\"Need: ${e.requiredAmount}, Have: ${e.availableAmount}\")\n                throw RuntimeException(\"Cannot complete payment\", e)\n            }\n            is X402Error.PaymentExpired -&gt; {\n                println(\"Payment expired, retrying...\")\n                makeRequestWithExhaustiveHandling(url)  // Recursive retry\n            }\n            is X402Error.PaymentVerificationFailed -&gt; {\n                println(\"Verification failed: ${e.reason}\")\n                throw RuntimeException(\"Payment not accepted\", e)\n            }\n            is X402Error.TransactionBroadcastFailed -&gt; {\n                println(\"Broadcast failed: ${e.reason}\")\n                throw RuntimeException(\"Cannot broadcast payment\", e)\n            }\n            is X402Error.InvalidPaymentRequest -&gt; {\n                println(\"Invalid request: ${e.reason}\")\n                throw RuntimeException(\"API error\", e)\n            }\n            is X402Error.Generic -&gt; {\n                println(\"Error ${e.code}: ${e.message}\")\n                throw RuntimeException(\"Generic error\", e)\n            }\n        }\n        // No need for 'else' - compiler knows all cases are covered!\n    }\n}\n</code></pre>"},{"location":"kotlin/reference/errors/#pattern-2-grouped-error-handling","title":"Pattern 2: Grouped Error Handling","text":"<pre><code>suspend fun handleErrorsGrouped(url: String) {\n    try {\n        val response = client.get(url)\n    } catch (e: X402Error) {\n        when (e) {\n            // Retryable errors\n            is X402Error.PaymentExpired,\n            is X402Error.TransactionBroadcastFailed -&gt; {\n                println(\"Retryable error: ${e.message}\")\n                // Implement retry logic\n            }\n\n            // User action required\n            is X402Error.InsufficientFunds -&gt; {\n                alertUser(\"Please add ${e.requiredAmount} USDC\")\n            }\n\n            // Automatic handling\n            is X402Error.PaymentRequired -&gt; {\n                val auth = client.createPayment(e.paymentRequest)\n                client.get(url, auth)\n            }\n\n            // Fatal errors\n            is X402Error.PaymentVerificationFailed,\n            is X402Error.InvalidPaymentRequest,\n            is X402Error.Generic -&gt; {\n                logger.error(e) { \"Fatal error: ${e.code}\" }\n                throw e\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"kotlin/reference/errors/#pattern-3-result-based-error-handling","title":"Pattern 3: Result-Based Error Handling","text":"<pre><code>import kotlin.Result\n\nsuspend fun makeRequestWithResult(url: String): Result&lt;String&gt; = try {\n    val response = client.get(url)\n    Result.success(response.body?.string() ?: \"\")\n} catch (e: X402Error) {\n    when (e) {\n        is X402Error.PaymentRequired -&gt; {\n            // Try payment recovery\n            try {\n                val auth = client.createPayment(e.paymentRequest)\n                val retry = client.get(url, auth)\n                Result.success(retry.body?.string() ?: \"\")\n            } catch (paymentError: X402Error) {\n                Result.failure(paymentError)\n            }\n        }\n        else -&gt; Result.failure(e)\n    }\n}\n\n// Usage\nval result = makeRequestWithResult(url)\nresult.onSuccess { data -&gt;\n    println(\"Success: $data\")\n}.onFailure { error -&gt;\n    println(\"Failed: ${error.message}\")\n}\n</code></pre>"},{"location":"kotlin/reference/errors/#pattern-4-retry-logic-with-sealed-classes","title":"Pattern 4: Retry Logic with Sealed Classes","text":"<pre><code>import kotlinx.coroutines.delay\n\nsuspend fun makeRequestWithRetry(\n    url: String,\n    maxRetries: Int = 3\n): Response {\n    var attempt = 0\n    var lastError: X402Error? = null\n\n    while (attempt &lt; maxRetries) {\n        try {\n            return client.get(url)\n\n        } catch (e: X402Error) {\n            lastError = e\n            val shouldRetry = when (e) {\n                is X402Error.PaymentRequired -&gt; {\n                    val auth = client.createPayment(e.paymentRequest)\n                    return client.get(url, auth)\n                }\n                is X402Error.PaymentExpired -&gt; true\n                is X402Error.TransactionBroadcastFailed -&gt; true\n                is X402Error.InsufficientFunds -&gt; false\n                is X402Error.PaymentVerificationFailed -&gt; false\n                is X402Error.InvalidPaymentRequest -&gt; false\n                is X402Error.Generic -&gt; X402Error.isRetryable(e.code)\n            }\n\n            if (shouldRetry &amp;&amp; attempt &lt; maxRetries - 1) {\n                delay(1000L * (attempt + 1))  // Exponential backoff\n                attempt++\n            } else {\n                throw e\n            }\n        }\n    }\n\n    throw lastError ?: X402Error.Generic(\"MAX_RETRIES\", \"Max retries exceeded\")\n}\n</code></pre>"},{"location":"kotlin/reference/errors/#user-friendly-error-messages","title":"User-Friendly Error Messages","text":"<p>Convert technical errors to user-friendly messages:</p> <pre><code>fun getUserFriendlyErrorMessage(e: X402Error): String = when (e) {\n    is X402Error.InsufficientFunds -&gt; {\n        val shortfall = e.requiredAmount.toDouble() - e.availableAmount.toDouble()\n        \"You don't have enough funds. Required: ${e.requiredAmount} USDC, \" +\n        \"Available: ${e.availableAmount} USDC. \" +\n        \"Please add $shortfall USDC to continue.\"\n    }\n    is X402Error.PaymentRequired -&gt; {\n        \"This resource requires a payment of ${e.paymentRequest.maxAmountRequired} USDC. \" +\n        \"Would you like to proceed?\"\n    }\n    is X402Error.PaymentExpired -&gt; {\n        \"The payment request expired. Please try again.\"\n    }\n    is X402Error.PaymentVerificationFailed -&gt; {\n        \"Your payment couldn't be verified. ${e.reason}. \" +\n        \"Please contact support if this persists.\"\n    }\n    is X402Error.TransactionBroadcastFailed -&gt; {\n        \"There was a problem processing your payment. ${e.reason}. \" +\n        \"Please check your connection and try again.\"\n    }\n    is X402Error.InvalidPaymentRequest -&gt; {\n        \"The server sent an invalid payment request. ${e.reason}. \" +\n        \"Please contact the API provider.\"\n    }\n    is X402Error.Generic -&gt; {\n        when (e.code) {\n            \"PAYMENT_LIMIT_EXCEEDED\" -&gt; \"Payment amount exceeds your configured limit.\"\n            \"MAX_RETRIES_EXCEEDED\" -&gt; \"Maximum retry attempts exceeded. Please try again later.\"\n            else -&gt; \"An error occurred: ${e.message}\"\n        }\n    }\n}\n\n// Usage\ntry {\n    val response = client.get(url)\n} catch (e: X402Error) {\n    showUserMessage(getUserFriendlyErrorMessage(e))\n}\n</code></pre>"},{"location":"kotlin/reference/errors/#logging-and-monitoring","title":"Logging and Monitoring","text":"<p>Implement comprehensive logging with sealed classes:</p> <pre><code>import mu.KotlinLogging\n\nprivate val logger = KotlinLogging.logger {}\n\nfun logPaymentError(error: X402Error, context: Map&lt;String, Any&gt; = emptyMap()) {\n    val logData = mutableMapOf&lt;String, Any&gt;()\n    logData.putAll(context)\n    logData[\"error_code\"] = error.code\n    logData[\"error_message\"] = error.message\n    logData.putAll(error.details)\n\n    when (error) {\n        is X402Error.PaymentRequired -&gt; {\n            logger.info { \"Payment required: ${error.paymentRequest.paymentId}\" }\n            logData[\"payment_id\"] = error.paymentRequest.paymentId\n            logData[\"amount\"] = error.paymentRequest.maxAmountRequired\n        }\n        is X402Error.InsufficientFunds -&gt; {\n            logger.error { \"Insufficient funds: ${error.message}\" }\n            logData[\"shortfall\"] = error.requiredAmount.toDouble() - error.availableAmount.toDouble()\n        }\n        is X402Error.PaymentExpired -&gt; {\n            logger.warn { \"Payment expired: ${error.paymentRequest.paymentId}\" }\n        }\n        is X402Error.PaymentVerificationFailed -&gt; {\n            logger.error { \"Verification failed: ${error.reason}\" }\n            logData[\"failure_reason\"] = error.reason\n        }\n        is X402Error.TransactionBroadcastFailed -&gt; {\n            logger.error(error) { \"Broadcast failed: ${error.reason}\" }\n            logData[\"failure_reason\"] = error.reason\n            error.cause?.let { logData[\"cause\"] = it.message ?: \"\" }\n        }\n        is X402Error.InvalidPaymentRequest -&gt; {\n            logger.error(error) { \"Invalid payment request: ${error.reason}\" }\n            logData[\"invalid_reason\"] = error.reason\n        }\n        is X402Error.Generic -&gt; {\n            logger.error { \"Generic error: ${error.code}\" }\n            logData.putAll(error.customDetails)\n        }\n    }\n\n    // Send to monitoring service\n    sendToMonitoring(logData)\n}\n\nprivate fun sendToMonitoring(data: Map&lt;String, Any&gt;) {\n    // Integrate with Datadog, New Relic, etc.\n}\n</code></pre>"},{"location":"kotlin/reference/errors/#extension-functions-for-error-handling","title":"Extension Functions for Error Handling","text":"<p>Create domain-specific extension functions:</p> <pre><code>// Extension to check if error is retryable\nfun X402Error.isRetryable(): Boolean = when (this) {\n    is X402Error.PaymentExpired -&gt; true\n    is X402Error.TransactionBroadcastFailed -&gt; true\n    is X402Error.PaymentVerificationFailed -&gt; false\n    is X402Error.InsufficientFunds -&gt; false\n    is X402Error.PaymentRequired -&gt; false\n    is X402Error.InvalidPaymentRequest -&gt; false\n    is X402Error.Generic -&gt; X402Error.isRetryable(this.code)\n}\n\n// Extension to get suggested wait time before retry\nfun X402Error.getRetryDelay(): Long? = when (this) {\n    is X402Error.PaymentExpired -&gt; 0L  // Retry immediately\n    is X402Error.TransactionBroadcastFailed -&gt; 2000L  // Wait 2 seconds\n    else -&gt; null  // Don't retry\n}\n\n// Extension to check if user action is needed\nfun X402Error.requiresUserAction(): Boolean = when (this) {\n    is X402Error.InsufficientFunds -&gt; true\n    is X402Error.PaymentRequired -&gt; true  // If not auto-handled\n    else -&gt; false\n}\n\n// Usage\ntry {\n    val response = client.get(url)\n} catch (e: X402Error) {\n    if (e.requiresUserAction()) {\n        alertUser(getUserFriendlyErrorMessage(e))\n    } else if (e.isRetryable()) {\n        e.getRetryDelay()?.let { delay -&gt;\n            delay(delay)\n            // Retry\n        }\n    }\n}\n</code></pre>"},{"location":"kotlin/reference/errors/#production-best-practices","title":"Production Best Practices","text":""},{"location":"kotlin/reference/errors/#1-always-handle-insufficient-funds","title":"1. Always Handle Insufficient Funds","text":"<pre><code>suspend fun handlePayment(url: String) {\n    try {\n        val response = autoClient.get(url)\n    } catch (e: X402Error.InsufficientFunds) {\n        // Alert user immediately\n        notifyUser(\"Please add funds to your account\")\n\n        // Log for monitoring\n        logger.error { \"Insufficient funds for user: $userId\" }\n\n        // Send alert to admin dashboard\n        alertDashboard(\"User $userId has insufficient funds\")\n    }\n}\n</code></pre>"},{"location":"kotlin/reference/errors/#2-set-payment-limits","title":"2. Set Payment Limits","text":"<pre><code>val client = X402AutoClient(account) {\n    maxPaymentAmount = \"10.0\"  // Never pay more than 10 USDC\n}\n</code></pre>"},{"location":"kotlin/reference/errors/#3-validate-before-payment","title":"3. Validate Before Payment","text":"<pre><code>suspend fun validateAndPay(request: PaymentRequest) {\n    // Check amount\n    val amount = request.maxAmountRequired.toDouble()\n    require(amount &lt;= MAX_ALLOWED_PAYMENT) {\n        \"Payment exceeds maximum: $amount\"\n    }\n\n    // Check expiration\n    require(!request.isExpired()) {\n        \"Payment request already expired\"\n    }\n\n    // Check balance\n    val processor = client.getProcessor()\n    val balance = processor.getBalance(account.publicKey).toDouble()\n    if (balance &lt; amount) {\n        throw X402Error.InsufficientFunds(\n            requiredAmount = amount.toString(),\n            availableAmount = balance.toString()\n        )\n    }\n\n    // Proceed with payment\n    val auth = client.createPayment(request)\n}\n</code></pre>"},{"location":"kotlin/reference/errors/#4-implement-circuit-breaker","title":"4. Implement Circuit Breaker","text":"<pre><code>class CircuitBreaker {\n    private var failureCount = 0\n    private val failureThreshold = 5\n    private val cooldownMs = 60000L\n    private var lastFailureTime = 0L\n\n    suspend fun shouldAttemptPayment(): Boolean {\n        if (failureCount &gt;= failureThreshold) {\n            if (System.currentTimeMillis() - lastFailureTime &lt; cooldownMs) {\n                return false  // Circuit open\n            } else {\n                reset()  // Try again after cooldown\n            }\n        }\n        return true\n    }\n\n    fun recordFailure() {\n        failureCount++\n        lastFailureTime = System.currentTimeMillis()\n    }\n\n    fun recordSuccess() {\n        reset()\n    }\n\n    private fun reset() {\n        failureCount = 0\n    }\n}\n\n// Usage\nval circuitBreaker = CircuitBreaker()\n\nsuspend fun makePaymentWithCircuitBreaker(request: PaymentRequest) {\n    if (!circuitBreaker.shouldAttemptPayment()) {\n        throw X402Error.Generic(\n            \"CIRCUIT_OPEN\",\n            \"Too many payment failures, circuit breaker is open\"\n        )\n    }\n\n    try {\n        val auth = client.createPayment(request)\n        circuitBreaker.recordSuccess()\n    } catch (e: X402Error) {\n        circuitBreaker.recordFailure()\n        throw e\n    }\n}\n</code></pre>"},{"location":"kotlin/reference/errors/#5-audit-trail-with-data-classes","title":"5. Audit Trail with Data Classes","text":"<pre><code>import kotlinx.datetime.Clock\nimport kotlinx.serialization.Serializable\n\n@Serializable\ndata class PaymentAuditEntry(\n    val timestamp: String,\n    val userId: String,\n    val paymentId: String,\n    val amount: String,\n    val paymentAddress: String,\n    val success: Boolean,\n    val signature: String? = null,\n    val errorCode: String? = null,\n    val errorMessage: String? = null\n)\n\nsuspend fun logPaymentActivity(\n    userId: String,\n    request: PaymentRequest,\n    auth: PaymentAuthorization?,\n    success: Boolean,\n    error: X402Error?\n) {\n    val auditEntry = PaymentAuditEntry(\n        timestamp = Clock.System.now().toString(),\n        userId = userId,\n        paymentId = request.paymentId,\n        amount = request.maxAmountRequired,\n        paymentAddress = request.paymentAddress,\n        success = success,\n        signature = auth?.signature,\n        errorCode = error?.code,\n        errorMessage = error?.message\n    )\n\n    // Save to audit log\n    saveToAuditLog(auditEntry)\n}\n</code></pre>"},{"location":"kotlin/reference/errors/#testing-error-handling","title":"Testing Error Handling","text":""},{"location":"kotlin/reference/errors/#unit-tests-with-sealed-classes","title":"Unit Tests with Sealed Classes","text":"<pre><code>import kotlin.test.Test\nimport kotlin.test.assertEquals\nimport kotlin.test.assertTrue\n\nclass ErrorHandlingTest {\n\n    @Test\n    fun testInsufficientFundsError() {\n        val error = X402Error.InsufficientFunds(\n            requiredAmount = \"1.0\",\n            availableAmount = \"0.5\"\n        )\n\n        assertEquals(\"INSUFFICIENT_FUNDS\", error.code)\n        assertEquals(\"1.0\", error.requiredAmount)\n        assertEquals(\"0.5\", error.availableAmount)\n        assertTrue(error.message.contains(\"Insufficient funds\"))\n    }\n\n    @Test\n    fun testPaymentExpired() {\n        val request = createExpiredPaymentRequest()\n        assertTrue(request.isExpired())\n\n        val error = X402Error.PaymentExpired(request)\n        assertEquals(\"PAYMENT_EXPIRED\", error.code)\n        assertEquals(request, error.paymentRequest)\n    }\n\n    @Test\n    fun testExhaustiveWhenExpression() {\n        val errors = listOf(\n            X402Error.PaymentRequired(createPaymentRequest()),\n            X402Error.InsufficientFunds(\"1.0\", \"0.5\"),\n            X402Error.PaymentExpired(createPaymentRequest()),\n            X402Error.PaymentVerificationFailed(\"Invalid signature\"),\n            X402Error.TransactionBroadcastFailed(\"Network error\"),\n            X402Error.InvalidPaymentRequest(\"Missing field\"),\n            X402Error.Generic(\"CUSTOM\", \"Custom error\")\n        )\n\n        errors.forEach { error -&gt;\n            val handled = when (error) {\n                is X402Error.PaymentRequired -&gt; \"payment_required\"\n                is X402Error.InsufficientFunds -&gt; \"insufficient_funds\"\n                is X402Error.PaymentExpired -&gt; \"expired\"\n                is X402Error.PaymentVerificationFailed -&gt; \"verification_failed\"\n                is X402Error.TransactionBroadcastFailed -&gt; \"broadcast_failed\"\n                is X402Error.InvalidPaymentRequest -&gt; \"invalid_request\"\n                is X402Error.Generic -&gt; \"generic\"\n            }\n            assertTrue(handled.isNotEmpty())\n        }\n    }\n}\n</code></pre>"},{"location":"kotlin/reference/errors/#companion-object-utilities","title":"Companion Object Utilities","text":"<p>The X402Error companion object provides utility methods:</p> <pre><code>// Get error information\nval info = X402Error.getInfo(\"PAYMENT_REQUIRED\")\nprintln(\"Message: ${info?.message}\")\nprintln(\"Retryable: ${info?.retry}\")\nprintln(\"User action: ${info?.userAction}\")\n\n// Check if retryable\nval isRetryable = X402Error.isRetryable(\"PAYMENT_EXPIRED\")\n\n// Get all error codes\nval allCodes = X402Error.getAllCodes()\nallCodes.forEach { (code, info) -&gt;\n    println(\"$code: ${info.message}\")\n}\n</code></pre>"},{"location":"kotlin/reference/errors/#related-documentation","title":"Related Documentation","text":"<ul> <li>API Reference</li> <li>Client Library</li> <li>Examples</li> <li>Installation</li> </ul>"},{"location":"packages/python/openlibx402-client/","title":"OpenLibx402 Client","text":"<p>HTTP client library for making X402-enabled API calls with automatic payment handling.</p>"},{"location":"packages/python/openlibx402-client/#installation","title":"Installation","text":"<pre><code>pip install openlibx402-client\n</code></pre>"},{"location":"packages/python/openlibx402-client/#features","title":"Features","text":"<ul> <li>Explicit Client: Manual control over payment flow</li> <li>Implicit Client: Automatic payment handling with configurable retries</li> <li>Support for all HTTP methods (GET, POST, PUT, DELETE)</li> <li>Safety limits with <code>max_payment_amount</code></li> <li>URL validation and SSRF protection</li> <li>Local development support with <code>allow_local</code></li> <li>Proper connection cleanup and security</li> </ul>"},{"location":"packages/python/openlibx402-client/#usage","title":"Usage","text":""},{"location":"packages/python/openlibx402-client/#explicit-client-manual-control","title":"Explicit Client (Manual Control)","text":"<pre><code>from openlibx402_client import X402Client\nfrom solders.keypair import Keypair\n\n# Load wallet\nkeypair = Keypair()\n\n# Create client\nclient = X402Client(wallet_keypair=keypair)\n\n# Make request\nresponse = await client.get(\"https://api.example.com/data\")\n\n# Check if payment required\nif client.payment_required(response):\n    payment_request = client.parse_payment_request(response)\n\n    # Create payment\n    authorization = await client.create_payment(payment_request)\n\n    # Retry with payment\n    response = await client.get(\n        \"https://api.example.com/data\",\n        payment=authorization\n    )\n\ndata = response.json()\n\n# Always cleanup\nawait client.close()\n</code></pre>"},{"location":"packages/python/openlibx402-client/#local-development","title":"Local Development","text":"<p>For local development with localhost URLs:</p> <pre><code># Enable allow_local for localhost/private IPs\nclient = X402Client(wallet_keypair=keypair, allow_local=True)\n\nresponse = await client.get(\"http://localhost:3000/api/data\")\n\nif client.payment_required(response):\n    payment_request = client.parse_payment_request(response)\n    authorization = await client.create_payment(payment_request)\n    response = await client.get(\n        \"http://localhost:3000/api/data\",\n        payment=authorization\n    )\n\nawait client.close()\n</code></pre>"},{"location":"packages/python/openlibx402-client/#implicit-client-auto-payment","title":"Implicit Client (Auto-Payment)","text":"<pre><code>from openlibx402_client import X402AutoClient\nfrom solders.keypair import Keypair\n\n# Create auto-client with safety limits\nclient = X402AutoClient(\n    wallet_keypair=keypair,\n    max_payment_amount=\"5.0\",  # Safety limit\n    max_retries=1\n)\n\n# Automatically handles 402 and pays\nresponse = await client.fetch(\"https://api.example.com/data\")\ndata = response.json()\n\n# Cleanup\nawait client.close()\n</code></pre>"},{"location":"packages/python/openlibx402-client/#disable-auto-retry","title":"Disable Auto-Retry","text":"<pre><code># Disable auto-retry for specific request\ntry:\n    response = await client.fetch(\n        \"https://api.example.com/data\",\n        auto_retry=False\n    )\nexcept PaymentRequiredError as e:\n    print(f\"Payment required: {e.payment_request.max_amount_required}\")\n</code></pre>"},{"location":"packages/python/openlibx402-client/#security-notes","title":"Security Notes","text":"<ul> <li>Always call <code>close()</code> when done to properly cleanup connections and sensitive data</li> <li>Private keys are held in memory - ensure proper disposal</li> <li>Only use URLs from trusted sources to prevent SSRF attacks</li> <li>Default RPC URL is devnet - use mainnet URL for production</li> <li>Set <code>allow_local=True</code> for local development (localhost URLs)</li> <li>NEVER use <code>allow_local=True</code> in production deployments</li> </ul>"},{"location":"packages/python/openlibx402-client/#api-reference","title":"API Reference","text":""},{"location":"packages/python/openlibx402-client/#x402client","title":"X402Client","text":"<ul> <li><code>get(url, payment=None, **kwargs)</code> - GET request</li> <li><code>post(url, payment=None, **kwargs)</code> - POST request</li> <li><code>put(url, payment=None, **kwargs)</code> - PUT request</li> <li><code>delete(url, payment=None, **kwargs)</code> - DELETE request</li> <li><code>request(method, url, payment=None, **kwargs)</code> - Generic HTTP request</li> <li><code>payment_required(response)</code> - Check if response requires payment</li> <li><code>parse_payment_request(response)</code> - Parse payment request from 402 response</li> <li><code>create_payment(request, amount=None)</code> - Create and broadcast payment</li> <li><code>close()</code> - Cleanup connections and sensitive data</li> </ul>"},{"location":"packages/python/openlibx402-client/#x402autoclient","title":"X402AutoClient","text":"<ul> <li><code>fetch(url, method=\"GET\", auto_retry=None, **kwargs)</code> - Request with auto-payment</li> <li><code>get(url, auto_retry=None, **kwargs)</code> - GET with auto-payment</li> <li><code>post(url, auto_retry=None, **kwargs)</code> - POST with auto-payment</li> <li><code>put(url, auto_retry=None, **kwargs)</code> - PUT with auto-payment</li> <li><code>delete(url, auto_retry=None, **kwargs)</code> - DELETE with auto-payment</li> <li><code>close()</code> - Cleanup connections</li> </ul>"},{"location":"packages/python/openlibx402-client/#license","title":"License","text":"<p>MIT</p>"},{"location":"packages/python/openlibx402-core/","title":"OpenLibx402 Core","text":"<p>Core implementation of the X402 payment protocol for autonomous AI agent payments.</p>"},{"location":"packages/python/openlibx402-core/#installation","title":"Installation","text":"<pre><code>pip install openlibx402-core\n</code></pre>"},{"location":"packages/python/openlibx402-core/#features","title":"Features","text":"<ul> <li>Payment request and authorization data structures</li> <li>Solana blockchain integration</li> <li>Comprehensive error handling</li> <li>Testing utilities with mock implementations</li> </ul>"},{"location":"packages/python/openlibx402-core/#usage","title":"Usage","text":"<pre><code>from openlibx402_core import PaymentRequest, PaymentAuthorization, SolanaPaymentProcessor\n\n# Create payment processor\nprocessor = SolanaPaymentProcessor(\"https://api.devnet.solana.com\")\n\n# Parse payment request from 402 response\nrequest = PaymentRequest.from_dict(response_data)\n\n# Create and send payment\ntransaction = await processor.create_payment_transaction(request, \"0.10\", keypair)\ntx_hash = await processor.sign_and_send_transaction(transaction, keypair)\n\n# Verify transaction\nverified = await processor.verify_transaction(\n    tx_hash,\n    request.payment_address,\n    \"0.10\",\n    request.asset_address\n)\n</code></pre>"},{"location":"packages/python/openlibx402-core/#testing","title":"Testing","text":"<pre><code>from openlibx402_core.testing import MockSolanaPaymentProcessor, create_mock_payment_request\n\n# Use mock processor in tests\nprocessor = MockSolanaPaymentProcessor()\nprocessor.balance = 100.0\n\nrequest = create_mock_payment_request(amount=\"0.10\")\n</code></pre>"},{"location":"packages/python/openlibx402-core/#license","title":"License","text":"<p>MIT</p>"},{"location":"packages/python/openlibx402-fastapi/","title":"OpenLibx402 FastAPI","text":"<p>FastAPI middleware and decorators for X402 payment protocol.</p>"},{"location":"packages/python/openlibx402-fastapi/#installation","title":"Installation","text":"<pre><code>pip install openlibx402-fastapi\n</code></pre>"},{"location":"packages/python/openlibx402-fastapi/#features","title":"Features","text":"<ul> <li>Simple decorator for adding payment requirements</li> <li>Dependency injection pattern for FastAPI</li> <li>Global configuration management</li> <li>Automatic payment verification</li> <li>402 response builders</li> </ul>"},{"location":"packages/python/openlibx402-fastapi/#usage","title":"Usage","text":""},{"location":"packages/python/openlibx402-fastapi/#decorator-approach","title":"Decorator Approach","text":"<pre><code>from fastapi import FastAPI\nfrom openlibx402_fastapi import payment_required\n\napp = FastAPI()\n\n@app.get(\"/premium-data\")\n@payment_required(\n    amount=\"0.10\",\n    payment_address=\"YOUR_WALLET_ADDRESS\",\n    token_mint=\"USDC_MINT_ADDRESS\",\n    description=\"Access to premium market data\"\n)\nasync def get_premium_data():\n    return {\"data\": \"Premium content\"}\n</code></pre>"},{"location":"packages/python/openlibx402-fastapi/#dependency-injection","title":"Dependency Injection","text":"<pre><code>from fastapi import FastAPI, Depends\nfrom openlibx402_fastapi import verify_payment_factory, PaymentAuthorization\n\napp = FastAPI()\n\n@app.get(\"/expensive-data\")\nasync def get_expensive_data(\n    payment: PaymentAuthorization = Depends(\n        verify_payment_factory(\n            amount=\"1.00\",\n            payment_address=\"YOUR_WALLET_ADDRESS\",\n            token_mint=\"USDC_MINT_ADDRESS\"\n        )\n    )\n):\n    return {\n        \"data\": \"Very expensive content\",\n        \"payment_id\": payment.payment_id\n    }\n</code></pre>"},{"location":"packages/python/openlibx402-fastapi/#global-configuration","title":"Global Configuration","text":"<pre><code>from openlibx402_fastapi import X402Config, init_x402\n\nconfig = X402Config(\n    payment_address=\"YOUR_WALLET_ADDRESS\",\n    token_mint=\"USDC_MINT_ADDRESS\",\n    network=\"solana-devnet\"\n)\ninit_x402(config)\n\n@app.get(\"/data\")\n@payment_required(amount=\"0.05\")  # Uses global config\nasync def get_data():\n    return {\"data\": \"content\"}\n</code></pre>"},{"location":"packages/python/openlibx402-fastapi/#license","title":"License","text":"<p>MIT</p>"},{"location":"packages/python/openlibx402-langchain/","title":"OpenLibx402 LangChain","text":"<p>LangChain integration for X402 payment protocol.</p>"},{"location":"packages/python/openlibx402-langchain/#installation","title":"Installation","text":"<pre><code>pip install openlibx402-langchain\n</code></pre>"},{"location":"packages/python/openlibx402-langchain/#features","title":"Features","text":"<ul> <li>X402PaymentTool for LangChain agents</li> <li>X402RequestsWrapper for automatic payment handling</li> <li>Convenience function for creating X402-enabled agents</li> </ul>"},{"location":"packages/python/openlibx402-langchain/#usage","title":"Usage","text":""},{"location":"packages/python/openlibx402-langchain/#using-x402paymenttool","title":"Using X402PaymentTool","text":"<pre><code>from langchain.chat_models import ChatOpenAI\nfrom langchain.agents import initialize_agent, AgentType\nfrom openlibx402_langchain import X402PaymentTool\nfrom solders.keypair import Keypair\n\nkeypair = Keypair()\n\npayment_tool = X402PaymentTool(\n    wallet_keypair=keypair,\n    max_payment=\"5.0\"\n)\n\nagent = initialize_agent(\n    tools=[payment_tool],\n    llm=ChatOpenAI(),\n    agent=AgentType.ZERO_SHOT_REACT_DESCRIPTION\n)\n\nresponse = agent.run(\"Get premium data from https://api.example.com/data\")\n</code></pre>"},{"location":"packages/python/openlibx402-langchain/#using-x402requestswrapper","title":"Using X402RequestsWrapper","text":"<pre><code>from langchain.agents import load_tools\nfrom openlibx402_langchain import X402RequestsWrapper\n\nrequests_wrapper = X402RequestsWrapper(\n    wallet_keypair=keypair,\n    max_payment=\"1.0\"\n)\n\ntools = load_tools(\n    [\"requests_all\"],\n    llm=ChatOpenAI(),\n    requests_wrapper=requests_wrapper\n)\n\nagent = initialize_agent(tools=tools, llm=ChatOpenAI())\n</code></pre>"},{"location":"packages/python/openlibx402-langchain/#convenience-function","title":"Convenience Function","text":"<pre><code>from openlibx402_langchain import create_x402_agent\n\nagent = create_x402_agent(\n    wallet_keypair=keypair,\n    max_payment=\"5.0\"\n)\n\nresponse = agent.run(\"Get premium data from API\")\n</code></pre>"},{"location":"packages/python/openlibx402-langchain/#license","title":"License","text":"<p>MIT</p>"},{"location":"packages/python/openlibx402-langgraph/","title":"OpenLibx402 LangGraph","text":"<p>LangGraph integration for X402 payment protocol.</p>"},{"location":"packages/python/openlibx402-langgraph/#installation","title":"Installation","text":"<pre><code>pip install openlibx402-langgraph\n</code></pre>"},{"location":"packages/python/openlibx402-langgraph/#features","title":"Features","text":"<ul> <li>Payment nodes for LangGraph workflows</li> <li>Async and sync node implementations</li> <li>Conditional edge functions for routing</li> <li>State management utilities</li> <li>Simple workflow creator</li> </ul>"},{"location":"packages/python/openlibx402-langgraph/#usage","title":"Usage","text":""},{"location":"packages/python/openlibx402-langgraph/#basic-payment-node","title":"Basic Payment Node","text":"<pre><code>from langgraph.graph import StateGraph, END\nfrom openlibx402_langgraph import payment_node, check_payment_required\nfrom solders.keypair import Keypair\n\nclass AgentState(TypedDict):\n    api_url: str\n    api_response: str\n    payment_required: bool\n    payment_completed: bool\n    wallet_keypair: Keypair\n\nworkflow = StateGraph(AgentState)\n\nworkflow.add_node(\"fetch\", fetch_api_node)\nworkflow.add_node(\"pay\", payment_node)\nworkflow.add_node(\"process\", process_node)\n\nworkflow.add_conditional_edges(\n    \"fetch\",\n    check_payment_required,\n    {\n        \"payment_required\": \"pay\",\n        \"success\": \"process\",\n        \"error\": END\n    }\n)\n\nworkflow.add_edge(\"pay\", \"fetch\")\nworkflow.add_edge(\"process\", END)\n\napp = workflow.compile()\n</code></pre>"},{"location":"packages/python/openlibx402-langgraph/#combined-fetch-payment-node","title":"Combined Fetch + Payment Node","text":"<pre><code>from openlibx402_langgraph import fetch_with_payment_node\n\nworkflow.add_node(\"fetch\", fetch_with_payment_node)\nworkflow.set_entry_point(\"fetch\")\nworkflow.add_edge(\"fetch\", \"process\")\n</code></pre>"},{"location":"packages/python/openlibx402-langgraph/#simple-workflow-helper","title":"Simple Workflow Helper","text":"<pre><code>from openlibx402_langgraph import create_simple_payment_workflow\n\nworkflow = create_simple_payment_workflow(\n    wallet_keypair=keypair,\n    api_url=\"https://api.example.com/data\"\n)\n\nresult = workflow({})\nprint(result[\"api_response\"])\n</code></pre>"},{"location":"packages/python/openlibx402-langgraph/#license","title":"License","text":"<p>MIT</p>"},{"location":"packages/typescript/openlibx402-client/","title":"@openlibx402/client","text":"<p>TypeScript HTTP client for X402 payment protocol.</p>"},{"location":"packages/typescript/openlibx402-client/#installation","title":"Installation","text":"<pre><code>npm install @openlibx402/client\n</code></pre>"},{"location":"packages/typescript/openlibx402-client/#features","title":"Features","text":"<ul> <li>Explicit Client: Manual control over payment flow</li> <li>Implicit Client: Automatic payment handling with configurable retries</li> <li>Support for all HTTP methods (GET, POST, PUT, DELETE)</li> <li>Safety limits with <code>maxPaymentAmount</code></li> <li>URL validation and SSRF protection</li> <li>Local development support with <code>allowLocal</code></li> <li>Proper connection cleanup and security</li> </ul>"},{"location":"packages/typescript/openlibx402-client/#usage","title":"Usage","text":""},{"location":"packages/typescript/openlibx402-client/#explicit-client-manual-control","title":"Explicit Client (Manual Control)","text":"<pre><code>import { X402Client } from '@openlibx402/client';\nimport { Keypair } from '@solana/web3.js';\n\n// Load wallet\nconst keypair = new Keypair();\n\n// Create client\nconst client = new X402Client(keypair);\n\n// Make request\nlet response = await client.get(\"https://api.example.com/data\");\n\n// Check if payment required\nif (client.paymentRequired(response)) {\n  const paymentRequest = client.parsePaymentRequest(response);\n\n  // Create payment\n  const authorization = await client.createPayment(paymentRequest);\n\n  // Retry with payment\n  response = await client.get(\"https://api.example.com/data\", { payment: authorization });\n}\n\nconst data = response.data;\n\n// Always cleanup\nawait client.close();\n</code></pre>"},{"location":"packages/typescript/openlibx402-client/#local-development","title":"Local Development","text":"<p>For local development with localhost URLs:</p> <pre><code>// Enable allowLocal for localhost/private IPs\nconst client = new X402Client(keypair, undefined, undefined, true);\n\nlet response = await client.get(\"http://localhost:3000/api/data\");\n\nif (client.paymentRequired(response)) {\n  const paymentRequest = client.parsePaymentRequest(response);\n  const authorization = await client.createPayment(paymentRequest);\n  response = await client.get(\"http://localhost:3000/api/data\", { payment: authorization });\n}\n\nawait client.close();\n</code></pre>"},{"location":"packages/typescript/openlibx402-client/#implicit-client-auto-payment","title":"Implicit Client (Auto-Payment)","text":"<pre><code>import { X402AutoClient } from '@openlibx402/client';\nimport { Keypair } from '@solana/web3.js';\n\n// Create auto-client with safety limits\nconst client = new X402AutoClient(keypair, undefined, {\n  maxPaymentAmount: \"5.0\",  // Safety limit\n  maxRetries: 1\n});\n\n// Automatically handles 402 and pays\nconst response = await client.fetch(\"https://api.example.com/data\");\nconst data = response.data;\n\n// Cleanup\nawait client.close();\n</code></pre>"},{"location":"packages/typescript/openlibx402-client/#disable-auto-retry","title":"Disable Auto-Retry","text":"<pre><code>// Disable auto-retry for specific request\ntry {\n  const response = await client.fetch(\"https://api.example.com/data\", {\n    autoRetry: false\n  });\n} catch (error) {\n  if (error instanceof PaymentRequiredError) {\n    console.log(`Payment required: ${error.paymentRequest.maxAmountRequired}`);\n  }\n}\n</code></pre>"},{"location":"packages/typescript/openlibx402-client/#security-notes","title":"Security Notes","text":"<ul> <li>Always call <code>close()</code> when done to properly cleanup connections and sensitive data</li> <li>Private keys are held in memory - ensure proper disposal</li> <li>Only use URLs from trusted sources to prevent SSRF attacks</li> <li>Default RPC URL is devnet - use mainnet URL for production</li> <li>Set <code>allowLocal=true</code> for local development (localhost URLs)</li> <li>NEVER use <code>allowLocal=true</code> in production deployments</li> </ul>"},{"location":"packages/typescript/openlibx402-client/#api-reference","title":"API Reference","text":""},{"location":"packages/typescript/openlibx402-client/#x402client","title":"X402Client","text":"<ul> <li><code>get(url, options?)</code> - GET request</li> <li><code>post(url, data?, options?)</code> - POST request</li> <li><code>put(url, data?, options?)</code> - PUT request</li> <li><code>delete(url, options?)</code> - DELETE request</li> <li><code>request(method, url, options?)</code> - Generic HTTP request</li> <li><code>paymentRequired(response)</code> - Check if response requires payment</li> <li><code>parsePaymentRequest(response)</code> - Parse payment request from 402 response</li> <li><code>createPayment(request, amount?)</code> - Create and broadcast payment</li> <li><code>close()</code> - Cleanup connections and sensitive data</li> </ul>"},{"location":"packages/typescript/openlibx402-client/#x402autoclient","title":"X402AutoClient","text":"<ul> <li><code>fetch(url, options?)</code> - Request with auto-payment</li> <li><code>get(url, options?)</code> - GET with auto-payment</li> <li><code>post(url, data?, options?)</code> - POST with auto-payment</li> <li><code>put(url, data?, options?)</code> - PUT with auto-payment</li> <li><code>delete(url, options?)</code> - DELETE with auto-payment</li> <li><code>close()</code> - Cleanup connections</li> </ul>"},{"location":"packages/typescript/openlibx402-client/#license","title":"License","text":"<p>MIT</p>"},{"location":"packages/typescript/openlibx402-core/","title":"@openlibx402/core","text":"<p>Core TypeScript library for X402 payment protocol.</p>"},{"location":"packages/typescript/openlibx402-core/#installation","title":"Installation","text":"<pre><code>npm install @openlibx402/core\n</code></pre>"},{"location":"packages/typescript/openlibx402-core/#features","title":"Features","text":"<ul> <li>Payment request and authorization structures</li> <li>Solana blockchain integration</li> <li>HTTP 402 protocol support</li> <li>TypeScript types and interfaces</li> </ul>"},{"location":"packages/typescript/openlibx402-core/#usage","title":"Usage","text":"<pre><code>import { PaymentRequest, SolanaPaymentProcessor } from '@openlibx402/core';\nimport { Keypair } from '@solana/web3.js';\n\nconst processor = new SolanaPaymentProcessor('https://api.devnet.solana.com');\n\nconst request: PaymentRequest = {\n  paymentAddress: 'wallet_address',\n  amount: '0.10',\n  assetAddress: 'token_mint'\n};\n\nconst transaction = await processor.createPaymentTransaction(request, keypair);\nconst txHash = await processor.signAndSendTransaction(transaction, keypair);\n</code></pre>"},{"location":"packages/typescript/openlibx402-core/#license","title":"License","text":"<p>MIT</p>"},{"location":"packages/typescript/openlibx402-express/","title":"@openlibx402/express","text":"<p>Express.js middleware and decorators for X402 payment protocol.</p>"},{"location":"packages/typescript/openlibx402-express/#installation","title":"Installation","text":"<pre><code>npm install @openlibx402/express\n</code></pre>"},{"location":"packages/typescript/openlibx402-express/#features","title":"Features","text":"<ul> <li>Express middleware for payment requirements</li> <li>Automatic payment verification</li> <li>402 response handling</li> <li>TypeScript support</li> </ul>"},{"location":"packages/typescript/openlibx402-express/#usage","title":"Usage","text":"<pre><code>import express from 'express';\nimport { paymentRequired } from '@openlibx402/express';\n\nconst app = express();\n\napp.get('/premium-data', paymentRequired({\n  amount: '0.10',\n  paymentAddress: 'YOUR_WALLET_ADDRESS',\n  tokenMint: 'USDC_MINT_ADDRESS',\n  description: 'Access to premium data'\n}), (req, res) =&gt; {\n  res.json({ data: 'Premium content' });\n});\n</code></pre>"},{"location":"packages/typescript/openlibx402-express/#license","title":"License","text":"<p>MIT</p>"},{"location":"packages/typescript/openlibx402-langchain/","title":"@openlibx402/langchain","text":"<p>LangChain.js integration for X402 payment protocol.</p>"},{"location":"packages/typescript/openlibx402-langchain/#installation","title":"Installation","text":"<pre><code>npm install @openlibx402/langchain\n</code></pre>"},{"location":"packages/typescript/openlibx402-langchain/#features","title":"Features","text":"<ul> <li>LangChain tools for X402 payments</li> <li>AI agent payment handling</li> <li>Automatic payment workflows</li> <li>TypeScript support</li> </ul>"},{"location":"packages/typescript/openlibx402-langchain/#usage","title":"Usage","text":"<pre><code>import { X402PaymentTool } from '@openlibx402/langchain';\nimport { ChatOpenAI } from 'langchain/chat_models/openai';\nimport { initializeAgent } from 'langchain/agents';\n\nconst paymentTool = new X402PaymentTool({\n  wallet: keypair,\n  maxPayment: '5.0'\n});\n\nconst agent = await initializeAgent({\n  tools: [paymentTool],\n  llm: new ChatOpenAI()\n});\n\nconst response = await agent.call({ input: 'Get premium data from API' });\n</code></pre>"},{"location":"packages/typescript/openlibx402-langchain/#license","title":"License","text":"<p>MIT</p>"},{"location":"packages/typescript/openlibx402-langgraph/","title":"@openlibx402/langgraph","text":"<p>LangGraph.js integration for X402 payment protocol.</p>"},{"location":"packages/typescript/openlibx402-langgraph/#installation","title":"Installation","text":"<pre><code>npm install @openlibx402/langgraph\n</code></pre>"},{"location":"packages/typescript/openlibx402-langgraph/#features","title":"Features","text":"<ul> <li>LangGraph nodes for payments</li> <li>Workflow integration</li> <li>AI agent payment workflows</li> <li>TypeScript support</li> </ul>"},{"location":"packages/typescript/openlibx402-langgraph/#usage","title":"Usage","text":"<pre><code>import { paymentNode } from '@openlibx402/langgraph';\nimport { StateGraph } from '@langchain/langgraph';\n\nconst workflow = new StateGraph();\n\nworkflow.addNode('pay', paymentNode);\nworkflow.addNode('fetch', fetchNode);\n\nworkflow.addEdge('pay', 'fetch');\n\nconst app = workflow.compile();\n</code></pre>"},{"location":"packages/typescript/openlibx402-langgraph/#license","title":"License","text":"<p>MIT</p>"},{"location":"packages/typescript/openlibx402-nextjs/","title":"@openlibx402/nextjs","text":"<p>Next.js middleware and utilities for the X402 payment protocol. This package provides seamless integration of blockchain-based micropayments into your Next.js applications.</p>"},{"location":"packages/typescript/openlibx402-nextjs/#installation","title":"Installation","text":"<pre><code>npm install @openlibx402/nextjs @openlibx402/core @solana/web3.js\n</code></pre>"},{"location":"packages/typescript/openlibx402-nextjs/#features","title":"Features","text":"<ul> <li>App Router Support - Built for Next.js 13+ App Router</li> <li>Payment Verification - Automatic on-chain payment verification</li> <li>TypeScript - Full type safety</li> <li>Flexible Configuration - Global or per-route configuration</li> <li>Easy Integration - Simple higher-order function API</li> </ul>"},{"location":"packages/typescript/openlibx402-nextjs/#usage","title":"Usage","text":"<pre><code>import { X402Config, initX402, withPayment } from '@openlibx402/nextjs';\n\n// Initialize configuration\nconst config = new X402Config({\n  paymentAddress: process.env.PAYMENT_WALLET_ADDRESS!,\n  tokenMint: process.env.USDC_MINT_ADDRESS!,\n  network: 'solana-devnet',\n});\n\ninitX402(config);\n\n// Protect API routes\nexport const GET = withPayment(\n  {\n    amount: '0.10',\n    description: 'Access to premium data',\n  },\n  async (req, context) =&gt; {\n    return NextResponse.json({\n      data: 'Premium content',\n      payment_id: context.payment?.paymentId,\n    });\n  }\n);\n</code></pre>"},{"location":"packages/typescript/openlibx402-nextjs/#license","title":"License","text":"<p>MIT</p>"},{"location":"rust/","title":"Rust Implementation","text":"<p>Welcome to the OpenLibx402 Rust implementation documentation. This section covers all Rust packages, libraries, middleware, and examples for building X402-enabled APIs and clients with type-safe, high-performance code.</p>"},{"location":"rust/#overview","title":"Overview","text":"<p>The Rust implementation provides:</p> <ul> <li>Core Library - X402 protocol implementation with models, errors, and Solana payment processing</li> <li>Client Library - HTTP client with automatic and explicit payment handling</li> <li>Middleware - Integration with popular Rust web frameworks (Rocket, Actix Web)</li> <li>Examples - Complete working examples for server and client implementations</li> </ul>"},{"location":"rust/#quick-navigation","title":"Quick Navigation","text":""},{"location":"rust/#libraries","title":"\ud83d\udcda Libraries","text":"<ul> <li>Core Library - Payment models, errors, and Solana processor</li> <li>Client Library - X402 HTTP client with auto-payment support</li> </ul>"},{"location":"rust/#middleware","title":"\ud83d\udd17 Middleware","text":"<ul> <li>Rocket Middleware - Rocket web framework integration</li> <li>Actix Web Middleware - Actix Web framework integration</li> </ul>"},{"location":"rust/#examples","title":"\ud83d\ude80 Examples","text":"<ul> <li>Rocket Server - Complete server with multiple pricing tiers</li> <li>Actix Web Server - Actix Web server with dynamic pricing</li> </ul>"},{"location":"rust/#getting-started","title":"\ud83d\udcd6 Getting Started","text":"<ul> <li>Installation</li> <li>Quick Start Server</li> <li>Quick Start Client</li> </ul>"},{"location":"rust/#reference","title":"\ud83d\udd27 Reference","text":"<ul> <li>API Reference</li> <li>Configuration</li> <li>Error Handling</li> </ul>"},{"location":"rust/#key-features","title":"Key Features","text":"<p>\u2728 Type-Safe - Compile-time guarantees with Rust's type system \ud83e\udd16 Automatic Payments - Clients automatically handle payment flows \u26a1 High Performance - Zero-copy, async-first design with Tokio \ud83d\udcb0 Micropayments - Support payments as low as $0.001 \ud83d\udd10 Secure - Memory-safe, payment verification, nonce-based replay protection \ud83c\udf10 Framework Agnostic - Works with Rocket, Actix Web, and custom implementations</p>"},{"location":"rust/#crate-dependencies","title":"Crate Dependencies","text":"<pre><code>[dependencies]\n# Core protocol\nopenlibx402-core = \"0.1\"\n\n# HTTP client\nopenlibx402-client = \"0.1\"\n\n# Rocket middleware\nopenlibx402-rocket = \"0.1\"\n\n# Actix Web middleware\nopenlibx402-actix = \"0.1\"\n</code></pre>"},{"location":"rust/#installation","title":"Installation","text":"<pre><code># Core package (required)\ncargo add openlibx402-core\n\n# Client (for consuming paid APIs)\ncargo add openlibx402-client\n\n# Middleware for your framework\ncargo add openlibx402-rocket\n# or\ncargo add openlibx402-actix\n</code></pre>"},{"location":"rust/#the-x402-flow","title":"The X402 Flow","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  AI Agent   \u2502  \u25001\u2500\u2192   \u2502  API Server  \u2502         \u2502 Blockchain \u2502\n\u2502   (Client)  \u2502         \u2502   (Server)   \u2502         \u2502  (Solana)  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n     \u2502                        \u2502                        \u2502\n     \u2502  GET /data             \u2502                        \u2502\n     \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192\u2502                        \u2502\n     \u2502                        \u2502                        \u2502\n     \u2502  402 Payment Required  \u2502                        \u2502\n     \u2502  + Payment Details     \u2502                        \u2502\n     \u2502\u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524                        \u2502\n     \u2502                        \u2502                        \u2502\n     \u2502  Create &amp; Broadcast    \u2502                        \u2502\n     \u2502  Payment Transaction   \u2502                        \u2502\n     \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192\u2502\n     \u2502                        \u2502                        \u2502\n     \u2502                        \u2502   Verify Transaction   \u2502\n     \u2502                        \u2502\u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n     \u2502                        \u2502                        \u2502\n     \u2502  GET /data             \u2502                        \u2502\n     \u2502  + Payment Auth Header \u2502                        \u2502\n     \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192\u2502                        \u2502\n     \u2502                        \u2502                        \u2502\n     \u2502  200 OK + Data         \u2502                        \u2502\n     \u2502\u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524                        \u2502\n</code></pre>"},{"location":"rust/#why-rust","title":"Why Rust?","text":"<p>Rust is an excellent choice for X402 implementations:</p> <ul> <li>Safety - Memory safety without garbage collection</li> <li>Performance - Zero-cost abstractions and minimal runtime</li> <li>Concurrency - Fearless concurrency with async/await</li> <li>Reliability - Catch bugs at compile time</li> <li>Ecosystem - Rich ecosystem of web frameworks and blockchain tools</li> </ul>"},{"location":"rust/#support","title":"Support","text":"<p>For issues, questions, or contributions: - GitHub Issues - GitHub Discussions - X402 Protocol - Rust Documentation</p>"},{"location":"rust/#next-steps","title":"Next Steps","text":"<p>Start with the Installation guide and choose your path:</p> <ul> <li>Building a Server? \u2192 Server Quick Start</li> <li>Building a Client? \u2192 Client Quick Start</li> <li>Need Details? \u2192 API Reference</li> </ul>"},{"location":"rust/examples/actix-server/","title":"Actix Web Server Example","text":"<p>Complete example of an X402-enabled API server using Actix Web with multiple pricing tiers.</p>"},{"location":"rust/examples/actix-server/#source-code","title":"Source Code","text":"<p>Location: <code>examples/rust/actix-server/</code></p>"},{"location":"rust/examples/actix-server/#overview","title":"Overview","text":"<p>This example demonstrates: - Free and paid endpoints - Multiple pricing tiers ($0.01, $0.10, $1.00) - Payment requirement configuration - Health check endpoint</p>"},{"location":"rust/examples/actix-server/#running-the-example","title":"Running the Example","text":"<pre><code>cd examples/rust/actix-server\ncargo run\n</code></pre> <p>Server starts on <code>http://localhost:8080</code></p>"},{"location":"rust/examples/actix-server/#endpoints","title":"Endpoints","text":"Endpoint Price Description <code>GET /</code> Free Welcome message <code>GET /basic</code> $0.01 Basic tier data <code>GET /premium</code> $0.10 Premium tier data <code>GET /enterprise</code> $1.00 Enterprise tier data <code>GET /health</code> Free Health check"},{"location":"rust/examples/actix-server/#testing","title":"Testing","text":""},{"location":"rust/examples/actix-server/#free-endpoint","title":"Free Endpoint","text":"<pre><code>curl http://localhost:8080/\n</code></pre> <p>Response: <pre><code>{\n  \"message\": \"Welcome to the X402 Actix Web example server!\"\n}\n</code></pre></p>"},{"location":"rust/examples/actix-server/#payment-required","title":"Payment Required","text":"<pre><code>curl -v http://localhost:8080/premium\n</code></pre> <p>Response (402 Payment Required): <pre><code>{\n  \"max_amount_required\": \"0.10\",\n  \"asset_type\": \"SPL\",\n  \"asset_address\": \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\",\n  \"payment_address\": \"7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU\",\n  \"network\": \"solana-devnet\",\n  \"expires_at\": \"2025-10-31T12:05:00Z\",\n  \"nonce\": \"abc-123-def\",\n  \"payment_id\": \"pay-456-ghi\",\n  \"resource\": \"/premium\",\n  \"description\": \"Access to premium tier data\"\n}\n</code></pre></p>"},{"location":"rust/examples/actix-server/#complete-code","title":"Complete Code","text":"<pre><code>use actix_web::{get, web, App, HttpResponse, HttpServer};\nuse openlibx402_actix::{\n    create_payment_request, payment_required_response, PaymentExtractor, PaymentRequirement,\n    X402Config, X402State,\n};\nuse serde::{Deserialize, Serialize};\n\n#[derive(Debug, Serialize, Deserialize)]\nstruct PremiumData {\n    message: String,\n    data: Vec&lt;String&gt;,\n    tier: String,\n}\n\n#[derive(Debug, Serialize, Deserialize)]\nstruct BasicData {\n    message: String,\n}\n\n/// Free endpoint\n#[get(\"/\")]\nasync fn index() -&gt; HttpResponse {\n    HttpResponse::Ok().json(BasicData {\n        message: \"Welcome to the X402 Actix Web example server!\".to_string(),\n    })\n}\n\n/// Basic tier - $0.01\n#[get(\"/basic\")]\nasync fn basic_tier(\n    state: web::Data&lt;X402State&gt;,\n    auth: Option&lt;PaymentExtractor&gt;,\n) -&gt; HttpResponse {\n    match auth {\n        Some(auth) =&gt; {\n            HttpResponse::Ok().json(PremiumData {\n                message: \"Access granted to basic tier\".to_string(),\n                data: vec![\n                    \"Basic data point 1\".to_string(),\n                    \"Basic data point 2\".to_string(),\n                ],\n                tier: \"basic\".to_string(),\n            })\n        }\n        None =&gt; {\n            let requirement =\n                PaymentRequirement::new(\"0.01\").with_description(\"Access to basic tier data\");\n            let payment_request = create_payment_request(&amp;state.config, &amp;requirement, \"/basic\");\n            payment_required_response(payment_request)\n        }\n    }\n}\n\n/// Premium tier - $0.10\n#[get(\"/premium\")]\nasync fn premium_tier(\n    state: web::Data&lt;X402State&gt;,\n    auth: Option&lt;PaymentExtractor&gt;,\n) -&gt; HttpResponse {\n    match auth {\n        Some(auth) =&gt; {\n            HttpResponse::Ok().json(PremiumData {\n                message: \"Access granted to premium tier\".to_string(),\n                data: vec![\n                    \"Premium insight 1\".to_string(),\n                    \"Premium insight 2\".to_string(),\n                    \"Premium insight 3\".to_string(),\n                    \"Exclusive data point\".to_string(),\n                ],\n                tier: \"premium\".to_string(),\n            })\n        }\n        None =&gt; {\n            let requirement = PaymentRequirement::new(\"0.10\")\n                .with_description(\"Access to premium tier data\")\n                .with_expires_in(600);\n            let payment_request = create_payment_request(&amp;state.config, &amp;requirement, \"/premium\");\n            payment_required_response(payment_request)\n        }\n    }\n}\n\n/// Enterprise tier - $1.00\n#[get(\"/enterprise\")]\nasync fn enterprise_tier(\n    state: web::Data&lt;X402State&gt;,\n    auth: Option&lt;PaymentExtractor&gt;,\n) -&gt; HttpResponse {\n    match auth {\n        Some(auth) =&gt; {\n            HttpResponse::Ok().json(PremiumData {\n                message: \"Access granted to enterprise tier\".to_string(),\n                data: vec![\n                    \"Enterprise analytics 1\".to_string(),\n                    \"Enterprise analytics 2\".to_string(),\n                    \"Enterprise analytics 3\".to_string(),\n                    \"Enterprise analytics 4\".to_string(),\n                    \"Confidential market data\".to_string(),\n                    \"Advanced predictions\".to_string(),\n                ],\n                tier: \"enterprise\".to_string(),\n            })\n        }\n        None =&gt; {\n            let requirement = PaymentRequirement::new(\"1.00\")\n                .with_description(\"Access to enterprise tier data and analytics\");\n            let payment_request =\n                create_payment_request(&amp;state.config, &amp;requirement, \"/enterprise\");\n            payment_required_response(payment_request)\n        }\n    }\n}\n\n/// Health check\n#[get(\"/health\")]\nasync fn health() -&gt; &amp;'static str {\n    \"OK\"\n}\n\n#[actix_web::main]\nasync fn main() -&gt; std::io::Result&lt;()&gt; {\n    // Configure X402\n    let config = X402Config {\n        payment_address: \"7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU\".to_string(),\n        token_mint: \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\".to_string(),\n        network: \"solana-devnet\".to_string(),\n        rpc_url: None,\n        auto_verify: true,\n    };\n\n    let state = web::Data::new(X402State {\n        config: config.clone(),\n    });\n\n    println!(\"\\n\ud83c\udf10 Starting Actix Web X402 Example Server\");\n    println!(\"=========================================\");\n    println!(\"Payment Address: {}\", config.payment_address);\n    println!(\"Token Mint: {}\", config.token_mint);\n    println!(\"Network: {}\", config.network);\n    println!(\"\\nEndpoints:\");\n    println!(\"  - GET  /          : Free endpoint (no payment)\");\n    println!(\"  - GET  /basic     : Basic tier ($0.01)\");\n    println!(\"  - GET  /premium   : Premium tier ($0.10)\");\n    println!(\"  - GET  /enterprise: Enterprise tier ($1.00)\");\n    println!(\"  - GET  /health    : Health check\");\n    println!(\"\\nServer running at http://127.0.0.1:8080\\n\");\n\n    HttpServer::new(move || {\n        App::new()\n            .app_data(state.clone())\n            .service(index)\n            .service(basic_tier)\n            .service(premium_tier)\n            .service(enterprise_tier)\n            .service(health)\n    })\n    .bind((\"127.0.0.1\", 8080))?\n    .run()\n    .await\n}\n</code></pre>"},{"location":"rust/examples/actix-server/#configuration","title":"Configuration","text":"<p>Update the wallet addresses in the code:</p> <pre><code>let config = X402Config {\n    payment_address: \"YOUR_WALLET_ADDRESS\".to_string(),  // Replace with your wallet\n    token_mint: \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\".to_string(),  // USDC Devnet\n    network: \"solana-devnet\".to_string(),\n    rpc_url: None,\n    auto_verify: true,\n};\n</code></pre>"},{"location":"rust/examples/actix-server/#using-with-client","title":"Using with Client","text":"<p>Test with the auto client:</p> <pre><code>use openlibx402_client::{X402AutoClient, AutoClientOptions};\nuse solana_sdk::signature::Keypair;\n\n#[tokio::main]\nasync fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {\n    let keypair = Keypair::new();\n    let options = AutoClientOptions {\n        max_payment_amount: \"5.0\".to_string(),\n        auto_retry: true,\n        max_retries: 3,\n    };\n\n    let client = X402AutoClient::new(keypair, None, Some(options));\n\n    // Test each tier\n    for endpoint in [\"basic\", \"premium\", \"enterprise\"] {\n        let url = format!(\"http://localhost:8080/{}\", endpoint);\n        match client.get(&amp;url).await {\n            Ok(response) =&gt; {\n                let body = response.text().await?;\n                println!(\"\u2713 {}: {}\", endpoint, body);\n            }\n            Err(e) =&gt; {\n                eprintln!(\"\u2717 {}: {}\", endpoint, e);\n            }\n        }\n    }\n\n    Ok(())\n}\n</code></pre>"},{"location":"rust/examples/actix-server/#key-features-demonstrated","title":"Key Features Demonstrated","text":"<ol> <li>Multiple Pricing Tiers - Different prices for different data levels</li> <li>Payment Descriptions - Human-readable descriptions in payment requests</li> <li>Custom Expirations - Premium tier has 10-minute expiration</li> <li>Optional Extractors - Using <code>Option&lt;PaymentExtractor&gt;</code> for flexible handling</li> <li>Health Check - Free endpoint for monitoring</li> <li>Async Handlers - All handlers are async for maximum performance</li> </ol>"},{"location":"rust/examples/actix-server/#performance-considerations","title":"Performance Considerations","text":"<p>Actix Web is known for excellent performance: - Async I/O with Tokio - Efficient request routing - Low overhead middleware - Connection pooling</p>"},{"location":"rust/examples/actix-server/#next-steps","title":"Next Steps","text":"<ul> <li>Modify pricing tiers</li> <li>Add custom business logic</li> <li>Integrate with database</li> <li>Add rate limiting</li> <li>Deploy to production</li> <li>Add middleware for logging/metrics</li> </ul>"},{"location":"rust/examples/actix-server/#see-also","title":"See Also","text":"<ul> <li>Actix Web Middleware Documentation</li> <li>Server Quick Start</li> <li>Rocket Server Example</li> </ul>"},{"location":"rust/examples/rocket-server/","title":"Rocket Server Example","text":"<p>Complete example of an X402-enabled API server using Rocket with multiple pricing tiers.</p>"},{"location":"rust/examples/rocket-server/#source-code","title":"Source Code","text":"<p>Location: <code>examples/rust/rocket-server/</code></p>"},{"location":"rust/examples/rocket-server/#overview","title":"Overview","text":"<p>This example demonstrates: - Free and paid endpoints - Multiple pricing tiers ($0.01, $0.10, $1.00) - Payment requirement configuration - Health check endpoint</p>"},{"location":"rust/examples/rocket-server/#running-the-example","title":"Running the Example","text":"<pre><code>cd examples/rust/rocket-server\ncargo run\n</code></pre> <p>Server starts on <code>http://localhost:8000</code></p>"},{"location":"rust/examples/rocket-server/#endpoints","title":"Endpoints","text":"Endpoint Price Description <code>GET /</code> Free Welcome message <code>GET /basic</code> $0.01 Basic tier data <code>GET /premium</code> $0.10 Premium tier data <code>GET /enterprise</code> $1.00 Enterprise tier data <code>GET /health</code> Free Health check"},{"location":"rust/examples/rocket-server/#testing","title":"Testing","text":""},{"location":"rust/examples/rocket-server/#free-endpoint","title":"Free Endpoint","text":"<pre><code>curl http://localhost:8000/\n</code></pre> <p>Response: <pre><code>{\n  \"message\": \"Welcome to the X402 Rocket example server!\"\n}\n</code></pre></p>"},{"location":"rust/examples/rocket-server/#payment-required","title":"Payment Required","text":"<pre><code>curl -v http://localhost:8000/premium\n</code></pre> <p>Response (402 Payment Required): <pre><code>{\n  \"max_amount_required\": \"0.10\",\n  \"asset_type\": \"SPL\",\n  \"asset_address\": \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\",\n  \"payment_address\": \"7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU\",\n  \"network\": \"solana-devnet\",\n  \"expires_at\": \"2025-10-31T12:05:00Z\",\n  \"nonce\": \"abc-123-def\",\n  \"payment_id\": \"pay-456-ghi\",\n  \"resource\": \"/premium\",\n  \"description\": \"Access to premium tier data\"\n}\n</code></pre></p>"},{"location":"rust/examples/rocket-server/#complete-code","title":"Complete Code","text":"<pre><code>use openlibx402_rocket::{\n    create_payment_request, PaymentGuard, PaymentRequirement,\n    PaymentRequiredResponse, X402Config,\n};\nuse rocket::{get, routes, serde::json::Json, State};\nuse serde::{Deserialize, Serialize};\n\n#[derive(Debug, Serialize, Deserialize)]\nstruct PremiumData {\n    message: String,\n    data: Vec&lt;String&gt;,\n    tier: String,\n}\n\n#[derive(Debug, Serialize, Deserialize)]\nstruct BasicData {\n    message: String,\n}\n\n/// Free endpoint\n#[get(\"/\")]\nfn index() -&gt; Json&lt;BasicData&gt; {\n    Json(BasicData {\n        message: \"Welcome to the X402 Rocket example server!\".to_string(),\n    })\n}\n\n/// Basic tier - $0.01\n#[get(\"/basic\")]\nfn basic_tier(\n    config: &amp;State&lt;X402Config&gt;,\n    _auth: Option&lt;PaymentGuard&gt;,\n) -&gt; Result&lt;Json&lt;PremiumData&gt;, PaymentRequiredResponse&gt; {\n    match _auth {\n        Some(auth) =&gt; {\n            Ok(Json(PremiumData {\n                message: \"Access granted to basic tier\".to_string(),\n                data: vec![\n                    \"Basic data point 1\".to_string(),\n                    \"Basic data point 2\".to_string(),\n                ],\n                tier: \"basic\".to_string(),\n            }))\n        }\n        None =&gt; {\n            let requirement = PaymentRequirement::new(\"0.01\")\n                .with_description(\"Access to basic tier data\");\n            let payment_request = create_payment_request(config, &amp;requirement, \"/basic\");\n            Err(PaymentRequiredResponse { payment_request })\n        }\n    }\n}\n\n/// Premium tier - $0.10\n#[get(\"/premium\")]\nfn premium_tier(\n    config: &amp;State&lt;X402Config&gt;,\n    _auth: Option&lt;PaymentGuard&gt;,\n) -&gt; Result&lt;Json&lt;PremiumData&gt;, PaymentRequiredResponse&gt; {\n    match _auth {\n        Some(auth) =&gt; {\n            Ok(Json(PremiumData {\n                message: \"Access granted to premium tier\".to_string(),\n                data: vec![\n                    \"Premium insight 1\".to_string(),\n                    \"Premium insight 2\".to_string(),\n                    \"Premium insight 3\".to_string(),\n                    \"Exclusive data point\".to_string(),\n                ],\n                tier: \"premium\".to_string(),\n            }))\n        }\n        None =&gt; {\n            let requirement = PaymentRequirement::new(\"0.10\")\n                .with_description(\"Access to premium tier data\")\n                .with_expires_in(600);\n            let payment_request = create_payment_request(config, &amp;requirement, \"/premium\");\n            Err(PaymentRequiredResponse { payment_request })\n        }\n    }\n}\n\n/// Enterprise tier - $1.00\n#[get(\"/enterprise\")]\nfn enterprise_tier(\n    config: &amp;State&lt;X402Config&gt;,\n    _auth: Option&lt;PaymentGuard&gt;,\n) -&gt; Result&lt;Json&lt;PremiumData&gt;, PaymentRequiredResponse&gt; {\n    match _auth {\n        Some(auth) =&gt; {\n            Ok(Json(PremiumData {\n                message: \"Access granted to enterprise tier\".to_string(),\n                data: vec![\n                    \"Enterprise analytics 1\".to_string(),\n                    \"Enterprise analytics 2\".to_string(),\n                    \"Enterprise analytics 3\".to_string(),\n                    \"Enterprise analytics 4\".to_string(),\n                    \"Confidential market data\".to_string(),\n                    \"Advanced predictions\".to_string(),\n                ],\n                tier: \"enterprise\".to_string(),\n            }))\n        }\n        None =&gt; {\n            let requirement = PaymentRequirement::new(\"1.00\")\n                .with_description(\"Access to enterprise tier data and analytics\");\n            let payment_request = create_payment_request(config, &amp;requirement, \"/enterprise\");\n            Err(PaymentRequiredResponse { payment_request })\n        }\n    }\n}\n\n/// Health check\n#[get(\"/health\")]\nfn health() -&gt; &amp;'static str {\n    \"OK\"\n}\n\n#[rocket::main]\nasync fn main() -&gt; Result&lt;(), rocket::Error&gt; {\n    // Configure X402\n    let config = X402Config {\n        payment_address: \"7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU\".to_string(),\n        token_mint: \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\".to_string(),\n        network: \"solana-devnet\".to_string(),\n        rpc_url: None,\n        auto_verify: true,\n    };\n\n    println!(\"\\n\ud83d\ude80 Starting Rocket X402 Example Server\");\n    println!(\"=====================================\");\n    println!(\"Payment Address: {}\", config.payment_address);\n    println!(\"Token Mint: {}\", config.token_mint);\n    println!(\"Network: {}\", config.network);\n    println!(\"\\nEndpoints:\");\n    println!(\"  - GET  /          : Free endpoint (no payment)\");\n    println!(\"  - GET  /basic     : Basic tier ($0.01)\");\n    println!(\"  - GET  /premium   : Premium tier ($0.10)\");\n    println!(\"  - GET  /enterprise: Enterprise tier ($1.00)\");\n    println!(\"  - GET  /health    : Health check\\n\");\n\n    let _rocket = rocket::build()\n        .manage(config)\n        .mount(\"/\", routes![index, basic_tier, premium_tier, enterprise_tier, health])\n        .launch()\n        .await?;\n\n    Ok(())\n}\n</code></pre>"},{"location":"rust/examples/rocket-server/#configuration","title":"Configuration","text":"<p>Update the wallet addresses in the code:</p> <pre><code>let config = X402Config {\n    payment_address: \"YOUR_WALLET_ADDRESS\".to_string(),  // Replace with your wallet\n    token_mint: \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\".to_string(),  // USDC Devnet\n    network: \"solana-devnet\".to_string(),\n    rpc_url: None,\n    auto_verify: true,\n};\n</code></pre>"},{"location":"rust/examples/rocket-server/#using-with-client","title":"Using with Client","text":"<p>Test with the auto client:</p> <pre><code>use openlibx402_client::{X402AutoClient, AutoClientOptions};\nuse solana_sdk::signature::Keypair;\n\n#[tokio::main]\nasync fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {\n    let keypair = Keypair::new();\n    let options = AutoClientOptions {\n        max_payment_amount: \"5.0\".to_string(),\n        auto_retry: true,\n        max_retries: 3,\n    };\n\n    let client = X402AutoClient::new(keypair, None, Some(options));\n\n    // Test each tier\n    for endpoint in [\"basic\", \"premium\", \"enterprise\"] {\n        let url = format!(\"http://localhost:8000/{}\", endpoint);\n        match client.get(&amp;url).await {\n            Ok(response) =&gt; {\n                let body = response.text().await?;\n                println!(\"\u2713 {}: {}\", endpoint, body);\n            }\n            Err(e) =&gt; {\n                eprintln!(\"\u2717 {}: {}\", endpoint, e);\n            }\n        }\n    }\n\n    Ok(())\n}\n</code></pre>"},{"location":"rust/examples/rocket-server/#key-features-demonstrated","title":"Key Features Demonstrated","text":"<ol> <li>Multiple Pricing Tiers - Different prices for different data levels</li> <li>Payment Descriptions - Human-readable descriptions in payment requests</li> <li>Custom Expirations - Premium tier has 10-minute expiration</li> <li>Optional Guards - Using <code>Option&lt;PaymentGuard&gt;</code> for flexible handling</li> <li>Health Check - Free endpoint for monitoring</li> </ol>"},{"location":"rust/examples/rocket-server/#next-steps","title":"Next Steps","text":"<ul> <li>Modify pricing tiers</li> <li>Add custom business logic</li> <li>Integrate with database</li> <li>Add rate limiting</li> <li>Deploy to production</li> </ul>"},{"location":"rust/examples/rocket-server/#see-also","title":"See Also","text":"<ul> <li>Rocket Middleware Documentation</li> <li>Server Quick Start</li> <li>Actix Web Server Example</li> </ul>"},{"location":"rust/getting-started/client-quickstart/","title":"Client Quick Start","text":"<p>Build your first X402 client in Rust to consume payment-protected APIs. This guide shows you how to use both automatic and explicit payment handling.</p>"},{"location":"rust/getting-started/client-quickstart/#choose-your-client-type","title":"Choose Your Client Type","text":"<ul> <li>Auto Client - Automatic payment handling (recommended)</li> <li>Explicit Client - Full control over payment flow</li> </ul>"},{"location":"rust/getting-started/client-quickstart/#auto-client","title":"Auto Client","text":"<p>The auto client automatically detects 402 responses, creates payments, and retries requests.</p>"},{"location":"rust/getting-started/client-quickstart/#step-1-create-project","title":"Step 1: Create Project","text":"<pre><code>cargo new my-x402-client\ncd my-x402-client\n</code></pre>"},{"location":"rust/getting-started/client-quickstart/#step-2-add-dependencies","title":"Step 2: Add Dependencies","text":"<pre><code>[dependencies]\nopenlibx402-core = \"0.1\"\nopenlibx402-client = \"0.1\"\ntokio = { version = \"1.35\", features = [\"full\"] }\nsolana-sdk = \"2.0\"\n</code></pre>"},{"location":"rust/getting-started/client-quickstart/#step-3-load-keypair","title":"Step 3: Load Keypair","text":"<pre><code>use solana_sdk::signature::{read_keypair_file, Keypair};\nuse std::error::Error;\n\nfn load_keypair() -&gt; Result&lt;Keypair, Box&lt;dyn Error&gt;&gt; {\n    // Load from file\n    let keypair = read_keypair_file(\n        std::env::var(\"SOLANA_KEYPAIR\")\n            .unwrap_or_else(|_| {\n                format!(\"{}/.config/solana/id.json\", std::env::var(\"HOME\").unwrap())\n            })\n    )?;\n    Ok(keypair)\n}\n</code></pre>"},{"location":"rust/getting-started/client-quickstart/#step-4-create-auto-client","title":"Step 4: Create Auto Client","text":"<pre><code>use openlibx402_client::{X402AutoClient, AutoClientOptions};\n\n#[tokio::main]\nasync fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {\n    // Load your Solana keypair\n    let keypair = load_keypair()?;\n\n    // Configure auto client\n    let options = AutoClientOptions {\n        max_payment_amount: \"5.0\".to_string(),  // Max $5 per request\n        auto_retry: true,\n        max_retries: 3,\n    };\n\n    // Create client\n    let client = X402AutoClient::new(keypair, None, Some(options));\n\n    // Make request - payment handled automatically!\n    let response = client.get(\"http://localhost:8000/premium\").await?;\n    let body = response.text().await?;\n\n    println!(\"Response: {}\", body);\n\n    Ok(())\n}\n</code></pre>"},{"location":"rust/getting-started/client-quickstart/#step-5-run-client","title":"Step 5: Run Client","text":"<pre><code>cargo run\n</code></pre> <p>The client will automatically: 1. Make initial request 2. Detect 402 response 3. Create and send payment 4. Retry with payment authorization 5. Return the data</p>"},{"location":"rust/getting-started/client-quickstart/#explicit-client","title":"Explicit Client","text":"<p>The explicit client gives you full control over the payment flow.</p>"},{"location":"rust/getting-started/client-quickstart/#step-1-create-project_1","title":"Step 1: Create Project","text":"<p>Same as auto client.</p>"},{"location":"rust/getting-started/client-quickstart/#step-2-add-dependencies_1","title":"Step 2: Add Dependencies","text":"<p>Same as auto client.</p>"},{"location":"rust/getting-started/client-quickstart/#step-3-create-explicit-client","title":"Step 3: Create Explicit Client","text":"<pre><code>use openlibx402_client::X402Client;\nuse solana_sdk::signature::{read_keypair_file, Keypair};\n\n#[tokio::main]\nasync fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {\n    // Load keypair\n    let keypair = read_keypair_file(\n        format!(\"{}/.config/solana/id.json\", std::env::var(\"HOME\")?)\n    )?;\n\n    // Create client\n    let client = X402Client::new(keypair, None);\n\n    // Make initial request\n    let response = client.get(\"http://localhost:8000/premium\").await?;\n\n    // Check if payment is required\n    if client.is_payment_required(&amp;response) {\n        println!(\"Payment required!\");\n\n        // Parse payment request\n        let payment_request = client.parse_payment_request(response).await?;\n\n        println!(\"Amount: {} USDC\", payment_request.max_amount_required);\n        println!(\"Description: {:?}\", payment_request.description);\n\n        // Create and send payment\n        let authorization = client.create_payment(&amp;payment_request).await?;\n\n        println!(\"Payment sent! Signature: {}\", authorization.signature);\n\n        // Retry with payment authorization\n        let response = client.get_with_auth(\n            \"http://localhost:8000/premium\",\n            &amp;authorization\n        ).await?;\n\n        let body = response.text().await?;\n        println!(\"Response: {}\", body);\n    } else {\n        // No payment required\n        let body = response.text().await?;\n        println!(\"Response: {}\", body);\n    }\n\n    Ok(())\n}\n</code></pre>"},{"location":"rust/getting-started/client-quickstart/#step-4-run-client","title":"Step 4: Run Client","text":"<pre><code>cargo run\n</code></pre>"},{"location":"rust/getting-started/client-quickstart/#post-requests","title":"POST Requests","text":"<p>Both clients support POST requests:</p>"},{"location":"rust/getting-started/client-quickstart/#auto-client_1","title":"Auto Client","text":"<pre><code>let body = serde_json::json!({\n    \"query\": \"premium data\"\n});\n\nlet response = client.post(\n    \"http://localhost:8000/query\",\n    Some(body.to_string())\n).await?;\n</code></pre>"},{"location":"rust/getting-started/client-quickstart/#explicit-client_1","title":"Explicit Client","text":"<pre><code>let body = serde_json::json!({\n    \"query\": \"premium data\"\n});\n\nlet response = client.post(\n    \"http://localhost:8000/query\",\n    Some(body.to_string())\n).await?;\n\nif client.is_payment_required(&amp;response) {\n    let payment_request = client.parse_payment_request(response).await?;\n    let authorization = client.create_payment(&amp;payment_request).await?;\n\n    let response = client.post_with_auth(\n        \"http://localhost:8000/query\",\n        Some(body.to_string()),\n        &amp;authorization\n    ).await?;\n\n    // Handle response\n}\n</code></pre>"},{"location":"rust/getting-started/client-quickstart/#error-handling","title":"Error Handling","text":"<p>Handle X402-specific errors:</p> <pre><code>use openlibx402_core::X402Error;\n\nmatch client.get(url).await {\n    Ok(response) =&gt; {\n        // Handle response\n    }\n    Err(e) =&gt; {\n        match e {\n            X402Error::PaymentRequired(msg) =&gt; {\n                eprintln!(\"Payment required: {}\", msg);\n            }\n            X402Error::InsufficientFunds(msg) =&gt; {\n                eprintln!(\"Insufficient funds: {}\", msg);\n            }\n            X402Error::PaymentExpired(msg) =&gt; {\n                eprintln!(\"Payment expired: {}\", msg);\n            }\n            X402Error::Network(msg) =&gt; {\n                eprintln!(\"Network error: {}\", msg);\n            }\n            _ =&gt; {\n                eprintln!(\"Error: {}\", e);\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"rust/getting-started/client-quickstart/#configuration","title":"Configuration","text":""},{"location":"rust/getting-started/client-quickstart/#auto-client-options","title":"Auto Client Options","text":"<pre><code>let options = AutoClientOptions {\n    max_payment_amount: \"10.0\".to_string(),  // Maximum amount to pay\n    auto_retry: true,                         // Automatically retry after payment\n    max_retries: 3,                           // Maximum retry attempts\n};\n</code></pre>"},{"location":"rust/getting-started/client-quickstart/#custom-rpc-url","title":"Custom RPC URL","text":"<pre><code>let client = X402AutoClient::new(\n    keypair,\n    Some(\"https://your-rpc-endpoint.com\"),\n    Some(options)\n);\n</code></pre>"},{"location":"rust/getting-started/client-quickstart/#best-practices","title":"Best Practices","text":""},{"location":"rust/getting-started/client-quickstart/#1-load-keypair-securely","title":"1. Load Keypair Securely","text":"<pre><code>use std::env;\n\nfn load_keypair() -&gt; Result&lt;Keypair, Box&lt;dyn Error&gt;&gt; {\n    let path = env::var(\"SOLANA_KEYPAIR\")\n        .or_else(|_| env::var(\"HOME\").map(|h| format!(\"{}/.config/solana/id.json\", h)))?;\n\n    read_keypair_file(path)\n        .map_err(|e| format!(\"Failed to load keypair: {}\", e).into())\n}\n</code></pre>"},{"location":"rust/getting-started/client-quickstart/#2-set-payment-limits","title":"2. Set Payment Limits","text":"<pre><code>let options = AutoClientOptions {\n    max_payment_amount: \"5.0\".to_string(),  // Protect against overpaying\n    auto_retry: true,\n    max_retries: 3,\n};\n</code></pre>"},{"location":"rust/getting-started/client-quickstart/#3-handle-all-error-cases","title":"3. Handle All Error Cases","text":"<pre><code>async fn fetch_premium_data(client: &amp;X402AutoClient) -&gt; Result&lt;String, Box&lt;dyn Error&gt;&gt; {\n    match client.get(\"http://localhost:8000/premium\").await {\n        Ok(response) =&gt; {\n            if response.status().is_success() {\n                Ok(response.text().await?)\n            } else {\n                Err(format!(\"HTTP error: {}\", response.status()).into())\n            }\n        }\n        Err(X402Error::InsufficientFunds(_)) =&gt; {\n            Err(\"Not enough USDC in wallet\".into())\n        }\n        Err(X402Error::PaymentExpired(_)) =&gt; {\n            // Retry with new payment request\n            client.get(\"http://localhost:8000/premium\").await?\n                .text().await.map_err(Into::into)\n        }\n        Err(e) =&gt; Err(e.into()),\n    }\n}\n</code></pre>"},{"location":"rust/getting-started/client-quickstart/#4-use-connection-pooling","title":"4. Use Connection Pooling","text":"<p>The client reuses HTTP connections automatically via reqwest.</p>"},{"location":"rust/getting-started/client-quickstart/#testing-without-payments","title":"Testing Without Payments","text":"<p>For testing, you can mock the payment processor:</p> <pre><code>#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[tokio::test]\n    async fn test_client() {\n        // Use test server without payment requirements\n        let client = X402AutoClient::new(\n            Keypair::new(),\n            None,\n            None\n        );\n\n        let response = client.get(\"http://localhost:8000/free-endpoint\").await.unwrap();\n        assert!(response.status().is_success());\n    }\n}\n</code></pre>"},{"location":"rust/getting-started/client-quickstart/#complete-example","title":"Complete Example","text":"<pre><code>use openlibx402_client::{X402AutoClient, AutoClientOptions};\nuse solana_sdk::signature::read_keypair_file;\nuse std::error::Error;\n\n#[tokio::main]\nasync fn main() -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt; {\n    // Load keypair\n    let keypair = read_keypair_file(\n        format!(\"{}/.config/solana/devnet.json\", std::env::var(\"HOME\")?)\n    )?;\n\n    // Configure client\n    let options = AutoClientOptions {\n        max_payment_amount: \"5.0\".to_string(),\n        auto_retry: true,\n        max_retries: 3,\n    };\n\n    let client = X402AutoClient::new(keypair, None, Some(options));\n\n    // Make multiple requests\n    let endpoints = vec![\n        \"http://localhost:8000/basic\",\n        \"http://localhost:8000/premium\",\n        \"http://localhost:8000/enterprise\",\n    ];\n\n    for endpoint in endpoints {\n        match client.get(endpoint).await {\n            Ok(response) =&gt; {\n                let body = response.text().await?;\n                println!(\"\u2713 {}: {}\", endpoint, body);\n            }\n            Err(e) =&gt; {\n                eprintln!(\"\u2717 {}: {}\", endpoint, e);\n            }\n        }\n    }\n\n    Ok(())\n}\n</code></pre>"},{"location":"rust/getting-started/client-quickstart/#next-steps","title":"Next Steps","text":"<ul> <li>Client Library Reference - Detailed API documentation</li> <li>Error Handling - All error types and handling</li> <li>Configuration - Advanced configuration options</li> </ul>"},{"location":"rust/getting-started/client-quickstart/#troubleshooting","title":"Troubleshooting","text":""},{"location":"rust/getting-started/client-quickstart/#failed-to-load-keypair","title":"\"Failed to load keypair\"","text":"<p>Make sure your keypair file exists:</p> <pre><code>ls ~/.config/solana/id.json\n</code></pre> <p>Generate one if needed:</p> <pre><code>solana-keygen new --outfile ~/.config/solana/devnet.json\n</code></pre>"},{"location":"rust/getting-started/client-quickstart/#insufficient-funds","title":"\"Insufficient funds\"","text":"<p>Check your SOL balance for gas fees:</p> <pre><code>solana balance\n</code></pre> <p>Airdrop on devnet:</p> <pre><code>solana airdrop 2\n</code></pre>"},{"location":"rust/getting-started/client-quickstart/#payment-verification-failed","title":"\"Payment verification failed\"","text":"<p>Ensure you're using the correct network (devnet vs mainnet) and have USDC tokens.</p>"},{"location":"rust/getting-started/installation/","title":"Installation","text":"<p>This guide covers installing the OpenLibx402 Rust packages for your project.</p>"},{"location":"rust/getting-started/installation/#prerequisites","title":"Prerequisites","text":"<ul> <li>Rust 1.70+ - Install Rust</li> <li>Cargo - Comes with Rust installation</li> <li>Solana Wallet - For testing and production payments</li> </ul>"},{"location":"rust/getting-started/installation/#quick-install","title":"Quick Install","text":""},{"location":"rust/getting-started/installation/#for-server-projects","title":"For Server Projects","text":"<pre><code># Add core library\ncargo add openlibx402-core\n\n# Add framework integration\ncargo add openlibx402-rocket\n# OR\ncargo add openlibx402-actix\n\n# Add required dependencies\ncargo add tokio --features full\ncargo add serde --features derive\n</code></pre>"},{"location":"rust/getting-started/installation/#for-client-projects","title":"For Client Projects","text":"<pre><code># Add core and client libraries\ncargo add openlibx402-core\ncargo add openlibx402-client\n\n# Add required dependencies\ncargo add tokio --features full\ncargo add solana-sdk\n</code></pre>"},{"location":"rust/getting-started/installation/#cargotoml-configuration","title":"Cargo.toml Configuration","text":""},{"location":"rust/getting-started/installation/#server-example-rocket","title":"Server Example (Rocket)","text":"<pre><code>[package]\nname = \"my-x402-server\"\nversion = \"0.1.0\"\nedition = \"2021\"\n\n[dependencies]\nopenlibx402-core = \"0.1\"\nopenlibx402-rocket = \"0.1\"\nrocket = { version = \"0.5\", features = [\"json\"] }\ntokio = { version = \"1.35\", features = [\"full\"] }\nserde = { version = \"1.0\", features = [\"derive\"] }\nserde_json = \"1.0\"\n</code></pre>"},{"location":"rust/getting-started/installation/#server-example-actix-web","title":"Server Example (Actix Web)","text":"<pre><code>[package]\nname = \"my-x402-server\"\nversion = \"0.1.0\"\nedition = \"2021\"\n\n[dependencies]\nopenlibx402-core = \"0.1\"\nopenlibx402-actix = \"0.1\"\nactix-web = \"4.4\"\nactix-rt = \"2.9\"\ntokio = { version = \"1.35\", features = [\"full\"] }\nserde = { version = \"1.0\", features = [\"derive\"] }\nserde_json = \"1.0\"\n</code></pre>"},{"location":"rust/getting-started/installation/#client-example","title":"Client Example","text":"<pre><code>[package]\nname = \"my-x402-client\"\nversion = \"0.1.0\"\nedition = \"2021\"\n\n[dependencies]\nopenlibx402-core = \"0.1\"\nopenlibx402-client = \"0.1\"\ntokio = { version = \"1.35\", features = [\"full\"] }\nsolana-sdk = \"2.0\"\nreqwest = \"0.12\"\n</code></pre>"},{"location":"rust/getting-started/installation/#from-source","title":"From Source","text":"<p>To build from source or contribute:</p> <pre><code># Clone repository\ngit clone https://github.com/openlibx402/openlibx402.git\ncd openlibx402/packages/rust\n\n# Build all packages\ncargo build --release\n\n# Run tests\ncargo test --workspace\n\n# Build documentation\ncargo doc --open\n</code></pre>"},{"location":"rust/getting-started/installation/#workspace-development","title":"Workspace Development","text":"<p>The Rust packages are organized as a Cargo workspace:</p> <pre><code>packages/rust/\n\u251c\u2500\u2500 Cargo.toml              # Workspace configuration\n\u251c\u2500\u2500 openlibx402-core/       # Core library\n\u251c\u2500\u2500 openlibx402-client/     # Client library\n\u251c\u2500\u2500 openlibx402-rocket/     # Rocket integration\n\u2514\u2500\u2500 openlibx402-actix/      # Actix Web integration\n</code></pre> <p>To work on multiple packages simultaneously:</p> <pre><code>cd packages/rust\n\n# Build everything\ncargo build\n\n# Test everything\ncargo test\n\n# Build specific package\ncargo build -p openlibx402-core\n\n# Test specific package\ncargo test -p openlibx402-client\n</code></pre>"},{"location":"rust/getting-started/installation/#setting-up-solana","title":"Setting Up Solana","text":""},{"location":"rust/getting-started/installation/#install-solana-cli","title":"Install Solana CLI","text":"<pre><code>sh -c \"$(curl -sSfL https://release.solana.com/stable/install)\"\n</code></pre>"},{"location":"rust/getting-started/installation/#generate-keypair","title":"Generate Keypair","text":"<p>For development and testing:</p> <pre><code># Generate new keypair\nsolana-keygen new --outfile ~/.config/solana/devnet.json\n\n# View public key\nsolana-keygen pubkey ~/.config/solana/devnet.json\n\n# Set network to devnet\nsolana config set --url https://api.devnet.solana.com\n\n# Airdrop SOL for gas fees\nsolana airdrop 2\n</code></pre>"},{"location":"rust/getting-started/installation/#get-test-usdc","title":"Get Test USDC","text":"<p>On devnet, you can mint test USDC or use a faucet.</p>"},{"location":"rust/getting-started/installation/#environment-variables","title":"Environment Variables","text":"<p>Set up your environment:</p> <pre><code># Add to ~/.bashrc or ~/.zshrc\nexport SOLANA_KEYPAIR=\"$HOME/.config/solana/devnet.json\"\nexport X402_PAYMENT_ADDRESS=\"YOUR_WALLET_ADDRESS\"\nexport X402_TOKEN_MINT=\"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\"  # USDC Devnet\nexport X402_NETWORK=\"solana-devnet\"\nexport X402_RPC_URL=\"https://api.devnet.solana.com\"\n</code></pre>"},{"location":"rust/getting-started/installation/#verify-installation","title":"Verify Installation","text":"<p>Create a simple test file:</p> <pre><code>// test_installation.rs\nuse openlibx402_core::{PaymentRequest, X402Error};\n\nfn main() -&gt; Result&lt;(), X402Error&gt; {\n    println!(\"OpenLibx402 Rust SDK installed successfully!\");\n    println!(\"Version: {}\", openlibx402_core::VERSION);\n    Ok(())\n}\n</code></pre> <p>Run it:</p> <pre><code>cargo run\n</code></pre>"},{"location":"rust/getting-started/installation/#next-steps","title":"Next Steps","text":"<ul> <li>Server Quick Start - Build your first X402 server</li> <li>Client Quick Start - Build your first X402 client</li> <li>Core Library - Learn about core types and functions</li> </ul>"},{"location":"rust/getting-started/installation/#troubleshooting","title":"Troubleshooting","text":""},{"location":"rust/getting-started/installation/#compilation-errors","title":"Compilation Errors","text":"<p>If you encounter compilation errors:</p> <pre><code># Update Rust\nrustup update\n\n# Clean build cache\ncargo clean\n\n# Rebuild\ncargo build\n</code></pre>"},{"location":"rust/getting-started/installation/#dependency-conflicts","title":"Dependency Conflicts","text":"<p>If you have dependency conflicts:</p> <pre><code># Update dependencies\ncargo update\n\n# Check for outdated dependencies\ncargo outdated\n</code></pre>"},{"location":"rust/getting-started/installation/#solana-sdk-issues","title":"Solana SDK Issues","text":"<p>If Solana SDK installation fails:</p> <pre><code># Use specific version\ncargo add solana-sdk@2.0\ncargo add solana-client@2.0\n</code></pre>"},{"location":"rust/getting-started/installation/#support","title":"Support","text":"<p>Need help? Check: - Rust Documentation - Cargo Book - GitHub Issues</p>"},{"location":"rust/getting-started/server-quickstart/","title":"Server Quick Start","text":"<p>Build your first X402-enabled API server in Rust. This guide shows you how to protect endpoints with payment requirements using either Rocket or Actix Web.</p>"},{"location":"rust/getting-started/server-quickstart/#choose-your-framework","title":"Choose Your Framework","text":"<ul> <li>Rocket - Elegant, type-safe web framework</li> <li>Actix Web - High-performance, actor-based framework</li> </ul>"},{"location":"rust/getting-started/server-quickstart/#rocket-server","title":"Rocket Server","text":""},{"location":"rust/getting-started/server-quickstart/#step-1-create-project","title":"Step 1: Create Project","text":"<pre><code>cargo new my-x402-server\ncd my-x402-server\n</code></pre>"},{"location":"rust/getting-started/server-quickstart/#step-2-add-dependencies","title":"Step 2: Add Dependencies","text":"<pre><code>[dependencies]\nopenlibx402-core = \"0.1\"\nopenlibx402-rocket = \"0.1\"\nrocket = { version = \"0.5\", features = [\"json\"] }\ntokio = { version = \"1.35\", features = [\"full\"] }\nserde = { version = \"1.0\", features = [\"derive\"] }\nserde_json = \"1.0\"\n</code></pre>"},{"location":"rust/getting-started/server-quickstart/#step-3-write-server-code","title":"Step 3: Write Server Code","text":"<pre><code>use openlibx402_rocket::{\n    create_payment_request, PaymentGuard, PaymentRequirement,\n    PaymentRequiredResponse, X402Config,\n};\nuse rocket::{get, routes, serde::json::Json, State};\nuse serde::Serialize;\n\n#[derive(Serialize)]\nstruct PremiumData {\n    message: String,\n    data: Vec&lt;String&gt;,\n}\n\n// Free endpoint - no payment required\n#[get(\"/\")]\nfn index() -&gt; &amp;'static str {\n    \"Welcome to my X402 API!\"\n}\n\n// Premium endpoint - requires $0.10 payment\n#[get(\"/premium\")]\nfn premium_data(\n    config: &amp;State&lt;X402Config&gt;,\n    auth: Option&lt;PaymentGuard&gt;,\n) -&gt; Result&lt;Json&lt;PremiumData&gt;, PaymentRequiredResponse&gt; {\n    match auth {\n        Some(_) =&gt; {\n            // Payment verified - return premium content\n            Ok(Json(PremiumData {\n                message: \"Premium content unlocked!\".to_string(),\n                data: vec![\n                    \"Secret data 1\".to_string(),\n                    \"Secret data 2\".to_string(),\n                ],\n            }))\n        }\n        None =&gt; {\n            // No payment - return 402 with payment request\n            let requirement = PaymentRequirement::new(\"0.10\")\n                .with_description(\"Access to premium data\");\n            let payment_request = create_payment_request(\n                config,\n                &amp;requirement,\n                \"/premium\"\n            );\n            Err(PaymentRequiredResponse { payment_request })\n        }\n    }\n}\n\n#[rocket::main]\nasync fn main() {\n    // Configure X402\n    let config = X402Config {\n        payment_address: \"YOUR_WALLET_ADDRESS\".to_string(),\n        token_mint: \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\".to_string(),\n        network: \"solana-devnet\".to_string(),\n        rpc_url: None,\n        auto_verify: true,\n    };\n\n    rocket::build()\n        .manage(config)\n        .mount(\"/\", routes![index, premium_data])\n        .launch()\n        .await\n        .unwrap();\n}\n</code></pre>"},{"location":"rust/getting-started/server-quickstart/#step-4-run-server","title":"Step 4: Run Server","text":"<pre><code>cargo run\n</code></pre> <p>Visit <code>http://localhost:8000/premium</code> - you'll get a 402 response with payment details!</p>"},{"location":"rust/getting-started/server-quickstart/#actix-web-server","title":"Actix Web Server","text":""},{"location":"rust/getting-started/server-quickstart/#step-1-create-project_1","title":"Step 1: Create Project","text":"<pre><code>cargo new my-x402-server\ncd my-x402-server\n</code></pre>"},{"location":"rust/getting-started/server-quickstart/#step-2-add-dependencies_1","title":"Step 2: Add Dependencies","text":"<pre><code>[dependencies]\nopenlibx402-core = \"0.1\"\nopenlibx402-actix = \"0.1\"\nactix-web = \"4.4\"\nactix-rt = \"2.9\"\ntokio = { version = \"1.35\", features = [\"full\"] }\nserde = { version = \"1.0\", features = [\"derive\"] }\nserde_json = \"1.0\"\n</code></pre>"},{"location":"rust/getting-started/server-quickstart/#step-3-write-server-code_1","title":"Step 3: Write Server Code","text":"<pre><code>use actix_web::{get, web, App, HttpResponse, HttpServer};\nuse openlibx402_actix::{\n    create_payment_request, payment_required_response,\n    PaymentExtractor, PaymentRequirement, X402Config, X402State,\n};\nuse serde::Serialize;\n\n#[derive(Serialize)]\nstruct PremiumData {\n    message: String,\n    data: Vec&lt;String&gt;,\n}\n\n// Free endpoint - no payment required\n#[get(\"/\")]\nasync fn index() -&gt; HttpResponse {\n    HttpResponse::Ok().body(\"Welcome to my X402 API!\")\n}\n\n// Premium endpoint - requires $0.10 payment\n#[get(\"/premium\")]\nasync fn premium_data(\n    state: web::Data&lt;X402State&gt;,\n    auth: Option&lt;PaymentExtractor&gt;,\n) -&gt; HttpResponse {\n    match auth {\n        Some(_) =&gt; {\n            // Payment verified - return premium content\n            HttpResponse::Ok().json(PremiumData {\n                message: \"Premium content unlocked!\".to_string(),\n                data: vec![\n                    \"Secret data 1\".to_string(),\n                    \"Secret data 2\".to_string(),\n                ],\n            })\n        }\n        None =&gt; {\n            // No payment - return 402 with payment request\n            let requirement = PaymentRequirement::new(\"0.10\")\n                .with_description(\"Access to premium data\");\n            let payment_request = create_payment_request(\n                &amp;state.config,\n                &amp;requirement,\n                \"/premium\"\n            );\n            payment_required_response(payment_request)\n        }\n    }\n}\n\n#[actix_web::main]\nasync fn main() -&gt; std::io::Result&lt;()&gt; {\n    // Configure X402\n    let config = X402Config {\n        payment_address: \"YOUR_WALLET_ADDRESS\".to_string(),\n        token_mint: \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\".to_string(),\n        network: \"solana-devnet\".to_string(),\n        rpc_url: None,\n        auto_verify: true,\n    };\n\n    let state = web::Data::new(X402State { config });\n\n    HttpServer::new(move || {\n        App::new()\n            .app_data(state.clone())\n            .service(index)\n            .service(premium_data)\n    })\n    .bind((\"127.0.0.1\", 8080))?\n    .run()\n    .await\n}\n</code></pre>"},{"location":"rust/getting-started/server-quickstart/#step-4-run-server_1","title":"Step 4: Run Server","text":"<pre><code>cargo run\n</code></pre> <p>Visit <code>http://localhost:8080/premium</code> - you'll get a 402 response with payment details!</p>"},{"location":"rust/getting-started/server-quickstart/#testing-your-server","title":"Testing Your Server","text":""},{"location":"rust/getting-started/server-quickstart/#using-curl","title":"Using curl","text":"<pre><code># Test free endpoint\ncurl http://localhost:8000/\n\n# Test premium endpoint (will return 402)\ncurl -v http://localhost:8000/premium\n</code></pre>"},{"location":"rust/getting-started/server-quickstart/#using-httpie","title":"Using httpie","text":"<pre><code># Install httpie\ncargo install httpie\n\n# Test premium endpoint\nhttp GET http://localhost:8000/premium\n</code></pre>"},{"location":"rust/getting-started/server-quickstart/#multiple-pricing-tiers","title":"Multiple Pricing Tiers","text":"<p>Add different pricing levels:</p> <pre><code>// Basic tier - $0.01\n#[get(\"/basic\")]\nfn basic_tier(\n    config: &amp;State&lt;X402Config&gt;,\n    auth: Option&lt;PaymentGuard&gt;,\n) -&gt; Result&lt;Json&lt;PremiumData&gt;, PaymentRequiredResponse&gt; {\n    match auth {\n        Some(_) =&gt; Ok(Json(PremiumData {\n            message: \"Basic tier\".to_string(),\n            data: vec![\"Basic data\".to_string()],\n        })),\n        None =&gt; {\n            let requirement = PaymentRequirement::new(\"0.01\");\n            let payment_request = create_payment_request(config, &amp;requirement, \"/basic\");\n            Err(PaymentRequiredResponse { payment_request })\n        }\n    }\n}\n\n// Premium tier - $0.10\n#[get(\"/premium\")]\nfn premium_tier(\n    config: &amp;State&lt;X402Config&gt;,\n    auth: Option&lt;PaymentGuard&gt;,\n) -&gt; Result&lt;Json&lt;PremiumData&gt;, PaymentRequiredResponse&gt; {\n    match auth {\n        Some(_) =&gt; Ok(Json(PremiumData {\n            message: \"Premium tier\".to_string(),\n            data: vec![\"Premium data 1\".to_string(), \"Premium data 2\".to_string()],\n        })),\n        None =&gt; {\n            let requirement = PaymentRequirement::new(\"0.10\");\n            let payment_request = create_payment_request(config, &amp;requirement, \"/premium\");\n            Err(PaymentRequiredResponse { payment_request })\n        }\n    }\n}\n\n// Enterprise tier - $1.00\n#[get(\"/enterprise\")]\nfn enterprise_tier(\n    config: &amp;State&lt;X402Config&gt;,\n    auth: Option&lt;PaymentGuard&gt;,\n) -&gt; Result&lt;Json&lt;PremiumData&gt;, PaymentRequiredResponse&gt; {\n    match auth {\n        Some(_) =&gt; Ok(Json(PremiumData {\n            message: \"Enterprise tier\".to_string(),\n            data: vec![\n                \"Enterprise data 1\".to_string(),\n                \"Enterprise data 2\".to_string(),\n                \"Enterprise data 3\".to_string(),\n            ],\n        })),\n        None =&gt; {\n            let requirement = PaymentRequirement::new(\"1.00\");\n            let payment_request = create_payment_request(config, &amp;requirement, \"/enterprise\");\n            Err(PaymentRequiredResponse { payment_request })\n        }\n    }\n}\n</code></pre>"},{"location":"rust/getting-started/server-quickstart/#configuration-options","title":"Configuration Options","text":"<p>Customize payment requirements:</p> <pre><code>let requirement = PaymentRequirement::new(\"0.10\")\n    .with_description(\"Access to premium API endpoint\")\n    .with_expires_in(600);  // 10 minutes\n</code></pre> <p>Configure X402:</p> <pre><code>let config = X402Config {\n    payment_address: \"YOUR_WALLET\".to_string(),\n    token_mint: \"USDC_MINT\".to_string(),\n    network: \"solana-devnet\".to_string(),\n    rpc_url: Some(\"https://your-rpc.com\".to_string()),  // Custom RPC\n    auto_verify: true,  // Verify payments on-chain\n};\n</code></pre>"},{"location":"rust/getting-started/server-quickstart/#next-steps","title":"Next Steps","text":"<ul> <li>Client Quick Start - Build a client to consume your API</li> <li>Rocket Middleware - Learn more about Rocket integration</li> <li>Actix Web Middleware - Learn more about Actix integration</li> <li>Configuration Reference - All configuration options</li> </ul>"},{"location":"rust/getting-started/server-quickstart/#complete-examples","title":"Complete Examples","text":"<p>See full working examples: - Rocket Server Example - Actix Web Server Example</p>"},{"location":"rust/libraries/client/","title":"Client Library","text":"<p>The <code>openlibx402-client</code> crate provides HTTP clients for consuming X402-protected APIs with automatic or explicit payment handling.</p>"},{"location":"rust/libraries/client/#installation","title":"Installation","text":"<pre><code>[dependencies]\nopenlibx402-client = \"0.1\"\nopenlibx402-core = \"0.1\"\ntokio = { version = \"1.35\", features = [\"full\"] }\nsolana-sdk = \"2.0\"\n</code></pre>"},{"location":"rust/libraries/client/#overview","title":"Overview","text":"<p>The client library provides two client types:</p> <ul> <li>X402AutoClient - Automatically detects and handles 402 responses</li> <li>X402Client - Explicit control over payment flow</li> </ul> <p>Both clients support: - GET and POST requests - Automatic payment creation - Configurable retry logic - Payment verification - Custom RPC endpoints</p>"},{"location":"rust/libraries/client/#x402autoclient","title":"X402AutoClient","text":"<p>The auto client automatically handles the complete payment flow.</p>"},{"location":"rust/libraries/client/#creating-an-auto-client","title":"Creating an Auto Client","text":"<pre><code>use openlibx402_client::{X402AutoClient, AutoClientOptions};\nuse solana_sdk::signature::Keypair;\n\n// With default options\nlet keypair = Keypair::new();\nlet client = X402AutoClient::new(keypair, None, None);\n\n// With custom options\nlet options = AutoClientOptions {\n    max_payment_amount: \"5.0\".to_string(),\n    auto_retry: true,\n    max_retries: 3,\n};\n\nlet client = X402AutoClient::new(\n    keypair,\n    Some(\"https://your-rpc.com\"),\n    Some(options)\n);\n</code></pre>"},{"location":"rust/libraries/client/#autoclientoptions","title":"AutoClientOptions","text":"<pre><code>pub struct AutoClientOptions {\n    /// Maximum amount willing to pay automatically (in USDC)\n    pub max_payment_amount: String,\n\n    /// Whether to automatically retry after payment\n    pub auto_retry: bool,\n\n    /// Maximum number of retry attempts\n    pub max_retries: u32,\n}\n</code></pre> <p>Default values: - <code>max_payment_amount</code>: \"10.0\" - <code>auto_retry</code>: true - <code>max_retries</code>: 3</p>"},{"location":"rust/libraries/client/#making-requests","title":"Making Requests","text":""},{"location":"rust/libraries/client/#get-request","title":"GET Request","text":"<pre><code>use openlibx402_client::X402AutoClient;\n\n#[tokio::main]\nasync fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {\n    let client = X402AutoClient::new(keypair, None, None);\n\n    // Automatically handles 402 and payment\n    let response = client.get(\"https://api.example.com/premium-data\").await?;\n    let body = response.text().await?;\n\n    println!(\"Data: {}\", body);\n    Ok(())\n}\n</code></pre>"},{"location":"rust/libraries/client/#post-request","title":"POST Request","text":"<pre><code>let body = serde_json::json!({\n    \"query\": \"premium data\"\n});\n\nlet response = client.post(\n    \"https://api.example.com/query\",\n    Some(body.to_string())\n).await?;\n\nlet data = response.text().await?;\n</code></pre>"},{"location":"rust/libraries/client/#automatic-flow","title":"Automatic Flow","text":"<p>When you make a request, the auto client:</p> <ol> <li>Makes initial HTTP request</li> <li>If 402 received:</li> <li>Parses payment request</li> <li>Checks amount against <code>max_payment_amount</code></li> <li>Creates and broadcasts payment</li> <li>Retries request with payment authorization</li> <li>Returns successful response or error</li> </ol>"},{"location":"rust/libraries/client/#access-to-underlying-client","title":"Access to Underlying Client","text":"<pre><code>// Get the explicit client for manual operations\nlet explicit_client = auto_client.client();\n\n// Get current options\nlet options = auto_client.options();\nprintln!(\"Max payment: {}\", options.max_payment_amount);\n</code></pre>"},{"location":"rust/libraries/client/#x402client","title":"X402Client","text":"<p>The explicit client gives you full control over the payment flow.</p>"},{"location":"rust/libraries/client/#creating-an-explicit-client","title":"Creating an Explicit Client","text":"<pre><code>use openlibx402_client::X402Client;\nuse solana_sdk::signature::Keypair;\n\nlet keypair = Keypair::new();\n\n// With default RPC\nlet client = X402Client::new(keypair, None);\n\n// With custom RPC\nlet client = X402Client::new(\n    keypair,\n    Some(\"https://your-rpc.com\")\n);\n</code></pre>"},{"location":"rust/libraries/client/#making-requests_1","title":"Making Requests","text":""},{"location":"rust/libraries/client/#get-request_1","title":"GET Request","text":"<pre><code>#[tokio::main]\nasync fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {\n    let client = X402Client::new(keypair, None);\n\n    // Make initial request\n    let response = client.get(\"https://api.example.com/premium-data\").await?;\n\n    // Check if payment required\n    if client.is_payment_required(&amp;response) {\n        // Parse payment request\n        let payment_request = client.parse_payment_request(response).await?;\n\n        println!(\"Amount: {} USDC\", payment_request.max_amount_required);\n\n        // Create payment\n        let authorization = client.create_payment(&amp;payment_request).await?;\n\n        // Retry with payment\n        let response = client.get_with_auth(\n            \"https://api.example.com/premium-data\",\n            &amp;authorization\n        ).await?;\n\n        let body = response.text().await?;\n        println!(\"Data: {}\", body);\n    } else {\n        let body = response.text().await?;\n        println!(\"Data: {}\", body);\n    }\n\n    Ok(())\n}\n</code></pre>"},{"location":"rust/libraries/client/#post-request_1","title":"POST Request","text":"<pre><code>let body = serde_json::json!({\"query\": \"data\"});\n\n// Initial request\nlet response = client.post(\n    \"https://api.example.com/query\",\n    Some(body.to_string())\n).await?;\n\nif client.is_payment_required(&amp;response) {\n    let payment_request = client.parse_payment_request(response).await?;\n    let authorization = client.create_payment(&amp;payment_request).await?;\n\n    // Retry with payment\n    let response = client.post_with_auth(\n        \"https://api.example.com/query\",\n        Some(body.to_string()),\n        &amp;authorization\n    ).await?;\n}\n</code></pre>"},{"location":"rust/libraries/client/#client-methods","title":"Client Methods","text":"<pre><code>// Check if response is 402\nlet is_402 = client.is_payment_required(&amp;response);\n\n// Parse payment request from 402 response\nlet payment_request = client.parse_payment_request(response).await?;\n\n// Create and broadcast payment\nlet authorization = client.create_payment(&amp;payment_request).await?;\n\n// Verify payment (optional)\nlet verified = client.verify_payment(&amp;authorization, \"0.10\").await?;\n\n// Make requests with payment authorization\nlet response = client.get_with_auth(url, &amp;authorization).await?;\nlet response = client.post_with_auth(url, body, &amp;authorization).await?;\n</code></pre>"},{"location":"rust/libraries/client/#error-handling","title":"Error Handling","text":"<p>Both clients return <code>X402Result&lt;T&gt;</code> or standard <code>Result</code> types.</p>"},{"location":"rust/libraries/client/#handling-x402-errors","title":"Handling X402 Errors","text":"<pre><code>use openlibx402_core::X402Error;\n\nmatch client.get(url).await {\n    Ok(response) =&gt; {\n        // Handle response\n    }\n    Err(X402Error::PaymentRequired(msg)) =&gt; {\n        eprintln!(\"Payment required: {}\", msg);\n    }\n    Err(X402Error::InsufficientFunds(msg)) =&gt; {\n        eprintln!(\"Insufficient funds: {}\", msg);\n    }\n    Err(X402Error::PaymentExpired(msg)) =&gt; {\n        eprintln!(\"Payment expired: {}\", msg);\n    }\n    Err(X402Error::TransactionBroadcast(msg)) =&gt; {\n        eprintln!(\"Transaction failed: {}\", msg);\n    }\n    Err(X402Error::Network(msg)) =&gt; {\n        eprintln!(\"Network error: {}\", msg);\n    }\n    Err(e) =&gt; {\n        eprintln!(\"Error: {}\", e);\n    }\n}\n</code></pre>"},{"location":"rust/libraries/client/#handling-http-errors","title":"Handling HTTP Errors","text":"<pre><code>let response = client.get(url).await?;\n\nif !response.status().is_success() {\n    eprintln!(\"HTTP error: {}\", response.status());\n}\n</code></pre>"},{"location":"rust/libraries/client/#advanced-usage","title":"Advanced Usage","text":""},{"location":"rust/libraries/client/#custom-request-handling","title":"Custom Request Handling","text":"<pre><code>impl X402Client {\n    // Make custom HTTP requests\n    async fn request(\n        &amp;self,\n        method: &amp;str,\n        url: &amp;str,\n        body: Option&lt;String&gt;,\n        authorization: Option&lt;&amp;PaymentAuthorization&gt;,\n    ) -&gt; X402Result&lt;Response&gt;\n}\n</code></pre>"},{"location":"rust/libraries/client/#payment-verification","title":"Payment Verification","text":"<pre><code>// Verify payment was successful\nlet authorization = client.create_payment(&amp;payment_request).await?;\n\nlet verified = client.verify_payment(\n    &amp;authorization,\n    &amp;payment_request.max_amount_required\n).await?;\n\nif verified {\n    println!(\"Payment verified on-chain\");\n}\n</code></pre>"},{"location":"rust/libraries/client/#checking-payment-requirements","title":"Checking Payment Requirements","text":"<pre><code>use reqwest::StatusCode;\n\nlet response = client.get(url).await?;\n\nmatch response.status() {\n    StatusCode::OK =&gt; {\n        // No payment required\n        let data = response.text().await?;\n    }\n    StatusCode::PAYMENT_REQUIRED =&gt; {\n        // Payment required\n        let payment_request = PaymentRequest::from_json(\n            &amp;response.text().await?\n        )?;\n    }\n    status =&gt; {\n        // Other HTTP error\n        eprintln!(\"HTTP {}\", status);\n    }\n}\n</code></pre>"},{"location":"rust/libraries/client/#best-practices","title":"Best Practices","text":""},{"location":"rust/libraries/client/#1-use-auto-client-for-simple-cases","title":"1. Use Auto Client for Simple Cases","text":"<pre><code>// Recommended for most use cases\nlet client = X402AutoClient::new(keypair, None, None);\nlet response = client.get(url).await?;\n</code></pre>"},{"location":"rust/libraries/client/#2-set-payment-limits","title":"2. Set Payment Limits","text":"<pre><code>let options = AutoClientOptions {\n    max_payment_amount: \"5.0\".to_string(),  // Prevent overpaying\n    auto_retry: true,\n    max_retries: 3,\n};\n</code></pre>"},{"location":"rust/libraries/client/#3-handle-expired-payments","title":"3. Handle Expired Payments","text":"<pre><code>loop {\n    match client.get(url).await {\n        Ok(response) =&gt; break response,\n        Err(X402Error::PaymentExpired(_)) =&gt; {\n            // Payment expired, retry automatically\n            continue;\n        }\n        Err(e) =&gt; return Err(e),\n    }\n}\n</code></pre>"},{"location":"rust/libraries/client/#4-reuse-clients","title":"4. Reuse Clients","text":"<pre><code>// Create once, reuse for multiple requests\nlet client = X402AutoClient::new(keypair, None, None);\n\nfor url in urls {\n    let response = client.get(&amp;url).await?;\n    // Process response\n}\n</code></pre>"},{"location":"rust/libraries/client/#5-custom-rpc-for-performance","title":"5. Custom RPC for Performance","text":"<pre><code>// Use dedicated RPC endpoint for better performance\nlet client = X402AutoClient::new(\n    keypair,\n    Some(\"https://your-fast-rpc.com\"),\n    None\n);\n</code></pre>"},{"location":"rust/libraries/client/#complete-examples","title":"Complete Examples","text":""},{"location":"rust/libraries/client/#auto-client-with-error-handling","title":"Auto Client with Error Handling","text":"<pre><code>use openlibx402_client::{X402AutoClient, AutoClientOptions};\nuse openlibx402_core::X402Error;\nuse solana_sdk::signature::Keypair;\n\n#[tokio::main]\nasync fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {\n    let keypair = Keypair::new();\n\n    let options = AutoClientOptions {\n        max_payment_amount: \"5.0\".to_string(),\n        auto_retry: true,\n        max_retries: 3,\n    };\n\n    let client = X402AutoClient::new(keypair, None, Some(options));\n\n    let urls = vec![\n        \"http://localhost:8000/basic\",\n        \"http://localhost:8000/premium\",\n        \"http://localhost:8000/enterprise\",\n    ];\n\n    for url in urls {\n        match client.get(url).await {\n            Ok(response) =&gt; {\n                let body = response.text().await?;\n                println!(\"\u2713 {}: {}\", url, body);\n            }\n            Err(X402Error::InsufficientFunds(msg)) =&gt; {\n                eprintln!(\"\u2717 {}: Insufficient funds - {}\", url, msg);\n            }\n            Err(X402Error::PaymentRequired(msg)) =&gt; {\n                eprintln!(\"\u2717 {}: Payment required exceeds limit - {}\", url, msg);\n            }\n            Err(e) =&gt; {\n                eprintln!(\"\u2717 {}: {}\", url, e);\n            }\n        }\n    }\n\n    Ok(())\n}\n</code></pre>"},{"location":"rust/libraries/client/#explicit-client-with-full-control","title":"Explicit Client with Full Control","text":"<pre><code>use openlibx402_client::X402Client;\nuse solana_sdk::signature::read_keypair_file;\n\n#[tokio::main]\nasync fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {\n    let keypair = read_keypair_file(\"~/.config/solana/id.json\")?;\n    let client = X402Client::new(keypair, None);\n\n    let url = \"http://localhost:8000/premium\";\n\n    // Make request\n    let response = client.get(url).await?;\n\n    // Handle 402\n    if client.is_payment_required(&amp;response) {\n        let payment_request = client.parse_payment_request(response).await?;\n\n        // Show payment details to user\n        println!(\"Payment required:\");\n        println!(\"  Amount: {} USDC\", payment_request.max_amount_required);\n        println!(\"  Description: {:?}\", payment_request.description);\n        println!(\"  Expires: {}\", payment_request.expires_at);\n\n        // Confirm with user (in real app)\n        println!(\"Proceeding with payment...\");\n\n        // Create payment\n        let authorization = client.create_payment(&amp;payment_request).await?;\n        println!(\"Payment sent: {}\", authorization.signature);\n\n        // Retry request\n        let response = client.get_with_auth(url, &amp;authorization).await?;\n        let body = response.text().await?;\n        println!(\"Received: {}\", body);\n    } else {\n        let body = response.text().await?;\n        println!(\"Received: {}\", body);\n    }\n\n    Ok(())\n}\n</code></pre>"},{"location":"rust/libraries/client/#see-also","title":"See Also","text":"<ul> <li>Core Library - Payment models and processor</li> <li>Client Quick Start - Quick start guide</li> <li>Error Reference - Error handling details</li> </ul>"},{"location":"rust/libraries/core/","title":"Core Library","text":"<p>The <code>openlibx402-core</code> crate provides the fundamental types, error handling, and Solana payment processing for the X402 protocol.</p>"},{"location":"rust/libraries/core/#installation","title":"Installation","text":"<pre><code>[dependencies]\nopenlibx402-core = \"0.1\"\n</code></pre>"},{"location":"rust/libraries/core/#overview","title":"Overview","text":"<p>The core library includes:</p> <ul> <li>Payment Models - <code>PaymentRequest</code> and <code>PaymentAuthorization</code></li> <li>Error Types - Comprehensive error handling with <code>X402Error</code></li> <li>Payment Processor - <code>SolanaPaymentProcessor</code> for blockchain operations</li> <li>Utilities - Serialization, base64 encoding, expiration checking</li> </ul>"},{"location":"rust/libraries/core/#payment-models","title":"Payment Models","text":""},{"location":"rust/libraries/core/#paymentrequest","title":"PaymentRequest","text":"<p>Represents a payment requirement from a server.</p> <pre><code>use openlibx402_core::PaymentRequest;\nuse chrono::{Utc, Duration};\n\nlet payment_request = PaymentRequest::new(\n    \"0.10\".to_string(),                                              // amount\n    \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\".to_string(),   // token mint\n    \"7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU\".to_string(),   // payment address\n    \"solana-devnet\".to_string(),                                    // network\n    Utc::now() + Duration::seconds(300),                            // expires_at\n    \"nonce123\".to_string(),                                         // nonce\n    \"payment123\".to_string(),                                       // payment_id\n    \"/api/premium-data\".to_string(),                                // resource\n).with_description(\"Access to premium data\".to_string());\n</code></pre>"},{"location":"rust/libraries/core/#fields","title":"Fields","text":"<ul> <li><code>max_amount_required</code> - Amount in USDC (e.g., \"0.10\")</li> <li><code>asset_type</code> - Asset type (\"SPL\" for Solana tokens)</li> <li><code>asset_address</code> - Token mint address (USDC address)</li> <li><code>payment_address</code> - Recipient wallet address</li> <li><code>network</code> - Network identifier (\"solana-devnet\", \"solana-mainnet\")</li> <li><code>expires_at</code> - Expiration timestamp (ISO 8601)</li> <li><code>nonce</code> - Unique nonce for replay protection</li> <li><code>payment_id</code> - Unique payment identifier</li> <li><code>resource</code> - API endpoint being accessed</li> <li><code>description</code> - Optional human-readable description</li> </ul>"},{"location":"rust/libraries/core/#methods","title":"Methods","text":"<pre><code>// Check if expired\nif payment_request.is_expired() {\n    println!(\"Payment request expired\");\n}\n\n// Serialize to JSON\nlet json = payment_request.to_json()?;\n\n// Deserialize from JSON\nlet request = PaymentRequest::from_json(&amp;json)?;\n\n// Encode as base64\nlet encoded = payment_request.to_base64()?;\n\n// Decode from base64\nlet request = PaymentRequest::from_base64(&amp;encoded)?;\n</code></pre>"},{"location":"rust/libraries/core/#paymentauthorization","title":"PaymentAuthorization","text":"<p>Represents proof of payment sent with retry requests.</p> <pre><code>use openlibx402_core::PaymentAuthorization;\n\nlet authorization = PaymentAuthorization::new(\n    \"payment123\".to_string(),                                       // payment_id\n    \"0.10\".to_string(),                                             // actual_amount\n    \"7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU\".to_string(),   // payment_address\n    \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\".to_string(),   // asset_address\n    \"solana-devnet\".to_string(),                                    // network\n    \"5VERv8NMv...\".to_string(),                                     // signature\n    \"7xKXtg2CW8...\".to_string(),                                    // public_key\n);\n</code></pre>"},{"location":"rust/libraries/core/#fields_1","title":"Fields","text":"<ul> <li><code>payment_id</code> - Links to the original payment request</li> <li><code>actual_amount</code> - Amount paid in USDC</li> <li><code>payment_address</code> - Recipient wallet address</li> <li><code>asset_address</code> - Token mint address</li> <li><code>network</code> - Network identifier</li> <li><code>timestamp</code> - When payment was authorized</li> <li><code>signature</code> - Solana transaction signature</li> <li><code>public_key</code> - Payer's public key</li> <li><code>transaction_hash</code> - On-chain transaction hash (optional)</li> </ul>"},{"location":"rust/libraries/core/#methods_1","title":"Methods","text":"<pre><code>// Serialize to JSON\nlet json = authorization.to_json()?;\n\n// Deserialize from JSON\nlet auth = PaymentAuthorization::from_json(&amp;json)?;\n\n// Encode for HTTP header\nlet header_value = authorization.to_header_value()?;\n\n// Decode from HTTP header\nlet auth = PaymentAuthorization::from_header_value(&amp;header_value)?;\n</code></pre>"},{"location":"rust/libraries/core/#error-types","title":"Error Types","text":"<p>The <code>X402Error</code> enum covers all error cases:</p> <pre><code>use openlibx402_core::X402Error;\n\npub enum X402Error {\n    PaymentRequired(String),\n    PaymentExpired(String),\n    InsufficientFunds(String),\n    PaymentVerification(String),\n    TransactionBroadcast(String),\n    InvalidPaymentRequest(String),\n    InvalidPaymentAuthorization(String),\n    Configuration(String),\n    Network(String),\n    Blockchain(String),\n    Serialization(String),\n}\n</code></pre>"},{"location":"rust/libraries/core/#error-codes","title":"Error Codes","text":"<p>Each error has a unique code:</p> <pre><code>let error = X402Error::PaymentRequired(\"Payment needed\".to_string());\nprintln!(\"Code: {}\", error.code());  // \"PAYMENT_REQUIRED\"\nprintln!(\"Message: {}\", error.message());\n</code></pre>"},{"location":"rust/libraries/core/#error-handling","title":"Error Handling","text":"<pre><code>use openlibx402_core::{X402Error, X402Result};\n\nfn process_payment() -&gt; X402Result&lt;String&gt; {\n    // ... operation that might fail\n\n    match result {\n        Ok(data) =&gt; Ok(data),\n        Err(X402Error::PaymentExpired(msg)) =&gt; {\n            eprintln!(\"Payment expired: {}\", msg);\n            Err(X402Error::PaymentExpired(msg))\n        }\n        Err(X402Error::InsufficientFunds(msg)) =&gt; {\n            eprintln!(\"Insufficient funds: {}\", msg);\n            Err(X402Error::InsufficientFunds(msg))\n        }\n        Err(e) =&gt; Err(e),\n    }\n}\n</code></pre>"},{"location":"rust/libraries/core/#automatic-conversions","title":"Automatic Conversions","text":"<p>The library provides automatic error conversions:</p> <pre><code>// Automatic conversion from serde_json::Error\nlet json_result: Result&lt;PaymentRequest, _&gt; = serde_json::from_str(data);\nlet x402_result: X402Result&lt;PaymentRequest&gt; = json_result.map_err(Into::into);\n\n// Automatic conversion from Solana errors\nlet solana_result = rpc_client.get_latest_blockhash();\nlet x402_result: X402Result&lt;_&gt; = solana_result.map_err(Into::into);\n</code></pre>"},{"location":"rust/libraries/core/#solana-payment-processor","title":"Solana Payment Processor","text":"<p>The <code>SolanaPaymentProcessor</code> handles blockchain operations.</p>"},{"location":"rust/libraries/core/#creating-a-processor","title":"Creating a Processor","text":"<pre><code>use openlibx402_core::SolanaPaymentProcessor;\n\n// Use default RPC URL\nlet processor = SolanaPaymentProcessor::new(\n    \"https://api.devnet.solana.com\",\n    None  // Use default commitment\n);\n\n// Use custom RPC and commitment\nuse solana_sdk::commitment_config::CommitmentConfig;\n\nlet processor = SolanaPaymentProcessor::new(\n    \"https://your-rpc.com\",\n    Some(CommitmentConfig::confirmed())\n);\n</code></pre>"},{"location":"rust/libraries/core/#creating-payments","title":"Creating Payments","text":"<pre><code>use solana_sdk::signature::Keypair;\n\nlet keypair = Keypair::new();\nlet payment_request = /* ... */;\n\n// Create and broadcast payment\nlet authorization = processor.create_payment(\n    &amp;payment_request,\n    &amp;keypair\n).await?;\n\nprintln!(\"Payment sent! Signature: {}\", authorization.signature);\n</code></pre> <p>The processor automatically: - Checks if payment expired - Validates addresses - Checks sender balance - Creates recipient ATA if needed - Builds and signs transaction - Broadcasts to Solana - Returns payment authorization</p>"},{"location":"rust/libraries/core/#verifying-payments","title":"Verifying Payments","text":"<pre><code>// Verify payment on-chain\nlet verified = processor.verify_payment(\n    &amp;authorization,\n    \"0.10\"  // expected amount\n).await?;\n\nif verified {\n    println!(\"Payment verified!\");\n}\n</code></pre>"},{"location":"rust/libraries/core/#checking-balances","title":"Checking Balances","text":"<pre><code>use solana_sdk::pubkey::Pubkey;\nuse std::str::FromStr;\n\nlet token_account = Pubkey::from_str(\"...\")?;\nlet balance = processor.get_token_balance(&amp;token_account).await?;\n\nprintln!(\"Balance: {} lamports\", balance);\n</code></pre>"},{"location":"rust/libraries/core/#default-rpc-urls","title":"Default RPC URLs","text":"<pre><code>// Get default RPC for network\nlet url = SolanaPaymentProcessor::default_rpc_url(\"solana-devnet\");\n// Returns: \"https://api.devnet.solana.com\"\n\nlet url = SolanaPaymentProcessor::default_rpc_url(\"solana-mainnet\");\n// Returns: \"https://api.mainnet-beta.solana.com\"\n</code></pre>"},{"location":"rust/libraries/core/#constants","title":"Constants","text":""},{"location":"rust/libraries/core/#library-version","title":"Library Version","text":"<pre><code>use openlibx402_core::VERSION;\n\nprintln!(\"openlibx402-core version: {}\", VERSION);\n</code></pre>"},{"location":"rust/libraries/core/#type-aliases","title":"Type Aliases","text":"<pre><code>// Result type for X402 operations\npub type X402Result&lt;T&gt; = Result&lt;T, X402Error&gt;;\n</code></pre>"},{"location":"rust/libraries/core/#features","title":"Features","text":"<p>The core library supports:</p> <ul> <li>Async-first - All I/O operations are async</li> <li>Type-safe - Compile-time guarantees</li> <li>Zero-copy - Efficient serialization where possible</li> <li>Comprehensive errors - Detailed error messages</li> <li>Automatic conversions - From common error types</li> <li>Solana integration - Full Solana SDK support</li> </ul>"},{"location":"rust/libraries/core/#examples","title":"Examples","text":""},{"location":"rust/libraries/core/#complete-payment-flow","title":"Complete Payment Flow","text":"<pre><code>use openlibx402_core::{\n    PaymentRequest, SolanaPaymentProcessor, X402Result\n};\nuse solana_sdk::signature::Keypair;\n\n#[tokio::main]\nasync fn main() -&gt; X402Result&lt;()&gt; {\n    // Parse payment request from server\n    let payment_request = PaymentRequest::from_json(r#\"\n        {\n            \"max_amount_required\": \"0.10\",\n            \"asset_type\": \"SPL\",\n            \"asset_address\": \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\",\n            \"payment_address\": \"7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU\",\n            \"network\": \"solana-devnet\",\n            \"expires_at\": \"2025-10-31T12:00:00Z\",\n            \"nonce\": \"abc123\",\n            \"payment_id\": \"pay_123\",\n            \"resource\": \"/api/premium-data\"\n        }\n    \"#)?;\n\n    // Create payment processor\n    let processor = SolanaPaymentProcessor::new(\n        \"https://api.devnet.solana.com\",\n        None\n    );\n\n    // Load keypair\n    let keypair = Keypair::new();  // Use your actual keypair\n\n    // Create and send payment\n    let authorization = processor.create_payment(\n        &amp;payment_request,\n        &amp;keypair\n    ).await?;\n\n    // Encode for HTTP header\n    let header_value = authorization.to_header_value()?;\n    println!(\"X-Payment-Authorization: {}\", header_value);\n\n    Ok(())\n}\n</code></pre>"},{"location":"rust/libraries/core/#see-also","title":"See Also","text":"<ul> <li>Client Library - HTTP client built on core</li> <li>Error Reference - Detailed error documentation</li> <li>API Reference - Complete API documentation</li> </ul>"},{"location":"rust/middleware/actix/","title":"Actix Web Middleware","text":"<p>The <code>openlibx402-actix</code> crate provides integration with the Actix Web framework for protecting endpoints with X402 payment requirements.</p>"},{"location":"rust/middleware/actix/#installation","title":"Installation","text":"<pre><code>[dependencies]\nopenlibx402-core = \"0.1\"\nopenlibx402-actix = \"0.1\"\nactix-web = \"4.4\"\nactix-rt = \"2.9\"\n</code></pre>"},{"location":"rust/middleware/actix/#overview","title":"Overview","text":"<p>Actix Web integration provides: - <code>PaymentExtractor</code> - Extractor for payment enforcement - <code>X402Config</code> and <code>X402State</code> - Server configuration - <code>PaymentRequirement</code> - Payment configuration per endpoint - Helper functions for creating payment requests and responses</p>"},{"location":"rust/middleware/actix/#quick-start","title":"Quick Start","text":"<pre><code>use actix_web::{get, web, App, HttpResponse, HttpServer};\nuse openlibx402_actix::{\n    create_payment_request, payment_required_response,\n    PaymentExtractor, PaymentRequirement, X402Config, X402State,\n};\nuse serde::Serialize;\n\n#[derive(Serialize)]\nstruct Data {\n    message: String,\n}\n\n#[get(\"/premium\")]\nasync fn premium(\n    state: web::Data&lt;X402State&gt;,\n    auth: Option&lt;PaymentExtractor&gt;,\n) -&gt; HttpResponse {\n    match auth {\n        Some(_) =&gt; HttpResponse::Ok().json(Data {\n            message: \"Premium content\".to_string(),\n        }),\n        None =&gt; {\n            let requirement = PaymentRequirement::new(\"0.10\");\n            let payment_request = create_payment_request(&amp;state.config, &amp;requirement, \"/premium\");\n            payment_required_response(payment_request)\n        }\n    }\n}\n\n#[actix_web::main]\nasync fn main() -&gt; std::io::Result&lt;()&gt; {\n    let config = X402Config {\n        payment_address: \"YOUR_WALLET\".to_string(),\n        token_mint: \"USDC_MINT\".to_string(),\n        network: \"solana-devnet\".to_string(),\n        rpc_url: None,\n        auto_verify: true,\n    };\n\n    let state = web::Data::new(X402State { config });\n\n    HttpServer::new(move || {\n        App::new()\n            .app_data(state.clone())\n            .service(premium)\n    })\n    .bind((\"127.0.0.1\", 8080))?\n    .run()\n    .await\n}\n</code></pre>"},{"location":"rust/middleware/actix/#x402config","title":"X402Config","text":"<p>Global configuration for X402 payments.</p> <pre><code>pub struct X402Config {\n    /// Wallet address to receive payments\n    pub payment_address: String,\n\n    /// SPL token mint address (USDC)\n    pub token_mint: String,\n\n    /// Solana network\n    pub network: String,\n\n    /// Optional custom RPC URL\n    pub rpc_url: Option&lt;String&gt;,\n\n    /// Whether to verify payments on-chain\n    pub auto_verify: bool,\n}\n</code></pre>"},{"location":"rust/middleware/actix/#x402state","title":"X402State","text":"<p>Application state containing configuration.</p> <pre><code>pub struct X402State {\n    pub config: X402Config,\n}\n</code></pre>"},{"location":"rust/middleware/actix/#setup","title":"Setup","text":"<pre><code>let config = X402Config {\n    payment_address: \"7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU\".to_string(),\n    token_mint: \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\".to_string(),\n    network: \"solana-devnet\".to_string(),\n    rpc_url: None,\n    auto_verify: true,\n};\n\nlet state = web::Data::new(X402State { config });\n\nHttpServer::new(move || {\n    App::new()\n        .app_data(state.clone())\n        // ...\n})\n</code></pre>"},{"location":"rust/middleware/actix/#paymentextractor","title":"PaymentExtractor","text":"<p>Extractor that enforces payment requirements.</p>"},{"location":"rust/middleware/actix/#usage","title":"Usage","text":"<pre><code>#[get(\"/protected\")]\nasync fn protected(auth: PaymentExtractor) -&gt; HttpResponse {\n    HttpResponse::Ok().json(serde_json::json!({\n        \"payment_id\": auth.authorization.payment_id\n    }))\n}\n</code></pre>"},{"location":"rust/middleware/actix/#optional-extractor","title":"Optional Extractor","text":"<p>Use <code>Option&lt;PaymentExtractor&gt;</code> to manually handle 402 responses:</p> <pre><code>#[get(\"/protected\")]\nasync fn protected(\n    state: web::Data&lt;X402State&gt;,\n    auth: Option&lt;PaymentExtractor&gt;,\n) -&gt; HttpResponse {\n    match auth {\n        Some(auth) =&gt; {\n            // Payment verified\n            HttpResponse::Ok().json(serde_json::json!({\n                \"data\": \"premium content\"\n            }))\n        }\n        None =&gt; {\n            // Return 402 with payment request\n            let requirement = PaymentRequirement::new(\"0.10\");\n            let payment_request = create_payment_request(&amp;state.config, &amp;requirement, \"/protected\");\n            payment_required_response(payment_request)\n        }\n    }\n}\n</code></pre>"},{"location":"rust/middleware/actix/#paymentrequirement","title":"PaymentRequirement","text":"<p>Configuration for payment requirements.</p> <pre><code>pub struct PaymentRequirement {\n    /// Amount required in USDC\n    pub amount: String,\n\n    /// Optional description\n    pub description: Option&lt;String&gt;,\n\n    /// Expiration time in seconds (default: 300)\n    pub expires_in: i64,\n}\n</code></pre>"},{"location":"rust/middleware/actix/#creating-requirements","title":"Creating Requirements","text":"<pre><code>// Simple requirement\nlet requirement = PaymentRequirement::new(\"0.10\");\n\n// With description\nlet requirement = PaymentRequirement::new(\"0.10\")\n    .with_description(\"Access to premium data\");\n\n// With custom expiration\nlet requirement = PaymentRequirement::new(\"0.10\")\n    .with_description(\"Premium API access\")\n    .with_expires_in(600);  // 10 minutes\n</code></pre>"},{"location":"rust/middleware/actix/#helper-functions","title":"Helper Functions","text":""},{"location":"rust/middleware/actix/#create_payment_request","title":"create_payment_request","text":"<p>Creates a payment request for an endpoint:</p> <pre><code>pub fn create_payment_request(\n    config: &amp;X402Config,\n    requirement: &amp;PaymentRequirement,\n    resource: &amp;str,\n) -&gt; PaymentRequest\n</code></pre>"},{"location":"rust/middleware/actix/#payment_required_response","title":"payment_required_response","text":"<p>Creates a 402 HTTP response with payment request:</p> <pre><code>pub fn payment_required_response(\n    payment_request: PaymentRequest\n) -&gt; HttpResponse\n</code></pre> <p>Example:</p> <pre><code>let requirement = PaymentRequirement::new(\"0.10\");\nlet payment_request = create_payment_request(&amp;config, &amp;requirement, \"/api/data\");\nlet response = payment_required_response(payment_request);\n</code></pre>"},{"location":"rust/middleware/actix/#paymenterror","title":"PaymentError","text":"<p>Error type for payment operations:</p> <pre><code>pub enum PaymentError {\n    Required,\n    InvalidHeader,\n    InvalidAuthorization(String),\n}\n</code></pre> <p>Automatically converts to appropriate HTTP responses: - <code>Required</code> \u2192 402 Payment Required - <code>InvalidHeader</code> \u2192 400 Bad Request - <code>InvalidAuthorization</code> \u2192 400 Bad Request</p>"},{"location":"rust/middleware/actix/#complete-examples","title":"Complete Examples","text":""},{"location":"rust/middleware/actix/#multiple-pricing-tiers","title":"Multiple Pricing Tiers","text":"<pre><code>use actix_web::{get, web, App, HttpResponse, HttpServer};\nuse openlibx402_actix::*;\nuse serde::Serialize;\n\n#[derive(Serialize)]\nstruct TierData {\n    tier: String,\n    data: Vec&lt;String&gt;,\n}\n\n#[get(\"/basic\")]\nasync fn basic(\n    state: web::Data&lt;X402State&gt;,\n    auth: Option&lt;PaymentExtractor&gt;,\n) -&gt; HttpResponse {\n    match auth {\n        Some(_) =&gt; HttpResponse::Ok().json(TierData {\n            tier: \"basic\".to_string(),\n            data: vec![\"Basic data\".to_string()],\n        }),\n        None =&gt; {\n            let req = PaymentRequirement::new(\"0.01\")\n                .with_description(\"Basic tier access\");\n            payment_required_response(create_payment_request(&amp;state.config, &amp;req, \"/basic\"))\n        }\n    }\n}\n\n#[get(\"/premium\")]\nasync fn premium(\n    state: web::Data&lt;X402State&gt;,\n    auth: Option&lt;PaymentExtractor&gt;,\n) -&gt; HttpResponse {\n    match auth {\n        Some(_) =&gt; HttpResponse::Ok().json(TierData {\n            tier: \"premium\".to_string(),\n            data: vec![\"Premium 1\".to_string(), \"Premium 2\".to_string()],\n        }),\n        None =&gt; {\n            let req = PaymentRequirement::new(\"0.10\")\n                .with_description(\"Premium tier access\")\n                .with_expires_in(600);\n            payment_required_response(create_payment_request(&amp;state.config, &amp;req, \"/premium\"))\n        }\n    }\n}\n\n#[get(\"/enterprise\")]\nasync fn enterprise(\n    state: web::Data&lt;X402State&gt;,\n    auth: Option&lt;PaymentExtractor&gt;,\n) -&gt; HttpResponse {\n    match auth {\n        Some(_) =&gt; HttpResponse::Ok().json(TierData {\n            tier: \"enterprise\".to_string(),\n            data: vec![\"Enterprise 1\".to_string(), \"Enterprise 2\".to_string(), \"Enterprise 3\".to_string()],\n        }),\n        None =&gt; {\n            let req = PaymentRequirement::new(\"1.00\")\n                .with_description(\"Enterprise tier access\");\n            payment_required_response(create_payment_request(&amp;state.config, &amp;req, \"/enterprise\"))\n        }\n    }\n}\n\n#[actix_web::main]\nasync fn main() -&gt; std::io::Result&lt;()&gt; {\n    let config = X402Config {\n        payment_address: \"YOUR_WALLET\".to_string(),\n        token_mint: \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\".to_string(),\n        network: \"solana-devnet\".to_string(),\n        rpc_url: None,\n        auto_verify: true,\n    };\n\n    let state = web::Data::new(X402State { config });\n\n    HttpServer::new(move || {\n        App::new()\n            .app_data(state.clone())\n            .service(basic)\n            .service(premium)\n            .service(enterprise)\n    })\n    .bind((\"127.0.0.1\", 8080))?\n    .run()\n    .await\n}\n</code></pre>"},{"location":"rust/middleware/actix/#accessing-payment-details","title":"Accessing Payment Details","text":"<pre><code>#[get(\"/paid-endpoint\")]\nasync fn paid_endpoint(auth: PaymentExtractor) -&gt; HttpResponse {\n    HttpResponse::Ok().json(serde_json::json!({\n        \"payment_id\": auth.authorization.payment_id,\n        \"amount_paid\": auth.authorization.actual_amount,\n        \"payer\": auth.authorization.public_key,\n        \"transaction\": auth.authorization.signature,\n    }))\n}\n</code></pre>"},{"location":"rust/middleware/actix/#mixed-free-and-paid-endpoints","title":"Mixed Free and Paid Endpoints","text":"<pre><code>#[get(\"/free\")]\nasync fn free_endpoint() -&gt; HttpResponse {\n    HttpResponse::Ok().body(\"This is free content\")\n}\n\n#[get(\"/paid\")]\nasync fn paid_endpoint(\n    state: web::Data&lt;X402State&gt;,\n    auth: Option&lt;PaymentExtractor&gt;,\n) -&gt; HttpResponse {\n    match auth {\n        Some(_) =&gt; HttpResponse::Ok().body(\"This is paid content\"),\n        None =&gt; {\n            let req = PaymentRequirement::new(\"0.10\");\n            payment_required_response(create_payment_request(&amp;state.config, &amp;req, \"/paid\"))\n        }\n    }\n}\n</code></pre>"},{"location":"rust/middleware/actix/#best-practices","title":"Best Practices","text":""},{"location":"rust/middleware/actix/#1-use-app-data-for-configuration","title":"1. Use App Data for Configuration","text":"<pre><code>let state = web::Data::new(X402State { config });\n\nHttpServer::new(move || {\n    App::new()\n        .app_data(state.clone())  // Available in all routes\n        .service(...)\n})\n</code></pre>"},{"location":"rust/middleware/actix/#2-set-reasonable-expirations","title":"2. Set Reasonable Expirations","text":"<pre><code>// Short-lived: 1 minute\nlet req = PaymentRequirement::new(\"0.01\").with_expires_in(60);\n\n// Standard: 5 minutes\nlet req = PaymentRequirement::new(\"0.10\").with_expires_in(300);\n\n// Long-lived: 1 hour\nlet req = PaymentRequirement::new(\"1.00\").with_expires_in(3600);\n</code></pre>"},{"location":"rust/middleware/actix/#3-add-descriptions","title":"3. Add Descriptions","text":"<pre><code>let req = PaymentRequirement::new(\"0.10\")\n    .with_description(\"Access to real-time market data\");\n</code></pre>"},{"location":"rust/middleware/actix/#4-enable-auto-verify-for-production","title":"4. Enable Auto-Verify for Production","text":"<pre><code>let config = X402Config {\n    // ...\n    auto_verify: true,  // Verify payments on-chain\n};\n</code></pre>"},{"location":"rust/middleware/actix/#see-also","title":"See Also","text":"<ul> <li>Actix Web Example - Complete example</li> <li>Server Quick Start - Getting started guide</li> <li>Configuration Reference - All options</li> </ul>"},{"location":"rust/middleware/rocket/","title":"Rocket Middleware","text":"<p>The <code>openlibx402-rocket</code> crate provides integration with the Rocket web framework for protecting endpoints with X402 payment requirements.</p>"},{"location":"rust/middleware/rocket/#installation","title":"Installation","text":"<pre><code>[dependencies]\nopenlibx402-core = \"0.1\"\nopenlibx402-rocket = \"0.1\"\nrocket = { version = \"0.5\", features = [\"json\"] }\n</code></pre>"},{"location":"rust/middleware/rocket/#overview","title":"Overview","text":"<p>Rocket integration provides: - <code>PaymentGuard</code> - Request guard for payment enforcement - <code>X402Config</code> - Server configuration - <code>PaymentRequirement</code> - Payment configuration per endpoint - Helper functions for creating payment requests</p>"},{"location":"rust/middleware/rocket/#quick-start","title":"Quick Start","text":"<pre><code>use openlibx402_rocket::{\n    create_payment_request, PaymentGuard, PaymentRequirement,\n    PaymentRequiredResponse, X402Config,\n};\nuse rocket::{get, routes, serde::json::Json, State};\nuse serde::Serialize;\n\n#[derive(Serialize)]\nstruct Data {\n    message: String,\n}\n\n#[get(\"/premium\")]\nfn premium(\n    config: &amp;State&lt;X402Config&gt;,\n    auth: Option&lt;PaymentGuard&gt;,\n) -&gt; Result&lt;Json&lt;Data&gt;, PaymentRequiredResponse&gt; {\n    match auth {\n        Some(_) =&gt; Ok(Json(Data {\n            message: \"Premium content\".to_string(),\n        })),\n        None =&gt; {\n            let requirement = PaymentRequirement::new(\"0.10\");\n            let payment_request = create_payment_request(config, &amp;requirement, \"/premium\");\n            Err(PaymentRequiredResponse { payment_request })\n        }\n    }\n}\n\n#[rocket::main]\nasync fn main() {\n    let config = X402Config {\n        payment_address: \"YOUR_WALLET\".to_string(),\n        token_mint: \"USDC_MINT\".to_string(),\n        network: \"solana-devnet\".to_string(),\n        rpc_url: None,\n        auto_verify: true,\n    };\n\n    rocket::build()\n        .manage(config)\n        .mount(\"/\", routes![premium])\n        .launch()\n        .await\n        .unwrap();\n}\n</code></pre>"},{"location":"rust/middleware/rocket/#x402config","title":"X402Config","text":"<p>Global configuration for X402 payments.</p> <pre><code>pub struct X402Config {\n    /// Wallet address to receive payments\n    pub payment_address: String,\n\n    /// SPL token mint address (USDC)\n    pub token_mint: String,\n\n    /// Solana network\n    pub network: String,\n\n    /// Optional custom RPC URL\n    pub rpc_url: Option&lt;String&gt;,\n\n    /// Whether to verify payments on-chain\n    pub auto_verify: bool,\n}\n</code></pre>"},{"location":"rust/middleware/rocket/#example-configuration","title":"Example Configuration","text":"<pre><code>let config = X402Config {\n    payment_address: \"7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU\".to_string(),\n    token_mint: \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\".to_string(),\n    network: \"solana-devnet\".to_string(),\n    rpc_url: Some(\"https://your-rpc.com\".to_string()),\n    auto_verify: true,\n};\n</code></pre>"},{"location":"rust/middleware/rocket/#paymentguard","title":"PaymentGuard","text":"<p>Request guard that enforces payment requirements.</p>"},{"location":"rust/middleware/rocket/#usage","title":"Usage","text":"<pre><code>#[get(\"/protected\")]\nfn protected(auth: PaymentGuard) -&gt; String {\n    format!(\"Payment ID: {}\", auth.authorization.payment_id)\n}\n</code></pre>"},{"location":"rust/middleware/rocket/#optional-guard","title":"Optional Guard","text":"<p>Use <code>Option&lt;PaymentGuard&gt;</code> to manually handle 402 responses:</p> <pre><code>#[get(\"/protected\")]\nfn protected(\n    config: &amp;State&lt;X402Config&gt;,\n    auth: Option&lt;PaymentGuard&gt;,\n) -&gt; Result&lt;Json&lt;Data&gt;, PaymentRequiredResponse&gt; {\n    match auth {\n        Some(auth) =&gt; {\n            // Payment verified\n            Ok(Json(Data { /* ... */ }))\n        }\n        None =&gt; {\n            // Return 402 with payment request\n            let requirement = PaymentRequirement::new(\"0.10\");\n            let payment_request = create_payment_request(config, &amp;requirement, \"/protected\");\n            Err(PaymentRequiredResponse { payment_request })\n        }\n    }\n}\n</code></pre>"},{"location":"rust/middleware/rocket/#paymentrequirement","title":"PaymentRequirement","text":"<p>Configuration for payment requirements.</p> <pre><code>pub struct PaymentRequirement {\n    /// Amount required in USDC\n    pub amount: String,\n\n    /// Optional description\n    pub description: Option&lt;String&gt;,\n\n    /// Expiration time in seconds (default: 300)\n    pub expires_in: i64,\n}\n</code></pre>"},{"location":"rust/middleware/rocket/#creating-requirements","title":"Creating Requirements","text":"<pre><code>// Simple requirement\nlet requirement = PaymentRequirement::new(\"0.10\");\n\n// With description\nlet requirement = PaymentRequirement::new(\"0.10\")\n    .with_description(\"Access to premium data\");\n\n// With custom expiration\nlet requirement = PaymentRequirement::new(\"0.10\")\n    .with_description(\"Premium API access\")\n    .with_expires_in(600);  // 10 minutes\n</code></pre>"},{"location":"rust/middleware/rocket/#helper-functions","title":"Helper Functions","text":""},{"location":"rust/middleware/rocket/#create_payment_request","title":"create_payment_request","text":"<p>Creates a payment request for an endpoint:</p> <pre><code>pub fn create_payment_request(\n    config: &amp;X402Config,\n    requirement: &amp;PaymentRequirement,\n    resource: &amp;str,\n) -&gt; PaymentRequest\n</code></pre> <p>Example:</p> <pre><code>let requirement = PaymentRequirement::new(\"0.10\");\nlet payment_request = create_payment_request(\n    config,\n    &amp;requirement,\n    \"/api/premium-data\"\n);\n</code></pre>"},{"location":"rust/middleware/rocket/#paymentrequiredresponse","title":"PaymentRequiredResponse","text":"<p>Response type that returns 402 status with payment request:</p> <pre><code>pub struct PaymentRequiredResponse {\n    pub payment_request: PaymentRequest,\n}\n</code></pre> <p>Automatically sets status to 402 and serializes payment request as JSON.</p>"},{"location":"rust/middleware/rocket/#complete-examples","title":"Complete Examples","text":""},{"location":"rust/middleware/rocket/#multiple-pricing-tiers","title":"Multiple Pricing Tiers","text":"<pre><code>use openlibx402_rocket::*;\nuse rocket::{get, routes, serde::json::Json, State};\nuse serde::Serialize;\n\n#[derive(Serialize)]\nstruct TierData {\n    tier: String,\n    data: Vec&lt;String&gt;,\n}\n\n#[get(\"/basic\")]\nfn basic(\n    config: &amp;State&lt;X402Config&gt;,\n    auth: Option&lt;PaymentGuard&gt;,\n) -&gt; Result&lt;Json&lt;TierData&gt;, PaymentRequiredResponse&gt; {\n    match auth {\n        Some(_) =&gt; Ok(Json(TierData {\n            tier: \"basic\".to_string(),\n            data: vec![\"Basic data\".to_string()],\n        })),\n        None =&gt; {\n            let req = PaymentRequirement::new(\"0.01\")\n                .with_description(\"Basic tier access\");\n            Err(PaymentRequiredResponse {\n                payment_request: create_payment_request(config, &amp;req, \"/basic\")\n            })\n        }\n    }\n}\n\n#[get(\"/premium\")]\nfn premium(\n    config: &amp;State&lt;X402Config&gt;,\n    auth: Option&lt;PaymentGuard&gt;,\n) -&gt; Result&lt;Json&lt;TierData&gt;, PaymentRequiredResponse&gt; {\n    match auth {\n        Some(_) =&gt; Ok(Json(TierData {\n            tier: \"premium\".to_string(),\n            data: vec![\"Premium data 1\".to_string(), \"Premium data 2\".to_string()],\n        })),\n        None =&gt; {\n            let req = PaymentRequirement::new(\"0.10\")\n                .with_description(\"Premium tier access\")\n                .with_expires_in(600);\n            Err(PaymentRequiredResponse {\n                payment_request: create_payment_request(config, &amp;req, \"/premium\")\n            })\n        }\n    }\n}\n\n#[get(\"/enterprise\")]\nfn enterprise(\n    config: &amp;State&lt;X402Config&gt;,\n    auth: Option&lt;PaymentGuard&gt;,\n) -&gt; Result&lt;Json&lt;TierData&gt;, PaymentRequiredResponse&gt; {\n    match auth {\n        Some(_) =&gt; Ok(Json(TierData {\n            tier: \"enterprise\".to_string(),\n            data: vec![\n                \"Enterprise data 1\".to_string(),\n                \"Enterprise data 2\".to_string(),\n                \"Enterprise data 3\".to_string(),\n            ],\n        })),\n        None =&gt; {\n            let req = PaymentRequirement::new(\"1.00\")\n                .with_description(\"Enterprise tier access\");\n            Err(PaymentRequiredResponse {\n                payment_request: create_payment_request(config, &amp;req, \"/enterprise\")\n            })\n        }\n    }\n}\n\n#[rocket::main]\nasync fn main() {\n    let config = X402Config {\n        payment_address: \"YOUR_WALLET\".to_string(),\n        token_mint: \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\".to_string(),\n        network: \"solana-devnet\".to_string(),\n        rpc_url: None,\n        auto_verify: true,\n    };\n\n    rocket::build()\n        .manage(config)\n        .mount(\"/\", routes![basic, premium, enterprise])\n        .launch()\n        .await\n        .unwrap();\n}\n</code></pre>"},{"location":"rust/middleware/rocket/#accessing-payment-details","title":"Accessing Payment Details","text":"<pre><code>#[get(\"/paid-endpoint\")]\nfn paid_endpoint(auth: PaymentGuard) -&gt; Json&lt;serde_json::Value&gt; {\n    Json(serde_json::json!({\n        \"payment_id\": auth.authorization.payment_id,\n        \"amount_paid\": auth.authorization.actual_amount,\n        \"payer\": auth.authorization.public_key,\n        \"transaction\": auth.authorization.signature,\n    }))\n}\n</code></pre>"},{"location":"rust/middleware/rocket/#mixed-free-and-paid-endpoints","title":"Mixed Free and Paid Endpoints","text":"<pre><code>// Free endpoint\n#[get(\"/free\")]\nfn free_endpoint() -&gt; &amp;'static str {\n    \"This is free content\"\n}\n\n// Paid endpoint\n#[get(\"/paid\")]\nfn paid_endpoint(\n    config: &amp;State&lt;X402Config&gt;,\n    auth: Option&lt;PaymentGuard&gt;,\n) -&gt; Result&lt;&amp;'static str, PaymentRequiredResponse&gt; {\n    match auth {\n        Some(_) =&gt; Ok(\"This is paid content\"),\n        None =&gt; {\n            let req = PaymentRequirement::new(\"0.10\");\n            Err(PaymentRequiredResponse {\n                payment_request: create_payment_request(config, &amp;req, \"/paid\")\n            })\n        }\n    }\n}\n</code></pre>"},{"location":"rust/middleware/rocket/#best-practices","title":"Best Practices","text":""},{"location":"rust/middleware/rocket/#1-use-global-config-state","title":"1. Use Global Config State","text":"<pre><code>rocket::build()\n    .manage(config)  // Available in all routes via State&lt;X402Config&gt;\n    .mount(\"/\", routes![...])\n</code></pre>"},{"location":"rust/middleware/rocket/#2-set-reasonable-expirations","title":"2. Set Reasonable Expirations","text":"<pre><code>// Short-lived data\nlet req = PaymentRequirement::new(\"0.01\").with_expires_in(60);  // 1 minute\n\n// Standard\nlet req = PaymentRequirement::new(\"0.10\").with_expires_in(300);  // 5 minutes\n\n// Long-lived\nlet req = PaymentRequirement::new(\"1.00\").with_expires_in(3600);  // 1 hour\n</code></pre>"},{"location":"rust/middleware/rocket/#3-add-descriptions","title":"3. Add Descriptions","text":"<pre><code>let req = PaymentRequirement::new(\"0.10\")\n    .with_description(\"Access to real-time market data\");\n</code></pre>"},{"location":"rust/middleware/rocket/#4-enable-auto-verify-for-production","title":"4. Enable Auto-Verify for Production","text":"<pre><code>let config = X402Config {\n    // ...\n    auto_verify: true,  // Verify payments on-chain\n};\n</code></pre>"},{"location":"rust/middleware/rocket/#see-also","title":"See Also","text":"<ul> <li>Rocket Example - Complete example</li> <li>Server Quick Start - Getting started guide</li> <li>Configuration Reference - All options</li> </ul>"},{"location":"rust/reference/api-reference/","title":"API Reference","text":"<p>Complete API reference for all Rust packages.</p>"},{"location":"rust/reference/api-reference/#openlibx402-core","title":"openlibx402-core","text":""},{"location":"rust/reference/api-reference/#paymentrequest","title":"PaymentRequest","text":"<pre><code>pub struct PaymentRequest {\n    pub max_amount_required: String,\n    pub asset_type: String,\n    pub asset_address: String,\n    pub payment_address: String,\n    pub network: String,\n    pub expires_at: DateTime&lt;Utc&gt;,\n    pub nonce: String,\n    pub payment_id: String,\n    pub resource: String,\n    pub description: Option&lt;String&gt;,\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#methods","title":"Methods","text":"<pre><code>impl PaymentRequest {\n    pub fn new(\n        max_amount_required: String,\n        asset_address: String,\n        payment_address: String,\n        network: String,\n        expires_at: DateTime&lt;Utc&gt;,\n        nonce: String,\n        payment_id: String,\n        resource: String,\n    ) -&gt; Self\n\n    pub fn with_description(self, description: String) -&gt; Self\n    pub fn is_expired(&amp;self) -&gt; bool\n    pub fn from_json(json: &amp;str) -&gt; X402Result&lt;Self&gt;\n    pub fn to_json(&amp;self) -&gt; X402Result&lt;String&gt;\n    pub fn to_base64(&amp;self) -&gt; X402Result&lt;String&gt;\n    pub fn from_base64(encoded: &amp;str) -&gt; X402Result&lt;Self&gt;\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#paymentauthorization","title":"PaymentAuthorization","text":"<pre><code>pub struct PaymentAuthorization {\n    pub payment_id: String,\n    pub actual_amount: String,\n    pub payment_address: String,\n    pub asset_address: String,\n    pub network: String,\n    pub timestamp: DateTime&lt;Utc&gt;,\n    pub signature: String,\n    pub public_key: String,\n    pub transaction_hash: Option&lt;String&gt;,\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#methods_1","title":"Methods","text":"<pre><code>impl PaymentAuthorization {\n    pub fn new(\n        payment_id: String,\n        actual_amount: String,\n        payment_address: String,\n        asset_address: String,\n        network: String,\n        signature: String,\n        public_key: String,\n    ) -&gt; Self\n\n    pub fn from_json(json: &amp;str) -&gt; X402Result&lt;Self&gt;\n    pub fn to_json(&amp;self) -&gt; X402Result&lt;String&gt;\n    pub fn to_header_value(&amp;self) -&gt; X402Result&lt;String&gt;\n    pub fn from_header_value(encoded: &amp;str) -&gt; X402Result&lt;Self&gt;\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#solanapaymentprocessor","title":"SolanaPaymentProcessor","text":"<pre><code>pub struct SolanaPaymentProcessor {\n    // fields are private\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#methods_2","title":"Methods","text":"<pre><code>impl SolanaPaymentProcessor {\n    pub fn new(rpc_url: &amp;str, commitment: Option&lt;CommitmentConfig&gt;) -&gt; Self\n\n    pub fn default_rpc_url(network: &amp;str) -&gt; &amp;'static str\n\n    pub async fn create_payment(\n        &amp;self,\n        request: &amp;PaymentRequest,\n        payer: &amp;Keypair,\n    ) -&gt; X402Result&lt;PaymentAuthorization&gt;\n\n    pub async fn verify_payment(\n        &amp;self,\n        authorization: &amp;PaymentAuthorization,\n        expected_amount: &amp;str,\n    ) -&gt; X402Result&lt;bool&gt;\n\n    pub async fn get_token_balance(&amp;self, token_account: &amp;Pubkey) -&gt; X402Result&lt;u64&gt;\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#x402error","title":"X402Error","text":"<pre><code>pub enum X402Error {\n    PaymentRequired(String),\n    PaymentExpired(String),\n    InsufficientFunds(String),\n    PaymentVerification(String),\n    TransactionBroadcast(String),\n    InvalidPaymentRequest(String),\n    InvalidPaymentAuthorization(String),\n    Configuration(String),\n    Network(String),\n    Blockchain(String),\n    Serialization(String),\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#methods_3","title":"Methods","text":"<pre><code>impl X402Error {\n    pub fn code(&amp;self) -&gt; &amp;'static str\n    pub fn message(&amp;self) -&gt; String\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#type-aliases","title":"Type Aliases","text":"<pre><code>pub type X402Result&lt;T&gt; = Result&lt;T, X402Error&gt;;\n</code></pre>"},{"location":"rust/reference/api-reference/#constants","title":"Constants","text":"<pre><code>pub const VERSION: &amp;str = env!(\"CARGO_PKG_VERSION\");\n</code></pre>"},{"location":"rust/reference/api-reference/#openlibx402-client","title":"openlibx402-client","text":""},{"location":"rust/reference/api-reference/#x402client","title":"X402Client","text":"<pre><code>pub struct X402Client {\n    // fields are private\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#methods_4","title":"Methods","text":"<pre><code>impl X402Client {\n    pub fn new(keypair: Keypair, rpc_url: Option&lt;&amp;str&gt;) -&gt; Self\n\n    pub async fn get(&amp;self, url: &amp;str) -&gt; X402Result&lt;Response&gt;\n\n    pub async fn get_with_auth(\n        &amp;self,\n        url: &amp;str,\n        authorization: &amp;PaymentAuthorization,\n    ) -&gt; X402Result&lt;Response&gt;\n\n    pub async fn post(&amp;self, url: &amp;str, body: Option&lt;String&gt;) -&gt; X402Result&lt;Response&gt;\n\n    pub async fn post_with_auth(\n        &amp;self,\n        url: &amp;str,\n        body: Option&lt;String&gt;,\n        authorization: &amp;PaymentAuthorization,\n    ) -&gt; X402Result&lt;Response&gt;\n\n    pub fn is_payment_required(&amp;self, response: &amp;Response) -&gt; bool\n\n    pub async fn parse_payment_request(&amp;self, response: Response) -&gt; X402Result&lt;PaymentRequest&gt;\n\n    pub async fn create_payment(\n        &amp;self,\n        request: &amp;PaymentRequest,\n    ) -&gt; X402Result&lt;PaymentAuthorization&gt;\n\n    pub async fn verify_payment(\n        &amp;self,\n        authorization: &amp;PaymentAuthorization,\n        expected_amount: &amp;str,\n    ) -&gt; X402Result&lt;bool&gt;\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#x402autoclient","title":"X402AutoClient","text":"<pre><code>pub struct X402AutoClient {\n    // fields are private\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#methods_5","title":"Methods","text":"<pre><code>impl X402AutoClient {\n    pub fn new(\n        keypair: Keypair,\n        rpc_url: Option&lt;&amp;str&gt;,\n        options: Option&lt;AutoClientOptions&gt;,\n    ) -&gt; Self\n\n    pub async fn get(&amp;self, url: &amp;str) -&gt; X402Result&lt;Response&gt;\n\n    pub async fn post(&amp;self, url: &amp;str, body: Option&lt;String&gt;) -&gt; X402Result&lt;Response&gt;\n\n    pub fn client(&amp;self) -&gt; &amp;X402Client\n\n    pub fn options(&amp;self) -&gt; &amp;AutoClientOptions\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#autoclientoptions","title":"AutoClientOptions","text":"<pre><code>#[derive(Debug, Clone)]\npub struct AutoClientOptions {\n    pub max_payment_amount: String,\n    pub auto_retry: bool,\n    pub max_retries: u32,\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#methods_6","title":"Methods","text":"<pre><code>impl Default for AutoClientOptions {\n    fn default() -&gt; Self {\n        Self {\n            max_payment_amount: \"10.0\".to_string(),\n            auto_retry: true,\n            max_retries: 3,\n        }\n    }\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#openlibx402-rocket","title":"openlibx402-rocket","text":""},{"location":"rust/reference/api-reference/#x402config","title":"X402Config","text":"<pre><code>#[derive(Debug, Clone)]\npub struct X402Config {\n    pub payment_address: String,\n    pub token_mint: String,\n    pub network: String,\n    pub rpc_url: Option&lt;String&gt;,\n    pub auto_verify: bool,\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#paymentrequirement","title":"PaymentRequirement","text":"<pre><code>#[derive(Debug, Clone)]\npub struct PaymentRequirement {\n    pub amount: String,\n    pub description: Option&lt;String&gt;,\n    pub expires_in: i64,\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#methods_7","title":"Methods","text":"<pre><code>impl PaymentRequirement {\n    pub fn new(amount: &amp;str) -&gt; Self\n    pub fn with_description(self, description: &amp;str) -&gt; Self\n    pub fn with_expires_in(self, seconds: i64) -&gt; Self\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#paymentguard","title":"PaymentGuard","text":"<pre><code>pub struct PaymentGuard {\n    pub authorization: PaymentAuthorization,\n}\n</code></pre> <p>Implements <code>FromRequest</code> for automatic extraction from HTTP requests.</p>"},{"location":"rust/reference/api-reference/#paymentrequiredresponse","title":"PaymentRequiredResponse","text":"<pre><code>pub struct PaymentRequiredResponse {\n    pub payment_request: PaymentRequest,\n}\n</code></pre> <p>Implements <code>Responder</code> to return 402 status with JSON body.</p>"},{"location":"rust/reference/api-reference/#functions","title":"Functions","text":"<pre><code>pub fn create_payment_request(\n    config: &amp;X402Config,\n    requirement: &amp;PaymentRequirement,\n    resource: &amp;str,\n) -&gt; PaymentRequest\n</code></pre>"},{"location":"rust/reference/api-reference/#openlibx402-actix","title":"openlibx402-actix","text":""},{"location":"rust/reference/api-reference/#x402config_1","title":"X402Config","text":"<pre><code>#[derive(Debug, Clone)]\npub struct X402Config {\n    pub payment_address: String,\n    pub token_mint: String,\n    pub network: String,\n    pub rpc_url: Option&lt;String&gt;,\n    pub auto_verify: bool,\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#x402state","title":"X402State","text":"<pre><code>#[derive(Debug, Clone)]\npub struct X402State {\n    pub config: X402Config,\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#paymentrequirement_1","title":"PaymentRequirement","text":"<pre><code>#[derive(Debug, Clone)]\npub struct PaymentRequirement {\n    pub amount: String,\n    pub description: Option&lt;String&gt;,\n    pub expires_in: i64,\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#methods_8","title":"Methods","text":"<pre><code>impl PaymentRequirement {\n    pub fn new(amount: &amp;str) -&gt; Self\n    pub fn with_description(self, description: &amp;str) -&gt; Self\n    pub fn with_expires_in(self, seconds: i64) -&gt; Self\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#paymentextractor","title":"PaymentExtractor","text":"<pre><code>pub struct PaymentExtractor {\n    pub authorization: PaymentAuthorization,\n}\n</code></pre> <p>Implements <code>FromRequest</code> for automatic extraction from HTTP requests.</p>"},{"location":"rust/reference/api-reference/#paymenterror","title":"PaymentError","text":"<pre><code>pub enum PaymentError {\n    Required,\n    InvalidHeader,\n    InvalidAuthorization(String),\n}\n</code></pre> <p>Implements <code>ResponseError</code> for automatic HTTP error responses.</p>"},{"location":"rust/reference/api-reference/#functions_1","title":"Functions","text":"<pre><code>pub fn create_payment_request(\n    config: &amp;X402Config,\n    requirement: &amp;PaymentRequirement,\n    resource: &amp;str,\n) -&gt; PaymentRequest\n\npub fn payment_required_response(payment_request: PaymentRequest) -&gt; HttpResponse\n</code></pre>"},{"location":"rust/reference/api-reference/#usage-examples","title":"Usage Examples","text":""},{"location":"rust/reference/api-reference/#core","title":"Core","text":"<pre><code>use openlibx402_core::{PaymentRequest, PaymentAuthorization, SolanaPaymentProcessor};\n\n// Create payment processor\nlet processor = SolanaPaymentProcessor::new(\"https://api.devnet.solana.com\", None);\n\n// Create payment\nlet authorization = processor.create_payment(&amp;payment_request, &amp;keypair).await?;\n\n// Verify payment\nlet verified = processor.verify_payment(&amp;authorization, \"0.10\").await?;\n</code></pre>"},{"location":"rust/reference/api-reference/#client","title":"Client","text":"<pre><code>use openlibx402_client::{X402AutoClient, AutoClientOptions};\n\nlet options = AutoClientOptions {\n    max_payment_amount: \"5.0\".to_string(),\n    auto_retry: true,\n    max_retries: 3,\n};\n\nlet client = X402AutoClient::new(keypair, None, Some(options));\nlet response = client.get(\"http://localhost:8000/premium\").await?;\n</code></pre>"},{"location":"rust/reference/api-reference/#rocket","title":"Rocket","text":"<pre><code>use openlibx402_rocket::{PaymentGuard, X402Config};\n\n#[get(\"/premium\")]\nfn premium(auth: PaymentGuard) -&gt; String {\n    format!(\"Payment ID: {}\", auth.authorization.payment_id)\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#actix-web","title":"Actix Web","text":"<pre><code>use openlibx402_actix::{PaymentExtractor, X402State};\n\n#[get(\"/premium\")]\nasync fn premium(auth: PaymentExtractor) -&gt; HttpResponse {\n    HttpResponse::Ok().json(serde_json::json!({\n        \"payment_id\": auth.authorization.payment_id\n    }))\n}\n</code></pre>"},{"location":"rust/reference/api-reference/#see-also","title":"See Also","text":"<ul> <li>Configuration Reference</li> <li>Error Handling</li> <li>Core Library</li> <li>Client Library</li> </ul>"},{"location":"rust/reference/configuration/","title":"Configuration Reference","text":"<p>Complete configuration reference for all Rust packages.</p>"},{"location":"rust/reference/configuration/#server-configuration","title":"Server Configuration","text":""},{"location":"rust/reference/configuration/#x402config","title":"X402Config","text":"<p>Global configuration for X402 payments in server applications.</p> <pre><code>pub struct X402Config {\n    /// Wallet address to receive payments\n    pub payment_address: String,\n\n    /// SPL token mint address (USDC)\n    pub token_mint: String,\n\n    /// Solana network identifier\n    pub network: String,\n\n    /// Optional custom RPC URL\n    pub rpc_url: Option&lt;String&gt;,\n\n    /// Whether to verify payments on-chain\n    pub auto_verify: bool,\n}\n</code></pre>"},{"location":"rust/reference/configuration/#configuration-options","title":"Configuration Options","text":""},{"location":"rust/reference/configuration/#payment_address-required","title":"payment_address (Required)","text":"<p>Your Solana wallet address that will receive payments.</p> <pre><code>payment_address: \"7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU\".to_string()\n</code></pre> <p>How to get: <pre><code># View your wallet address\nsolana-keygen pubkey ~/.config/solana/id.json\n</code></pre></p>"},{"location":"rust/reference/configuration/#token_mint-required","title":"token_mint (Required)","text":"<p>The SPL token mint address for the token you want to receive.</p> <pre><code>// USDC on Devnet\ntoken_mint: \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\".to_string()\n\n// USDC on Mainnet\ntoken_mint: \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\".to_string()\n</code></pre>"},{"location":"rust/reference/configuration/#network-required","title":"network (Required)","text":"<p>The Solana network to use.</p> <pre><code>// For development and testing\nnetwork: \"solana-devnet\".to_string()\n\n// For production\nnetwork: \"solana-mainnet\".to_string()\n\n// For testing\nnetwork: \"solana-testnet\".to_string()\n</code></pre>"},{"location":"rust/reference/configuration/#rpc_url-optional","title":"rpc_url (Optional)","text":"<p>Custom RPC endpoint. If not specified, uses default for the network.</p> <pre><code>// Use default\nrpc_url: None\n\n// Use custom RPC\nrpc_url: Some(\"https://your-rpc-endpoint.com\".to_string())\n</code></pre> <p>Default RPC URLs: - Devnet: <code>https://api.devnet.solana.com</code> - Mainnet: <code>https://api.mainnet-beta.solana.com</code> - Testnet: <code>https://api.testnet.solana.com</code></p>"},{"location":"rust/reference/configuration/#auto_verify-required","title":"auto_verify (Required)","text":"<p>Whether to automatically verify payments on-chain.</p> <pre><code>// Verify all payments (recommended for production)\nauto_verify: true\n\n// Skip verification (faster, less secure)\nauto_verify: false\n</code></pre> <p>Recommendation: Enable for production, can disable for development.</p>"},{"location":"rust/reference/configuration/#example-configurations","title":"Example Configurations","text":""},{"location":"rust/reference/configuration/#development","title":"Development","text":"<pre><code>let config = X402Config {\n    payment_address: env::var(\"PAYMENT_ADDRESS\")?,\n    token_mint: \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\".to_string(),\n    network: \"solana-devnet\".to_string(),\n    rpc_url: None,\n    auto_verify: false,  // Faster for development\n};\n</code></pre>"},{"location":"rust/reference/configuration/#production","title":"Production","text":"<pre><code>let config = X402Config {\n    payment_address: env::var(\"PAYMENT_ADDRESS\")?,\n    token_mint: \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\".to_string(),\n    network: \"solana-mainnet\".to_string(),\n    rpc_url: Some(env::var(\"SOLANA_RPC_URL\")?),  // Use dedicated RPC\n    auto_verify: true,  // Verify all payments\n};\n</code></pre>"},{"location":"rust/reference/configuration/#high-performance","title":"High Performance","text":"<pre><code>let config = X402Config {\n    payment_address: env::var(\"PAYMENT_ADDRESS\")?,\n    token_mint: \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\".to_string(),\n    network: \"solana-mainnet\".to_string(),\n    rpc_url: Some(\"https://your-fast-rpc.com\".to_string()),\n    auto_verify: true,\n};\n</code></pre>"},{"location":"rust/reference/configuration/#payment-requirements","title":"Payment Requirements","text":""},{"location":"rust/reference/configuration/#paymentrequirement","title":"PaymentRequirement","text":"<p>Configuration for individual endpoint payment requirements.</p> <pre><code>pub struct PaymentRequirement {\n    /// Amount required in USDC\n    pub amount: String,\n\n    /// Optional human-readable description\n    pub description: Option&lt;String&gt;,\n\n    /// Expiration time in seconds (default: 300)\n    pub expires_in: i64,\n}\n</code></pre>"},{"location":"rust/reference/configuration/#configuration-options_1","title":"Configuration Options","text":""},{"location":"rust/reference/configuration/#amount-required","title":"amount (Required)","text":"<p>Payment amount in USDC.</p> <pre><code>// Micropayment\nlet req = PaymentRequirement::new(\"0.001\");\n\n// Standard\nlet req = PaymentRequirement::new(\"0.10\");\n\n// Premium\nlet req = PaymentRequirement::new(\"1.00\");\n</code></pre>"},{"location":"rust/reference/configuration/#description-optional","title":"description (Optional)","text":"<p>Human-readable description shown to users.</p> <pre><code>let req = PaymentRequirement::new(\"0.10\")\n    .with_description(\"Access to premium market data\");\n</code></pre>"},{"location":"rust/reference/configuration/#expires_in-optional","title":"expires_in (Optional)","text":"<p>Payment validity duration in seconds.</p> <pre><code>// Short-lived: 1 minute\nlet req = PaymentRequirement::new(\"0.01\")\n    .with_expires_in(60);\n\n// Standard: 5 minutes (default)\nlet req = PaymentRequirement::new(\"0.10\")\n    .with_expires_in(300);\n\n// Long-lived: 1 hour\nlet req = PaymentRequirement::new(\"1.00\")\n    .with_expires_in(3600);\n</code></pre> <p>Recommendation: Use shorter expirations for lower amounts, longer for higher amounts.</p>"},{"location":"rust/reference/configuration/#example-requirements","title":"Example Requirements","text":""},{"location":"rust/reference/configuration/#basic-tier","title":"Basic Tier","text":"<pre><code>PaymentRequirement::new(\"0.01\")\n    .with_description(\"Basic tier access\")\n    .with_expires_in(300)\n</code></pre>"},{"location":"rust/reference/configuration/#premium-tier","title":"Premium Tier","text":"<pre><code>PaymentRequirement::new(\"0.10\")\n    .with_description(\"Premium tier with advanced features\")\n    .with_expires_in(600)\n</code></pre>"},{"location":"rust/reference/configuration/#enterprise-tier","title":"Enterprise Tier","text":"<pre><code>PaymentRequirement::new(\"5.00\")\n    .with_description(\"Enterprise tier with full API access\")\n    .with_expires_in(3600)\n</code></pre>"},{"location":"rust/reference/configuration/#client-configuration","title":"Client Configuration","text":""},{"location":"rust/reference/configuration/#autoclientoptions","title":"AutoClientOptions","text":"<p>Configuration for automatic payment handling.</p> <pre><code>pub struct AutoClientOptions {\n    /// Maximum amount willing to pay automatically (in USDC)\n    pub max_payment_amount: String,\n\n    /// Whether to automatically retry after payment\n    pub auto_retry: bool,\n\n    /// Maximum number of retry attempts\n    pub max_retries: u32,\n}\n</code></pre>"},{"location":"rust/reference/configuration/#configuration-options_2","title":"Configuration Options","text":""},{"location":"rust/reference/configuration/#max_payment_amount-optional","title":"max_payment_amount (Optional)","text":"<p>Maximum amount the client will automatically pay.</p> <pre><code>// Conservative\nlet options = AutoClientOptions {\n    max_payment_amount: \"1.0\".to_string(),\n    ..Default::default()\n};\n\n// Moderate\nlet options = AutoClientOptions {\n    max_payment_amount: \"10.0\".to_string(),  // Default\n    ..Default::default()\n};\n\n// Generous\nlet options = AutoClientOptions {\n    max_payment_amount: \"100.0\".to_string(),\n    ..Default::default()\n};\n</code></pre>"},{"location":"rust/reference/configuration/#auto_retry-optional","title":"auto_retry (Optional)","text":"<p>Whether to automatically retry after payment.</p> <pre><code>// Auto-retry (default)\nlet options = AutoClientOptions {\n    auto_retry: true,\n    ..Default::default()\n};\n\n// Manual retry\nlet options = AutoClientOptions {\n    auto_retry: false,\n    ..Default::default()\n};\n</code></pre>"},{"location":"rust/reference/configuration/#max_retries-optional","title":"max_retries (Optional)","text":"<p>Maximum retry attempts after payment.</p> <pre><code>// Few retries\nlet options = AutoClientOptions {\n    max_retries: 1,\n    ..Default::default()\n};\n\n// Standard\nlet options = AutoClientOptions {\n    max_retries: 3,  // Default\n    ..Default::default()\n};\n\n// Many retries\nlet options = AutoClientOptions {\n    max_retries: 10,\n    ..Default::default()\n};\n</code></pre>"},{"location":"rust/reference/configuration/#example-configurations_1","title":"Example Configurations","text":""},{"location":"rust/reference/configuration/#conservative","title":"Conservative","text":"<pre><code>let options = AutoClientOptions {\n    max_payment_amount: \"1.0\".to_string(),\n    auto_retry: true,\n    max_retries: 1,\n};\n</code></pre>"},{"location":"rust/reference/configuration/#balanced-default","title":"Balanced (Default)","text":"<pre><code>let options = AutoClientOptions {\n    max_payment_amount: \"10.0\".to_string(),\n    auto_retry: true,\n    max_retries: 3,\n};\n</code></pre>"},{"location":"rust/reference/configuration/#aggressive","title":"Aggressive","text":"<pre><code>let options = AutoClientOptions {\n    max_payment_amount: \"100.0\".to_string(),\n    auto_retry: true,\n    max_retries: 5,\n};\n</code></pre>"},{"location":"rust/reference/configuration/#environment-variables","title":"Environment Variables","text":"<p>Recommended environment variables for configuration.</p>"},{"location":"rust/reference/configuration/#server","title":"Server","text":"<pre><code># Required\nexport X402_PAYMENT_ADDRESS=\"7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU\"\nexport X402_TOKEN_MINT=\"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\"\nexport X402_NETWORK=\"solana-devnet\"\n\n# Optional\nexport X402_RPC_URL=\"https://your-rpc.com\"\nexport X402_AUTO_VERIFY=\"true\"\n</code></pre>"},{"location":"rust/reference/configuration/#client","title":"Client","text":"<pre><code># Required\nexport SOLANA_KEYPAIR=\"$HOME/.config/solana/id.json\"\n\n# Optional\nexport X402_MAX_PAYMENT=\"10.0\"\nexport X402_MAX_RETRIES=\"3\"\nexport SOLANA_RPC_URL=\"https://api.devnet.solana.com\"\n</code></pre>"},{"location":"rust/reference/configuration/#loading-from-environment","title":"Loading from Environment","text":"<pre><code>use std::env;\n\n// Server\nlet config = X402Config {\n    payment_address: env::var(\"X402_PAYMENT_ADDRESS\")?,\n    token_mint: env::var(\"X402_TOKEN_MINT\")?,\n    network: env::var(\"X402_NETWORK\")?,\n    rpc_url: env::var(\"X402_RPC_URL\").ok(),\n    auto_verify: env::var(\"X402_AUTO_VERIFY\").unwrap_or(\"true\".to_string()) == \"true\",\n};\n\n// Client\nlet keypair = read_keypair_file(env::var(\"SOLANA_KEYPAIR\")?)?;\nlet options = AutoClientOptions {\n    max_payment_amount: env::var(\"X402_MAX_PAYMENT\").unwrap_or(\"10.0\".to_string()),\n    auto_retry: true,\n    max_retries: env::var(\"X402_MAX_RETRIES\")\n        .unwrap_or(\"3\".to_string())\n        .parse()\n        .unwrap_or(3),\n};\n</code></pre>"},{"location":"rust/reference/configuration/#best-practices","title":"Best Practices","text":""},{"location":"rust/reference/configuration/#1-use-environment-variables-in-production","title":"1. Use Environment Variables in Production","text":"<pre><code>let config = X402Config {\n    payment_address: env::var(\"X402_PAYMENT_ADDRESS\")\n        .expect(\"X402_PAYMENT_ADDRESS must be set\"),\n    // ...\n};\n</code></pre>"},{"location":"rust/reference/configuration/#2-enable-verification-in-production","title":"2. Enable Verification in Production","text":"<pre><code>auto_verify: env::var(\"ENV\")\n    .map(|e| e == \"production\")\n    .unwrap_or(false)\n</code></pre>"},{"location":"rust/reference/configuration/#3-use-dedicated-rpc-endpoints","title":"3. Use Dedicated RPC Endpoints","text":"<pre><code>rpc_url: Some(env::var(\"SOLANA_RPC_URL\")?)\n</code></pre>"},{"location":"rust/reference/configuration/#4-set-reasonable-payment-limits","title":"4. Set Reasonable Payment Limits","text":"<pre><code>max_payment_amount: \"10.0\".to_string()  // Not too high, not too low\n</code></pre>"},{"location":"rust/reference/configuration/#5-log-configuration-safely","title":"5. Log Configuration (Safely)","text":"<pre><code>println!(\"X402 Config:\");\nprintln!(\"  Network: {}\", config.network);\nprintln!(\"  Auto-verify: {}\", config.auto_verify);\n// Don't log sensitive data like private keys\n</code></pre>"},{"location":"rust/reference/configuration/#see-also","title":"See Also","text":"<ul> <li>API Reference</li> <li>Error Handling</li> <li>Server Quick Start</li> <li>Client Quick Start</li> </ul>"},{"location":"rust/reference/errors/","title":"Error Handling","text":"<p>Comprehensive guide to error handling in OpenLibx402 Rust SDK.</p>"},{"location":"rust/reference/errors/#x402error-enum","title":"X402Error Enum","text":"<p>All X402 operations return <code>X402Result&lt;T&gt;</code> which is an alias for <code>Result&lt;T, X402Error&gt;</code>.</p> <pre><code>pub enum X402Error {\n    PaymentRequired(String),\n    PaymentExpired(String),\n    InsufficientFunds(String),\n    PaymentVerification(String),\n    TransactionBroadcast(String),\n    InvalidPaymentRequest(String),\n    InvalidPaymentAuthorization(String),\n    Configuration(String),\n    Network(String),\n    Blockchain(String),\n    Serialization(String),\n}\n</code></pre>"},{"location":"rust/reference/errors/#error-types","title":"Error Types","text":""},{"location":"rust/reference/errors/#paymentrequired","title":"PaymentRequired","text":"<p>Payment is required to access the resource.</p> <p>When it occurs: - Client makes request without payment authorization - Server returns 402 status code - Auto client exceeds max payment amount</p> <p>Example: <pre><code>match client.get(url).await {\n    Err(X402Error::PaymentRequired(msg)) =&gt; {\n        eprintln!(\"Payment required: {}\", msg);\n        // Handle by creating payment\n    }\n    // ...\n}\n</code></pre></p> <p>Error code: <code>PAYMENT_REQUIRED</code></p>"},{"location":"rust/reference/errors/#paymentexpired","title":"PaymentExpired","text":"<p>The payment request or authorization has expired.</p> <p>When it occurs: - Payment request timestamp has passed - Attempting to use expired payment authorization - Server rejects expired payment</p> <p>Example: <pre><code>match processor.create_payment(&amp;request, &amp;keypair).await {\n    Err(X402Error::PaymentExpired(msg)) =&gt; {\n        eprintln!(\"Payment expired: {}\", msg);\n        // Request new payment details from server\n    }\n    // ...\n}\n</code></pre></p> <p>Error code: <code>PAYMENT_EXPIRED</code></p>"},{"location":"rust/reference/errors/#insufficientfunds","title":"InsufficientFunds","text":"<p>Wallet doesn't have enough funds for the payment.</p> <p>When it occurs: - Token balance is less than required amount - Not enough SOL for transaction fees</p> <p>Example: <pre><code>match processor.create_payment(&amp;request, &amp;keypair).await {\n    Err(X402Error::InsufficientFunds(msg)) =&gt; {\n        eprintln!(\"Insufficient funds: {}\", msg);\n        // Show user balance and required amount\n        // Prompt to add funds\n    }\n    // ...\n}\n</code></pre></p> <p>Error code: <code>INSUFFICIENT_FUNDS</code></p>"},{"location":"rust/reference/errors/#paymentverification","title":"PaymentVerification","text":"<p>Payment verification failed.</p> <p>When it occurs: - Transaction not found on-chain - Amount doesn't match expected - Transaction failed - Invalid transaction signature</p> <p>Example: <pre><code>match processor.verify_payment(&amp;auth, \"0.10\").await {\n    Err(X402Error::PaymentVerification(msg)) =&gt; {\n        eprintln!(\"Verification failed: {}\", msg);\n        // Payment may not be confirmed yet\n        // Or transaction details don't match\n    }\n    // ...\n}\n</code></pre></p> <p>Error code: <code>PAYMENT_VERIFICATION_FAILED</code></p>"},{"location":"rust/reference/errors/#transactionbroadcast","title":"TransactionBroadcast","text":"<p>Failed to broadcast transaction to the blockchain.</p> <p>When it occurs: - Network connectivity issues - RPC endpoint unavailable - Invalid transaction - Nonce errors</p> <p>Example: <pre><code>match processor.create_payment(&amp;request, &amp;keypair).await {\n    Err(X402Error::TransactionBroadcast(msg)) =&gt; {\n        eprintln!(\"Broadcast failed: {}\", msg);\n        // Retry with exponential backoff\n        // Or try different RPC endpoint\n    }\n    // ...\n}\n</code></pre></p> <p>Error code: <code>TRANSACTION_BROADCAST_FAILED</code></p>"},{"location":"rust/reference/errors/#invalidpaymentrequest","title":"InvalidPaymentRequest","text":"<p>Payment request is malformed or invalid.</p> <p>When it occurs: - JSON parsing fails - Required fields missing - Invalid addresses - Invalid amounts</p> <p>Example: <pre><code>match PaymentRequest::from_json(json) {\n    Err(X402Error::InvalidPaymentRequest(msg)) =&gt; {\n        eprintln!(\"Invalid payment request: {}\", msg);\n        // Server sent bad data\n    }\n    // ...\n}\n</code></pre></p> <p>Error code: <code>INVALID_PAYMENT_REQUEST</code></p>"},{"location":"rust/reference/errors/#invalidpaymentauthorization","title":"InvalidPaymentAuthorization","text":"<p>Payment authorization is malformed or invalid.</p> <p>When it occurs: - Header parsing fails - Base64 decoding fails - Required fields missing - Invalid format</p> <p>Example: <pre><code>match PaymentAuthorization::from_header_value(header) {\n    Err(X402Error::InvalidPaymentAuthorization(msg)) =&gt; {\n        eprintln!(\"Invalid authorization: {}\", msg);\n        // Client sent bad authorization\n    }\n    // ...\n}\n</code></pre></p> <p>Error code: <code>INVALID_PAYMENT_AUTHORIZATION</code></p>"},{"location":"rust/reference/errors/#configuration","title":"Configuration","text":"<p>Configuration error.</p> <p>When it occurs: - Invalid wallet addresses - Invalid network names - Missing required configuration - Invalid RPC URLs</p> <p>Example: <pre><code>let config = X402Config {\n    payment_address: \"invalid\".to_string(),  // Invalid address\n    // ...\n};\n// Error will occur when used\n</code></pre></p> <p>Error code: <code>CONFIGURATION_ERROR</code></p>"},{"location":"rust/reference/errors/#network","title":"Network","text":"<p>Network or HTTP error.</p> <p>When it occurs: - HTTP request fails - Connection timeout - DNS resolution fails - Server unreachable</p> <p>Example: <pre><code>match client.get(url).await {\n    Err(X402Error::Network(msg)) =&gt; {\n        eprintln!(\"Network error: {}\", msg);\n        // Retry with backoff\n    }\n    // ...\n}\n</code></pre></p> <p>Error code: <code>NETWORK_ERROR</code></p>"},{"location":"rust/reference/errors/#blockchain","title":"Blockchain","text":"<p>Solana blockchain error.</p> <p>When it occurs: - RPC errors - Account not found - Program errors - Transaction simulation fails</p> <p>Example: <pre><code>match processor.create_payment(&amp;request, &amp;keypair).await {\n    Err(X402Error::Blockchain(msg)) =&gt; {\n        eprintln!(\"Blockchain error: {}\", msg);\n        // May be transient, retry\n    }\n    // ...\n}\n</code></pre></p> <p>Error code: <code>BLOCKCHAIN_ERROR</code></p>"},{"location":"rust/reference/errors/#serialization","title":"Serialization","text":"<p>JSON serialization/deserialization error.</p> <p>When it occurs: - JSON parsing fails - Base64 encoding/decoding fails - Invalid UTF-8</p> <p>Example: <pre><code>match payment_request.to_json() {\n    Err(X402Error::Serialization(msg)) =&gt; {\n        eprintln!(\"Serialization error: {}\", msg);\n        // Data structure issue\n    }\n    // ...\n}\n</code></pre></p> <p>Error code: <code>SERIALIZATION_ERROR</code></p>"},{"location":"rust/reference/errors/#error-handling-patterns","title":"Error Handling Patterns","text":""},{"location":"rust/reference/errors/#basic-error-handling","title":"Basic Error Handling","text":"<pre><code>use openlibx402_core::X402Error;\n\nmatch client.get(url).await {\n    Ok(response) =&gt; {\n        // Handle success\n    }\n    Err(e) =&gt; {\n        eprintln!(\"Error: {}\", e);\n    }\n}\n</code></pre>"},{"location":"rust/reference/errors/#match-specific-errors","title":"Match Specific Errors","text":"<pre><code>match client.get(url).await {\n    Ok(response) =&gt; {\n        // Handle success\n    }\n    Err(X402Error::PaymentRequired(msg)) =&gt; {\n        // Handle payment required\n    }\n    Err(X402Error::InsufficientFunds(msg)) =&gt; {\n        // Handle insufficient funds\n    }\n    Err(X402Error::Network(msg)) =&gt; {\n        // Handle network error\n    }\n    Err(e) =&gt; {\n        // Handle other errors\n        eprintln!(\"Error: {}\", e);\n    }\n}\n</code></pre>"},{"location":"rust/reference/errors/#retry-logic","title":"Retry Logic","text":"<pre><code>use tokio::time::{sleep, Duration};\n\nasync fn retry_with_backoff&lt;F, T&gt;(\n    mut f: F,\n    max_retries: u32,\n) -&gt; Result&lt;T, X402Error&gt;\nwhere\n    F: FnMut() -&gt; std::pin::Pin&lt;Box&lt;dyn std::future::Future&lt;Output = Result&lt;T, X402Error&gt;&gt;&gt;&gt;,\n{\n    let mut retries = 0;\n    let mut delay = Duration::from_millis(100);\n\n    loop {\n        match f().await {\n            Ok(result) =&gt; return Ok(result),\n            Err(e) =&gt; {\n                retries += 1;\n                if retries &gt;= max_retries {\n                    return Err(e);\n                }\n\n                match e {\n                    X402Error::Network(_) | X402Error::TransactionBroadcast(_) =&gt; {\n                        // Retry network and broadcast errors\n                        sleep(delay).await;\n                        delay *= 2; // Exponential backoff\n                    }\n                    _ =&gt; return Err(e), // Don't retry other errors\n                }\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"rust/reference/errors/#error-recovery","title":"Error Recovery","text":"<pre><code>async fn fetch_with_recovery(client: &amp;X402AutoClient, url: &amp;str) -&gt; Result&lt;String, Box&lt;dyn std::error::Error&gt;&gt; {\n    match client.get(url).await {\n        Ok(response) =&gt; Ok(response.text().await?),\n        Err(X402Error::PaymentExpired(_)) =&gt; {\n            // Payment expired, retry automatically\n            client.get(url).await?.text().await.map_err(Into::into)\n        }\n        Err(X402Error::InsufficientFunds(msg)) =&gt; {\n            Err(format!(\"Please add funds to your wallet: {}\", msg).into())\n        }\n        Err(X402Error::Network(_)) =&gt; {\n            // Retry once for network errors\n            sleep(Duration::from_secs(1)).await;\n            client.get(url).await?.text().await.map_err(Into::into)\n        }\n        Err(e) =&gt; Err(e.into()),\n    }\n}\n</code></pre>"},{"location":"rust/reference/errors/#logging-errors","title":"Logging Errors","text":"<pre><code>use log::{error, warn, info};\n\nmatch client.get(url).await {\n    Ok(response) =&gt; {\n        info!(\"Request successful\");\n    }\n    Err(X402Error::PaymentRequired(msg)) =&gt; {\n        info!(\"Payment required: {}\", msg);\n    }\n    Err(X402Error::PaymentExpired(msg)) =&gt; {\n        warn!(\"Payment expired: {}\", msg);\n    }\n    Err(X402Error::InsufficientFunds(msg)) =&gt; {\n        error!(\"Insufficient funds: {}\", msg);\n    }\n    Err(e) =&gt; {\n        error!(\"Unexpected error: {}\", e);\n    }\n}\n</code></pre>"},{"location":"rust/reference/errors/#custom-error-types","title":"Custom Error Types","text":"<pre><code>use thiserror::Error;\n\n#[derive(Error, Debug)]\npub enum AppError {\n    #[error(\"X402 error: {0}\")]\n    X402(#[from] X402Error),\n\n    #[error(\"Database error: {0}\")]\n    Database(String),\n\n    #[error(\"Application error: {0}\")]\n    Application(String),\n}\n\nasync fn app_logic() -&gt; Result&lt;(), AppError&gt; {\n    let response = client.get(url).await?;  // Auto-converts X402Error\n    // ... other logic\n    Ok(())\n}\n</code></pre>"},{"location":"rust/reference/errors/#error-methods","title":"Error Methods","text":""},{"location":"rust/reference/errors/#code","title":"code()","text":"<p>Get the error code as a string.</p> <pre><code>let error = X402Error::PaymentRequired(\"Payment needed\".to_string());\nprintln!(\"Code: {}\", error.code());  // \"PAYMENT_REQUIRED\"\n</code></pre>"},{"location":"rust/reference/errors/#message","title":"message()","text":"<p>Get the error message.</p> <pre><code>let error = X402Error::InsufficientFunds(\"Not enough USDC\".to_string());\nprintln!(\"Message: {}\", error.message());  // \"Insufficient funds: Not enough USDC\"\n</code></pre>"},{"location":"rust/reference/errors/#best-practices","title":"Best Practices","text":""},{"location":"rust/reference/errors/#1-always-handle-payment-required","title":"1. Always Handle Payment Required","text":"<pre><code>match client.get(url).await {\n    Ok(response) =&gt; { /* ... */ }\n    Err(X402Error::PaymentRequired(_)) =&gt; {\n        // Expected error, handle gracefully\n    }\n    Err(e) =&gt; {\n        // Unexpected error, log and handle\n        eprintln!(\"Unexpected error: {}\", e);\n    }\n}\n</code></pre>"},{"location":"rust/reference/errors/#2-provide-user-friendly-messages","title":"2. Provide User-Friendly Messages","text":"<pre><code>match error {\n    X402Error::InsufficientFunds(_) =&gt; {\n        \"You don't have enough USDC in your wallet. Please add funds.\"\n    }\n    X402Error::PaymentExpired(_) =&gt; {\n        \"Payment request expired. Refreshing...\"\n    }\n    X402Error::Network(_) =&gt; {\n        \"Network connection issue. Retrying...\"\n    }\n    _ =&gt; \"An error occurred. Please try again.\"\n}\n</code></pre>"},{"location":"rust/reference/errors/#3-log-errors-appropriately","title":"3. Log Errors Appropriately","text":"<pre><code>// Info level for expected errors\ninfo!(\"Payment required: {}\", msg);\n\n// Warn level for recoverable errors\nwarn!(\"Payment expired, retrying\");\n\n// Error level for unexpected errors\nerror!(\"Transaction broadcast failed: {}\", msg);\n</code></pre>"},{"location":"rust/reference/errors/#4-retry-transient-errors","title":"4. Retry Transient Errors","text":"<pre><code>match error {\n    X402Error::Network(_) |\n    X402Error::TransactionBroadcast(_) |\n    X402Error::Blockchain(_) =&gt; {\n        // These are often transient, retry\n        retry_operation().await?\n    }\n    _ =&gt; return Err(error),\n}\n</code></pre>"},{"location":"rust/reference/errors/#5-dont-retry-user-errors","title":"5. Don't Retry User Errors","text":"<pre><code>match error {\n    X402Error::InsufficientFunds(_) |\n    X402Error::InvalidPaymentRequest(_) |\n    X402Error::Configuration(_) =&gt; {\n        // User action required, don't retry\n        return Err(error);\n    }\n    _ =&gt; { /* ... */ }\n}\n</code></pre>"},{"location":"rust/reference/errors/#testing-with-errors","title":"Testing with Errors","text":"<pre><code>#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[tokio::test]\n    async fn test_insufficient_funds() {\n        // Test handling of insufficient funds\n        let keypair = Keypair::new();  // Empty wallet\n        let client = X402Client::new(keypair, None);\n\n        match client.create_payment(&amp;payment_request).await {\n            Err(X402Error::InsufficientFunds(_)) =&gt; {\n                // Expected error\n            }\n            _ =&gt; panic!(\"Expected InsufficientFunds error\"),\n        }\n    }\n\n    #[tokio::test]\n    async fn test_expired_payment() {\n        let expired_request = PaymentRequest {\n            expires_at: Utc::now() - Duration::seconds(10),\n            // ...\n        };\n\n        let processor = SolanaPaymentProcessor::new(rpc_url, None);\n        match processor.create_payment(&amp;expired_request, &amp;keypair).await {\n            Err(X402Error::PaymentExpired(_)) =&gt; {\n                // Expected error\n            }\n            _ =&gt; panic!(\"Expected PaymentExpired error\"),\n        }\n    }\n}\n</code></pre>"},{"location":"rust/reference/errors/#see-also","title":"See Also","text":"<ul> <li>API Reference</li> <li>Configuration</li> <li>Core Library</li> <li>Client Library</li> </ul>"}]}